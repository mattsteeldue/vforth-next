File: c:\Zx\forth\F15\tools\vForth\!Blocks-64.bin
Created: Mon Mar 17 21:27:14 2025

See index at end of file.

\ v-Forth 2.0 - NextZXOS version - build 2024-12-28
\ MIT License (c) 1990-2024 Matteo Vitturi
\ Read LICENSE.md file for MIT License terms agreement
\ or at Forth prompt use NEEDS VIEW and then VIEW LICENSE.md
\
\ This file provides persistency for BLOCK-Screen system.
\ The first 512 bytes of this file aren't used by BLOCK system
\ they're used by F_GETLINE primitive instead.



Scr# 1 
  0 98BLOCK system - introduction )
  1 (  This Forth System comes with a 16 MBytes file named
  2 (  !Blocks-64.bin that provides a BLOCK-like mass storage
  3 (  system to hold 32767 BLOCKs or 16383 Screens  that
  4 (  can be edited using the "Full Screen Editor" utility
  5 (  available after you type
  6 (
  7 (    NEEDS EDIT
  8 (
  9 (  Each BLOCK is 512 bytes and each Screen is 1 KByte long
 10 (  and can store text in 16 lines x 64 columns way or can
 11 (  be used as a virtual-memory area where you can
 12 (  persistently store anything you like.
 13 (
 14 (  Accessing the first blocks is faster than the others.
 15 (

Scr# 2 
  0 ( Error messages    from -31 to -17 )
  1 msg# -31
  2 
  3 
  4 
  5 
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 msg# -17

Scr# 3 
  0 ( Error messages    from -15 to -1  )
  1 msg# -15
  2 
  3 
  4 
  5 
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 msg# -1

Scr# 4 
  0 is undefined.
  1 Stack is empty.
  2 Dictionary full.
  3 No such a line.
  4 has already been defined.
  5 Invalid stream.
  6 No such a block.
  7 Stack full.
  8 Old dictionary is full.
  9 Tape error.
 10 Wrong array index.
 11 Invalid floating point.
 12 Heap full.
 13 Division by zero.
 14 Patching the wrong definition.
 15 [ BREAK ] was pressed.

Scr# 5 
  0 ( Error messages    from #17 to #31 )
  1 Can't be executed.
  2 Can't be compiled.
  3 Syntax error.
  4 Bad definition end.
  5 is a protected definition.
  6 Aren't loading now.
  7 Forget across vocabularies.
  8 RS loading error.
  9 Cannot open stream.
 10 Error at postit time.
 11 Inconsistent fixup.
 12 Unexpected fixup/commaer.
 13 Commaer data error.
 14 Commaer wrong order.
 15 Programming error.

Scr# 6 
  0 ( Error messages    from #33 to #47 )
  1 Programming error.
  2 Checksum error.
  3 F_GETLINE pos error.
  4 F_GETLINE seek error.
  5 Directory not found.
  6 Not a BMP file.
  7 NextZXOS Opendir error.
  8 NextZXOS Out of memory.
  9 NextZXOS Open error.
 10 NextZXOS Close error.
 11 File not found.
 12 NextZXOS DOS call error.
 13 NextZXOS Pos error.
 14 NextZXOS Read error.
 15 NextZXOS Write error.

Scr# 7 
  0 ( Error messages    from #49 to #63 )
  1 \ Test suite errors.
  2 Incorrect result.
  3 Wrong number of results.
  4 Cell number before '->' does not match ...}T spec.
  5 Cell number before AND after '->' does not match.
  6 Cell number after '->' below ...}T does not match.
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 Abort.

Scr# 8 
  0 ( Error messages    from #65 to #79 )
  1 
  2 
  3 
  4 
  5 
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 msg #79

Scr# 9 
  0 ( Print a complete error list )
  1 \ LOAD this screen to display the error list page by page
  2 DECIMAL MARKER FORGET-THIS-TASK
  3  : LIST-A-PAGE ( n -- )
  4    DUP 1+ 16 * SWAP 16 * DO
  5      I 3 .R SPACE 58 EMIT SPACE I MESSAGE CR
  6    LOOP ;
  7  : LIST-OF-ERRORS ( -- )
  8    CR 5 0 DO I LIST-A-PAGE
  9      I 4 - IF ."   press any key..." KEY CR THEN
 10      ?TERMINAL IF LEAVE THEN
 11    LOOP
 12    FORGET-THIS-TASK ABORT ;
 13 \ ...
 14 LIST-OF-ERRORS
 15 \ ...

Scr# 10 
  0 .( AUX )
  1 \ include demo/savebank.dot.f
  2 
  3 
  4 
  5 
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 11 
  0 ( Autoexec )
  1 \ This Screen is usually loaded at first cold start
  2 \ by AUTOEXEC definition
  3 \
  4   DECIMAL
  5   7 17 EMITC EMITC       \ Paper 7 (WHITE)
  6   0 26 EMITC EMITC       \ non stop scroll
  7           0  67 REG!     \ Palette Control (ULA first)
  8          25  64 REG!     \ Palette Index Select (blue paper)
  9   %00000001  65 REG!     \ Palette Data (darker)
 10          14  64 REG!     \ Palette Index Select (yellow ink)
 11   %11111001  65 REG!     \ Palette Data (lighter)
 12 \
 13   INCLUDE    /TOOLS/VFORTH/LIB/AUTOEXEC.F
 14   ABORT
 15 

Scr# 20 
  0 ( LOADG )
  1 \
  2 \  search for EMPTYDEV marker
  3   -find EMPTYDEV         \  ff  |  xt b tf
  4   1 and 3 *              \   0  |  xt b 4
  5 
  6 \  selectively load Screen 25 if EMPTYDEV exists
  7 \           or load Screen 22 if EMPTYDEV doesn't exist
  8   22 +
  9   dup ." loading " .
 10   load
 11 
 12 \ continue to next Screen.
 13   -->
 14 
 15 

Scr# 21 
  0 ( LOADG )
  1 \
  2 \ Put here your project main source
  3 \
  4   marker EMPTYDEV
  5   include demo/fedora.f
  6 \
  7 \ Done.
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 22 
  0 ( LOADG )
  1 \ Check the current dictionary status
  2 \ to decide if the patch is needed
  3   ' abort >body  #13 cells + @
  4   ' noop = 1 and              \  0  |  1
  5   ' autoexec >body 3 cells + @
  6   ' noop = 1 and and          \  0  |  1
  7   ' autoexec >body 1 cells + @
  8     #11  = 1 and and          \  0  |  1
  9 
 10 \ call screen# 23 or #24
 11   23 + LOAD
 12 
 13 
 14 
 15 

Scr# 23 
  0 ( LOADG )
  1 ." no needs for patch" cr
  2 \  Keep this screen empty
  3 
  4 
  5 
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 24 
  0 ( LOADG )
  1 \ enable autoexec for warm start
  2   ' autoexec  ' abort >body  #13 cells + !
  3 
  4 \ and make it permanent for this session
  5   ' autoexec  ' autoexec >body 3 cells + !
  6 
  7 \ make autoexec to load Screen #20 at next startup
  8 \ instead of usual Screen #11
  9   #20 ' autoexec >body 1 cells + !
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 25 
  0 ( LOADG )
  1 \ Ignore xt and b from caller (Screen #20)
  2   2DROP
  3 
  4 \ clean dictionary up to EMPTYDEV marker
  5   emptydev
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 26 
  0 ( restore default )
  1 \ enable autoexec for warm start
  2   ' noop      ' abort >body  #13 cells + !
  3 
  4 \ and make it permanent for this session
  5   ' noop      ' autoexec >body 3 cells + !
  6 
  7 \ make autoexec to load Screen #20 at next startup
  8 \ instead of usual Screen #11
  9   #11 ' autoexec >body 1 cells + !
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 35 
  0 
  1 
SUP> python temp.py
  2 
  3 
  4 
  5 
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 100 
  0 .( Assembler. Use NEEDS ASSEMBLER instead )
  1 \ Loads ASSEMBLER vocabulary
  2 NEEDS INVERT  NEEDS FLIP \ NEEDS CHECKSUM CR
  3 FORTH  DEFINITIONS   MARKER FORGET-ASSEMBLER \ MARKER-ASM
  4 \ DECIMAL 139 LOAD \ check how MMU7 can be used.
  5 VOCABULARY TOOLS-ASM IMMEDIATE
  6 VOCABULARY FORTH-ASM
  7 \ DECIMAL 118 LOAD \ MMU allocation ( Seems bugged )
  8  : ASSEMBLER FORTH-ASM ; IMMEDIATE
  9 DECIMAL 101 LOAD \ tools
 10 DECIMAL 120 LOAD \ Z80
 11 DECIMAL 140 LOAD \ structure
 12 DECIMAL 160 LOAD \ Z80N
 13 DECIMAL 117 LOAD \ final CODE patch
 14 needs checksum hex E080 LP @ over - checksum .
 15 ." Done " CR DECIMAL

Scr# 101 
  0 .( Z80 Assembler. ) CR
  1 ASSEMBLER TOOLS-ASM DEFINITIONS
  2 HEX           \ DP @ LP ! HEX E080 DP !
  3 \
  4 NEEDS INVERT  \ : INVERT -1 XOR ;
  5 : @+ >R R@ CELL+ R> @ ;
  6 : !+ >R R@ ! R> CELL+ ;
  7 : @- 0 CELL+ - >R R@ @ R> ;
  8 1 VARIABLE TABL1 1 ,          TABL1 !
  9 : ROTLEFT  TABL1 + @
 10   UM* \ U*
 11   OR ;
 12 \ ## commented unused words to save space
 13 \ ## CHAR - CONSTANT &-
 14 \ ## CHAR ~ CONSTANT &~
 15 -->

Scr# 102 
  0 ( Z80 Utility - Sys depend )
  1 \ ## commented unused words to save space
  2 \ ## : % COMPILE ' <NAME ;
  3 \ ## : % POSTPONE ' <NAME ;
  4 \ ## : %ID. ID. ;
  5 : %>BODY PFA CELL+ ;
  6 \ ## : %BODY> 0 CELL+ - NFA ;
  7 : %>CODE PFA CFA CELL+    2 CFA NEGATE + ;   ( dir/indir )
  8 \ ## : IGNORE? 1+ C@ &~ = ;
  9 : (>NEXT%) PFA LFA @ ;
 10 \ ## : VOCEND?
 11 \ ## @ FFFF AND A081 = ; \ this is the ghost word inside VOCAB
 12 \ ## : >NEXT% BEGIN (>NEXT%)
 13 \ ##   DUP 1+ C@ &- - UNTIL ;
 14 -->
 15 

Scr# 103 
  0 ( Z80 Utility - Sys depend )
  1 : STARTVOC ' ASSEMBLER >BODY
  2   CELL+ @ ;
  3 : IS-A <BUILDS
  4   0 ,
  5   DOES>
  6   @ SWAP %>CODE @ = ;
  7 : REMEMBER HERE LATEST
  8   (>NEXT%) %>BODY ! ;
  9   IMMEDIATE
 10 : CONTAINED-IN OVER AND = ;
 11 -->
 12 
 13 
 14 
 15 

Scr# 104 
  0 ( Z80 System independ. )
  1 \ 0 VARIABLE TABLE FF ,
  2 \ FFFF , FFFFFF , FFFFFFFF ,
  3 \ : FIRSTBYTES CELLS TABLE
  4 \   + @ AND ;
  5 0 VARIABLE TALLY-BI           TALLY-BI !
  6 0 VARIABLE TALLY-BY           TALLY-BY !
  7 0 VARIABLE TALLY-BA           TALLY-BA !
  8 0 VARIABLE ISS                ISS      !
  9 0 VARIABLE ISL                ISL      !
 10 0 VARIABLE PREVIOUS           PREVIOUS !
 11 : !TALLY 0 TALLY-BY !
 12  0 TALLY-BI ! 0 TALLY-BA !
 13  0 PREVIOUS ! ;
 14 -->
 15 

Scr# 105 
  0 ( Z80 System independ. )
  1 : AT-REST? TALLY-BI @ 0=
  2  TALLY-BY @ 0= AND ;
  3 : BADPAIRS? DUP 2 * AND
  4  AAAAAAAA AND ;
  5 : BAD?
  6  TALLY-BA @ BADPAIRS? ;
  7 \ ## : COMPATIBLE?
  8 \ ##  TALLY-BA @ OR BADPAIRS?
  9 \ ##  0= ;
 10 DECIMAL
 11 -->
 12 
 13 
 14 
 15 

Scr# 106 
  0 ( Z80 Generate errors )
  1 : CHECK26 AT-REST? 0=
  2   26 ?ERROR ;
  3 : CHECK27 BAD? 27 ?ERROR ;
  4 : CHECK31 2DUP SWAP
  5   CONTAINED-IN 0= 31 ?ERROR ;
  6 : CHECK33 2DUP SWAP INVERT
  7   CONTAINED-IN 0= 33 ?ERROR ;
  8 : CHECK28 2DUP AND 28 ?ERROR ;
  9 : CHECK29 2DUP OR -1 -
 10   29 ?ERROR ;
 11 : CHECK30 DUP PREVIOUS @ <
 12   30 ?ERROR DUP PREVIOUS ! ;
 13 HEX
 14 -->
 15 

Scr# 107 
  0 ( Assembler Z80 )
  1 : OR!
  2   >R R@ @ CHECK28 OR R> ! ;
  3 : OR!U >R R@ @ OR R> ! ;
  4 : AND! >R INVERT R@ @
  5   CHECK29 AND R> ! ;
  6 -->
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 108 
  0 ( Assembler Z80 )
  1 \ ## commented unused words to save space
  2 \ ## : >DATA %>BODY ;
  3 \ ## : >BI %>BODY CELL+ ;
  4 \ ## : >BY %>BODY 2 CELLS + ;
  5 \ ## : >BA %>BODY 3 CELLS + ;
  6 \ ## : >CNT %>BODY 4 CELLS + ;
  7 \ ## : >DIS %>BODY 5 CELLS ;
  8 : CORRECT,-
  9   ISL @ 1 CELLS - ALLOT ;
 10 : !POSTIT
 11   HERE ISS ! 0 PREVIOUS ! ;
 12 : TALLY:, @+ TALLY-BI !
 13   @+ TALLY-BY ! @+ TALLY-BA !
 14   @ ISL ! ;
 15 -->

Scr# 109 
  0 ( Assembler Z80 )
  1 : POSTIT CHECK26 !POSTIT
  2   HERE ISS ! @+ , TALLY:,
  3   CORRECT,- ;
  4 IS-A IS-CBPI : CBPI CHECK33
  5 <BUILDS , , , , 1 , DOES>
  6 REMEMBER CB C, POSTIT ;
  7 IS-A IS-EDPI : EDPI CHECK33
  8 <BUILDS , , , , 1 , DOES>
  9 REMEMBER ED C, POSTIT ;
 10 IS-A IS-DDPI : DDPI CHECK33
 11 <BUILDS , , , , 1 , DOES>
 12 REMEMBER DD C, POSTIT ;
 13 IS-A IS-FDPI : FDPI CHECK33
 14 <BUILDS , , , , 1 , DOES>
 15 REMEMBER FD C, POSTIT ; -->

Scr# 110 
  0 ( Assembler Z80 )
  1 IS-A IS-1PI : 1PI CHECK33
  2 <BUILDS , , , , 1 , DOES>
  3 REMEMBER POSTIT ;
  4 IS-A IS-2PI : 2PI CHECK33
  5 <BUILDS , , , , 2 , DOES>
  6 REMEMBER POSTIT ;
  7 IS-A IS-3PI : 3PI CHECK33
  8 <BUILDS , , , , 3 , DOES>
  9 REMEMBER POSTIT ;
 10 : IS-PI >R R@ IS-1PI
 11  R@ IS-2PI  R@ IS-3PI  OR OR
 12  R@ IS-CBPI R@ IS-EDPI OR OR
 13  R@ IS-DDPI R@ IS-FDPI OR OR
 14  R> DROP ;
 15 -->

Scr# 111 
  0 ( Assembler Z80 )
  1 : TALLY:|
  2   @+ TALLY-BI AND!
  3   @+ TALLY-BY OR!
  4   @  TALLY-BA OR!U ;
  5 : FIXUP> @+ ISS @ OR!
  6   TALLY:| CHECK27 ;
  7 IS-A IS-XFI : XFI CHECK31
  8 <BUILDS , , , , DOES>
  9 REMEMBER FIXUP> ;
 10 : CORRECT-R 0 CELL+ ISL @
 11 - ROTLEFT ;
 12 -->
 13 
 14 
 15 

Scr# 112 
  0 ( Assembler Z80 )
  1 : TALLY:|R @+ CORRECT-R
  2  TALLY-BI AND! @+ TALLY-BY OR!
  3  @ TALLY-BA OR!U ;
  4 : FIXUP< @+ CORRECT-R ISS
  5  @ OR! TALLY:|R CHECK27 ;
  6 IS-A IS-XFIR : XFIR CHECK31
  7 <BUILDS , , , , DOES>
  8 REMEMBER FIXUP< ;
  9 : TALLY:,, CELL+ @+ CHECK30
 10 TALLY-BY AND! @ TALLY-BA
 11 OR!U ;
 12 : COMMA @+ >R TALLY:,,
 13  CHECK27 R> EXECUTE ;
 14 -->
 15 

Scr# 113 
  0 ( Assembler Z80 )
  1 IS-A IS-COMMA
  2 : COMMAER
  3 <BUILDS , 0 , , , , , DOES>
  4 REMEMBER COMMA ;
  5 0 VARIABLE PRO-TALLY          PRO-TALLY !
  6   2 CELLS ALLOT
  7 : T! PRO-TALLY !+ !+ !+ DROP ;
  8 : T@ PRO-TALLY 3 CELLS +
  9   @- @- @- DROP ;
 10 -->
 11 
 12 
 13 
 14 
 15 

Scr# 114 
  0 ( Assembler Z80 )
  1 : 1FAMILY, 0 DO DUP >R T@
  2   R> 1PI OVER + LOOP
  3   DROP DROP ;
  4 : 2FAMILY, 0 DO DUP >R T@
  5   R> 2PI OVER + LOOP
  6   DROP DROP ;
  7 : 3FAMILY, 0 DO DUP >R T@
  8   R> 3PI OVER + LOOP
  9   DROP DROP ;
 10 : XFAMILY| 0 DO DUP >R T@
 11   R> XFI OVER + LOOP
 12   DROP DROP ;
 13 : XFAMILY|R 0 DO DUP >R T@
 14   R> XFIR OVER + LOOP
 15   DROP DROP ; -->

Scr# 115 
  0 ( Assembler Z80 )
  1 : CBFAMILY, 0 DO DUP >R T@
  2   R> CBPI OVER + LOOP
  3   DROP DROP ;
  4 : EDFAMILY, 0 DO DUP >R T@
  5   R> EDPI OVER + LOOP
  6   DROP DROP ;
  7 -->
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 116 
  0 ( Assembler Z80 )
  1 : DDFAMILY, 0 DO DUP >R T@
  2   R> DDPI OVER + LOOP
  3   DROP DROP ;
  4 : FDFAMILY, 0 DO DUP >R T@
  5   R> FDPI OVER + LOOP
  6   DROP DROP ;
  7 \
  8 EXIT
  9 \ stop
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 117 
  0 ( Assembler z80 )
  1 FORTH DEFINITIONS \ RENAME CODE MCOD
  2 : CODE ?EXEC CODE \ previous def of CODE
  3   [COMPILE] ASSEMBLER
  4   TOOLS-ASM
  5   !TALLY !CSP ; IMMEDIATE
  6 : C;  \ Ends a CODE definition
  7   CURRENT @ CONTEXT !  ?EXEC
  8   TOOLS-ASM  CHECK26  CHECK27
  9   SMUDGE ; IMMEDIATE
 10 \
 11 ' ASSEMBLER ' ;CODE >BODY 4 CELLS + ! ( patch to ;CODE )
 12 \
 13 FORTH DEFINITIONS DECIMAL
 14 ." Patch done " CR
 15 

Scr# 118 
  0 ( Assembler MMU config -- seems bugged: don't use )
  1 EXIT  seems bugged: don't use
  2 HEX 1F CONSTANT ASM-PAGE
  3 : ASM-MMU  ( n -- )
  4   DUP 1 - IF  ASM-PAGE 0 0 01BD M_P3DOS  2C ?ERROR
  5               2DROP 2DROP THEN ;
  6 : ASM-MMU-DONE 3 ASM-MMU ;
  7 : FORGET-ASSEMBLER
  8   3 ASM-MMU \ free  8K-page
  9   [ ' CODE <NAME 1+ HEX ] LITERAL
 10   4F43 OVER ! C544 SWAP CELL+ ! \ Rename CODE
 11   MARKER-ASM ;
 12 : ASSEMBLER FORTH-ASM  ASM-PAGE MMU7! ; IMMEDIATE
 13 \
 14 3 ASM-MMU
 15 2 ASM-MMU   \ Allocate MMU page 3F

Scr# 119 
  0 ( Assembler vocabulary checksum )
  1 HEX
  2 : T
  3   BASE @ HEX CR
  4   FFFF E000 DO
  5     I U.
  6     I 080 CHECKSUM 2 .R SPACE
  7   080 +LOOP
  8   BASE !
  9 ;
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 120 
  0 .( Z80 definitions. ) CR
  1 ASSEMBLER DEFINITIONS HEX
  2 TOOLS-ASM
  3 \
  4 0 1 0 800 ' C,
  5   COMMAER N,
  6 0 0 CELL+ 0 200 ' ,
  7   COMMAER NN,
  8 0 0 CELL+ 0 400 ' ,
  9   COMMAER AA,
 10 0 1 0 100 ' C,
 11   COMMAER P,
 12 0 1 0 1000 ' C,
 13   COMMAER D,
 14 -->
 15 

Scr# 121 
  0 ( Z80 ) HEX
  1 00 00 00 T!
  2 08 07 8 1FAMILY,
  3   RLCA RRCA RLA  RRA  DAA  CPL  SCF  CCF
  4 \
  5 08 00 2 1FAMILY,   NOP       EXAFAF
  6 \
  7 08 E3 4 1FAMILY,   EX(SP)HL  EXDEHL  DI  EI
  8 \
  9 00 00 238 T!
 10 08 00 8 XFAMILY|
 11    00| 08| 10| 18|
 12    20| 28| 30| 38|
 13 00 00 238 C7 1PI    RST
 14 -->
 15 \ RST 38|  DAA

Scr# 122 
  0 ( Z80 ) HEX
  1 00 00 07 T!
  2 01 00 8 XFAMILY|
  3   B|  C|    D|  E|
  4   H|  L| (HL)|  A|
  5 08 80 8 1FAMILY,
  6  ADDA ADCA SUBA SBCA
  7  ANDA XORA ORA  CPA
  8 \
  9 00 00 00 76 1PI HALT
 10 -->
 11 \ ADDA B|
 12 \ HALT
 13 
 14 
 15 

Scr# 123 
  0 ( Z80 ) HEX
  1 00 00 30 T!
  2 10 00 4 XFAMILY|
  3   BC| DE| HL| SP|
  4 01 02 2 1FAMILY,
  5   LD(X)A INCX
  6 01 09 3 1FAMILY,
  7   ADDHL  LDA(X)  DECX
  8 00 0200 30 01 1PI LDX
  9 00 00 30 30 XFI AF|
 10 00 00 30 T!
 11 04 C1 2 1FAMILY,
 12   POP PUSH
 13 -->
 14 \ LD(X)A BC|
 15 \ LDX BC| nn NN,

Scr# 124 
  0 ( Z80 immediate data )
  1 00 0100 00 T!
  2 08 D3 2 1FAMILY,
  3   OUTA  INA
  4 00 0800 00 T!
  5 08 C6 8 1FAMILY,
  6   ADDN ADCN SUBN SBCN
  7   ANDN XORN ORN  CPN
  8 00 00 00 T!
  9 10 C9 4 1FAMILY,
 10   RET EXX JPHL LDSPHL
 11 -->
 12 \ OUTA n P,   INA n P,
 13 \ ADDN n N,
 14 
 15 

Scr# 125 
  0 ( Z80 address )
  1 00 0400 00 T!
  2 08 22 4 1FAMILY,
  3   LD()HL LDHL() LD()A LDA()
  4 0A C3 2 1FAMILY,
  5   JP CALL
  6 00 00 38 T!
  7 \ LD B'| C| LD()A nn AA,
  8 08 00 8 XFAMILY|
  9   B'| C'| D'| E'|
 10   H'| L'| (HL)'| A'|
 11 01 04 2 1FAMILY,
 12   INC DEC
 13 00 00 3F 40 1PI LD
 14 00 0800 38 06 1PI LDN
 15 -->

Scr# 126 
  0 ( Z80 ) HEX
  1 00 00 138 T!
  2 08 00 8 XFAMILY|
  3   NZ|  Z|  NC|  CY|
  4   PO| PE|   P|   M|
  5 00 00 138 C0 1PI  RETF
  6 00 0400 138 T!
  7 \
  8 02 C2 2 1FAMILY,
  9  JPF CALLF
 10 -->
 11 \ JPF Z| aa AA,
 12 \ CALLF PO| aa AA,
 13 \ RETF NC|
 14 \ and CY| instead of C|
 15 

Scr# 127 
  0 ( Z80 relative jump )
  1 HEX
  2 00 1000 00 T!
  3 08 10 2 1FAMILY,
  4   DJNZ JR
  5 00 00 218 T!
  6 \
  7 \
  8 08 00 4 XFAMILY|
  9   NZ'| Z'| NC'| CY'|
 10 00 1000 218 20 1PI JRF
 11 -->
 12 \ JRF Z'| d D,
 13 \ JR d D,
 14 \ DJNZ d D,
 15 

Scr# 128 
  0 ( ED prefix )
  1 00 00 30 T!
  2 08 42 2 EDFAMILY,
  3  SBCHL  ADCHL
  4 00 0400 30 T!
  5 08 43 2 EDFAMILY,
  6   LD()X  LDX()
  7 00 00 38 T!
  8 01 40 2 EDFAMILY,
  9   IN(C)  OUT(C)
 10 -->
 11 \ SBCHL BC| ADCHL SP|
 12 \ LDX() BC| nn AA,
 13 \ LD()X SP| nn AA,
 14 \ IN(C) L'|
 15 \ OUT(C) H'|

Scr# 129 
  0 ( ED prefix )
  1 00 00 00 T!
  2 01 44 4 EDFAMILY,
  3   NEG RETN IM0 LDIA
  4 02 4D 2 EDFAMILY,
  5   RETI LDRA
  6 01 56 2 EDFAMILY,
  7   IM1 LDAI
  8 01 5E 2 EDFAMILY,
  9   IM2 LDAR
 10 08 67 2 EDFAMILY,
 11   RRD RLD
 12 -->
 13 
 14 
 15 

Scr# 130 
  0 ( ED prefix )
  1 00 00 00 T!
  2 01 A0 4 EDFAMILY,
  3   LDI  CPI  INI  OUTI
  4 01 A8 4 EDFAMILY,
  5   LDD  CPD  IND  OUTD
  6 01 B0 4 EDFAMILY,
  7   LDIR CPIR INIR OTIR
  8 01 B8 4 EDFAMILY,
  9   LDDR CPDR INDR OTDR
 10 -->
 11 
 12 
 13 
 14 
 15 

Scr# 131 
  0 ( CB prefix )
  1 00 00 07 T!
  2 08 00 8 CBFAMILY,
  3   RLC  RRC  RL  RR
  4   SLA  SRA  SL1 SRL
  5 00 00 43F T!
  6 40 40 3 CBFAMILY,
  7   BIT  RES  SET
  8 00 00 438 T!
  9 08 00 8 XFAMILY|
 10   0| 1| 2| 3| 4| 5| 6| 7|
 11 -->
 12 \ RLC B|
 13 \ BIT 3| B|
 14 \ RES 3| B|
 15 \ SET 3| B|

Scr# 132 
  0 ( IX IY prefix )
  1 HEX
  2 00 00 00 T!
  3 02 E3 1 DDFAMILY,
  4   EX(SP)IX
  5 02 E3 1 FDFAMILY,
  6   EX(SP)IY
  7 \
  8 10 E9 2 DDFAMILY,
  9   JPIX  LDSPIX
 10 10 E9 2 FDFAMILY,
 11   JPIY  LDSPIY
 12 \
 13 -->
 14 \
 15 

Scr# 133 
  0 ( IX IY prefix )
  1 HEX
  2 00 00 30 T!
  3 00 09 1 DDFAMILY, ADDIX
  4 00 09 1 FDFAMILY, ADDIY
  5 \
  6 00 0400 00 T!
  7 \
  8 08 22 2 DDFAMILY,
  9   LD()IX LDIX()
 10 08 22 2 FDFAMILY,
 11   LD()IY  LDIY()
 12 -->
 13 \ ADDIX IX|  ADDIX SP|
 14 \ LD()IY aa AA,
 15 \ LDIY() aa AA,

Scr# 134 
  0 ( IX IY prefix )
  1 : I)
  2 HERE 1 - C@
  3 HERE 2 - C@ [ HEX ] CB - IF
  4 -1 ALLOT SWAP C, C,
  5 ELSE
  6 -2 ALLOT SWAP C, CB C, C,
  7 THEN ;
  8 TOOLS-ASM
  9 00 00 07 T!
 10 00 06 1 XFAMILY| (I
 11 : (IX+  (I  DD I) ;
 12 : (IY+  (I  FD I) ;
 13 TOOLS-ASM
 14 -->
 15 \ LD B'| (IY+ d )|    ADCA (IY+ d )|   SRA (IY+ d )|

Scr# 135 
  0 ( IX IY prefix )
  1 HEX
  2 : )|
  3   HERE 1 - C@
  4   HERE 2 - C@
  5   CB = IF SWAP THEN
  6   HERE 1 - C! C, ;
  7 \
  8 : IXY| ( n -- )
  9  DUP HERE 2 - C@ - IF
 10   HERE 1- C@
 11   -1 ALLOT SWAP C, C,
 12  THEN ;
 13 TOOLS-ASM
 14 -->
 15 

Scr# 136 
  0 ( IX IY prefix )
  1 \ INC DEC  (IX'+ d )|
  2 \ LDN  (IX'+ d )|  n N,
  3 00 00 38 T!
  4 00 30 1 XFAMILY|   (I'
  5 : (IX'+ (I' DD I) ;
  6 : (IY'+ (I' FD I) ;
  7 TOOLS-ASM
  8 \ LD(IX+ d )|  r|
  9 00 00 07 T!
 10 00 70 1 DDFAMILY, LD(IX+
 11 00 70 1 FDFAMILY, LD(IY+
 12 : )'| ' EXECUTE )| ;
 13 TOOLS-ASM
 14 -->
 15 

Scr# 137 
  0 ( IX IY prefix )
  1 \ LDIXL A|
  2 00 00 07 T!
  3 08 60 2
  4    DDFAMILY, LDIXH LDIXL
  5 08 60 2
  6    FDFAMILY, LDIYH LDIYL
  7 -->
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 138 
  0 ( IX IY prefix )
  1 HEX
  2 : IX| HL| DD IXY| ;
  3 : IY| HL| FD IXY| ;
  4 : IXL| L| DD IXY| ;
  5 : IXH| H| DD IXY| ;
  6 : IYL| L| FD IXY| ;
  7 : IYH| H| FD IXY| ;
  8 TOOLS-ASM
  9 \ LDX IY| nn NN,
 10 \ POP IY|  LD A'| IXL|
 11 \ DP @ U. KEY \ verify...
 12 \
 13 DECIMAL
 14 
 15 

Scr# 139 
  0 ( Page-in and Page-out - development )
  1 HEX
  2 ' LIT <NAME CONSTANT PAGE-ORG
  3 \
  4 : PAGE-IN
  5   PAGE-ORG 0< NOT IF
  6     DP @ LP ! E080 DP !
  7   THEN ;
  8 \
  9 : PAGE-OUT
 10   PAGE-ORG 0< NOT IF
 11     DP @ LP @ DP ! LP !
 12   THEN ;
 13 \
 14 
 15 

Scr# 140 
  0 .( Z80 near structure )   CR
  1 ASSEMBLER DEFINITIONS HEX
  2 : NEXT                     JPIX ;
  3 : PSH1           PUSH HL|  JPIX ;
  4 : PSH2 PUSH DE|  PUSH HL|  JPIX ;
  5 \ : ldsp,rp ldx() sp| 30 +origin AA, ;
  6 \ : ldrp,sp ld()x sp| 30 +origin AA, ;
  7 \ : ldhl,rp ldx() hl| 30 +origin AA, ;
  8 \ : ldrp,hl ld()x hl| 30 +origin AA, ;
  9 : HOLDPLACE HERE 0 D, ;
 10 : DISP, OVER -
 11   1 - SWAP C! ;
 12 : BACK,
 13  HOLDPLACE SWAP DISP, ;
 14 \
 15 : | ;  -->

Scr# 141 
  0 ( Z80 Near struct. )
  1 : THEN, HERE DISP, ;
  2 : ELSE, JR HOLDPLACE
  3   SWAP THEN, ;
  4 \
  5 DECIMAL
  6 EXIT
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 142 
  0 ( Z80 Near struct. )
  1 EXIT
  2 \
  3 : IF, JRF Z'|
  4   HOLDPLACE ;
  5 : -IF, JRF NZ'|
  6   HOLDPLACE ;
  7 : <IF, JRF CY'|
  8   HOLDPLACE ;
  9 : -<IF, JRF NC'|
 10   HOLDPLACE ;
 11 
 12 
 13 
 14 
 15 

Scr# 143 
  0 ( Z80 Near struct. )
  1 EXIT
  2 : BEGIN, HERE ;
  3 : UNTIL, IF, SWAP DISP, ;
  4 : -UNTIL, -IF, SWAP DISP, ;
  5 : <UNTIL, <IF, SWAP DISP, ;
  6 : -<UNTIL, -<IF, SWAP DISP, ;
  7 : WHILE, IF, ;
  8 : -WHILE, -IF, ;
  9 : <WHILE, <IF, ;
 10 : -<WHILE, -<IF, ;
 11 : REPEAT, JR HOLDPLACE
 12   ROT DISP, THEN, ;
 13 -->
 14 
 15 

Scr# 144 
  0 ( Z80 Near struct. )
  1 EXIT
  2 : DJNZ,
  3   DJNZ HOLDPLACE
  4   SWAP DISP, ;
  5 FORTH DEFINITIONS
  6 DECIMAL
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 145 
  0 ." Z80 far struct "
  1 : THEN' HERE SWAP ! ;
  2 : HOLDPLACE' HERE 0 AA, ;
  3 : IF' JPF Z| HOLDPLACE' ;
  4 : ELSE' JP HOLDPLACE
  5         SWAP THEN' ;
  6 : BEGIN' HERE ;
  7 : UNTIL' IF' DROP THEN' ;
  8 : WHILE' IF' ;
  9 : REPEAT' ELSE' DROP THEN' ;
 10 DECIMAL
 11 FORTH DEFINITIONS
 12 
 13 
 14 
 15 

Scr# 146 
  0 ( Testing & Debugging this vocabulary )
  1 : T?
  2  TALLY-BY ?
  3  TALLY-BI ?
  4  TALLY-BA ?
  5 ;
  6 : H?
  7  HEX
  8  HERE 8 - DUMP
  9 ;
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 147 
  0 ( 128K memory BANK! test )
  1 HEX
  2 \ BANKM : 5B5C
  3 : ?BANK BASE @
  4   5B5C C@ 2 BASE ! .
  5   BASE ! ;
  6 : TEST
  7   BANK!
  8   C000 @ U.
  9   10 BANK!
 10 ;
 11 
 12 
 13 
 14 
 15 

Scr# 148 
  0 ( 128K memory BANK! test )
  1 \ n  between 0 and 7
  2 \ set bank n at C000
  3 CODE BANK! ( n -- )
  4  LDAR
  5  DI
  6  EXAFAF
  7  LD   D'|   B|
  8  LD   E'|   C|
  9  POP  BC|
 10  LDX  HL|  HEX  5B5C NN,
 11  LD   A'| (HL)|
 12  ANDN HEX  F8  N,
 13  ORA   C|
 14  LDX  BC|  HEX  7FFD NN,
 15 -->

Scr# 149 
  0 ( 128K memory BANK! test )
  1  OUT(C) A'|
  2  LD  (HL)'|   A|
  3  LD     B'|   D|
  4  LD     C'|   E|
  5  EXAFAF
  6  JPF    PO|  HERE 3 + AA,
  7  EI
  8  NEXT
  9 C;
 10 \
 11 HEX
 12 : BANK@
 13  5B5C @ 7 AND
 14 ;
 15 

Scr# 150 
  0 ( Assembler test - 0 )
  1 CODE TEST0
  2  RLCA RRCA RLA RRA
  3  DAA CPL SCF CCF
  4  NOP EXAFAF EX(SP)HL EXDEHL
  5  DI EI HALT RET EXX
  6  JPHL LDSPHL
  7  RST 00| RST 38|
  8  ADDA B| ADCA C| SUBA D|
  9  SBCA E| ANDA H| XORA L|
 10  ORA (HL)| CPA A|
 11  LD(X)A BC| LDA(X) DE|
 12  INCX HL| DECX SP|
 13  ADDHL BC| ADDHL SP|
 14 C;
 15 -->

Scr# 151 
  0 ( Assembler test - 1 )
  1 CODE TEST1
  2  LDX  BC| 1234 NN,
  3  LDX  SP| 5678 NN,
  4  PUSH AF| POP HL|
  5  OUTA 254 P, INA 254 P,
  6  ADDN 1 N, ADCN 2 N,
  7  SUBN 3 N, SBCN 4 N,
  8  ANDN 5 N, XORN 6 N,
  9  ORN  7 N, CPN  8 N,
 10  LD()HL 1234 AA,
 11  LDHL() 1234 AA,
 12  LD()A  1234 AA,
 13  LDA()  1234 AA,
 14 C;
 15 -->

Scr# 152 
  0 ( Assembler test - 2 )
  1 CODE TEST2
  2  JP 1234 AA, CALL 1234 AA,
  3  INC B'| DEC A'|
  4  LD D'| E|  LD (HL)'| A|
  5  LDN B'| 1 N, LDN A'| 8 N,
  6  JPF Z| 1234 AA,
  7  CALLF M| 1234 AA,
  8  RETF PE|
  9  DJNZ -10 D, JR +10 D,
 10  JRF NZ'| +10 D,
 11  JRF CY'| -10 D,
 12  SBCHL DE| ADCHL SP|
 13  LDX() BC| 1234 AA,
 14  LD()X SP| 1234 AA,
 15 C; -->

Scr# 153 
  0 ( Assembler test - 3 )
  1 CODE TEST3
  2  IN(C) D'|  OUT(C) E'|
  3  NEG RETN IM0 LDIA RETI LDRA
  4  IM1 LDAI IM2 LDAR RRD RLD
  5  LDI   CPI   INI   OUTI
  6  LDD   CPD   IND   OUTD
  7  LDIR  CPIR  INIR  OTIR
  8  LDDR  CPDR  INDR  OTDR
  9  RLC B| RRC C| RL D| RR E|
 10  SLA H| SRA L| SRL (HL)|
 11  BIT 2| D|  BIT 3| E|
 12  RES 4| H|  RES 5| L|
 13  SET 6| (HL)| SET 7| A|
 14 C;
 15 EXIT

Scr# 154 
  0 ( Assembler test - 4 )
  1 CODE TEST4
  2 BEGIN,
  3 NOP NOP NOP
  4 END,
  5 NEXT
  6 C;
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 155 
  0 ( Assembler test - 5 )
  1 CODE TEST5
  2 INCX IX|  DECX IY|
  3 PUSH IX|  POP  IY|
  4 EX(SP)IX  JPIY
  5 LDSPIX    LDSPIY
  6 ADDIX BC| ADDIX DE|
  7 ADDIX IX| ADDIX SP|
  8 ADDIY BC| ADDIY DE|
  9 ADDIY IY| ADDIY SP|
 10 LD()IX 4 AA, LDIX() 3 AA,
 11 LD()IY 5 AA, LDIY() 6 AA,
 12 LDX IX| 7 NN,
 13 LDX IY| 8 NN,
 14 C;
 15 

Scr# 156 
  0 ( Assembler test - 6 )
  1 CODE TEST6
  2  ADCA (HL)|
  3  ADCA (IY+ 9 )|
  4  INC (HL)'|
  5  INC (IY'+ 9 )|
  6  LDN (HL)'|      5 N,
  7  LDN (IY'+ 9 )|  5 N,
  8  SRA  (HL)|
  9  SRA (IY+  9 )|
 10  SET 0| (HL)|
 11  SET 0| (IY+ 9 )|
 12  LDIX() 1234 AA,
 13 C;
 14 EXIT
 15 

Scr# 157 
  0 ( Assembler test - 7 )
  1 CODE TEST7
  2     LDX HL| 0 NN,
  3     BIT 5| (IY+ 1 )|
  4     IF, INC L'| THEN,
  5 PSH1 C;
  6 \
  7 : KEYIN
  8   BEGIN
  9   TEST7
 10   ?ESCAPE
 11   UNTIL ;
 12 
 13 
 14 
 15 

Scr# 158 
  0 ( Assembler test - 8 - Z80N )
  1 HEX CODE TEST8
  2  TESTN FF N,
  3  SWAPNIB MIRRORA
  4  LDIX LDDX LDIRX LDDRX
  5  LDWS LDPIRX
  6  OUTINB JP(C)
  7  PIXELDN PIXELAD SETAE
  8  BSLADE,B BSRADE,B BSRLDE,B
  9  BSRFDE,B BRLCDE,B
 10  MUL
 11  ADDHL,A ADDDE,A ADDBC,A
 12  ADDBC, 07654 NN,
 13  PUSHN 07654 LH,  NEXT C;
 14 
 15 

Scr# 159 
  0 ( Assembler test - 9 - Z80N )
  1 HEX CODE TEST9
  2  DECIMAL
  3  NEXTREG  3 P, 4 N,
  4  NEXTREGA 3 P,
  5  NEXTREG 87 P, 1 N,
  6  NEXTREGA 87 P,
  7 NEXT C;
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 160 
  0 .( Z80N Next extensions )
  1 ASSEMBLER DEFINITIONS HEX
  2 : FLIP, FLIP , ;            \ faster than $100 /MOD C, C,
  3 TOOLS-ASM
  4 0 1 0 4000 ' FLIP, COMMAER LH,
  5 \
  6 00 0900 00 91 EDPI NEXTREG
  7 \  NEXTREG  reg P, n N,
  8 00 0100 00 92 EDPI NEXTREGA
  9 \  NEXTREGA reg P,
 10 00 4000 00 8A EDPI PUSHN
 11 \   PUSHN nn LH,
 12 00 0800 00 27 EDPI TESTN
 13 \  TESTN n N,
 14 -->
 15 

Scr# 161 
  0 ( Z80N Next extension )
  1 \
  2 00 00 00 T!
  3 01 23 2 EDFAMILY,
  4  SWAPNIB MIRRORA
  5 08 A4 4 EDFAMILY,
  6  LDIX LDDX LDIRX LDDRX
  7 \
  8 12 A5 2 EDFAMILY,
  9  LDWS LDPIRX
 10 08 90 2 EDFAMILY,
 11  OUTINB JP(C)
 12 01 93 3 EDFAMILY,
 13  PIXELDN PIXELAD SETAE
 14 -->
 15 

Scr# 162 
  0 ( Z80N Next extension )
  1 01 28 5 EDFAMILY,
  2  BSLADE,B BSRADE,B BSRLDE,B
  3  BSRFDE,B BRLCDE,B
  4 01 30 4 EDFAMILY,
  5  MUL
  6  ADDHL,A ADDDE,A ADDBC,A
  7 00 0200 00 T!
  8 01 34 3 EDFAMILY,
  9  ADDHL, ADDDE, ADDBC,
 10 \ ADDBC, nn NN,
 11 \
 12 FORTH DEFINITIONS DECIMAL
 13 \
 14         \ DP @ LP @ DP !  LP !
 15 \

Scr# 163 
  0 ( ROLL development )
  1 NEEDS ASSEMBLER
  2 CODE ROLL ( n1 n2 n3 .. n -- n2 n3 .. n1 )
  3   exx                         \ we need all registers free
  4   pop     hl|                 \ number of cells to roll
  5   ld      a'|     h|
  6   ora      l|
  7   jrf     z'|  HOLDPLACE      \ skip if n is ZERO
  8   addhl   hl|                 \ number of bytes to move
  9   ld      b'|     h|
 10   ld      c'|     l|
 11   addhl   sp|                 \ address of n1
 12   ld      a'|  (hl)|          \ take n1 into de
 13   incx    hl|
 14   exafaf
 15   ld      a'|  (hl)|          -->

Scr# 164 
  0 ( ROLL development )
  1   ld      d'|       h|        \ prepare destination address
  2   ld      e'|       l|
  3   decx    hl|
  4   decx    hl|
  5   lddr                        \ move 2*n bytes
  6   exdehl
  7   ld   (hl)'|       a|
  8   decx    hl|
  9   exafaf
 10   ld   (hl)'|       a|
 11 HERE DISP,
 12   exx
 13   jpix
 14 C;
 15 

Scr# 165 
  0 ( M*/ - development )
  1 NEEDS PICK
  2 : M*/ ( d  m  n  -- d2 )
  3   2dup xor 3 pick xor >R      \ l h m n        R: s
  4   abs >R abs >R DABS          \ l h            R: s n m
  5   swap R@ um* rot R> um*      \ l L h H        R: s n
  6   rot 0 D+                    \ l dx
  7   R@ um/mod                   \ l r1 q1
  8   rot rot                     \ q1 l r1
  9   R> um/mod                   \ q1 r2 q2       R: s
 10   nip swap                    \ q2 q1
 11   R> D+-                      \ d              R:
 12 ;
 13 
 14 
 15 

Scr# 166 
  0 ( Assembler example - White noise Egghead 3 )
  1 NEEDS ASSEMBLER DECIMAL
  2 CODE WHITE-NOISE  ( -- )
  3      di exx               \ preserve registers
  4 HERE call 0000 AA,
  5      exx ei  NEXT
  6 \ subroutine
  7 HERE SWAP 1+ !            \ patch CALL 0000 here above
  8      ldn  e'|  250  N,
  9      ldx  hl|  300 NN,    \ start pointer in ROM
 10 HERE push de|
 11      ldn  b'|   32  N,
 12 HERE push bc|             \ main loop
 13      ld   a'| (hl)|
 14      incx hl|
 15 -->

Scr# 167 
  0 ( Assembler example - White noise Egghead 3 )
  1      andn 248 N,         \ black border
  2      outa 254 P,         \ send to speaker
  3      ld   a'|   e|
  4      cpl
  5 HERE dec  a'|
  6      jrf nz'| BACK,      \ inner delay
  7      pop  bc|
  8      djnz     BACK,      \ next step to main loop
  9      pop  de|
 10      ld   a'|    e|
 11      subn 24 N,          \ size of step
 12      cpn  30 N,          \ end range
 13      retf  z|
 14      retf cy|
 15 -->

Scr# 168 
  0 ( Assembler example - White noise Egghead 3 )
  1      ld   e'|   a|
  2      cpl
  3 \
  4 HERE ldn  b'| 40 N,      \ silent period
  5 HERE djnz BACK,
  6      dec  a'|
  7      jrf nz'| BACK,
  8      jr       BACK,
  9 C;
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 169 
  0 ( Assemble example -  Checksum of a RAM chunk )
  1 NEEDS ASSEMBLER
  2 CODE CHECKSUM ( a u -- n )
  3 (    D9 C,       )   exx
  4 (    D1 C,       )   pop    bc|
  5 (    E1 C,       )   pop    hl|
  6 (    AF C,       )   xora    a|
  7                  HERE
  8 (    86 C,       )   adda (hl)|
  9 (    23 C,       )   cpi
 10 (    20 C, F8 C, )   jpf    pe|  AA,
 11 (    5F C,       )   ld     c'|  A|
 12 (    D5 C,       )   push   bc|
 13 (    D9 C,       )   exx
 14 (    DD C, E9 C, )   jpix      C;
 15 

Scr# 170 
  0 \ BURP
  1 \ Example
  2 : BURP
  3 [ HEX ] 7999 6000
  4 DO
  5  I HEX . I DECIMAL . CR
  6  ?TERMINAL IF QUIT THEN
  7 [ HEX ] 100
  8 +LOOP
  9 ;
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 171 
  0 ( Example - Dump many pages )
  1 \ Dumps from a1 to a2
  2 DECIMAL
  3 : MDUMP ( a1 a2 -- )
  4  SWAP DO
  5   I DUMP
  6  64 +LOOP
  7 ;
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 172 
  0 ( NEEDS - development )
  1 \ check for cccc exists in vocabulary
  2 \ if it doesn't then  INCLUDE  inc/cccc.F
  3 DECIMAL
  4 \ temp filename cccc.f as counted string zero-padded
  5 CREATE   NEEDS-W     35 ALLOT   \ 32 + .F + 0x00 = len 35
  6 \ temp complete path+filename
  7 CREATE   NEEDS-FN    40 ALLOT
  8 \ constant path
  9 CREATE   NEEDS-INC   ," inc/"
 10 CREATE   NEEDS-LIB   ," lib/"
 11 -->
 12 
 13 
 14 
 15 

Scr# 173 
  0 ( NEEDS - development )
  1 \ Concatenate path at a and filename and include it
  2 \ No error is issued if filename doesn't exist.
  3 : needs/  ( a -- )             \ a       \ has  path/
  4   COUNT TUCK                   \ n a n
  5   NEEDS-FN SWAP CMOVE          \ n       \ Path
  6   NEEDS-FN +                   \ a1+n    \ concat
  7   NEEDS-W 1+ SWAP 35 CMOVE     \         \ Filename
  8   NEEDS-FN                     \ a3
  9   PAD 1 F_OPEN 0=              \ fh f
 10   IF f_include      \ using filehandle
 11   ELSE DROP THEN
 12 ;
 13 -->
 14 
 15 

Scr# 174 
  0 ( NEEDS - development )
  1 \ replace illegal characters in name with tilde ~
  2 : needs-ch    ( a -- )
  3   COUNT BOUNDS
  4   DO
  5     NCDM NDOM 9 I C@ (MAP) I C!
  6   LOOP ;
  7 -->
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 175 
  0 ( NEEDS - development )
  1 \ include  "path/cccc.f" if cccc is not defined
  2 \ filename cccc.f is temporary stored at NEEDS-W
  3 : needs-f     ( a -- )
  4   -FIND IF                        \ a
  5     DROP 2DROP                    \
  6   ELSE                            \ a cfa b
  7     NEEDS-W    35 ERASE           \ a
  8     HERE C@ 1+ HERE OVER          \ a n here n
  9     NEEDS-W    SWAP CMOVE         \ a n
 10     NEEDS-W    needs-ch           \ a n
 11     NEEDS-W  +                    \ a a1+n
 12     [ HEX 662E DECIMAL ] LITERAL  \ a a1+n ".F"
 13     SWAP !                        \ a
 14     needs/                        \   (uses path passed)
 15   THEN ; -->

Scr# 176 
  0 ( NEEDS - development )
  1 \ check for cccc exists in vocabulary
  2 \ if it doesn't then  INCLUDE  inc/cccc.F
  3 \ search in inc subdirectory
  4 : needs
  5   >in @ dup
  6   needs-inc needs-f
  7   >IN !
  8   NEEDS-LIB needs-f        \ 2nd chance at "lib/"
  9   >in !
 10   -find if
 11     2drop
 12   else
 13     needs-w count type space 43 message
 14   then
 15 ;

Scr# 177 
  0 ( INCLUDE - development )
  1 0 VARIABLE SOURCE-ID          SOURCE-ID !
  2 : INCLUDE ( -- )
  3   PAD 96 ERASE
  4   BL WORD COUNT PAD SWAP CMOVE
  5   PAD  PAD 96 +  1  F_OPEN
  6   43 ?ERROR
  7   SOURCE-ID @ >R  BLK @ >R
  8   SOURCE-ID !
  9   R> R> EXIT
 10   SOURCE-ID @ F_CLOSE DROP
 11   R> BLK ! R> SOURCE-ID !
 12 ;
 13 
 14 
 15 

Scr# 178 
  0 ( DEFER IS - EXIT UNLOOP - development )
  1 : UNLOOP R> R> R> 2DROP >R ;
  2 : ['] COMPILE LIT ' , ; IMMEDIATE
  3 : DEFER  ( -- cccc )
  4   <BUILDS [ ' NOOP ] LITERAL ,
  5    DOES> @ EXECUTE ; IMMEDIATE
  6 : IS ( xt -- )
  7   ' >BODY CELL+
  8   STATE @ IF
  9     COMPILE LIT , COMPILE !
 10   ELSE ! THEN ; IMMEDIATE
 11 : :NONAME ( -- xt
 12   ?EXEC HERE [ ' ' @ ] LITERAL , !CSP [COMPILE] ]
 13 ;
 14 
 15 

Scr# 179 
  0 ( CHECK NULL - search any 0x00 in blocks )
  1 needs J  \   : J RP@ 6 + @ ;
  2 : CHECKNULL
  3   800 650  DO
  4     [CHAR] . EMIT
  5     I BLOCK C@ 00   = IF
  6       CR I .   ." WRONG "  I 2/ .   THEN
  7     ?TERMINAL  IF QUIT THEN
  8   LOOP
  9 ;
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 180 
  0 .( Line editor -- Use NEEDS EDITOR instead  )
  1 NEEDS INVV NEEDS TRUV -->
  2 \ See .pdf documentation.
  3 \
  4 \ Inverse/True Video
  5 : INVV ( -- )
  6   [ HEX 14 ] LITERAL EMITC
  7   1 EMITC
  8 ;
  9 : TRUV ( -- )
 10   [ HEX 14 ] LITERAL EMITC
 11   0 EMITC
 12 ;
 13 DECIMAL
 14 --> \ Continue LOADing
 15 

Scr# 181 
  0 ( Line Editor          2/6 )
  1 : TEXT ( c -- )     \ accept following text to PAD
  2   HERE C/L 1+ BLANK  WORD PAD C/L 1+ CMOVE ;
  3 : LINE ( n -- a )   \ leave address of current screen line n
  4   DUP 0 <        3 ?ERROR  \ error 3: No such line.
  5   DUP L/SCR < 0= 3 ?ERROR
  6   SCR @ (LINE) DROP ;
  7 : -MOVE ( a -- n )  \ move from a to current screen line n
  8   LINE C/L CMOVE UPDATE ;
  9 \
 10 --> \ continues to next
 11 \ Quick reference
 12 \ [ TIB ]  <->  [ PAD ]  <->   [BLOCK]
 13 \          TEXT        H  E  RE
 14 \                      D  S  INS
 15 

Scr# 182 
  0 ( Line Editor          3/6 )
  1 VOCABULARY EDITOR
  2 EDITOR DEFINITIONS
  3 : H ( n -- )        \ hold line n to PAD
  4   LINE PAD 1+ C/L DUP PAD C! CMOVE ;
  5 : E ( n -- )        \ blank line n of current screen
  6   LINE C/L BLANK  UPDATE ;
  7 : RE ( n -- )       \ replace line n using PAD content
  8   PAD 1+ SWAP -MOVE ;
  9 : D ( n -- )        \ remove line n from current screen
 10   DUP H L/SCR 1- DUP ROT ?DO I 1+ LINE I -MOVE LOOP E ;
 11 : S ( n -- )        \ shift lines >= n down by one
 12   DUP  L/SCR 1- DO  I 1- LINE  I -MOVE  -1 +LOOP E ;
 13 : INS ( n -- )      \ insert line n from PAD
 14   DUP S RE ;
 15 -->

Scr# 183 
  0 ( Line Editor          4/6 )
  1 : P ( n -- ) \ put line n
  2   126 TEXT RE ;
  3 : L ( -- ) \ list current
  4   SCR @ LIST ;
  5 : N ( -- ) \ next screen
  6   1 SCR +! L ;
  7 : B ( -- ) \ back screen
  8   -1 SCR +! L ;
  9 FORTH DEFINITIONS
 10 : BCOPY ( n1 n2 -- ) \ copy screen n1 to n2, overvriting it
 11   DUP SCR ! B/SCR * SWAP B/SCR *
 12   B/SCR 0 DO 2DUP
 13   BLOCK SWAP BLOCK B/BUF CMOVE UPDATE
 14   SWAP 1+ SWAP 1+
 15   LOOP 2DROP ;   -->

Scr# 184 
  0 ( Line Editor          5/6 )
  1 \ usually used after an error during LOAD:
  2 : WHERE ( n1 n2 -- ) \ display offending row after an error
  3   DUP B/SCR /MOD DUP SCR ! ." Screen# " DECIMAL . CR
  4   B/BUF * ROT + C/L /MOD DUP 3 .R SPACE
  5   ROT B/SCR / (LINE) -TRAILING TYPE
  6   CR 2+ SPACES [CHAR] ^ EMIT SPACE
  7 ;
  8 -->
  9 \
 10 \ quick reference
 11 [TIB] <> [PAD]  <>  [BLOCK]
 12               H E RE
 13      TEXT     D S INS
 14 
 15 

Scr# 185 
  0 ( Line Editor          6/6 )
  1 : .PAD ( -- ) \ show PAD content
  2   PAD C/L -TRAILING TYPE ;
  3 : SAVE ( -- ) \ save all modified screens flushing to disk
  4   UPDATE FLUSH ;
  5 : UNUSED ( -- n ) \ return free dictionary space
  6   SP@ PAD - ;
  7 : ROOM ( -- ) \ display room available in dictionary
  8   UNUSED U. ." bytes free." CR ;
  9 EXIT
 10 \
 11 \ omitted:
 12 : BMOVE OVER SWAP BCOPY
 13   BCLEAR ;
 14 EXIT
 15 

Scr# 186 
  0 ( VOCABULARY exploration )
  1 MARKER TASK
  2 VOCABULARY VOC1 IMMEDIATE
  3 VOCABULARY VOC2 IMMEDIATE
  4 VOC1 DEFINITIONS : T1 NOOP ;
  5 VOC2 DEFINITIONS : T2 NOOP ;
  6 FORTH DEFINITIONS : F0 NOOP ;
  7 VOC1 DEFINITIONS : K1 NOOP ;
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 187 
  0 ( Utility: Restore AUTOEXEC )
  1 \ The following sequence restores AUTOEXEC within ABORT
  2 \ definition
  3 \
  4 \ ##  USE WITH CARE  ##
  5 \
  6 ' ABORT >BODY 13 CELLS + @
  7 ' NOOP - 14 ?ERROR
  8 ' AUTOEXEC
  9 ' ABORT >BODY 13 CELLS + !
 10 DECIMAL 14 EMITC
 11 BYE
 12 \
 13 \ and remember Scr# 220
 14 \ to move up or down LIMIT
 15 

Scr# 188 
  0 ( Editor utility           )
  1 \ multiple BCOPY
  2 : MBC. ( n1 n2 -- )  SWAP . ." -> " . ;
  3 : MBCOPY ( b1 b2 n --- )
  4   FLUSH >R 2DUP > IF          \ b1 > b2
  5     R> 0 DO 2DUP MBC. 2DUP BCOPY
  6     1 + SWAP 1 + SWAP
  7     LOOP
  8   ELSE                        \ b1 < b2
  9     R@ + 1 - SWAP R@ + 1 - SWAP
 10     1 R> DO 2DUP MBC. 2DUP BCOPY
 11     1 - SWAP 1 - SWAP
 12     -1 +LOOP
 13   THEN
 14   2DROP ;
 15 

Scr# 189 
  0 .( Call utility. )        CR
  1 \ CALL# ( n1 a -- n2 )  \ must save BC, DE, and IX.
  2 HEX CODE  CALL#  ( n1 -- n2 )
  3   D9 C, E1 C, C1 C,         \ exx       pop hl    pop bc
  4   79 C, D9 C,               \ ld a,c    exx
  5   DD C, E5 C,               \ push ix
  6   D5 C, C5 C, D9 C,         \ push de   push bc   exx
  7   22 C, HERE 3 + ,          \ ld (),hl
  8   0 +ORIGIN $2000 - NOT 1 AND $DF *
  9   0 +ORIGIN $2000 = NOT 1 AND $CD * + C, HERE 0B + ,
 10   D9 C, C1 C, D1 C,         \ exx       pop bc    pop  de
 11   DD C, E1 C, D9 C,         \ pop ix    exx
 12   C5 C, D9 C,               \ push bc   exx
 13   DD C, E9 C,               \ jp ix
 14   SMUDGE DECIMAL
 15 

Scr# 190 
  0 .( EDIT - Full Screen Editor )
  1 CR .( Better use NEEDS EDIT instead. ) CR
  2 NEEDS INVV    NEEDS TRUV
  3 NEEDS LINE    NEEDS CASE
  4 NEEDS EDITOR  EDITOR DEFINITIONS
  5 : KEYB  ( -- c )  CURS KEY ;  \ show cursor and wait keypress
  6 : KEYBEMIT  ( -- c )  KEYB DUP EMIT ; \ and emit it
  7 : KEYBEMITD  ( -- b )  \ and treat it as hex digit
  8   KEYBEMIT [ HEX ] 10 [ DECIMAL ] DIGIT DROP ;
  9 DECIMAL   0 VARIABLE NROW        NROW ! \ current row
 10           0 VARIABLE NCOL        NCOL ! \ current columns
 11 : HOMEC   0 NROW ! 0 NCOL ! ;           \ cursor at home
 12 : ADDRC   ( -- a )                      \ calc cursor addr
 13   NROW @ LINE NCOL @ + ;
 14 -->
 15 

Scr# 191 
  0 ( EDIT - Full Screen Editor   2/8 )
  1 : TO-SCR  ( row1 col1 -- col2 row2 )    \ translate xy
  2   0 + SWAP 2 + ;
  3 : AT-XY   ( col row -- )                \ set print position
  4   22 EMITC  EMITC EMITC ;               \ using standard AT
  5 : HOME 0 0 AT-XY ;                      \ cursor at home
  6 : BUZZ    7 EMIT ;                      \ sound BEL
  7 : CURC! ( c -- )    \ store chr to current screen position
  8   ADDRC  C! UPDATE ;
  9 : CURC@ ( -- c )    \ fetch chr from current screen position
 10   ADDRC  C@ ;
 11 -->
 12 
 13 
 14 
 15 

Scr# 192 
  0 ( EDIT - Full Screen Editor   3/8 )
  1 \
  2 : RULER 6 0 DO ." +----.----" LOOP ." +--" ;
  3 \ move cursor
  4 : UPC     NROW @  0 > IF -1  NROW +!  ELSE  BUZZ  THEN ;
  5 : DOWNC   NROW @ 15 < IF  1  NROW +!  ELSE  BUZZ  THEN ;
  6 : LEFTC   NCOL @  0 > IF -1  ELSE  UPC    63 THEN NCOL +! ;
  7 : RIGHTC  NCOL @ 63 < IF  1  ELSE  DOWNC -63 THEN NCOL +! ;
  8 \ display page
  9 : PUTPAGE ." Screen # " SCR @ . CR RULER CR
 10           L/SCR 0 DO I SCR @ (LINE) TYPE CR LOOP RULER ;
 11 \ refresh current line
 12 : REFRESH
 13   NROW @ SCR @  OVER 0 TO-SCR AT-XY  (LINE) TYPE ;
 14 -->
 15 

Scr# 193 
  0 ( Full Screen Editor   4/8 )
  1 : EDIT-FRAME
  2   0 19 AT-XY
  3   INVV ."  row:" TRUV 5 SPACES INVV ."  col:" TRUV 5 SPACES
  4   INVV ."  hex:" TRUV 5 SPACES INVV ."  dec:" TRUV 6 SPACES
  5   INVV ."  chr:" TRUV
  6   CR INVV ."  pad:" TRUV PAD COUNT 59 MIN TYPE
  7   0 21 AT-XY  INVV ."  cmd:" TRUV
  8   CR ." U-ndo    B-ack    D-el     I-nsert   H-old"
  9   CR ." Q-uit    N-ext    S-hift   R-eplace  P-ut hex byte"
 10   56 0 AT-XY  INVV ."   edit  " TRUV ;
 11 : EDIT-STAT CURC@
 12   25 19 AT-XY  HEX DUP 3 .R  36 19 AT-XY  DECIMAL DUP 3 .R
 13   47 19 AT-XY  32 MAX EMIT
 14   15 19 AT-XY  NCOL @  3 .R  05 19 AT-XY  NROW @      3 .R ;
 15 -->

Scr# 194 
  0 ( Full Screen Editor   5/8 )
  1 : BYTE ( -- b ) \ accept two hex digit as a byte
  2   KEYBEMITD 4 LSHIFT
  3   KEYBEMITD + ; DECIMAL
  4 : UNDO  ( -- ) \ discard changes on current Screen
  5   B/SCR 0 DO
  6     SCR @ B/SCR * I +
  7     BLOCK CELL-
  8     0 SWAP !
  9   LOOP ;
 10 HEX
 11 : DONEC             8F 28 +ORIGIN C!    \ reset cursor face
 12                     5F 2A +ORIGIN C! ;  \ reset cursor face
 13 : INITC   CURC@ BL MAX 28 +ORIGIN C!    \ change cursor face
 14                     8F 2A +ORIGIN C! ;
 15 DECIMAL -->

Scr# 195 
  0 ( Full Screen Editor   6/8 )
  1 : CMD   ( c -- )   \ handle EDIT key options
  2   6 21 AT-XY DONEC KEYBEMIT UPPER BL MAX DUP EMIT
  3   CASE
  4   [CHAR] P OF BYTE CURC! ENDOF  \ put a byte at cursor
  5   [CHAR] H OF NROW @ H   ENDOF  \ copy to PAD
  6   [CHAR] S OF NROW @ S   ENDOF  \ shift down one row
  7   [CHAR] R OF NROW @ RE  ENDOF  \ replace row from PAD
  8   [CHAR] I OF NROW @ INS ENDOF  \ insert row from PAD
  9   [CHAR] D OF NROW @ D   ENDOF  \ delete row + copy to PAD
 10   [CHAR] N OF  1 SCR +! HOMEC ENDOF  \ next screen
 11   [CHAR] B OF -1 SCR +! HOMEC ENDOF  \ prev screen
 12   [CHAR] U OF UNDO BUZZ  ENDOF
 13   [CHAR] Q OF ."  ok" CR C/L 2 * SPACES
 14               0 21 AT-XY QUIT ENDOF
 15   ENDCASE 0 0 AT-XY PUTPAGE EDIT-FRAME ; -->

Scr# 196 
  0 ( Full Screen Editor   7/8 )
  1 : DELC    ( -- )    \ back-space
  2   NCOL @  0 > IF -1 NCOL +! THEN
  3   ADDRC DUP 1+ SWAP C/L NCOL @ - 1- CMOVE UPDATE
  4   BL NROW @ LINE C/L + 1- C! ;
  5 : INSC    ( -- )    \ insert blank at cursor and shift the rest
  6   ADDRC DUP 1+      C/L NCOL @ - 1- CMOVE>
  7   BL ADDRC  C!  UPDATE ;
  8 : CTRLC  ( c -- )   \ manage control keys
  9   CASE 08 OF LEFTC  ENDOF      09 OF RIGHTC ENDOF
 10        10 OF DOWNC  ENDOF      11 OF UPC    ENDOF
 11        12 OF DELC   REFRESH ENDOF
 12        13 OF DOWNC 0 NCOL ! ENDOF
 13        07 OF CMD            ENDOF
 14   ENDCASE ;
 15 -->

Scr# 197 
  0 ( Full Screen Editor   8/8 )
  1 FORTH DEFINITIONS
  2 : EDIT     ( -- )
  3   EDITOR CLS HOMEC PUTPAGE EDIT-FRAME
  4   BEGIN
  5     EDIT-STAT  INITC
  6     CURC@ NROW @ NCOL @ TO-SCR  2DUP AT-XY
  7     KEYB  ?TERMINAL IF DROP 0 INSC   REFRESH THEN
  8     DUP BL < IF
  9       >R AT-XY EMIT R>  CTRLC
 10     ELSE
 11       CURC! AT-XY DROP CURC@ EMIT RIGHTC
 12     THEN
 13   AGAIN  \ quit via EDIT-key + Q
 14   ;
 15 FORTH DEFINITIONS

Scr# 198 
  0 ( \\ comment - example )
  1 : \\
  2   BLK @
  3   IF
  4     BLK @ 1 >
  5     IF
  6       >IN @ C/L MOD C/L SWAP - >IN +!
  7     ELSE
  8       B/BUF CELL- >IN !
  9     THEN
 10   ELSE
 11     0 TIB @ >IN @ + !
 12   THEN
 13 ; IMMEDIATE
 14 
 15 

Scr# 199 
  0 ( MARKER - development )
  1 : MARKER ( -- cccc )
  2   <BUILDS
  3    VOC-LINK @ , CURRENT @ , CONTEXT @ ,
  4    LATEST           , \ value for DP
  5    LATEST PFA LFA @ , \ value for LATEST
  6   DOES>
  7    DUP @ VOC-LINK !   CELL+
  8    DUP @ CURRENT  !   CELL+
  9    DUP @ CONTEXT  !   CELL+
 10    DUP @ DP       !   CELL+  @ CURRENT @ !
 11 ; IMMEDIATE
 12 HERE LATEST HEX .S
 13 MARKER TEST
 14 SEE TEST
 15 

Scr# 200 
  0 .( example - .RESET & CPU SPEED )  CR
  1 HEX
  2 : SPEED!
  3      7 243B P!
  4  3 AND 253B P!
  5 ;
  6 \
  7 \ EXIT
  8 \
  9 : .RESET
 10  2 253B P!
 11  2 243B P!
 12 ;
 13 
 14 
 15 

Scr# 201 
  0 ( Test - Z80 op-code DAA test )
  1 HEX
  2 CODE TEST-DAA
  3  POP HL|
  4  LD A'| L|
  5  CPN 10 N,
  6  SBCN 69 N,
  7  DAA
  8  LD L'| A|
  9  PSH1
 10  C;
 11 
 12 
 13 
 14 
 15 

Scr# 202 
  0 ( PICK - development )
  1 CODE PICK ( n -- v-nth )
  2  POP   HL|
  3  ADDHL HL|
  4  ADDHL SP|
  5  LD    A'|  (HL)|
  6  INCX  HL|
  7  LD    H'|  (HL)|
  8  LD    L'|     A|
  9  PSH1
 10 C;
 11 
 12 
 13 
 14 
 15 

Scr# 203 
  0 ( U* - development )
  1 CODE U*  ( u1 u2 -- ud )
  2  POP DE|
  3  POP HL|
  4  PUSH BC|
  5 \
  6  LD  C'|  L|
  7  LD  B'|  H|
  8  LDX HL| 0 NN,
  9  LDN A'| DECIMAL 16 N,
 10  HERE \ BEGIN,
 11   ADDHL HL|
 12   RL E|
 13   RL D|
 14   JRF NC'| HOLDPLACE
 15 -->

Scr# 204 
  0 ( U* - development )
  1    ADDHL BC|
  2    JRF NC'| HOLDPLACE
  3     INCX DE|
  4    HERE DISP, \ THEN,
  5   HERE DISP, \ THEN,
  6   DEC A'|
  7  JRF NZ'| HOLDPLACE
  8  SWAP DISP, \ -UNTIL,
  9  EXDEHL
 10 \
 11  POP BC|
 12  PSH2
 13  C;
 14 
 15 

Scr# 205 
  0 ( U/ - development )
  1 CODE U/ ( dn n -- r dq )
  2  POP  DE| \ Divisor
  3  POP  HL| \ High
  4  EX(SP)IX \ Low
  5  PUSH BC|
  6  LD   A'|    H|
  7  LD   C'|    L|
  8  LDX  HL|    0  NN,
  9  LDN  B'| DECIMAL 32 N,
 10  HERE DUP \ BEGIN,
 11   ADDIX IX|
 12   RL     C|
 13   RLA
 14   ADCHL HL|
 15 -->

Scr# 206 
  0 ( U/ - development )
  1   JRF CY'| HOLDPLACE
  2    SBCHL DE|
  3    JRF NC'| HOLDPLACE
  4     ADDHL DE|
  5     ROT DJNZ HOLDPLACE
  6     SWAP DISP,
  7    SWAP ELSE,
  8     ORA A|  SBCHL DE|
  9    SWAP THEN,
 10    INC IX|
 11   THEN,
 12  DNJZ BACK,
 13 -->
 14 
 15 

Scr# 207 
  0 ( U/ - development )
  1  LD   D'|  A|
  2  LD   E'|  C|
  3  POP  BC|
  4  POP  IX|
  5  PUSH HL|
  6  PUSH IX|
  7  PUSH DE|
  8  NEXT
  9 C;
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 208 
  0 ( UPPER - development )
  1 CODE UPPER ( c1 -- c2 )
  2 POP   HL|
  3 LD A'| L|
  4 CPN HEX 61 N,
  5 JRF CY'| HOLDPLACE
  6  CPN HEX 7B N,
  7  JRF NC'| HOLDPLACE
  8   SUBN HEX 20 N,
  9  HERE DISP,
 10 HERE DISP,
 11 LD L'| A|
 12 PSH1
 13 C;
 14 DECIMAL
 15 

Scr# 209 
  0 ( "NUL" - development )
  1 \
  2 : X
  3   BLK @ 1 > IF
  4     1 BLK +!
  5     0 >IN  !
  6     BLK @ B/SCR 1 - AND 0=
  7     IF ?EXEC   R> DROP   THEN
  8   ELSE
  9      R> DROP
 10   THEN
 11 ; IMMEDIATE
 12 \
 13 DECIMAL 128  ' X <NAME 1+ C! \ patch
 14 \
 15 

Scr# 210 
  0 \ 1. F_GETLINE from handle( via F_READ and F_SEEK ) DECIMAL
  1 : F_GETLINE ( a m fh -- n )
  2   >R F_FGETPOS 44 ?ERROR                \ m a m     \ fh
  3   2SWAP OVER 1+ SWAP                    \ m  d  a m
  4   R@ F_READ 46 ?ERROR                   \ m d a k
  5   ?DUP IF \ at least 1 chr was read     \ m d a k
  6     SPAN !                              \ m d a
  7     10 ENCLOSE DROP NIP SWAP            \ m d b a
  8     13 ENCLOSE DROP NIP ROT MIN         \ m d a n
  9     DUP >R 2SWAP R> 0 D+ R> F_SEEK ?ERROR \ m a n
 10     ELSE R> 2SWAP 2DROP DROP 0 THEN
 11   >R DUP DUP 1+ SWAP R@ CMOVE           \ m a       \ n|0
 12   2DUP + 0 SWAP CELL- !
 13   R@ + 1- SWAP R@ - BLANK  R>
 14 ; -->
 15 

Scr# 211 
  0 \ 2. include from handle
  1 : F_INCLUDE  ( fh -- )
  2   BLK @ >R  >IN @ >R  SOURCE-ID @ >R
  3   R@ IF R@ F_FGETPOS 44 ?ERROR ELSE 0 0 THEN >R >R
  4   SOURCE-ID !
  5   BEGIN
  6     1 BLOCK
  7     DUP B/BUF BLANK
  8     1+ SOURCE-ID @ F_GETLINE       \ a n
  9     TUCK                           \ n a n
 10     2DUP +                         \ n a n a+n
 11     OVER B/BUF SWAP 2+ -           \ n a n a+n b-n-1
 12     BLANK                          \ n a n
 13     + 1+ 0 SWAP C!                 \ n
 14 -->
 15 

Scr# 212 
  0 \ 2. include from handle
  1 \
  2   WHILE
  3     1 BLK ! 0 >IN !  INTERPRET
  4   REPEAT
  5   SOURCE-ID @  0 SOURCE-ID !  F_CLOSE 42 ?ERROR
  6   R> R> R>   DUP SOURCE-ID !
  7   IF SOURCE-ID @ F_SEEK 43 ?ERROR ELSE 2DROP THEN
  8   R> >IN !  R> BLK ! ;
  9  -->
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 213 
  0 \ 3. an INCLUDE wrapper
  1 : OPEN#    ( -- fh )  \ used in the form OPEN FFFF
  2   [CHAR] "  WORD COUNT OVER + 0 SWAP !
  3   PAD 1 F_OPEN 43 ?ERROR ;
  4 : INCLUDE
  5   OPEN# DUP F_INCLUDE F_CLOSE DROP ;
  6 EXIT
  7 \
  8 \ 5 VALUE FH
  9 \ CREATE FILENAME ," Test.f"
 10 \ FILENAME 1+ PAD 1 F_OPEN 43 ?ERROR TO FH
 11 \ FILENAME COUNT TYPE
 12 \ : G 1 BLOCK FH F_GETLINE ;
 13 \ FH F_CLOSE . CR
 14 
 15 

Scr# 214 
  0 ( UM* using MUL new OP-code - development )
  1 CASEOFF
  2 CODE U* ( n1 n2 -- d ) \ unsigned multiply
  3  pop de|  pop hl|  push bc|
  4  ld   c'|   e|
  5  ld   b'|   d|
  6  ld   d'|   l|
  7  mul
  8  ld   a'|   e|
  9  exafaf
 10  ld   a'|   h|
 11  ld   e'|   c|
 12  ld   c'|   d|
 13 -->
 14 
 15 

Scr# 215 
  0 ( UM* using MUL new OP-code - development )
  1  ld   d'|   h|
  2  ld   h'|   b|
  3  mul
  4  exdehl
  5  mul
  6  addhl de|
  7  ld   e'|   c|
  8  ldn  d'|   00 n,
  9  exafaf  \ saves carry flag
 10  ld   c'|   a|
 11  addhl de|
 12  exafaf \ restore carry flag
 13  ld   e'|   a|
 14  ld   d'|   b|
 15 -->

Scr# 216 
  0 ( UM* using MUL new OP-code - development )
  1  mul
  2  ldn  a'|  00  n,
  3  adca  d|
  4  ld   d'|   a|
  5  ld   b'|   l|
  6  ld   l'|   h|
  7  ldn  h'|  00  n,
  8  addhl de|
  9  ld   d'|   b|
 10  ld   e'|   c|
 11  pop  bc|
 12  PSH2
 13 c;
 14 
 15 

Scr# 217 
  0 ( TEST )
  1 HEX
  2 : TEST
  3  FFFF 0 DO
  4   I I 1- U*
  5   I I 1- UM*
  6   DMINUS D+ AND IF I . CR QUIT THEN
  7  LOOP
  8 ;
  9 DECIMAL
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 218 
  0 ( UM* using MUL new OP-code - development )
  1 code u* ( n1 n2 -- d )
  2  pop de|  pop hl|  push bc|
  3  ld   b'|   l|
  4  ld   c'|   e|
  5  ld   e'|   l|
  6  ld   l'|   d|
  7  push hl|
  8  ld   l'|   c|
  9  mul
 10  exdehl
 11  mul
 12  xora  a|
 13  addhl de|
 14  adca  a|
 15 -->

Scr# 219 
  0 ( UM* using MUL new OP-code - development )
  1  ld   e'|   c|
  2  ld   d'|   b|
  3  mul
  4  ld   b'|   a|
  5  ld   c'|   h|
  6  ld   a'|   d|
  7  adda  l|
  8  ld   h'|   a|
  9  ld   l'|   e|
 10  pop  de|
 11  mul
 12  exdehl
 13  adchl bc|
 14  pop bc|  psh2  c;
 15 

Scr# 220 
  0 ( Utility -  MOVE SP )
  1 \ Before use this utility verify your memory configuration.
  2 ." Moving utility." CR
  3 \ Use: HEX D900 MOVE-SP
  4 \ or   HEX F840 MOVE-SP
  5 HEX
  6 : MOVE-SP ( a -- )
  7   DUP 16 +ORIGIN !
  8   DUP 12 +ORIGIN !
  9   DUP        S0  !
 10   DUP        TIB !
 11   S0 @ SP!
 12 ;
 13 DECIMAL
 14 -->
 15 

Scr# 221 
  0 ( Utility - MOVE RP )
  1 \ Use: HEX D9A0 MOVE-RP
  2 \ or   HEX F8E0 MOVE-RP
  3 HEX
  4 : MOVE-RP ( a -- )
  5   DUP R0 @ 80 -
  6   SWAP 80 - C0 CMOVE
  7   DUP 14 +ORIGIN !
  8   DUP 2E +ORIGIN !
  9   DUP         R0 !
 10 ;
 11 \
 12 DECIMAL
 13 -->
 14 
 15 

Scr# 222 
  0 ( Utility - MOVE LIMIT )
  1 \ Use: HEX E000 MOVE-LIMIT
  2 \ or   HEX FF58 MOVE-LIMIT
  3 HEX
  4 : MOVE-LIMIT ( a -- )
  5   DUP LIMIT !
  6   DUP 24 +ORIGIN !
  7   204 #BUFF * - DUP FIRST !
  8   DUP USE !
  9   DUP PREV !
 10   22 +ORIGIN !
 11 ;
 12 DECIMAL
 13 -->
 14 7 TO #BUFF
 15 

Scr# 223 
  0 ( Utility - UP AND DOWN )
  1 HEX
  2 : UP ( -- ) \ Move SP, RP, User's, Buffers to high memory
  3   FF58 MOVE-LIMIT
  4   F0E0 MOVE-RP
  5   F040 MOVE-SP
  6   EMPTY-BUFFERS ;
  7 \
  8 : DOWN ( -- ) \ Move SP, RP, User's, Buffers to low memory
  9   D0E8 MOVE-SP
 10   D188 MOVE-RP
 11   E000 MOVE-LIMIT
 12   EMPTY-BUFFERS ;
 13 DECIMAL
 14 
 15 

Scr# 224 
  0 ( Test - 128K BANK! TEST )
  1 HEX
  2 \ BANKM : 5B5C
  3 : ?BANK BASE @
  4   5B5C C@ 2 BASE ! .
  5   BASE ! ;
  6 : TEST
  7   BANK!
  8   C000 @ U.
  9   10 BANK!
 10 ;
 11 
 12 
 13 
 14 
 15 

Scr# 225 
  0 ( ?DO LOOP - development )
  1 : BACK-
  2  BACK
  3  SP@ CSP @ -
  4  IF 2+ [COMPILE] THEN
  5  THEN
  6  ?CSP CSP !
  7 ;
  8 -->
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 226 
  0 ( ?DO LOOP - development )
  1 : ?DO
  2  COMPILE (?DO)
  3  CSP @ !CSP
  4  HERE 0 , 0
  5  HERE 3
  6 ; IMMEDIATE
  7 \
  8 : DO
  9  COMPILE (DO)
 10  CSP @ !CSP
 11  HERE 3
 12 ; IMMEDIATE
 13 -->
 14 
 15 

Scr# 227 
  0 ( ?DO LOOP - development )
  1 : LOOP
  2  3 ?PAIRS
  3  COMPILE (LOOP)
  4  BACK-
  5 ; IMMEDIATE
  6 \
  7 : +LOOP
  8  3 ?PAIRS
  9  COMPILE (+LOOP)
 10  BACK-
 11 ; IMMEDIATE
 12 
 13 
 14 
 15 

Scr# 228 
  0 ( ?DO LOOP - development )
  1 : TYPE
  2  OVER + SWAP
  3  ?DO
  4   I C@ EMIT
  5  LOOP
  6 ;
  7 : TEST
  8  0 0
  9  ?DO I . CR LOOP
 10 ;
 11 
 12 
 13 
 14 
 15 

Scr# 229 
  0 ( POSTPONE - development )
  1 DECIMAL
  2 : POSTPONE  ( -- cccc )
  3  ?COMP -FIND \ xt b f
  4  0= 0 ?ERROR
  5  192 < IF COMPILE COMPILE THEN
  6  ,
  7 ; IMMEDIATE
  8 EXIT
  9 \ test
 10 : TEST1 POSTPONE 0BRANCH HERE 0 ,
 11  2 ; IMMEDIATE
 12 : TEST2 POSTPONE 13 EMITC ;
 13 
 14 
 15 

Scr# 230 
  0 \ 0. F_GETLINE from handle( F_READ and F_SEEK )
  1 : f_getline ( a m fh -- n )
  2   >R TUCK R@ F_FGETPOS 44 ?ERROR        \ m a m d     \ R:fh
  3   2SWAP     OVER 1+ SWAP                \ m d a a+1 m
  4   R@ F_READ 46 ?ERROR                   \ m d a f
  5   IF      \ at least 1 chr was read     \ m d a f
  6     10 ENCLOSE DROP NIP   SWAP          \ m d b a
  7     13 ENCLOSE DROP NIP   ROT MIN       \ m d a n
  8     dup span !                          \ m d a n
  9     DUP >R 2SWAP R> 0 D+                \ m a n d+n   \ R: fh
 10     R> F_SEEK 45 ?ERROR
 11   ELSE
 12     R> 2SWAP 2DROP DROP 0
 13   THEN
 14 -->
 15 

Scr# 231 
  0 \ 1. include from handle
  1   >R                                    \ m a         \ R:n
  2 \ shift one byte
  3   DUP DUP 1+ SWAP                       \ m a a+1 a
  4   R@ CMOVE                              \ m a
  5 \ zero pad
  6   2DUP +                                \ m a m+a
  7   0 SWAP CELL- !                        \ m a
  8 \ trailing blank
  9   R@ + 1-                               \ m a+n-1
 10   SWAP R@ -                             \ a+n-1 m-n+1
 11   BLANK                                 \
 12   R>                                    \ n           \ R:
 13 ;
 14 : dup. dup . ;   : 2dup. space 2dup D. ;
 15 needs i'       -->

Scr# 232 
  0 \ 2. include from handle
  1 : f_include  ( fh -- )
  2   BLK @ >R  >IN @ >R  SOURCE-ID @ >R   cr source-id ?
  3   R@ IF R@ F_FGETPOS 44 ?ERROR         2dup d. space space
  4     >IN @ 2-  SPAN @  -  S>D D+
  5   ELSE 0 0 THEN  >R >R  SOURCE-ID !
  6       ." span " span ? >in ? i i' d. blk ? source-id ?
  7   BEGIN
  8     1 BLOCK B/BUF 2DUP  BLANK
  9     SWAP 1+ SWAP CELL-  SOURCE-ID @ F_GETLINE \  n
 10   \ CR 1 BLOCK OVER TYPE \ display
 11   WHILE
 12     1 BLK ! 0 >IN !  INTERPRET
 13   REPEAT
 14   -->
 15 

Scr# 233 
  0 \ 3. include from handle
  1   SOURCE-ID @ ( 0 SOURCE-ID ! ) F_CLOSE 42 ?ERROR
  2   R> R> R>  DUP  SOURCE-ID !
  3   IF
  4     SOURCE-ID @ F_SEEK 43 ?ERROR
  5   ELSE
  6     2DROP
  7   THEN
  8   R> >IN !
  9   R> BLK !
 10 ;
 11 \ : X 1 BLOCK 512 BLANK  ;
 12 \ : G 1 BLOCK 1+ 510 3 F_GETLINE ;
 13 \ : T 1 BLOCK DUMP 1 BLOCK 448 + 100 DUMP ;
 14  -->
 15 

Scr# 234 
  0 \ 4. an INCLUDE wrapper
  1 : open<    ( -- fh )  \ used in the form OPEN cccc
  2   BL        WORD COUNT OVER + 0 SWAP !
  3   PAD 1 F_OPEN 43 ?ERROR ;
  4 : include
  5   OPEN< DUP F_INCLUDE F_CLOSE DROP ;
  6 173 LOAD
  7 EXIT
  8 \ 173 load \ NEEDS
  9 \ 5 VALUE FH
 10 \ CREATE FILENAME ," Test.f"
 11 \ FILENAME 1+ PAD 1 F_OPEN 43 ?ERROR TO FH
 12 \ FILENAME COUNT TYPE
 13 \ : G 1 BLOCK FH F_GETLINE ;
 14 \ FH F_CLOSE . CR
 15 

Scr# 235 
  0 ( Study - Long memory dump )
  1 \ Utility to dump large intervals of memory
  2 \ usually 13 SELECT to redirect to stream #13 "output"
  3 : LDUMP  ( a1 a2 -- )
  4   SWAP DO
  5     I 64 DUMP
  6   \ KEY
  7     ?TERMINAL IF LEAVE THEN
  8   64 +LOOP
  9 ;
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 236 
  0 ( Example - Save RAM to BLOCKS )
  1 : 1K>BLOCK ( a n -- )
  2   BLOCK B/BUF CMOVE UPDATE
  3 ;
  4 : 8K>BLOCKS ( a n -- )
  5   B/SCR *
  6   16 0 DO
  7     OVER I B/BUF * +
  8     OVER I         +
  9   \ CR 2DUP DECIMAL U. HEX U.
 10     1K>BLOCK
 11   LOOP
 12   2DROP
 13 ;
 14 
 15 

Scr# 237 
  0 code s*/  ( b1 b2 b3 -- b4 := b1 * b2 / b3 )
  1     exx
  2     pop    de|
  3     ld     a'|  e|   \ divisor
  4     pop    de|       \ multiplr
  5     ora     a|
  6     jrf    z'|  HOLDPLACE
  7     pop    hl|       \ number
  8     ld     d'|  l|
  9     mul
 10     exdehl
 11     ld     d'|  a|
 12     xora    a|
 13     ldn    b'|  decimal 16 N,
 14 -->
 15 

Scr# 238 
  0 \ s*/
  1 HERE
  2     addhl  hl|
  3     rla
  4     cpa     d|
  5     jrf   cy'| HOLDPLACE
  6     suba    d|
  7     inc    l'|
  8            HERE DISP,
  9     djnz   BACK,
 10     push   hl|
 11   HERE DISP,
 12     exx
 13     jpix
 14 c;
 15 

Scr# 239 
  0 ( Example - Rainbow effects )
  1 HEX  CODE  SYNC
  2  76 C,       \ halt i.e. sync with interrupt
  3  DD C, E9 C, ( NEXT ) SMUDGE
  4 : STRIPE ( b -- )  FFFE P! 4 0 do loop ;
  5 : RAINBOW
  6   BEGIN
  7     SYNC
  8     09 00 DO
  9       07 00 DO I STRIPE LOOP
 10       01 07 DO I STRIPE -1 +LOOP
 11     LOOP
 12     ?TERMINAL
 13   UNTIL
 14 ; DECIMAL
 15 

Scr# 240 
  0 ( test )
  1 marker redo
  2 code test
  3 push  sp|
  4 addhl af|
  5 nop
  6 c;
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 241 
  0 \ Leo Brodie - Starting Forth - Square
  1 0 variable board 7 allot           board !
  2 : square ( square# -- addr ) board + ;
  3 : clear  board 9 erase ; clear
  4 : bar    ." | " ;
  5 : dashes cr 9 0 do [char] - emit loop cr ;
  6 : .box ( square# -- )
  7   square c@  dup 0= if 2 spaces
  8     else dup 1 = if ." X " else ." O "
  9     then then drop ;
 10 : display ( -- )
 11   cr 9 0 do i if i 3 mod 0 = if dashes else bar then then
 12   i .box loop cr quit ;
 13 : play  1- 0 max 8 min square c! ;
 14 : x! ( square# -- )  1 swap play display ;
 15 : o! ( square# -- ) -1 swap play display ;

Scr# 242 
  0 ( Example - CUBES )
  1 : CUBE ( n  -- d  )
  2   >R R@ ABS DUP UM*      \ u1 u2
  3   R@ ABS UM* DROP 0 SWAP \ u1 ud2
  4   ROT R@ ABS UM*         \ ud2 ud1
  5   D+ R> D+-  ;           \ d
  6 0 VARIABLE %CUBE 145 4 * 2+ ALLOT            %CUBE !
  7 : %CUBE# 2* 2* %CUBE + ; \ address of cube
  8 : BUILD%CUBE 144 0 DO I CUBE I %CUBE# 2! LOOP ; BUILD%CUBE
  9 NEEDS J
 10 NEEDS K
 11 -->
 12 : J RP@ 6 + @ ;
 13 : K RP@ 10 + @ ;
 14 -->
 15 

Scr# 243 
  0 ( Example - CUBES )
  1 NEEDS 2OVER
  2 : ISCUBE? ( d -- n tf | ff )
  3   ABS DMINUS
  4   144 0 DO
  5     I %CUBE# 2@ 2OVER D+ OR 0=
  6     IF 2DROP 0 I  LEAVE THEN
  7   LOOP NIP
  8   DUP 0< IF DROP 0 ELSE 1 THEN
  9 ;
 10 -->
 11 
 12 
 13 
 14 
 15 

Scr# 244 
  0 ( Example - CUBES )
  1 : CUBES
  2   100 1 DO
  3     100 I DO
  4       100 I DO
  5         I %CUBE# 2@    J %CUBE# 2@ D+ K %CUBE# 2@ D+
  6         ISCUBE? IF
  7           CR K . J . I . SPACE .
  8         THEN
  9       LOOP
 10     LOOP
 11   LOOP
 12 ;
 13 
 14 
 15 

Scr# 245 
  0 \ Leo Brodie - Starting Forth - Vectored execution
  1 MARKER TASK                          needs [']
  2 : hello ." hello " ;
  3 : goodbye ." goodbye " ;
  4 0 variable 'aloha             'aloha !
  5 : aloha 'aloha @ execute ;
  6 
  7 ' hello 'aloha !
  8 
  9 : say  ' 'aloha ! ;
 10 : coming  ['] hello 'aloha ! ;
 11 : going ['] goodbye 'aloha ! ;
 12 
 13 
 14 
 15 

Scr# 246 
  0 \ Leo Brodie - Starting Forth - Buzzphrases Generator - ver 1.
  1 needs choose
  2 : buzzword  ( n -- )
  3   10 choose 1+ 247 (line) drop
  4   + 20 -trailing type ;
  5 : 1adj    0 buzzword ;
  6 : 2adj   20 buzzword ;
  7 : noun   40 buzzword ;
  8 : phrase    1adj space 2adj space noun space ;
  9 : paragraph
 10   cr  ." by using "  phrase  cr ." coordinated with "
 11   phrase  cr ." it is possible for even the most "
 12   phrase  cr  ." to function as "
 13   phrase  cr  ." within the constraint of "
 14   phrase  ." ." ;
 15 \ paragraph

Scr# 247 
  0 \ Leo Brodie - Starting Forth - Buzzphrases Generator - ver 1.
  1 integrated          management          criteria
  2 total               organization        flexibility
  3 systematized        monitored           capability
  4 parallel            reciprocal          mobility
  5 functional          digital             programming
  6 responsive          logistical          concepts
  7 optimal             transitional        time phasing
  8 synchronized        incremental         projections
  9 compatible          third generation    hardware
 10 qualified           policy              through-put
 11 partial             decision            engineering
 12 
 13 
 14 
 15 

Scr# 248 
  0 ( Simple Word RENAMEr )
  1 \ old and new names have
  2 \ the same length
  3 HEX
  4 : RENAME
  5   ' >BODY NFA DUP C@ 1F AND
  6   2DUP + >R
  7   BL WORD      20 ALLOT
  8   COUNT 1F AND ROT MIN
  9   >R SWAP 1+ R>
 10   CMOVE
 11   R@ C@ 80 OR R> C!
 12   -20 ALLOT ;
 13 DECIMAL
 14 
 15 

Scr# 249 
  0 ( ENUM - development
  1 : ENUMERATED ( n -- cccc cccc ... )
  2   0 DO
  3     I CONSTANT
  4   LOOP
  5 ;
  6 
  7 
  8 8 ENUMERATED
  9   BLACK
 10   BLUE
 11   RED
 12   MAGENTA
 13   GREEN
 14   CYAN
 15   YELLOW WHITE

Scr# 250 
  0 \ BLOCK-SHIFT - utility
  1 \ change line 3
  2 : BLOCK-SHIFT
  3   99 118
  4  DO
  5  I . ." TO " I 1+ . CR
  6  I I 1+ BCOPY
  7  ?TERMINAL IF LEAVE THEN
  8  -1
  9  +LOOP
 10 ;
 11 
 12 
 13 
 14 
 15 

Scr# 251 
  0 ( block move reorder - utility )
  1 \ Utility used while
  2 \ reordering all screens
  3 DECIMAL  3 LOAD
  4 DECIMAL 41 LOAD
  5 : BLOCK-SHIFT
  6  CLS
  7  350 1 DO
  8   0. AT. I . SPACE
  9   I I 10000 +
 10   BCOPY
 11   ?TERMINAL IF LEAVE THEN
 12  LOOP
 13 ;
 14 
 15 

Scr# 252 
  0 \ Print all blocsks to #13
  1 \ The "blocks2txt.pl" Perl script does the same faster
  2 : >OUTPUT 13
  3   DUP DEVICE ! SELECT ;
  4 : PRINT-ALL-BLOCKS
  5   >OUTPUT
  6   ." This list is produced via Scr# 252 " CR CR
  7   1 1000 INDEX CR CR
  8   1001 1 DO
  9     VIDEO I 5 .R
 10     I BLOCK >OUTPUT I LIST CR
 11     VIDEO 5 0 DO 8 EMITC LOOP
 12     ?TERMINAL IF LEAVE THEN
 13   LOOP
 14   VIDEO CR ;
 15 

Scr# 253 
  0 ( INITIALIZE-MMC )
  1 \ this erases blocks from
  2 \ # 302 up
  3 EXIT STOP STOP
  4 : INITIALIZE-MMC
  5 #SEC
  6 302
  7 DO I . I BCLEAR
  8 ?TERMINAL IF LEAVE THEN
  9 LOOP
 10 ;
 11 
 12 
 13 
 14 
 15 

Scr# 254 
  0 ( MICRODRIVE CARTRIDGE LAST BLOCK )
  1 \ At least one block should
  2 \ be unusable due to the
  3 \ ring-junction on the tape
  4 \ so this block shouldn't be
  5 \ available.
  6 \ More: Real cartridges can
  7 \ have up to 85-90 K
  8 \ This means 170-180 blocks.
  9 \
 10 \ Old version of this system uses Micro-
 11 \ drives unit from 2 to 8 to store
 12 \ up to 889 KBytes of Screen Data
 13 \
 14 \ See Screen # 1778
 15 

Scr# 256 
  0 ( +loop standardization )
  1 NEEDS ASSEMBLER \ Import vocabulary
  2 HEX   ASSEMBLER DEFINITIONS
  3 : ldsp,rp ASSEMBLER ldx() sp| 30 +origin ;
  4 : ldrp,sp ASSEMBLER ld()x sp| 30 +origin ;
  5 FORTH DEFINITIONS
  6 code (*loop)
  7   ldx     hl|   2 nn,
  8   addhl   sp|            \ save sp in hl'
  9   exx
 10   pop     bc|
 11   ldsp,rp
 12   pop     hl|       \ index
 13   pop     de|       \ limit
 14   push    de|       \ restore it back, interrupt may occur
 15 -->

Scr# 257 
  0 ( +loop standardization )
  1   xora     a|
  2   sbchl   de|     \ index - limit: limit is the new zero
  3   addhl   bc|     \ index - limit + increment
  4   bit      7|   b|
  5   jrf     z'| HOLDPLACE       \ increment < 0 ?
  6     ccf
  7   HERE DISP,
  8   jrf    cy'| HOLDPLACE
  9     addhl   de|   \ index + increment
 10     push    hl|
 11     exx
 12     ldsphl        \ restore SP and go BRANCH
 13     jp  ' BRANCH aa,
 14 -->
 15 

Scr# 258 
  0 ( +loop standardization )
  1   HERE  DISP,
  2   pop     hl|       \ discard limit
  3   ldrp,sp           \ change RP
  4   exx
  5   ldsphl
  6   incx    bc|       \ skip BRANCH
  7   incx    bc|
  8   jpix
  9 c;
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 259 
  0 \ Forth Application Tecniques - 5.1.1
  1 MARKER THAT
  2 : I'M
  3   BL WORD
  4   COUNT TYPE CR
  5 ;
  6 : MEET
  7   ." HI " I'M ;
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 260 
  0 ( TRACE )
  1 \
  2 \ tracer word
  3 \
  4 ' NOOP   VARIABLE TRACER        TRACER !
  5 ' NOOP , \ patched to TR-EXIT  on scr# 262
  6 \
  7 \ saved Instruction Pointer (BC register)
  8 \
  9 ' QUIT >BODY VARIABLE TR-IP      TR-IP  !
 10 R0 @         VARIABLE TR-RP      TR-RP  !
 11 S0 @         VARIABLE TR-SP      TR-SP  !
 12 0            VARIABLE TR-X       TR-X   !
 13 0            VARIABLE TR-Y       TR-Y   !
 14 1            VARIABLE TR-MMU     TR-MMU !
 15 -->

Scr# 261 
  0 ( TRACE )
  1 HEX CODE TROFF                \ disable tracing
  2   DD C, 21 C,  (NEXT) ,       \ ld ix, (NEXT)
  3   DD C, E9 C,                 \ jpix
  4   SMUDGE
  5 \
  6 : AT@ ( -- row col )
  7   MMU7@ >R  10 MMU7!
  8 \ FB23  @  FB21  @  FB2D  @
  9   FB22 C@ 8 /       FB24 C@
 10   R> MMU7! ;
 11 -->
 12 : AT! ( col row -- )
 13   MMU7@ >R  10 MMU7!
 14   FB2D  !  FB21  !  FB23  !
 15   R> MMU7! ;

Scr# 262 
  0 ( TRACE )
  1 HEX CODE TR-ENTER
  2   ED C, 73 C, TR-SP  ,    \ ld (TR-SP),sp     ; save SP
  3   ED C, 43 C, TR-IP  ,    \ ld (TR-IP),bc     ; save BC (IP)
  4   2A C, 30 +ORIGIN   ,    \ ld hl,(RP)        ; save RP
  5   22 C,       TR-RP  ,    \ ld (TR-RP),hl
  6 \
  7   01 C,      TRACER  ,    \ ld bc,TRACER      ; goto tracer
  8   DD C, 21 C, (NEXT) ,    \ ld ix,(NEXT)      ; disable trc
  9   DD C, E9 C,             \ jp (ix)
 10   SMUDGE
 11 \
 12 : AT. 16 EMITC SWAP EMITC EMITC ;
 13 -->
 14 
 15 

Scr# 263 
  0 ( TRACE )
  1 HEX CODE TR-EXIT
  2   ED C, 7B C, TR-SP  ,            \ ld sp,(TR-SP)
  3   ED C, 4B C, TR-IP  ,            \ ld bc,(TR-IP)
  4   2A C,       TR-RP  ,            \ ld hl,(TR-RP)
  5   22 C, 30 +ORIGIN   ,            \ ld (RP),hl
  6 \
  7   DD C, 21 C, ' TR-ENTER >BODY ,  \ ld ix, TR-ENTER->BODY
  8   C3 C, (NEXT) ,                  \ jp (NEXT)
  9   SMUDGE
 10   ' TR-EXIT   TRACER CELL+ !      \ patch to TRACER
 11 \
 12 -->
 13 
 14 
 15 

Scr# 264 
  0 ( TRACE )
  1 HEX CODE TRON                     \ Restore tracing
  2   DD C, 21 C, ' TR-ENTER  >BODY , \ ld ix, TR-ENTER->BODY
  3   C3 C, (NEXT) ,                  \ jp (NEXT)
  4   SMUDGE
  5 \
  6 : -SPACES
  7   1F AND
  8   0 DO 8 EMITC LOOP ;
  9 \
 10 -->
 11 
 12 
 13 
 14 
 15 

Scr# 265 
  0 ( TRACE )
  1 NEEDS INVV NEEDS TRUV NEEDS .WORD
  2 TROFF DECIMAL
  3 : TRACE
  4   14 SELECT 0 0 AT. INVV       BASE @ HEX
  5 \ TR-RP @ CELL- R0 @ DO I U. I @ CELL- @ DUP U. .WORD
  6 \ 32 SPACES CR  -2 +LOOP 5 SPACES
  7 \ TR-IP @ @ DUP U. .WORD CR
  8 \ CR .S
  9   ?TERMINAL IF TROFF QUIT THEN
 10   BASE ! DEVICE @ SELECT ;
 11 ' TRACE TRACER !
 12 \ ' NOOP  TRACER !
 13 
 14 
 15 

Scr# 266 
  0 ( TEST )
  1 MARKER TASK
  2 : TEST
  3   22 0 DO
  4     I 33 AT. AT@
  5     I 0 AT. I 3 DECIMAL .R SPACE
  6   \ 8 / 3 .R SPACE
  7     HEX U. U.
  8   LOOP DECIMAL ;
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 267 
  0 ( GO-TO )
  1 needs assembler
  2 hex 5CB2 constant RAMTOP
  3     1B76 constant STMT_RET
  4     1E67 constant GO_TO
  5 \
  6 variable saved-ix
  7 variable saved-bc
  8 variable saved-sp
  9 variable saved-hl
 10 \
 11 decimal -->
 12 
 13 
 14 
 15 

Scr# 268 
  0 ( GO-TO )
  1 code GO-TO
  2   ld()x    bc|   saved-bc  AA,
  3   ld()x    sp|   saved-sp  AA,
  4   ld()x    ix|   saved-ix  AA,
  5 \
  6   ldhl()   RAMTOP  AA,
  7   decx     hl|
  8   decx     hl|
  9   ld       (hl)|  hex  13  N,
 10   dec      hl|
 11   ld       (hl)|       03  N,
 12   ld()hl   ERR_SP
 13 \
 14 -->
 15 

Scr# 269 
  0 ( GO-TO )
  1   ld()x    hl|   saved-hl  AA,
  2   ldx      bc|   STMT_RET  NN,
  3   push     bc|
  4   jp       GO_TO 5 + AA,
  5 \
  6   ld()x    sp|
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 270 
  0 \ SCREEN-FROM-FILE.f
  1 
  2 needs LINE   needs J
  3 : SCREEN-FROM-FILE  ( n -- cccc )
  4   open< >R  SCR !
  5   l/scr 0 do
  6     1 block c/l 1+  2dup blank
  7     J  f_getline drop
  8     1 block I LINE c/l cmove
  9   loop
 10   R> f_close
 11 ;
 12 
 13 
 14 
 15 

Scr# 271 
  0 \ SCREEN-TO-FILE.f
  1 \
  2 needs LINE   needs J
  3 : SCREEN-TO-FILE  ( n -- cccc )
  4   scr ! bl word count over + 0 over c! 1+
  5   [ 2 4 + ] literal f_open #47 ?error >R
  6   $0A    here  c!
  7   l/scr 0 do
  8     I line c/l -trailing  J f_write 2drop
  9     here 1  J f_write 2drop
 10   loop
 11   here 1 R@ f_write 2drop
 12   R> f_close
 13 ;
 14 
 15 

Scr# 275 
  0 ( Eratostenes )
  1 8000 constant ablock
  2 : initialize
  3   62 ablock + ablock do
  4     i block update b/buf blank
  5   loop ;
  6 : apos ( n -- a )    \ address of
  7   b/buf /mod ablock + block + ;
  8 : exclude  ( i n -- )    \ i n
  9   over dup *             \ i n i^2
 10   do                     \ i
 11     [char] x i apos c!   \ i
 12     update               \ i
 13   dup +loop              \ i
 14   drop ;                 \
 15 -->

Scr# 276 
  0 ( Eratostenes )
  1 : sieve ( n -- )
  2   [char] x 0 apos 2dup c! 1+ c!
  3   150 2 do
  4     i apos c@ bl = if
  5       i 32400 exclude
  6       [char] . emit
  7     then
  8   loop
  9 ;
 10 \
 11 \
 12 \
 13 \
 14 \
 15 \

Scr# 279 
  0 ( Fibonacci )
  1 \ n must be between 0 and 46
  2 NEEDS 2OVER
  3 : FIBO ( n -- d )
  4  0. ROT
  5  DUP  1 > IF
  6   1- 1. ROT
  7   0 DO
  8    2SWAP 2OVER
  9    D+
 10   LOOP
 11   2SWAP 2DROP
 12  THEN
 13 ;
 14 : T 46 0 do i dup 3 .R space fibo d. cr
 15   ?terminal if leave then loop ;

Scr# 280 
  0 ( SQRT )
  1 \ Extract square root of d (Newton method)
  2 \ 0 <= n < 1073741824
  3 \ n <-- ( n + d/n )/ 2
  4 NEEDS INVERT
  5 : DSQRT ( d  -- n  )
  6   [ 0 INVERT 1 RSHIFT INVERT ] \ number with high bit only set
  7   LITERAL                      \  d n
  8   BEGIN     .s                 \  d n
  9     >R 2DUP R@ UM/MOD NIP      \  d q         R: n
 10     R@ + 1 RSHIFT              \  d (n+q)/2   R: n
 11     DUP R> =                   \  d (n+q)/2  n=n
 12   UNTIL
 13   NIP NIP                      \ remove d
 14 ;
 15 : SQRT 0 DSQRT ;

Scr# 281 
  0 ( Primality Test )
  1 NEEDS DSQRT
  2 : ?PRIME ( d -- f )
  3   OVER 1 AND IF               \ d  odd?
  4     2DUP DSQRT 2+             \ d  lim
  5     2 DO                      \ d
  6       2DUP I UM/MOD DROP      \ d  mod
  7       0= IF 2DROP 0 0 LEAVE THEN  \ leave if divisible
  8     LOOP
  9     OR 0= 0=
 10   ELSE
 11     DROP 2 =
 12   THEN ;
 13 : ?BREAK ?TERMINAL IF QUIT THEN ;
 14 : T DUP 0 ?PRIME IF . ." , " ELSE DROP THEN ;
 15 -->

Scr# 282 
  0 ( Primality Test )
  1 : prime ( n -- d )
  2   1- dup 0> if
  3     >R  1 0
  4     begin
  5       2 0 D+ 2dup ?prime
  6       if  R>  1-  >R  then
  7       ?break
  8     until
  9     R> drop
 10   else
 11     2 0
 12   then ;
 13 \
 14 : TT 30000  2  DO I T ?BREAK LOOP ;
 15 

Scr# 283 
  0 ( LOAD-BYTES TEST )
  1 \ load bytes from filename held in PAD
  2 \ PAD is volatile
  3 : LOAD-BYTES ( a n -- )
  4   PAD DUP 10 - 01 F_OPEN          \ a n u f
  5   41 ?ERROR                       \ a n u
  6   DUP FH ! F_READ                 \ m f
  7   46 ?ERROR                       \ m
  8   DROP FH @ F_CLOSE               \ f
  9   42 ?ERROR
 10 ;
 11 \ filename" prova.txt"
 12 \ PAD 64 read-bytes
 13 
 14 
 15 

Scr# 284 
  0 ( TEST )
  1 \ Given an address, compute the relative address from $2000
  2 : DOT-RELATIVE ( a1 -- a2 )
  3   HERE SWAP - [ HEX ] 2000 + \
  4 ; DECIMAL
  5 0 VARIABLE FH       FH !
  6 \ accept volatile filename at PAD
  7 : FILENAME" ( -- )  \
  8   [CHAR] " WORD COUNT    \ a+1 n
  9   TUCK OVER + 0          \ n a+1 a+n+1 0
 10   SWAP !                 \ n a+1
 11   PAD ROT 1+             \ a+1 pad n+1
 12   CMOVE ;
 13 -->
 14 
 15 

Scr# 285 
  0 ( SAVE-BYTES TEST )
  1 \ save bytes to filename held in PAD
  2 \ create new file, error if it already exists
  3 \ PAD is volatile
  4 : SAVE-BYTES ( a n -- )
  5   PAD DUP 10 - 06 F_OPEN          \ a n u f
  6   41 ?ERROR                       \ a n u
  7   DUP FH ! F_WRITE                \ m f
  8   47 ?ERROR                       \ m
  9   DROP FH @ F_CLOSE               \ f
 10   42 ?ERROR
 11 ;
 12 \ filename" prova.txt"
 13 \ PAD 64 save-bytes
 14 
 15 

Scr# 286 
  0 ( DOT example  .helloworld )
  1 create Org Assembler
  2         ldx   hl|   Here   0  NN,
  3   Here  ld    a'|   (hl)|
  4         anda   a|
  5         retf   z|
  6         rst   10|
  7         incx  hl|
  8         jr    Back,  \ to the closest Here
  9 \
 10   Org dot-relative  ," Hello, World!"  1+ swap !
 11 \
 12 Org   Here Org -    \  start-addres & length
 13 Filename" /dot/helloworld" save-bytes
 14 \
 15 

Scr# 287 
  0 ( search for AT position )
  1 \ : save-page [ hex ] E000 2000 save-bytes ;
  2 decimal
  3 16 constant pg
  4 filename" L2_10_0100.bin"  pg mmu7! 01 00 AT. save-page
  5 filename" L2_10_0201.bin"  pg mmu7! 02 01 AT. save-page
  6 filename" L2_10_0302.bin"  pg mmu7! 03 02 AT. save-page
  7 filename" L2_10_0403.bin"  pg mmu7! 04 03 AT. save-page
  8 filename" L2_10_0131.bin"  pg mmu7! 01 31 AT. save-page
  9 filename" L2_10_0232.bin"  pg mmu7! 02 32 AT. save-page
 10 filename" L2_10_0333.bin"  pg mmu7! 03 33 AT. save-page
 11 filename" L2_10_0449.bin"  pg mmu7! 04 49 AT. save-page
 12 filename" L2_10_0162.bin"  pg mmu7! 01 62 AT. save-page
 13 filename" L2_10_0263.bin"  pg mmu7! 02 63 AT. save-page
 14 
 15 

Scr# 288 
  0 ( TEST )
  1 : AT. 22 EMITC SWAP EMITC EMITC ;
  2 hex
  3 : T
  4   AT.
  5   10 mmu7!
  6   FB00 PAD  100 CMOVE
  7   CLS  PAD  DUMP
  8 ;
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 289 
  0 ( TEST )
  1 CREATE ANAME ," /tools/vforth/mytest.bin"
  2 : BUFER 1 BUFFER ;
  3 \
  4 : SAVE-BUFER
  5   1+ 0 [ HEX ] 0E
  6   F_OPEN   41 ?ERROR
  7   DUP BUFER 255 ROT
  8   F_WRITE  47 ?ERROR
  9   DROP
 10   F_CLOSE  42 ?ERROR
 11 ;
 12 : START
 13   ANAME SAVE-BUFER
 14 ;
 15 

Scr# 290 
  0 ( map - character replacing )
  1 \ translate c using mapping a1 -> a2. n is mapping length
  2 code (map) ( a2 a1 n c1 -- c2 )
  3   exx
  4   pop   hl|               \ c
  5   ld    a'|   l|          \ character to map
  6   pop   bc|               \ n length of a1 map-string
  7   pop   hl|               \ a1 map-string
  8   ld    d'|   b|
  9   ld    e'|   c|          \ length in de too
 10   cpir
 11 -->
 12 
 13 
 14 
 15 

Scr# 291 
  0 ( map - character replacing )
  1   pop   hl|               \ a2 map-string
  2   jrf  nz'|  holdplace
  3     addhl de|
  4     decx  hl|
  5     sbchl bc|
  6     ld    a'| (hl)|
  7   here disp,
  8   ld    l'|   a|
  9   ldn   h'|   0  N,
 10   push  hl|
 11   exx
 12   jpix
 13 c;
 14 -->
 15 

Scr# 292 
  0 ( map - character replacing )
  1 create ncdm  \  ^`%&$_{}~
  2 hex 5E C, 60 C, 25 C, 26 C, 24 C, 5F C, 7B C, 7D C, 7E C,
  3 create ndom  \  :?/*|\<>"
  4 hex 3A C, 3F C, 2F C, 2A C, 7C C, 5C C, 3C C, 3E C, 22 C,
  5 \
  6 : needs-check
  7   needs-w count over + swap
  8   Do
  9     ncdm ndom 9 i c@ (map) i c!
 10   Loop
 11 ;
 12 
 13 
 14 
 15 

Scr# 293 
  0 ( map - character replacing )
  1 : t
  2   >r cod  count  dom  count rot min
  3   r@ . r@ emit space r> (map) dup . emit cr ;
  4 \
  5  char \ t
  6  char / t
  7  char : t
  8  char | t
  9  char " t
 10  char < t
 11  char > t
 12  char ? t
 13  char * t
 14 
 15 

Scr# 294 
  0 ( GREY-SCREEN example )
  1 HERE
  2  LD   A'|  (HL)|
  3  XORA  D|
  4  LD (HL)'|    A|
  5  INCX HL|
  6  DJNZ BACK,
  7  DEC  C'|
  8  JRF NZ'| BACK,
  9  POP BC|
 10 NEXT C;
 11 DECIMAL
 12 
 13 
 14 
 15 

Scr# 300 
  0 ( Study: MMU7 / set or get bank )
  1 \ set MMU7 to 8K-page given between 0 and 233
  2 \ to fit *ANY* page
  3 DECIMAL
  4 CODE MMU7! ( n -- )
  5  POP   HL|
  6  LD    A'|  L|
  7  NEXTREGA 87 P,
  8  NEXT
  9 C;
 10 \ query current page in MMU7
 11 : MMU7@ ( -- n )
 12   87 REG@
 13 ;
 14 
 15 

Scr# 301 
  0 ( Study: MMU7 / simplest )
  1 \ decode bits 765 of H as 8K-page 64-71
  2 \ lower bits of H and L are offset from E000h
  3 \
  4 \ heap pointer:                pppb bbbb  bbbb bbbb
  5 \ page:offset:     0100 0ppp : 111b bbbb  bbbb bbbb
  6 \
  7 CODE >FAR ( ha -- a n )
  8  POP   DE|
  9  LD    A'|  D|
 10  ANDN  HEX  E0 N,
 11  RLCA
 12  RLCA
 13  RLCA
 14 -->
 15 

Scr# 302 
  0 ( Study: MMU7 / simplest )
  1 \
  2  ORN   HEX  40 N,
  3 \
  4  LD    L'|  A|
  5  LDN   H'|  00 N,
  6  LD    A'|  D|
  7  ORN   HEX  E0 N,
  8  LD    D'|  A|
  9  PSH2
 10 C;
 11 -->
 12 
 13 
 14 
 15 

Scr# 303 
  0 ( Study: MMU7 / simplest )
  1 \ reverse of >FAR: encodes a FAR address 8K-page in bits 765
  2 \ of H, lower bits of HL are offset at E000h
  3 \
  4 CODE <FAR ( a n -- ha )
  5  POP   DE|
  6  POP   HL|
  7  LD    A'|  E|
  8  ANDN  HEX  07 N,    \ page number is betwen 0 and 7
  9  RRCA
 10  RRCA
 11  RRCA
 12 -->
 13 
 14 
 15 

Scr# 304 
  0 ( Study: MMU7 / simplest )
  1 \
  2  LD    D'|  A|
  3  LD    A'|  H|
  4  ANDN  HEX  1F N,
  5  ORA    D|
  6  LD    H'|  A|
  7  PSH1
  8 C;
  9 DECIMAL
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 305 
  0 ( Study: MMU7 / 16th byte )
  1 \ decode 7 top bits of H as 8K-page 72-199
  2 \ lsb of H and all L are offset rounded at 16th byte
  3 \
  4 \ heap pointer              pppp pppb   bbbb bbbb
  5 \ page:offset   xppp pppp : 111b bbbb   bbbb 0000
  6 \
  7 CODE >FAR ( a1 -- a2 n )
  8  POP   HL|
  9  LD    A'|   H|
 10  SRL    A|
 11  ADDN  HEX  48  N,
 12  LD    E'|   A|        \ page
 13  LDN   D'|   0  N,
 14 -->
 15 

Scr# 306 
  0 ( Study: MMU7 / 16th byte )
  1 \
  2  ADDHL HL|
  3  ADDHL HL|
  4  ADDHL HL|
  5  ADDHL HL|               \ shift hl 4 bits left
  6  LD    A'|   H|
  7  ORN   HEX  E0  N,
  8  LD    H'|   A|          \ E000 offset
  9  PUSH  HL|
 10  PUSH  DE|
 11  NEXT C;
 12 -->
 13 
 14 
 15 

Scr# 307 
  0 ( Study: MMU7 / 16th byte )
  1 \ reverse of >FAR, encodes 8K-page in bits 7-1 of H
  2 \ bit 1 of H and L are the address rounded at 16 byte
  3 \
  4 CODE <FAR ( a2 b -- a1 )
  5  POP   DE|          \ page 72-199
  6  POP   HL|          \ offset at E000
  7  LD    A'|   E|
  8  SUBN  HEX  48  N,
  9  ADDHL HL|
 10  ADDHL HL|
 11  ADDHL HL|
 12  ADDHL HL|
 13  -->
 14 
 15 

Scr# 308 
  0 ( Study: MMU7 / 16th byte )
  1 \
  2  RLA                     \ A receives HL msb
  3  LD    L'|   H|
  4  LD    H'|   A|
  5  PUSH  HL|
  6  NEXT C;
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 309 
  0 ( example < asm )
  1 code < ( n1 n2 -- f )
  2   pop de|      pop hl|
  3   ld  a'|  h|  xorn hex 80 n,  ld h'| a|
  4   ld  a'|  d|  xorn hex 80 n,  ld d'| a|
  5 \ anda a|
  6   sbchl de|
  7   sbchl hl|
  8   push  hl|
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 310 
  0 ( LED - Large EDitor  1/18 )
  1 \ Large file EDitor: each line can be 85 characters long
  2 \ then maximum line number is 17.568
  3 decimal  marker TASK
  4  85 CONSTANT COLS/ROW            \ columns per row
  5   8 1024 * COLS/ROW / CONSTANT ROWS/PAGE   \ rows per 8K
  6        512 COLS/ROW / CONSTANT LED-CHARSIZE
  7 1  VARIABLE LED-LN     LED-LN ! \ line number
  8 1  VARIABLE LED-MAX   LED-MAX ! \ max line number
  9 0  VARIABLE LED-ROW   LED-ROW !
 10 0  VARIABLE LED-COL   LED-COL !
 11 1  VARIABLE LED-HOME LED-HOME ! \ first line to display
 12 CREATE LED-FN DECIMAL  80 ALLOT \ filename
 13 0 variable LED-FH  LED-FH !     \ filehandle of open file
 14 \
 15 -->

Scr# 311 
  0 ( LED - Large EDitor  2/18 )
  1 \ Since 8Kpages #32-39 are used by HEAP, we can use #40-223
  2 \ for this Large-file EDitor
  3 : >>FAR ( row -- n a ) \ given a row-number ret page+offset
  4   rows/page /mod  [ decimal ] 40 +
  5   dup 223 >  if 40 error then   \ out-of-memory
  6   swap cols/row  * [ HEX ] E000 OR swap ;
  7 \
  8 \ Row-ADdress, prepare MMU7 and return address of row
  9 : LED-RAD  ( row -- a )
 10   >>FAR MMU7! ;
 11 \
 12 : LED-CLOSE
 13   led-fh @ f_close [ decimal ] 42 ?error
 14   0 led-fh ! ;
 15 -->

Scr# 312 
  0 ( LED - Large EDitor  3/18 )
  1 \ assumes to read page np from filehandle LED-FH
  2 \ returns actual characters read. 0 means EOF
  3 \ row is stored in 8K-pages RAM 40-223
  4 decimal needs SHOW-PROGRESS
  5 : LED-RD1  ( np -- b )
  6   1 block   \ use block 1 as special buffer  \ np a a
  7   dup b/buf 2- led-fh @ f_getline >R         \ np a     \ b
  8   swap led-rad COLS/ROW 2dup blank           \ a a1 n1
  9   cmove R>                                   \ b
 10 ;
 11 -->
 12 
 13 
 14 
 15 

Scr# 313 
  0 ( LED - Large EDitor  4/18 )
  1 \ load filename specified in LED-FH
  2 \ Filehandle must be already open for read
  3 DECIMAL
  4 : LED-LOAD
  5   begin
  6     led-ln @  show-progress
  7     1 led-ln +!
  8     led-ln @ led-rd1
  9     ?terminal 1 AND 1- AND
 10   0= until \ end of file
 11   led-ln @ 1- led-max !
 12 ;
 13 -->
 14 
 15 

Scr# 314 
  0 ( LED - Large EDitor  5/18 )
  1 \ accept text for filename and keep it in LED-FN cz-string
  2 decimal
  3 : LED-FILE ( -- cccc )
  4   bl word dup 1+ c@ if
  5     led-fn 80 erase
  6     led-fn over c@ 1+ cmove 1
  7   else drop 0 then
  8 ;
  9 : LED-OPEN    \ open file and load to RAM
 10   led-file if
 11     led-fn 1+ pad 1 f_open 43 ?error led-fh !
 12     0 led-ln !  led-load led-close
 13   then
 14 ;
 15 -->

Scr# 315 
  0 ( LED - Large EDitor  6/18 )
  1 \ write line # np to file
  2 \ n.b. trailing spaces are always removed
  3 : LED-WR1  ( np -- )
  4   led-rad COLS/ROW -TRAILING                      \ a n
  5   2DUP  + [ HEX ] 0A  SWAP C!                     \ a n
  6   2DUP 1+ LED-FH @ F_WRITE [ decimal ] 47 ?ERROR  \ a n n
  7   DROP  + [ HEX ] 20  SWAP C!                     \
  8 ;
  9 -->
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 316 
  0 ( LED - Large EDitor  7/18 )
  1 \ save current filename
  2 : LED-SAVE
  3   led-fn 1+ pad [ hex 0C 02 + ] LITERAL
  4   f_open [ decimal ] 43 ?error
  5   led-fh  !
  6   LED-MAX @ 1+ 1 ?DO
  7     I show-progress
  8     I LED-WR1
  9     ?terminal if leave then \ can be interrupted via BREAK
 10   LOOP
 11   led-fh @ f_close
 12   0 led-fh !
 13 ;
 14 -->
 15 

Scr# 317 
  0 ( LED - Large EDitor  8/18 )
  1 DECIMAL
  2 : LED-LINE ( n -- a )     \ address of current screen line n
  3   LED-HOME @ + LED-RAD ;
  4 : LED-PAD ( -- a )          \ dedicated PAD
  5   HERE 168 + ;
  6 : LED-DISPLAY               \ display current screen
  7   16 0 DO
  8     I LED-HOME @ +  LED-MAX @ > IF
  9       COLS/ROW 1 do [char] # emit loop
 10     ELSE
 11       I led-line COLS/ROW TYPE
 12     THEN
 13     CR
 14   LOOP
 15 ; -->

Scr# 318 
  0 ( LED - Large EDitor  9/18 )
  1 : LED-MOVE ( a n -- )      \ move from a to line n
  2   led-line COLS/ROW cmove ;
  3 : H ( n -- )               \ hold line to pad
  4   led-line pad 1+ cols/row dup pad c! cmove ;
  5 : E ( n -- )               \ erase line
  6   led-line cols/row blank  ;
  7 : RE ( n -- )              \ restore line from pad
  8   pad 1+ swap led-move ;
  9 : D ( n -- )               \ delete line
 10   dup H led-max @ dup 1- rot     \  m m-1 n
 11   ?Do
 12     i 1+ led-line led-pad cols/row cmove
 13     led-pad i led-move
 14   Loop E  -1 led-max +! ;
 15 -->

Scr# 319 
  0 ( LED - Large EDitor 10/18 )
  1 : S ( n -- )                \ insert blank line
  2   dup 1- led-max @          \ n n m
  3   ?do
  4     i       led-line led-pad cols/row cmove
  5     led-pad i 1+ led-move
  6   -1 +Loop 1 led-max +!
  7   E
  8 ;
  9 : INS ( n -- )              \ insert line from pad
 10   dup S RE ;
 11 -->
 12 
 13 
 14 
 15 

Scr# 320 
  0 ( LED - Large EDitor 11/18 )
  1 DECIMAL   0 VARIABLE NROW     NROW !    \ current row
  2           0 VARIABLE NCOL     NCOL !    \ current columns
  3 : HOMEC   0 NROW ! 0 NCOL ! ;           \ cursor at home
  4 : ADDRC   ( -- a )                      \ calc cursor addr
  5   LED-HOME @ NROW @ + LED-RAD NCOL @ + ;
  6 : TO-SCR  ( row1 col1 -- col2 row2 )    \ translate xy
  7   0 + SWAP 2 + ;
  8 : AT-XY   ( col row -- )                \ set print position
  9   22 EMITC  EMITC EMITC ;               \ using standard AT.
 10 : HOME 0 0 AT-XY ;                      \ cursor at home
 11 : BUZZ    7 EMIT ;                      \ sound BEL
 12 : CURC! ( c -- )    \ store chr to current screen position
 13   ADDRC  C! ;
 14 : CURC@ ( -- c )    \ fetch chr from current screen position
 15   ADDRC  C@ ; -->

Scr# 321 
  0 ( LED - Large EDitor 12/18 )
  1 : EDIT-FRAME
  2   0 19 AT-XY
  3   INVV ."  row:" TRUV 8 SPACES INVV ."  col:" TRUV 5 SPACES
  4   INVV ."  hex:" TRUV 5 SPACES INVV ."  dec:" TRUV 6 SPACES
  5   INVV ."  chr:" TRUV
  6   CR INVV ."  pad:" TRUV PAD COUNT 55 MIN TYPE
  7   0 21 AT-XY  INVV ."  cmd:" TRUV
  8   CR ." W-RITE   B-ack    D-el     I-nsert   H-old"
  9   CR ." Q-uit    N-ext    S-hift   R-eplace  P-ut hex byte"
 10   COLS/ROW 10 -  0 AT-XY  INVV ."   LED   " TRUV ;
 11 : EDIT-STAT CURC@
 12   28 19 AT-XY  HEX DUP 3 .R  39 19 AT-XY  DECIMAL DUP 3 .R
 13   50 19 AT-XY  32 MAX EMIT
 14   18 19 AT-XY  NCOL @  3 .R
 15   05 19 AT-XY  NROW @  LED-HOME @ + 6 .R ; -->

Scr# 322 
  0 ( LED - Large EDitor 13/18 )
  1 NEEDS INVV NEEDS TRUV
  2 : RULER COLS/ROW 10 DO
  3         ." |----.----"  10 +LOOP  ;
  4 : PUTPAGE 0 0 AT-XY LED-FN COUNT TYPE CR RULER CR
  5           LED-DISPLAY RULER ;
  6 : PREVP   1 led-home @ < if -16 led-home +! else buzz then ;
  7 : NEXTP  16 led-home +! led-max @ led-home @ <
  8             if PREVP buzz then ;
  9 : UPC    NROW @  0 > IF -1  NROW +!  ELSE  prevp putpage THEN ;
 10 : DOWNC  NROW @ 15 < IF  1  NROW +!  ELSE  nextp putpage THEN ;
 11 : LEFTC  NCOL @  0 > IF -1  ELSE  UPC    80 THEN NCOL +! ;
 12 : RIGHTC NCOL @ 80 < IF  1  ELSE  DOWNC -80 THEN NCOL +! ;
 13 -->
 14 
 15 

Scr# 323 
  0 ( LED - Large EDitor 14/18 )
  1 : BYTE ( -- b ) \ accept two hex digit as a byte
  2   KEY DUP EMIT 10 DIGIT DROP 4 LSHIFT
  3   KEY DUP EMIT 10 DIGIT DROP + ;
  4 HEX
  5 : DONEC             8F 26 +ORIGIN C!    \ reset cursor face
  6                     5F 28 +ORIGIN C! ;  \ reset cursor face
  7 : INITC   CURC@ BL MAX 26 +ORIGIN C!    \ change cursor face
  8                     8F 28 +ORIGIN C! ;
  9 DECIMAL
 10 : REFRESH                           \ refresh current line
 11   NROW @ 0 TO-SCR AT-XY COLS/ROW  spaces
 12   NROW @ 0 TO-SCR AT-XY NROW @ LED-line COLS/ROW type ;
 13 -->
 14 
 15 

Scr# 324 
  0 ( LED - Large EDitor 15/18 )
  1 : CMD   ( c -- )   \ handle EDIT key options
  2   6 21 AT-XY DONEC KEY UPPER BL MAX DUP EMIT CASE
  3   [CHAR] P OF BYTE CURC! ENDOF  \ put a byte at cursor
  4   [CHAR] H OF NROW @ H   ENDOF  \ copy to PAD
  5   [CHAR] S OF NROW @ S   ENDOF  \ shift down one row
  6   [CHAR] R OF NROW @ RE  ENDOF  \ replace row from PAD
  7   [CHAR] I OF NROW @ INS ENDOF  \ insert row from PAD
  8   [CHAR] D OF NROW @ D   ENDOF  \ delete row + copy to PAD
  9   [CHAR] N OF NEXTP      ENDOF  \ next page
 10   [CHAR] B OF PREVP      ENDOF  \ prev page
 11   [CHAR] W OF LED-save   ENDOF
 12   [CHAR] Q OF ."  ok" CR C/L 2 * SPACES
 13               0 21 AT-XY 30 EMITC 8 EMITC  QUIT ENDOF
 14   ENDCASE PUTPAGE EDIT-FRAME ; -->
 15 

Scr# 325 
  0 ( LED - Large EDitor 16/18 )
  1 : DELC    ( -- )    \ back-space
  2   NCOL @  0 > IF -1 NCOL +! THEN
  3   ADDRC DUP 1+ SWAP C/L NCOL @ - 1- CMOVE UPDATE
  4   BL NROW @ LINE C/L + 1- C! ;
  5 : INSC    ( -- )    \ insert blank at cursor and shift the rest
  6   ADDRC DUP 1+      C/L NCOL @ - 1- CMOVE>
  7   BL ADDRC  C!  UPDATE ;
  8 : CTRLC  ( c -- )   \ manage control keys
  9   CASE 08 OF LEFTC  ENDOF      09 OF RIGHTC ENDOF
 10        10 OF DOWNC  ENDOF      11 OF UPC    ENDOF
 11        12 OF DELC   REFRESH ENDOF
 12        13 OF DOWNC 0 NCOL ! ENDOF
 13        07 OF CMD            ENDOF
 14   ENDCASE ;
 15 -->

Scr# 326 
  0 ( LED - Large EDitor 17/18 )
  1 : LED-EDIT ( -- )
  2   30 EMITC LED-CHARSIZE EMITC  \ change chr width
  3   1 LED-HOME !
  4   CLS HOMEC PUTPAGE EDIT-FRAME
  5   BEGIN
  6     EDIT-STAT  INITC
  7     CURC@ NROW @ NCOL @ TO-SCR  2DUP AT-XY
  8     KEY  ?TERMINAL IF DROP 0 INSC   REFRESH THEN
  9     DUP BL < IF
 10       >R AT-XY EMIT R>  CTRLC
 11     ELSE
 12       CURC! AT-XY DROP CURC@ EMIT RIGHTC
 13     THEN
 14   AGAIN  \ quit using EDIT-key + Q
 15 ; -->

Scr# 327 
  0 ( LED - Large EDitor 18/18 )
  1 : LED
  2   LED-OPEN LED-EDIT
  3 ;
  4 
  5 
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 328 
  0 ( MMU7 HEAP )
  1 \ reserve n bytes on heap, retunrs heap-pointer to them
  2 : HEAP ( n -- ha )
  3   dup ?page
  4   hp@ swap
  5   cell+
  6   hp +!
  7   hp@ swap
  8   tuck   far !
  9 ;
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 329 
  0 ( MMU7 HEAP STRING )
  1 \ accepts a string and stores it to Heap,
  2 \ returns a Pointer to a counted string
  3 : +" ( ha -- ha )
  4  DUP FAR C@
  5  [CHAR] " WORD
  6  DUP C@ >R 1+
  7  HP@ FAR R@ CMOVE
  8  R@ HP+!
  9  R> +
 10  OVER FAR C!
 11 ;
 12 -->
 13 
 14 
 15 

Scr# 330 
  0 ( MMU7 HEAP STRING )
  1 \ accepts a string and store it to Heap, returns a
  2 \ pointer to a counted string
  3 : H" ( -- ha )
  4  HP @
  5  [CHAR] " WORD  DUP C@ 1+ >R
  6  OVER FAR  TUCK CELL+  R@ CMOVE
  7  R> CELL+ HP +!
  8  HP @ [ HEX ] 1FFF AND 1EFF >
  9  IF 1FFF OR 1+ HP ! THEN
 10  HP @ OVER !
 11 ;
 12 DECIMAL
 13 
 14 
 15 

Scr# 331 
  0 ( MMU7 HEAP STRING )
  1 \ given a pointer, prints the counted string
  2 \
  3 : .H
  4   FAR
  5   COUNT TYPE
  6 ;
  7 -->
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 332 
  0 ( MMU7 HEAP POINTER )
  1 \ like CONSTANT but it returns a FAR-resolved pointer
  2 : POINTER ( a -- cccc )
  3  <BUILDS
  4   ,
  5  DOES>
  6   @ FAR
  7 ;
  8 -->
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 333 
  0 ( S" Counted Strings in Heap )
  1 : (S")  R@ R> CELL+ >R  @ FAR COUNT ;
  2 \
  3 : S"  ( -- a n )
  4   STATE @ IF
  5    COMPILE (S") H" ,
  6   ELSE
  7    H" FAR COUNT
  8   THEN
  9 ; IMMEDIATE
 10 \
 11 : TEST_S"  S" HELLO WORLD" NOOP ;
 12 EXIT
 13 CR TEST_S" TYPE
 14 CR S" HELLO WORLD" TYPE
 15 

Scr# 334 
  0 \ TEST
  1 : Q CR
  2  ." HP  " HP@ U. CR
  3  ." P   " CURPAGE ? CR
  4 ;
  5 
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 335 
  0 ( Testing where $6000 is paged )
  1 HEX
  2 : T
  3   MMU7
  4   E000 DUMP
  5   FD38 DUMP
  6 ;
  7 DECIMAL
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 336 
  0 ( Testing where $6000 is paged )
  1 DECIMAL 14 EMITC
  2 HEX 8F EMITC 8F EMITC
  3 DECIMAL
  4 
  5 
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 340 
  0 ( TILEMAP study )
  1 : TILE-PALETTE
  2   [ BINARY  ] 00110000 [ HEX ] 43 REG!  \ set tilemap palette
  3   [ DECIMAL ] 07       [ HEX ] 40 REG!  \ selet slot
  4   [ BINARY  ] 11111000 [ HEX ] 41 REG!  \ set ink color
  5   [ DECIMAL ] 00       [ HEX ] 40 REG!  \ selet slot
  6   [ BINARY  ] 00000010 [ HEX ] 41 REG!  \ set paper
  7 
  8 ;
  9 -->
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 341 
  0 ( R/W : BLK-READ )
  1 \ read block n to address a
  2 : blk-read  ( a n -- )
  3   blk-seek
  4   b/buf
  5   blk-fh @
  6   f_read
  7   [ hex ] 2E ?error
  8   drop
  9 ;
 10 -->
 11 
 12 
 13 
 14 
 15 

Scr# 342 
  0 ( R/W : BLK-WRITE )
  1 \ write block n from address a
  2 : blk-write  ( a n -- )
  3   blk-seek
  4   b/buf
  5   blk-fh @
  6   f_write
  7   [ hex ] 2E ?error
  8   drop
  9 ;
 10 -->
 11 
 12 
 13 
 14 
 15 

Scr# 343 
  0 ( R/W : BLK-INIT )
  1 : blk-init
  2  blk-fh @ f_close drop   \ ignore error
  3  filename
  4  here 3 f_open
  5  44 ?error
  6  blk-fh !
  7 ;
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 344 
  0 ( blk-fname )
  1 : STRING"
  2   [CHAR] " WORD   COUNT 1+ ALLOT ;
  3 create blk-fname
  4   STRING" !Block-64.bin" 0 c,
  5 
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 345 
  0 ( r/w patch )
  1 ' r/w >BODY 30 + @ .word
  2 ' r/w >BODY 36 + @ .word
  3 \ ' nxtrd ' r/w >BODY 30 + !
  4 \ ' nxtwr ' r/w >BODY 36 + !
  5 
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 346 
  0 ( +loop standardization )
  1 NEEDS ASSEMBLER \ Import vocabulary
  2 \
  3 CODE (-loop)
  4   ldx     hl|   2 NN,
  5   addhl   sp|       \ save sp in hl'
  6   exx
  7   pop     bc|       \ increment
  8   ldsp,rp           \ use SP as RP temporarily
  9   pop     hl|       \ index
 10   pop     de|       \ limit
 11   push    de|       \ restore it back, interrupt may occur
 12   -->
 13 
 14 
 15 

Scr# 347 
  0 ( +loop standardization )
  1   xora     a|
  2   sbchl   de|     \ index - limit: limit is the new zero
  3   addhl   bc|     \ index - limit + increment
  4   bit      7|   b|
  5   jrf     z'| HOLDPLACE       \ increment < 0 ?
  6     ccf
  7   HERE DISP,
  8   jrf    cy'| HOLDPLACE
  9     addhl   de|   \ index + increment
 10     push    hl|
 11     exx
 12     ldsphl        \ restore SP and go BRANCH
 13     jp  ' BRANCH aa,
 14 -->
 15 

Scr# 348 
  0 ( +loop standardization )
  1   HERE  DISP,
  2   pop     hl|       \ discard limit
  3   ldrp,sp           \ change RP
  4   exx
  5   ldsphl
  6   incx    bc|       \ skip BRANCH
  7   incx    bc|
  8   jpix
  9 c;
 10 -->
 11 
 12 
 13 
 14 
 15 

Scr# 349 
  0 ( +loop standardization )
  1 CODE (*LOOP)
  2   ldx     hl|  1  NN,
  3   push    hl|
  4   jp      ' (-LOOP)   ( >BODY direct )  AA,
  5 c;
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 350 
  0 ( test )
  1 \ patch to +LOOP
  2 \ ' (-loop) ' +loop >BODY 6 + !
  3 \ ' (*loop) '  loop >BODY 6 + !
  4 0 variable increment          increment  !
  5 0 variable iterations         iterations !
  6 : t
  7   0 iterations !
  8   11  1
  9   do
 10     i .
 11     1 iterations +!
 12     iterations @ 21 > if quit  then
 13   2
 14   +loop
 15 ;

Scr# 351 
  0 ( -- )
  1 : x
  2   hex .s
  3   csp @ 16 - 20 dump
  4   cr cr
  5 ;
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 352 
  0 : Do
  1   ?comp
  2   lp @
  3   sp@ lp !
  4   [compile] do
  5 ; immediate
  6 : Loop
  7 x [compile] loop
  8 x begin
  9     sp@ lp @ -
 10   while
 11     [compile] then
 12   repeat
 13   lp !
 14 ; immediate
 15 -->

Scr# 353 
  0 : ?Do
  1   ?comp
  2   lp @
  3   sp@ lp !
  4   [compile] ?do
  5 ; immediate
  6 : +Loop
  7 x [compile] +loop
  8 x begin
  9     sp@ lp @ -
 10   while
 11     [compile] then
 12   repeat
 13   lp !
 14 ; immediate
 15 -->

Scr# 354 
  0 ( LEAVE study )
  1 needs assembler
  2 code (leave)
  3   ldhl()   hex 30 +origin AA,
  4   ldx      de|  4  NN,
  5   addhl    de|
  6   ld()hl   hex 30 +origin AA,
  7   jp ' BRANCH ( >BODY ) AA,
  8   c;
  9 -->
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 355 
  0 ( UNLOOP study )
  1 needs unloop
  2 : leave
  3   compile (leave)     \ unloop compile branch
  4   here >R 0 ,
  5   0 0                 \ csp h 0 h 3 h 2 x x
  6   sp@ dup cell+ cell+ \               ^   ^ sp sp+4
  7   tuck                \                     sp+4 sp sp+4
  8   csp @ swap -        \                     sp+4 sp csp-sp+4
  9   cmove               \ csp - - h 0 h 3 h 2
 10   csp @ cell-         \ csp - - h 0 h 3 h 2 csp-2
 11   R>   over !         \ csp h - h 0 h 3 h 2 csp-2
 12   cell- 0 swap !      \ csp h 0 h 0 h 3 h 2 csp-2
 13 ; immediate
 14 -->
 15 

Scr# 356 
  0 ( t )
  1 : t
  2   4 0 ?do
  3     i .
  4     i  if  leave  then
  5     i .
  6   loop
  7 ;
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 357 
  0 ( Matt Davies'  .helloworld )
  1 CODE .helloworld
  2         ldx  hl|   here  0  NN,
  3   here  ld   a'|   (hl)|
  4         anda  a|
  5         retf  z|
  6         rst  10|
  7         incx hl|
  8         jr   BACK,
  9         c;
 10   here  ," Hello, World!"  1+ swap !
 11 \
 12 \
 13 
 14 
 15 

Scr# 358 
  0 ( Speed Test - Benchmark - 5.12 sec. )
  1 HEX 5C78 1+ CONSTANT FRAMES DECIMAL  \ system variable
  2 : WAIT-TICK     (   --   )  \ waits for next frame/256
  3   FRAMES C@ BEGIN DUP FRAMES C@  - UNTIL DROP ;
  4 : DUMMY 100 255 113 */  DROP ;
  5 : SPEED-TEST
  6   0  ( init counter )
  7   WAIT-TICK ( and take ) FRAMES C@
  8   BEGIN
  9     SWAP 1+ SWAP  ( increment counter ) \ cnt frame
 10     DUMMY DUP FRAMES C@ -
 11   UNTIL
 12   DROP ;
 13 \ Result  7516 with Indirect Thread
 14 \ Result  8745 with Direct Thread
 15 \ Result  9773 with Golden Ratio

Scr# 360 
  0 ( F_STAT     via RST 8 hook code )
  1 \ Get file information/status
  2 code F_STAT ( fspec buff -- f )
  3   exx
  4   pop   de|      \ 11-byte buffer
  5   exx
  6   ex(sp)ix       \ filespec nul-terminated
  7   push  de|         push  bc|
  8   ldn   a'|   char  *  n,    di
  9   rst   08|   hex  AC  c,    ei
 10   pop   bc|         pop   de|         pop   bc|
 11   sbchl hl|
 12   push  hl|
 13   jpix
 14 c;
 15 

Scr# 361 
  0 ( F_FGETPOS  via RST 08 hook code )
  1 code F_FGETPOS ( n -- d f ) \ Get current file position.
  2   pop   hl|          ld    a'|   l|
  3   push  ix|          push  de|          push  bc|
  4   di
  5   rst  08|   hex  9F  c,
  6   ei
  7   exx
  8   pop   bc|          pop   de|          pop   ix|
  9   exx
 10   push  de|          push  bc|
 11   sbchl hl|
 12   push  hl|
 13   jpix    c;  -->
 14 
 15 

Scr# 362 
  0 ( F_SEEK     via RST 08 hook code )
  1 code F_SEEK ( d n -- f ) \ Sek to position in file.
  2   exx
  3   pop   hl|          ld    a'|  l|
  4   pop   bc|          pop   de|
  5   exx
  6   push  ix|          push  de|          push  bc|
  7   exx
  8   ldx   ix| 0 nn,
  9   di
 10   rst   08| $9F  c,
 11   ei
 12   pop   bc|          pop   de|          pop   ix|
 13   sbchl hl|
 14   push  hl|
 15   jpix    c;  -->

Scr# 363 
  0 ( F_WRITE    via RST 8 hook code )
  1 code F_WRITE ( a b fh -- n f ) \ Write bytes to file
  2   exx
  3   pop   hl|     \ file handle number
  4   ld    a'|   l|
  5   pop   bc|     \ bytes to read
  6   ex(sp)ix          exx
  7   push  de|         push  bc|         di
  8   rst   08|   hex  9E  c,             ei
  9   exx
 10   pop   bc|         pop   de|         pop   ix|
 11   push  de|     \ actual bytes read
 12   exx               push  de|
 13   sbchl hl|     \ flag
 14   push  hl|
 15   jpix    c;  -->

Scr# 364 
  0 ( F_READ     via RST 8 hook code )
  1 code F_READ ( a b fh -- n f ) \ Read bytes from file.
  2   exx
  3   pop   hl|         ld    a'|  l|
  4   pop   bc|         ex(sp)ix
  5   exx
  6   push  de|         push  bc|
  7   di
  8   rst   08|   hex  9D  c,
  9   ei
 10   pop   bc|         pop   de|           pop  ix|
 11   push  de|
 12   sbchl hl|
 13   push  hl|
 14   jpix    c;  -->
 15 

Scr# 365 
  0 ( F_CLOSE    via RST 8 hook code )
  1 code F_CLOSE ( fh -- f ) \ Close a file or directory.
  2   pop   hl|
  3   ld    a'|   l|
  4   push  ix|          push  de|          push  bc|
  5   di
  6   rst   08|   hex  9B  c,
  7   ei
  8   pop   bc|          pop   de|          pop   ix|
  9   sbchl hl|
 10   push  hl|
 11   jpix
 12 c;
 13 -->
 14 
 15 

Scr# 366 
  0 ( F_OPEN     via RST 8 hook code )
  1 code F_OPEN ( fspec buff mode -- fn f ) \ Open a file
  2   exx
  3   pop   bc|      \ mode
  4   ld    b'|   c|
  5   pop   de|      \ 8-byte buffer if any
  6   ex(sp)ix       \ filespec nul-terminated
  7   exx
  8   push  de|         push  bc|
  9   ldn   a'|   char  *  n,
 10   di
 11   rst   08|   hex  9A  c,
 12   ld    e'|   a|
 13   ldn   d'|   0  n,
 14 -->
 15 

Scr# 367 
  0 ( F_OPEN     via RST 8 hook code )
  1   ei
  2   exx
  3   pop   bc|         pop   de|         pop   ix|
  4   exx
  5   sbchl hl|
  6   push  hl|
  7   jpix
  8 c;
  9 -->
 10 \ CREATE FILENAME ," file.txt"
 11 \ FILENAME 1+ PAD 1 F_OPEN
 12 \ DROP
 13 \ F_CLOSE
 14 
 15 

Scr# 368 
  0 ( F_FSTAT    via RST 8 hook code )
  1 \ Get file information/status
  2 code F_FSTAT ( fspec buf c -- f )
  3   exx
  4   pop   hl|         pop   de|        ld   a'|  l|
  5   exx
  6   ex(sp)ix        \ filespec
  7   push  de|         push  bc|
  8   di
  9   rst   08|   $AC  c,
 10   pop   bc|         pop   de|        pop   ix|
 11   sbchl hl|
 12   push  hl|
 13   jpix
 14 c;
 15 

Scr# 369 
  0 ( F_SYNC     via RST 8 hook code )
  1 code F_SYNC  ( fh -- f ) \ Sync file changes to disk.
  2   pop   hl|        ld    a'|   l|
  3   push  ix|        push  de|          push  bc|
  4   di
  5   rst   08|   hex  9C  c,
  6   ei
  7   pop   bc|        pop   de|          pop   ix|
  8   sbchl hl|
  9   push  hl|
 10   jpix
 11 c;
 12 -->
 13 \ 2 F_SYNC works
 14 
 15 

Scr# 370 
  0 ( M_DOSVERSION via RST 8 hook code )
  1 \ Get API version/mode information
  2 \ Entry: none
  3 \ Exit: Fc=1, error; A=14 "no such device"
  4 \ Fc=0, success. BC="NX"; DE=maj.min in BCD format
  5 \   HL="en" or "es" for English/Spanish
  6 code M_DOSVERSION ( -- n )
  7   push  ix|
  8   push  bc|
  9   rst   08|   hex  88  c,
 10   pop   bc|
 11   pop   ix|
 12   push  de|
 13   jpix
 14 c;
 15 DECIMAL

Scr# 371 
  0 ( F_GETFREE  via RST 08 hook code test )
  1 code f_getfree ( drive -- d ) \ Get free space on drive.
  2   pop   hl|
  3   push  ix|         push  de|          push  bc|
  4   ld    a'|   l|
  5   di
  6   rst   08|   hex  B1  c,
  7   ei
  8   exx
  9   pop   bc|         pop   de|          pop   ix|
 10   exx
 11   push  de|         push  bc|          exx
 12   sbchl hl|
 13   push  hl|
 14   jpix
 15 c;

Scr# 372 
  0 ( M_P3DOS )
  1 code M_P3DOS  \ Make a +3DOS/IDEDOS/NextZXOS API call.
  2    ( n1 n2 n3 n4 a -- n5 n6 n7 n8 )
  3    ( hl de bc  a   -- hl de bc  a flag )
  4   exx
  5   pop   hl|   \ call ID
  6   pop   de|
  7   ld    a'|    e|
  8   pop   bc|
  9   pop   de|
 10   ex(sp)hl    \ call ID on TOS
 11   exx
 12   pop   hl|
 13   push  ix|         push  de|         push  bc|
 14   exdehl      \ call ID
 15 -->

Scr# 373 
  0 ( M_P3DOS )
  1 \  use page 7 RAM bank
  2   ldn   c'|   7   n,
  3   di
  4   rst   08|    hex  94  c,
  5   ei
  6   ld()x hl|  hex 032 +origin  aa,
  7   exx
  8   pop   bc|         pop   de|         pop   ix|
  9   exx
 10   push  hl|         push  de|         push  bc|
 11   -->
 12 
 13 
 14 
 15 

Scr# 374 
  0 ( M_P3DOS )
  1   ldn   h'|    0   n,
  2   ld    l'|    a|
  3   push  hl|
  4   exx
  5   sbchl  hl|
  6   push   hl|
  7   jpix
  8 c;
  9 decimal
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 375 
  0 ( F_OPENDIR  via RST 8 hook code )
  1 code F_OPENDIR ( fspec -- fh f ) \ Open directory.
  2   ex(sp)ix     \ fspec nul-terminated
  3   push  de|         push  bc|
  4   ldn   b'|   HEX  10 N,
  5   ldn   a'|   CHAR C  N,
  6   di
  7   rst   08|   HEX A3       C,
  8   ei
  9   ld    e'|  a|     ldn   d'|   0  N,
 10   exx
 11   pop   bc|         pop   de|         pop   ix|
 12   exx
 13   push  de|         exx
 14   sbchl hl|         push  hl|
 15   jpix  c;    -->

Scr# 376 
  0 ( F_READDIR  via RST 8 hook code )
  1 code F_READDIR ( buff fspec fh -- n f ) \ Read next entry.
  2   pop   hl|        \ file handle number
  3   ld    a'|   l|
  4   pop   de|        \ wildcard string (nul-terminated)
  5   ex(sp)ix         \ buffer
  6   push  bc|
  7   rst   08|   HEX A4 C,
  8   jr    BACK,
  9   c;    DECIMAL
 10   0 VARIABLE FH    FH !
 11 create path ," c:/tools/vforth/lib/"
 12 : opendir< ( -- fh )
 13   bl word count over + 0 swap !
 14   f_opendir 43 ?error ;
 15 -->

Scr# 377 
  0 ( NextZXOS - IDE_PATH 01b1 )
  1 MARKER TASK  \ M_P3DOS expects hl, de, bc, a, address
  2              \         returns hl, de, bc, a, errcode
  3 : IDE_PATH ( a n -- f )
  4   >R 0 0 R> $01B1 M_P3DOS >R 2DROP 2DROP R> ;
  5 : PATH>PAD ( -- )
  6   BL WORD COUNT >R PAD R@ CMOVE $FF PAD R> + C! ;
  7 : PATH_OP ( b -- )
  8   PATH>PAD PAD SWAP IDE_PATH 44 ?ERROR ;
  9 : SETCD ( -- ) 0 PATH_OP ;
 10 : GETCD ( -- ) 1 PATH_OP ;
 11 : MAKEDIR ( -- ) 2 PATH_OP ;
 12 : REMOVEDIR ( -- ) 3 PATH_OP ;
 13 
 14 
 15 

Scr# 378 
  0 ( DIR TEST )
  1 : DIR ( a -- )
  2   opendir< FH !
  3   begin
  4     PAD  0       1+  FH @  f_readdir  46 ?error
  5     while PAD ?TERMINAL IF QUIT THEN
  6       begin
  7         DUP C@ ?DUP while emit 1+  \ next address
  8       repeat 6 emit
  9       1+        DUP @ >R
 10       cell+     DUP @ >R
 11       cell+     2@ SWAP 08 d.r space space
 12       R> .fat-date space R> .fat-time CR
 13   repeat
 14   FH @ F_CLOSE .
 15 ;

Scr# 379 
  0 ( NextZXOS - IDE_MODE 01d5 )
  1 : IDE_MODE! ( hl de bc a -- )
  2   >R 0 0 R> 1
  3   [ HEX ] 01D5 M_P3DOS [ DECIMAL ]
  4   44 ?ERROR 2DROP 2DROP VIDEO ;
  5 HEX
  6 : LAYER: <builds C, , does> dup C@   \ ide_mode!
  7    swap 1+ @ ide_mode! 1E emitc emitc ;
  8 : LAYER0 0000 IDE_MODE! ; \ ULA
  9   0100 04  LAYER: LAYER10  \ Lo-Res
 10   0101 04  LAYER: LAYER11  \ ULA Enhanced
 11   0102 08  LAYER: LAYER12  \ Hi-Res
 12   0103 04  LAYER: LAYER13  \ Hi-Col
 13   0200 04  LAYER: LAYER2
 14 DECIMAL
 15 

Scr# 380 
  0 ( NextZXOS - IDE_CAPACITY $01b4 )
  1 \ M_P3DOS expects hl, de, bc, a, address
  2 \         returns hl, de, bc, a as error code
  3 : IDE_CAPACITY ( n -- d )
  4 \ n: unit (0 or 1)
  5 \ d: total card capacity in sectors.
  6   >R  0 ( hl )   0 ( de )  R> 1 AND ( bc )  0 ( a )
  7   [ HEX ] 01B4 M_P3DOS [ DECIMAL ]
  8   44 ?ERROR
  9   2DROP ( bc a ) SWAP ( hl,de )
 10 ;
 11 EXIT
 12 > TEST <
 13 0 IDE_CAPACITY D.
 14 
 15 

Scr# 381 
  0 ( NextZXOS - DOS_FREE_SPACE $0121 )
  1 \ c: drive letter UpperCase
  2 \ d: total card capacity in sectors.
  3 : DOS_FREE_SPACE ( c -- d )
  4   >R  0  0  0  R>
  5   [ HEX ] 0121 M_P3DOS [ DECIMAL ]
  6   44 ?ERROR
  7   DROP ( a ) ROT ( de bc hl ) DROP SWAP
  8   \
  9 ;
 10 EXIT
 11 > TEST <
 12 CHAR C DOS_FREE_SPACE D.
 13 
 14 
 15 

Scr# 382 
  0 ( NextZXOS - IDE_MODE 01d5 )
  1 \ Set current NextBasic display mode
  2 : IDE_MODE! ( hl de bc a -- )
  3   >R 0 0 R> 1
  4   [ HEX ] 01D5 M_P3DOS [ DECIMAL ]
  5   44 ?ERROR 2DROP 2DROP VIDEO
  6 ;
  7 HEX
  8 : LAYER0  0000 IDE_MODE!  ;
  9 : LAYER10 0100 IDE_MODE!  1E EMITC 4 EMITC ; \ Lo-Res
 10 : LAYER11 0101 IDE_MODE!  1E EMITC 4 EMITC ; \ ULA
 11 : LAYER12 0102 IDE_MODE!  1E EMITC 8 EMITC ; \ Hi-Res
 12 : LAYER13 0103 IDE_MODE!  1E EMITC 4 EMITC ; \ Hi-Col
 13 : LAYER2  0200 IDE_MODE!  1E EMITC 4 EMITC ;
 14 
 15 

Scr# 383 
  0 ( NextZXOS - IDE_MODE 01d5 )
  1 \ Query current NextBasic display mode information
  2 : IDE_MODE@ ( -- hl de bc a )
  3   0 0 0 0
  4   [ HEX ] 01D5 M_P3DOS [ DECIMAL ]
  5   44 ?ERROR
  6 ;
  7 \
  8 \ hex 1840 0 800 9
  9 \ hex 1820 7 800 5
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 384 
  0 ( DOS_FLUSH $0142 )
  1 \ Flush any pending write to SD
  2 : DOS_FLUSH ( c -- )
  3   >R 0 0 0 R>
  4   [ HEX ] 0142 M_P3DOS [ DECIMAL ]
  5   44 ?ERROR
  6   DROP 2DROP
  7 ;
  8 \ CHAR C DOS_FLUSH
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 385 
  0 ( DOS_VERSION / IDE_VERSION )
  1 NEEDS SPLIT
  2 : DOS_VERSION ( -- version issue )
  3   0 0 0 0
  4   [ HEX ] 0103 M_P3DOS [ DECIMAL ]
  5   44 ?ERROR
  6   2DROP NIP SPLIT
  7 ;
  8 : IDE_VERSION ( -- sub ver )
  9   0 0 0 0
 10   [ HEX ] 00A0 M_P3DOS [ DECIMAL ]
 11   44 ?ERROR
 12   2DROP NIP SPLIT
 13 ;
 14 
 15 

Scr# 386 
  0 ( IDE_BASIC 1/5 )
  1 NEEDS ASSEMBLER
  2 CODE IDE_BASIC ( a -- f )
  3   POP       HL|          \ command line address in HL
  4   PUSH      BC|          \ save Forth registers
  5   PUSH      IX|
  6   LD()X     SP|  HEX 02C +ORIGIN  AA,  \ save Forth SP
  7   LDX()     SP|  HEX 008 +ORIGIN  AA,  \ use Basic SP
  8   LDX       DE|  HEX 5756 NN,
  9   LDX       BC|  HEX 243B NN,
 10   OUT(C)    D'|   INC B'|   IN(C) D'|   \ ask MMU7
 11   DEC       B'|
 12   OUT(C)    E'|   INC B'|   IN(C) E'|   \ ask MMU6
 13   PUSH      DE|
 14 -->
 15 

Scr# 387 
  0 ( IDE_BASIC 2/5 )
  1 \ switch ROM from 3 to 2
  2   LDAR                   \ ask if interrupts are enabled
  3   PUSH      AF|
  4   DI
  5   LDX       BC|   HEX 7FFD NN,  \ port
  6   LDX       DE|   HEX 5B2C NN,  \ BANKM
  7   LDA(X)    DE|
  8   RES        4|    A|     \ switch ROM from 3 to 2
  9   OUT(C)    A'|           \ whatever RAM page at C000
 10   LD(X)A    DE|
 11   POP       AF|
 12   JPF       PO|  HERE 3 + AA,  \ skip EI if interrupts
 13   EI                           \ was disabled
 14 -->
 15 

Scr# 388 
  0 ( IDE_BASIC 3/5 )
  1   \ prepares for ide call
  2   NEXTREG  HEX 56 P, 0 N,          \ set RAM page 0 at C000
  3   NEXTREG  HEX 57 P, 1 N,          \ set RAM page 0 at C000
  4 \ LDX       DE|  HEX 01C0  NN,     \ IDE_BASIC via
  5 \ RST       08|  HEX 0094  C,      \ M_P3DOS seems not work
  6   CALL      HEX 01C0 AA,           \ direct call works
  7   SBCHL     HL|                    \ evaluate CFlag to 0/-1
  8 -->
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 389 
  0 ( IDE_BASIC 4/5 )
  1 \ switch ROM from 2 to 3
  2   LDAR                   \ ask if interrupts are enabled
  3   DI
  4   PUSH      AF|
  5   LDX       BC|   HEX 7FFD NN,  \ port
  6   LDX       DE|   HEX 5B2C NN,  \ BANKM
  7   LDA(X)    DE|
  8   SET        4|    A|     \ switch ROM from 2 to 3 (48K)
  9   OUT(C)    A'|           \ whatever RAM page at C000
 10   LD(X)A    DE|
 11   POP       AF|
 12   JPF       PO|  HERE 3 + AA,  \ skip EI if interrupts
 13   EI                           \ was disabled
 14 -->
 15 

Scr# 390 
  0 ( IDE_BASIC 5/5 )
  1   POP       DE|
  2   LD        A'|   E|   \ restore MMU6
  3   NEXTREGA HEX 56 P,
  4   LD        A'|   D|   \ restore MMU7
  5   NEXTREGA HEX 57 P,
  6   LDX()     SP|  HEX 02C +ORIGIN  AA,  \ restore Forth SP
  7   POP       IX|
  8   POP       BC|
  9   PUSH      HL|     \ this was obtained by SBC HL,HL above
 10   EI
 11   NEXT
 12   C;
 13   DECIMAL
 14 
 15 

Scr# 391 
  0 ( IDE_BASIC test )
  1 HEX 5C53 CONSTANT PROG
  2 HEX 5C3A CONSTANT ERRNR
  3 CREATE CMD_BASIC            \  ," .KEYHELP:"
  4 HEX F5 C, CHAR : C, F5 C,   \ PRINT:PRINT
  5 \ CHAR : CHAR . C, CHAR $ C,  \ .$
  6 CHAR : C, E2 C,             \ STOP  \  EA C,  \ REM
  7     0D C,  \ <CR>
  8 : TEST
  9   PROG @ 6 +
 10   IDE_BASIC
 11   [ HEX ] ERRNR C@ SWAP
 12 ;
 13 DECIMAL
 14 \ 
 15 

Scr# 392 
  0 ( REMOUNT via IDE_MOUNT    $01d2 )
  1 \ M_P3DOS expects hl, de, bc, a, and address
  2 \         returns hl, de, bc, a, and flag error code
  3 : REMOUNT  ( -- )
  4   BLK-FH @ F_CLOSE DROP         \ close BLOCKS file
  5   0 0 0 0 [ HEX ] 01D2 M_P3DOS  >R 2DROP 2DROP R>
  6   IF
  7     ." Cannot unmount" CR
  8   ELSE
  9     ." Remove/insert SD and press Y"
 10     BEGIN KEY UPPER [CHAR] Y = UNTIL
 11     0 0 0 1 [ HEX ] 01D2 M_P3DOS DROP 2DROP 2DROP
 12   THEN
 13   BLK-INIT [ DECIMAL ]
 14 ;
 15 

Scr# 393 
  0 ( IDE_TOKENISE $01d8 )
  1 \ M_P3DOS expects hl, de, bc, a, and address
  2 \         returns hl, de, bc, a, and flag error code
  3 HEX
  4 : IDE_TOKENISE ( a1 n1 -- a2 n2 n3 f )
  5   >R 1FFF AND        \ hl=offset of text in 8K-page n
  6   0 R> FF AND        \ c=8K-page n1, b=0 for tokenising
  7   0 01D8 M_P3DOS NIP \ hl de bc flag
  8 ;
  9 : IDE_DETOKENISE ( a0 a1 n -- f )
 10   >R 1FFF AND        \ hl=offset of text in 8K-page n
 11   SWAP               \ de=addres of tokenised basic line
 12   R> FF AND 100 +    \ c=8K-page n1, b=1 for detoken.
 13   01D8 M_P3DOS NIP   \ hl de bc flag
 14 ;
 15 

Scr# 394 
  0 ( IDE_TOKENISER )
  1 NEEDS HEAP  NEEDS S"  NEEDS +C
  2 H" PRINT:PRINT" HEX 0D +C  \ ha
  3 FAR MMU7@ IDE_TOKENISE
  4 
  5 
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 395 
  0 ( SPRITE structure )
  1 : t
  2   #17 MMU7!
  3   $FFFF $E000
  4   do i $80 dump
  5   key drop
  6   $80 +loop
  7 ;
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 398 
  0 ( looking for AT position in LAYERs )
  1 \ search memory for a specific xt for debug purposes
  2 DECIMAL NEEDS .AT
  3 : .AT
  4 22 EMITC 31 AND SWAP 21 MIN EMITC EMITC ;
  5 HEX
  6 : LOOK-FOR
  7   0F MMU7!
  8   FFFF  E000  DO
  9     0D 11 AT.
 10     0D11 I @ = IF I U. THEN
 11     100D I @ = IF I U. THEN
 12   LOOP
 13   1 MMU7! ;
 14 
 15 

Scr# 399 
  0 ( Sprite definition )
  1 0
  2   2  +FIELD  _spriteid
  3   2  +FIELD  _xcoord
  4   2  +FIELD  _ycoord
  5   1  +FIELD  _pattern
  6   1  +FIELD  _mflipflags
  7   1  +FIELD  _anchor
  8   1  +FIELD  _visible
  9 CONSTANT SPRITE-LEN
 10 \
 11 CREATE SPRITE       SPRITE-LEN  ALLOT
 12 -->
 13 
 14 
 15 

Scr# 400 
  0 ( Sprite struct definition )
  1 \
  2 NEEDS ASSEMBLER
  3 NEEDS OPEN<         \ later we use as OPEN< filename.f
  4 NEEDS J
  5 NEEDS BINARY       needs .s
  6 \
  7 MARKER TASK
  8 \
  9 : db .s ."  << " ;
 10 CODE WAIT halt next C;
 11 : PAUSE 0 ?DO WAIT LOOP ;
 12 \
 13 : +FIELD ( n1 n2 <name> -- n3 )
 14   <BUILDS OVER , + DOES> @ + ;
 15 -->

Scr# 401 
  0 ( Sprite struct definition )
  1 0
  2   2  +FIELD  _spriteid   \ to attr. 3 bits 5:0
  3   2  +FIELD  _xcoord     \ to attr. 0 + attr. 2 bit 0
  4   2  +FIELD  _ycoord     \ to attr. 1
  5   1  +FIELD  _rotmir     \ to attr. 2 bits 3:1
  6   1  +FIELD  _pattern    \ to attr. 2 bits 7:4
  7   1  +FIELD  _anchor     \ to attr. 4 ...
  8 CONSTANT SPRITE-OB
  9 \
 10 CREATE SPRITE  SPRITE-OB  ALLOT
 11 -->
 12 
 13 
 14 
 15 

Scr# 402 
  0 ( Sprite Lib - Derek Bolli et Al. )
  1 BINARY 00000010 CONSTANT SPRITE-ROT
  2        00000100 CONSTANT SPRITE-VFLIP
  3        00001000 CONSTANT SPRITE-HFLIP
  4 \
  5 HEX 303B CONSTANT SPRITE-SLOT-SELECT-PORT
  6     0057 CONSTANT SPRITE-ATTRIBUTE-PORT
  7     005B CONSTANT SPRITE-PATTERN-PORT
  8 DECIMAL
  9    256 CONSTANT SPRITE-BUFLEN
 10 \
 11 CREATE SPRITE-BUFFER SPRITE-BUFLEN ALLOT
 12        SPRITE-BUFFER SPRITE-BUFLEN ERASE
 13 -->
 14 
 15 

Scr# 403 
  0 ( Sprite Lib )
  1 \ transmit 256 bytes of sprite data from address a
  2 \ : SPRITE-DATA>    ( a -- )
  3 \ 256 OVER + SWAP DO
  4 \   I C@ SPRITE-PATTERN-PORT P!
  5 \ LOOP ;
  6 
  7 CODE SPRITE-DATA> ( a -- )
  8   pop     hl|
  9   push    bc|
 10   ldx     bc|  SPRITE-PATTERN-PORT  NN,
 11   otir
 12   pop     bc|
 13   next
 14   C; -->
 15 

Scr# 404 
  0 ( Sprite Lib )
  1 \ init sprite number id
  2 : SPRITE-INIT ( id -- )
  3   SPRITE-SLOT-SELECT-PORT P!        \ select sprite id
  4   SPRITE-BUFFER
  5   SPRITE-DATA>
  6 ;
  7 \ set current sprite current attribute
  8 : SPRITE-ATTR ( b -- )
  9 \ base @ >R dup hex . dup binary . cr R> base !
 10   SPRITE-ATTRIBUTE-PORT P!
 11 ;
 12 DECIMAL -->
 13 
 14 
 15 

Scr# 405 
  0 ( Sprite Lib )
  1 \ setup up to  64 sprites read from <file>
  2 : SPRITE-LOAD< ( <file> -- )
  3   OPEN< >R                      \ open file and save fh
  4   064 0 DO
  5     SPRITE-BUFFER SPRITE-BUFLEN \ since we are inside a loop
  6     J                           \ get filehandle using J
  7     F_READ                      \ read from file
  8     IF      LEAVE               \ non-zero means error
  9     ELSE    I SPRITE-INIT       \ setup this sprite
 10     THEN
 11     DROP             \ discard actual bytes read in any case
 12   LOOP
 13   R>  F_CLOSE  42 ?ERROR
 14 ; -->
 15 

Scr# 406 
  0 ( Sprite )
  1 HEX
  2 : SPRITE-UPDATE      ( a n -- )
  3   SPRITE-SLOT-SELECT-PORT P!
  4   DUP  _xcoord     C@        SPRITE-ATTR     \ attribute 0
  5   DUP  _ycoord     C@        SPRITE-ATTR     \ attribute 1
  6   DUP  _xcoord 1+  C@  1 AND
  7   OVER _rotmir     C@ 0E AND OR
  8   OVER _pattern    C@ F0 AND OR
  9                              SPRITE-ATTR     \ attribute 2
 10   DUP  _spriteid   C@ C0 OR  SPRITE-ATTR     \ attribute 3
 11   DROP ;
 12 DECIMAL -->
 13 
 14 
 15 

Scr# 407 
  0 ( Sprite )
  1 CODE SPRITE-HIDE    ( n -- )
  2   exx
  3   pop     hl|
  4   ldx     bc|   SPRITE-SLOT-SELECT-PORT  NN,
  5   out(c)  l'|
  6   ldx     bc|   SPRITE-ATTRIBUTE-PORT    NN,
  7   out(c)  (hl)'|      \ Attribute 0
  8   out(c)  (hl)'|      \ Attribute 1
  9   out(c)  (hl)'|      \ Attribute 2
 10   out(c)  (hl)'|      \ Attribute 3
 11   exx
 12   next
 13   C;
 14 DECIMAL
 15 -->

Scr# 408 
  0 ( Sprite Test )
  1 \
  2 .( open<   ../../demos/NextBASIC/basicSprites/DKSprite.spr  )
  3 \
  4 \
  5 SPRITE-LOAD< ../../demos/NextBASIC/basicSprites/DKSprite.spr
  6 \
  7 -->
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 409 
  0 ( Sprite Test )
  1 HEX
  2 FE 08 REG!   \ no contention on Peripeal 3 Setting
  3 E3 14 REG!   \ Global Transparency Colour
  4 18 40 REG!   \ Palette Index Register
  5 E3 41 REG!   \ Palette Data
  6 02 07 REG!   \ Go 7 MHz
  7 \
  8 \ enable Sprite on Border and set Layer-Priority to SLU
  9 \ BINARY 00000011 HEX 15 REG!
 10 3 HEX 15 REG!
 11 -->
 12 
 13 
 14 
 15 

Scr# 410 
  0 ( Sprite definition )
  1 NEEDS INVV NEEDS TRUV
  2 DECIMAL
  3 \
  4   1  SPRITE  _spriteid   !
  5 009  SPRITE  _xcoord     !
  6 010  SPRITE  _ycoord     !
  7   0  SPRITE  _pattern    c!
  8   0  SPRITE  _rotmir     c!
  9   0  SPRITE  _anchor     c!
 10 \
 11 SPRITE 0 SPRITE-UPDATE
 12 -->
 13 
 14 
 15 

Scr# 411 
  0 ( TEST )
  1 \
  2 : TEST
  3   60 0 DO
  4     I 1 AND    SPRITE _spriteid !
  5     I 4 *      SPRITE _xcoord !
  6     SPRITE  0  SPRITE-UPDATE
  7     04 pause
  8   LOOP
  9   0 SPRITE-HIDE
 10 ;
 11 ." Sync TEST "
 12 TEST
 13 -->
 14 
 15 

Scr# 412 
  0 ( ISR-TEST )
  1 NEEDS INTERRUPTS
  2 : ISR-TEST
  3   23672 ( FRAMES ) @ 7 AND 0= IF
  4     SPRITE _xcoord @ 320 >
  5     IF -20 SPRITE _xcoord ! THEN
  6     5  SPRITE _xcoord  +!
  7     SPRITE _xcoord @ 1 AND
  8     SPRITE _spriteid !
  9     SPRITE  0  SPRITE-UPDATE
 10   THEN
 11 ;
 12 ISR-OFF
 13 ' ISR-TEST ISR-XT !
 14 \ ISR-ON
 15 -->

Scr# 413 
  0 ( SPRITE with ISR-TEST )
  1 : BYE ISR-OFF BYE ;
  2 INVV CR
  3 ." GIVE ISR-OFF to stop."
  4 TRUV CR
  5 \
  6   ISR-ON
  7 \
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 414 
  0 needs .at  needs .paper  needs mouse
  1 needs ms
  2 : test
  3   begin
  4     0 0 .at mouse-xy . . CR
  5     mouse-rs ?   mouse-ds ?  mouse-s ? CR
  6     mouse-s @ 4 + .
  7     10 ms
  8   ?terminal until
  9 ;
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 415 
  0 ( .HEX and .BIN utility )
  1 DECIMAL
  2 : .HEX ( n -- ) \ print n in hexadecimal
  3   BASE @        \ save current base
  4   16 BASE !     \ set to hexadecimal
  5   SWAP U.       \ print number
  6   BASE !
  7 ;
  8 : .BIN ( n -- ) \ print n in binary
  9   BASE @        \ save current base
 10   2 BASE !      \ set to binary
 11   SWAP U.       \ print number
 12   BASE !
 13 ;
 14 
 15 

Scr# 416 
  0 ( rshift )
  1 needs assembler
  2 code rshift ( n1 u -- n2 )
  3   exx
  4   pop     bc|
  5   ld       c|  b'|
  6   pop     de|
  7   bsrlde,b
  8   push    de|
  9   exx
 10   Next c;
 11 -->
 12 
 13 
 14 
 15 

Scr# 417 
  0 ( rshift )
  1 needs assembler
  2 code Lshift ( n1 u -- n2 )
  3   exx
  4   pop     bc|
  5   ld       c|  b'|
  6   pop     de|
  7   bslade,b
  8   push    de|
  9   exx
 10   Next c;
 11 -->
 12 
 13 
 14 
 15 

Scr# 418 
  0 ( Enhanced ULA Control Register $43 )
  1    8         67 REG!     \ Palette Control (ULA first + SUL)
  2 $43 REG@ .
  3 decimal
  4 
  5 
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 419 
  0 ( Autoexec )
  1 \
  2   DECIMAL
  3    8         67 REG!     \ Palette Control (ULA first + SUL)
  4   25         64 REG!     \ Palette Index Select (blue paper)
  5   %00000001  65 REG!     \ Palette Data (darker)
  6   14         64 REG!     \ Palette Index Select (yellow ink)
  7   %11111001  65 REG!     \ Palette Data (lighter)
  8   1 17 EMITC EMITC       \ Paper 1 (blue)
  9 \
 10   INCLUDE    /TOOLS/VFORTH/LIB/AUTOEXEC.F
 11   ABORT
 12 
 13 
 14 
 15 

Scr# 420 
  0 ( TILEMAP study )
  1 Hex needs binary needs layers
  2 MARKER TASK
  3 NEEDS SPLIT
  4 \ 0x68 (104) - ULA Control. disable ULA output
  5 \ 80 68 reg!
  6 \ 0x6B (107) - Tilemap Control
  7 \ bin 10100001 hex 6b reg!
  8 : WAIT-KEY
  9   BEGIN
 10     [ HEX ] FE P@ 1F AND 1F XOR
 11   UNTIL ;
 12 -->
 13 
 14 
 15 

Scr# 421 
  0 ( TILEMAP study )
  1 \ 0x6B (107) Tilemap Control
  2 \ bit 7 = 1 enable the tilemap
  3 \ bit 6 = 0 for 40x32, 1 for 80x32
  4 \ bit 5 = eliminate the attribute entry in the tilemap
  5 \ bit 4 = Palette select, 0 first tilemap-paltte
  6 \ bit 3 = 1 to activate text mode !
  7 \ bit 2 = reserved, must be zero
  8 \ bit 1 = Activate 512 tile mode
  9 \ bit 0 = Force tilemap on top of ULA
 10 : TILE-ON  [ binary ] 10000001 [ hex ] 6B reg!  80 68 reg! ;
 11 : TILE-OFF [ binary ] 00000000 [ hex ] 6B reg!  00 68 reg! ;
 12 : TILE-TXT [ binary ] 11001001 [ hex ] 6B reg!  80 68 reg! ;
 13 : SET-PAL ( c n -- )  [ HEX ] 40 REG! 41 REG! ;
 14 : GET-PAL ( n -- c )  [ HEX ] 40 REG! 41 REG@ ;
 15 -->

Scr# 422 
  0 ( TILEMAP study )
  1 HEX
  2 \
  3 : TILE-BASE
  4   0A 6F reg!  \ Tile Definitions Base Address
  5   00 6E reg!  \ Tilemap Base Address at $4000
  6 ;
  7 : TILE-TXT-BASE
  8   14 6F reg!  \ Tile Definitions Base Address
  9   00 6E reg!  \ Tilemap Base Address at $4000
 10 ;
 11 -->
 12 
 13 
 14 
 15 

Scr# 423 
  0 ( TILEMAP study )
  1 \ given c produces 4 bytes to be stored for a tile-line
  2 : TILE-BIT        ( c -- n1 n2 n3 n4 )
  3   7 LSHIFT 0 0    ( n d )
  4   8 0 DO
  5     2DUP D+ 2DUP D+ 2DUP D+ 2DUP D+  \ 4 lshift
  6     ROT DUP + DUP  \ shift  n  bit-14 on the sign-bit
  7     0< IF -ROT     \ operate on d
  8          06 0 D+   \ this is palette entry for ink
  9     ELSE  -ROT
 10          01 0 D+   \ this is palette entry for paper
 11     THEN
 12   LOOP ROT DROP
 13   SPLIT    ROT  SPLIT   2SWAP ;
 14 -->
 15 

Scr# 424 
  0 ( TILEMAP study )
  1 \ Copy charset to 4A00, 1 bit is 4 bit
  2 : TILE-DEF
  3   [ HEX ] 5C36 @        \ CHARS address
  4   5B00 4A00 DO
  5     DUP C@      \ DUP 2/  OR
  6     TILE-BIT
  7     I       C!
  8     I 1+    C!
  9     I CELL+ C!
 10     I CELL+ 1+ C!
 11     1+
 12   4 +LOOP DROP
 13 ;
 14 -->
 15 

Scr# 425 
  0 ( TILEMAP study )
  1 \ copy charset to 5400, 1 bit is 1 bit
  2 : TILE-TXT-DEF
  3   [ HEX ] 5C36 @        \ CHARS address
  4   5B00 5400 DO
  5     DUP C@ \ DUP 2/  OR
  6     I C!
  7     1+
  8   LOOP DROP
  9 ;
 10 -->
 11 
 12 
 13 
 14 
 15 

Scr# 426 
  0 ( TILEMAP study )
  1 : TILE-EXAMPLE
  2   [ HEX ] 4000 [ DECIMAL ]    \ 4000-4A00
  3   2560 ERASE   \ 40x32x2
  4   2560 0 DO
  5     \ choose an ascii code between $20 and $7F
  6     I 2/    96 MOD 32 + I [ HEX ] 4000 + C! [ DECIMAL ]
  7     \ choose a palette offset (0 or 1) and shift it up
  8     I 2 AND 3 LSHIFT    I [ HEX ] 4001 + C!
  9   2 +LOOP
 10 ;
 11 -->
 12 
 13 
 14 
 15 

Scr# 427 
  0 ( TILEMAP study )
  1 : TILE-TXT-EXAMPLE
  2   [ HEX ] 4000 [ DECIMAL ]    \ 4000-5400
  3   5120 ERASE   \ 80x32x2
  4   5120 0 DO
  5     \ choose an ascii code between $20 and $7F
  6     I 2/    96 MOD 32 + I [ HEX ] 4000 + C! [ DECIMAL ]
  7     \ choose a palette entry  (0 or 1)
  8     I 2 AND             I [ HEX ] 4001 + C!
  9   2 +LOOP
 10 ;
 11 DECIMAL
 12 -->
 13 
 14 
 15 

Scr# 428 
  0 ( TILEMAP study )
  1 : TILE-PALETTE
  2   [ HEX ] 43 REG@          \ get current status of reg $43
  3   [ BINARY ] 10001111 AND \ .011.... is Tilemap 1st pal.
  4   [ BINARY ] 00110000 OR  \ .011.... is Tilemap 1st pal.
  5   [ HEX ] 43 REG! [ decimal ]
  6   \ 16 palette entries plus their shift
  7   [ binary ] 00000000 [ hex ]  00  set-pal   \ black
  8   [ binary ] 00000001 [ hex ]  01  set-pal   \ blue
  9   [ binary ] 11011000 [ hex ]  06  set-pal   \ yellow
 10   [ binary ] 00000001 [ hex ]  11  set-pal   \ blue
 11   [ binary ] 11000000 [ hex ]  16  set-pal   \ red
 12 ; -->
 13 
 14 
 15 

Scr# 429 
  0 ( TILEMAP study )
  1 : TILE-TXT-PALETTE
  2   [ HEX ] 43 REG@          \ get current status of reg $43
  3   [ BINARY  ] 10001111 AND \ .011.... is Tilemap 1st pal.
  4   [ BINARY  ] 00110000 OR  \ .011.... is Tilemap 1st pal.
  5   [ HEX ] 43 REG! [ decimal ]
  6   \ palette entries are given in couple ink on paper
  7   [ binary ] 11011000 [ hex ]  01  set-pal   \ yellow
  8   [ binary ] 00000001 [ hex ]  00  set-pal   \ on blue
  9   [ binary ] 11000000 [ hex ]  03  set-pal   \ red
 10   [ binary ] 00000001 [ hex ]  02  set-pal   \ on blue
 11 ;
 12 decimal
 13 
 14 
 15 

Scr# 430 
  0 ( TILEMAP study )
  1 LAYER2
  2 TILE-ON
  3 TILE-PALETTE
  4 TILE-DEF
  5 TILE-BASE
  6 TILE-EXAMPLE
  7 LAYER0 WAIT-KEY LAYER2
  8 TILE-TXT
  9 TILE-TXT-palette
 10 TILE-TXT-BASE
 11 tile-txt-example
 12 TILE-TXT-DEF
 13 layer0 wait-key layer2
 14 tile-off
 15 decimal

Scr# 431 
  0 ( TILEMAP study )
  1 : T1  ( c -- )
  2   DUP
  3   \ [ hex ] 4001 c!  4003 c!
  4   \ [ hex ] 6C REG!
  5   [ hex ]  00  set-pal   \ blue
  6 ;
  7 : TT
  8   binary
  9   [ decimal ] 256 0 DO
 10     I T1
 11     I . key
 12     ?terminal if decimal quit then
 13   1 +LOOP
 14 ;
 15 

Scr# 433 
  0 ( tile help )
  1 needs ASSEMBLER     \ Assume LAYER2
  2 CODE INNER ( j i -- )
  3   nextreg decimal 87 p, 32 n,
  4   ldx     de|  hex E000 1 - nn,
  5   ldhl()  ZZ   aa,                \ fetch ZZ content
  6   incx    hl|                     \ increment
  7   ld()hl  ZZ   aa,                \ store ZZ back
  8   addhl   de|                     \ add $E000 to original ZZ
  9   ld      a'|  (hl)|
 10   pop     de|  \ I : y horizontal
 11   pop     hl|  \ J : x vertical
 12   ld      d'|    a|
 13   ld      h'|    e|
 14   ld      a'|    e|
 15 -->

Scr# 434 
  0 ( tile help )
  1   rlca
  2   rlca
  3   rlca
  4   andn    7   N,
  5   addn    L2-RAM-PAGE  N,
  6   ldn    a'|   hex E0  n,
  7   adda    h|
  8   ld     h'|  a|
  9   ld  (hl)'|  d|
 10   next
 11 c;
 12 
 13 
 14 
 15 

Scr# 435 
  0 ( tile help )
  1 needs ASSEMBLER     \ Assume LAYER2
  2 hex 12 reg@ 2* constant L2-RAM-PAGE \ 8K-RAM page
  3 CODE pixeladd ( x y -- )
  4   pop     hl|  \ y : y horizontal
  5   pop     de|  \ x : x vertical
  6   ld      h'|    e|
  7   ld      a'|    e|
  8 -->
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 436 
  0 ( tile help )
  1   rlca
  2   rlca
  3   rlca
  4   andn    7   N,
  5   addn    L2-RAM-PAGE  N,
  6   nextrega decimal 87  p,
  7   ldn    a'|   hex E0  n,
  8   ora     e|
  9   ld     h'|  a|
 10   push   hl|
 11   next
 12 c;
 13 decimal
 14 
 15 

Scr# 438 
  0 ( afxframe tester )
  1 needs afxframe decimal
  2 : tester ( -- )
  3   881 block c/l +  afx-ch-desc 4 + !
  4   880 block c/l +  afx-ch-desc !
  5   88 0 do
  6     afxframe
  7   loop
  8 ;
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 439 
  0 ( afx load to block )
  1 needs load-bytes needs pad" needs load2block
  2 decimal
  3 \
  4 pad" /sfx/zxgames/arcanoid2_1.afx"      880 load2block
  5 pad" /sfx/zxgames/arcanoid2_2.afx"      881 load2block
  6 pad" /sfx/zxgames/arcanoid2_3.afx"      882 load2block
  7 pad" /sfx/zxgames/arcanoid2_4.afx"      883 load2block
  8 pad" /sfx/zxgames/arcanoid2_5.afx"      884 load2block
  9 pad" /sfx/zxgames/captainfizz_1.afx"       885 load2block
 10 pad" /sfx/zxgames/captainfizz_2.afx"       886 load2block
 11 pad" /sfx/zxgames/captainfizz_3.afx"       887 load2block
 12 pad" /sfx/zxgames/captainfizz_4.afx"       888 load2block
 13 pad" /sfx/zxgames/captainfizz_5.afx"       889 load2block
 14 \
 15 

Scr# 480 
  0 ( Lift Challenge )
  1 needs enumerated
  2 needs .at
  3 marker forget-lift
  4 \
  5 8 constant floors
  6 variable current-floor
  7 variable request-floor
  8 variable cabinet-door
  9 variable floor-button
 10          floors allot
 11 -->
 12 
 13 
 14 
 15 

Scr# 481 
  0 ( Lift Challenge )
  1 \
  2 2 enumerate close open
  3 \
  4 : index-of
  5   <builds , does> @ + ;
  6 \
  7 -->
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 482 
  0 ( Lift Challenge )
  1 : display-commn
  2 4 constant  command-strlen
  3 \
  4 create command-list
  5   ," --"
  6   ," GO"
  7   ," UP"
  8   ," DN"
  9 \
 10 \
 11 4 enumerated _NONE _GO _UP _DOWN
 12 \
 13 -->
 14 
 15 

Scr# 483 
  0 ( Lift Challenge )
  1 6 constant  floor-name-strlen
  2 \
  3 create floor-list
  4   ,"  T  "
  5   ,"  1  "
  6   ,"  2  "
  7   ,"  3  "
  8   ,"  4  "
  9   ,"  5  "
 10   ,"  6  "
 11   ,"  7  "
 12 8 constant  how-many-floors
 13 -->
 14 
 15 

Scr# 484 
  0 ( Lift Challenge )
  1 \
  2 \ given a command "n" display the lift
  3 \
  4 : display-lift  ( n -- )
  5   ." ["
  6   command-strlen *
  7   command-list +
  8   command-strlen type
  9   ." ]"
 10 ;
 11 \
 12 : display-lift-or-well ( n f -- )
 13   if display-lift else drop 4 spaces then
 14 ;
 15 -->

Scr# 485 
  0 ( Lift Challenge )
  1 \
  2 : display-floor  ( n f -- )
  3   over floor-name-strlen *
  4   floor-list +  type
  5   10 spaces ." |"
  6   display-lift-or-well ." |"
  7   3 spaces
  8 ;
  9 -->
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 486 
  0 ( Lift Challenge )
  1 \
  2 \ true flag to display the lift, false for empty well
  3 : display-beam  ( n f -- )
  4   ." --------------|"
  5   display-lift-or-well
  6   ." |--"
  7 ;
  8 -->
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 487 
  0 ( Lift Challenge )
  1 : display ( -- )
  2   0 0 .at
  3   1 8 do
  4       i 0 display-beam  cr
  5       i 0 display-floor cr
  6   -1 +loop
  7   0 0 display-beam
  8 ;
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 490 
  0 ( MOUSE FACE )
  1 MARKER NO-MOUSE-DEF
  2 \
  3 hex 14 reg@ constant E3       \ Global Transparency
  4 : " 00 C, ;        \ Black
  5 : | 6D C, ;        \ Dark-Grey
  6 : v B6 C, ;        \ Light-Grey
  7 : M FF C, ;        \ White
  8 : _ E3 C, ;        \ Transparency
  9 \
 10 \
 11 CREATE MOUSE-FACE
 12 \
 13 -->
 14 
 15 

Scr# 491 
  0  m | " " _ _ _ _ _ _ _ _ _ _ _ _   \ 0
  1  M M | " " _ _ _ _ _ _ _ _ _ _ _   \ 1
  2  M m M | " " _ _ _ _ _ _ _ _ _ _   \ 2
  3  M M M M | " " _ _ _ _ _ _ _ _ _   \ 3
  4  M M m M M | " " _ _ _ _ _ _ _ _   \ 4
  5  M M M M M M | " " _ _ _ _ _ _ _   \ 5
  6  M M M m M M M | " " _ _ _ _ _ _   \ 6
  7  M M M M M M M M | " " _ _ _ _ _   \ 7
  8  M M M M m M M M M | " " _ _ _ _   \ 8
  9  M M M M M M | " " " " " " _ _ _   \ 9
 10  M M | v M M | " " " _ _ _ _ _ _   \ A
 11  M | " v M M v | " " _ _ _ _ _ _   \ B
 12  | " _ _ v M M | " " _ _ _ _ _ _   \ C
 13  _ _ _ _ v M M v | " " _ _ _ _ _   \ D
 14  _ _ _ _ _ M M v | " " _ _ _ _ _   \ E
 15  _ _ _ _ _ v v | " " " _ _ _ _ _   -->

Scr# 492 
  0 ( MOUSE FACE )
  1 HEX 303B CONSTANT SPRITE-SLOT-SELECT-PORT
  2     0057 CONSTANT SPRITE-ATTRIBUTE-PORT
  3     005B CONSTANT SPRITE-PATTERN-PORT
  4        0 CONSTANT MOUSE-SPRITE-ID
  5 : MOUSE-SPRITE-SET ( a n -- )
  6   SPRITE-SLOT-SELECT-PORT P!
  7   [ DECIMAL ] 256 OVER + SWAP
  8   DO
  9     16 I + I
 10     DO
 11       I C@ SPRITE-PATTERN-PORT P!
 12     LOOP
 13   16 +LOOP
 14 ;
 15 -->

Scr# 493 
  0 ( MOUSE FACE )
  1 \
  2   MOUSE-FACE  MOUSE-SPRITE-ID  MOUSE-SPRITE-SET
  3 \
  4   NO-MOUSE-DEF
  5 \
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 500 
  0 ( Next Registers )
  1 \ HEX 253B CONSTANT REG-DATA
  2 \ HEX 243B CONSTANT REG-SELECT
  3 \ : REG-RD ( p -- v ) REG-SELECT P! REG-DATA P@ ;   \ REG@
  4 \ : REG-WR ( v p -- ) REG-SELECT P! REG-DATA P! ;   \ REG!
  5 \
  6 : B.  ( n -- ) \ display a number in binary
  7  BASE @ >R  S>D  2DUP HEX <# # # #> TYPE SPACE
  8  2 BASE ! <# 8 0 DO # LOOP #> TYPE  R> BASE ! ;
  9 \
 10 CR ." Machine ID    " 00 REG@   B.
 11 CR ." Core Version  " 01 REG@   B.
 12 CR ." Machine type  " 03 REG@   B.
 13 CR ." CPU Speed     " 07 REG@   7 AND DUP .
 14 DECIMAL 35 SWAP LSHIFT S>D <# # CHAR . HOLD #S #>
 15 SPACE TYPE SPACE ." MHz" CR

Scr# 501 
  0 ( Next Registers )
  1 HEX
  2 CR ." Reset         " 02 REG@   B.
  3 CR ." Peripheal 1   " 05 REG@   B.
  4 CR ." Peripheal 2   " 06 REG@   B.
  5 CR ." Peripheal 3   " 08 REG@   B.
  6 CR ." Peripheal 4   " 09 REG@   B.
  7 CR ." Core Boot     " 10 REG@   B.
  8 CR ." Video Timing  " 11 REG@   B.
  9 CR ." Layer 2 Active RAM Bank " 12 REG@   B.
 10 CR ." Layer 2 Shadow RAM Bank " 13 REG@   B.
 11 CR ." Global Transparency Colour " 14 REG@   B.
 12 CR ." Sprite and Layer System Setup " 15 REG@   B.
 13 CR ." Layer 2 Horizontal Scroll Control " 16 REG@   B.
 14 CR ." Layer 2 Vertical Scroll Control   " 17 REG@   B.
 15 -->

Scr# 502 
  0 ( Next Registers )
  1 HEX
  2 CR ." Layer 2 Clip Window Definition    " 18 REG@   B.
  3 CR ." Sprites Clip Window Definition    " 19 REG@   B.
  4 CR ." Layer 0 Clip Window Definition    " 1A REG@   B.
  5 CR ." Layer 3 Clip Window Definition    " 1B REG@   B.
  6 CR ." Clip Window Control               " 1C REG@   B.
  7 CR ." Active Video Line " 1E REG@   100 * 1F REG@   + .
  8 CR ." Line Interrupt Control      " 22 REG@   .
  9 CR ." Line Interrupt Value        " 23 REG@   .
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 503 
  0 ( Next Registers )
  1 HEX
  2 CR ." ULA Horizontal Scroll Control " 26 REG@   .
  3 CR ." ULA Vertical   Scroll Control " 27 REG@   .
  4 CR ." Stored Palette Value  " 28 REG@   .
  5 CR ." Layer 3 Horizontal Scroll Control "
  6                           2F REG@   100 * 30 REG@   + .
  7 CR ." Layer 3 Vetical Scroll Control " 31 REG@   .
  8 CR ." Layer 1,0 Horizontal Scroll Control " 32 REG@   .
  9 CR ." Layer 1,0 Vertical   Scroll Control " 33 REG@   .
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 504 
  0 ( Next Registers )
  1 HEX NEEDS LAYERS
  2 : CHECK-LAYER
  3   LAYER0  69 REG@
  4   LAYER10 69 REG@
  5   LAYER11 69 REG@
  6   LAYER12 69 REG@
  7   LAYER2  69 REG@
  8   LAYER12
  9   2 BASE ! .S
 10 ;
 11 
 12 
 13 
 14 
 15 

Scr# 511 
  0 ( Prepare Sine Table on Screen # DEST )
  1 NEEDS FLOATING
  2 NEEDS J
  3 DECIMAL  513 CONSTANT DEST  \ this
  4 \
  5 \ given d return a counted-string
  6 : D>PAD ( d -- a u )
  7   tuck dabs                   \ n ud   ( n has sign )
  8   <# # # # # # rot sign #>    \ a u
  9 ;
 10 \ store a space at address and increment
 11 : +SPACE ( a0 -- a1 )
 12   bl over c! 1+
 13 ;
 14 : +4SPACES +space +space +space +space ;
 15 -->

Scr# 512 
  0 ( Prepare Sine Table on Screen # DEST )
  1 DECIMAL \ prepare 91 Sine values from 0 deg to 90 deg
  2 : PREPARE  ( -- )
  3   13 0 do                     \ 13 rows 7 values each
  4     i 2+ DEST (line) drop update     \ a
  5     +4spaces
  6     07 0 do                          \ a
  7       i j 7 * + 0 deg>rad FSin       \ a d
  8       10000 0 F* 1/2 F+ Fint d>pad   \ a pad n
  9       >R over R@ cmove R> +          \ a+n
 10       +space                         \ a+n+1
 11       [char] , over c! 1+            \ a+n+2
 12       +space                         \ a+n+3
 13     loop +4spaces drop
 14   loop ;
 15 \ give FLOATING PREPARE

Scr# 513 
  0 ( Sine Cosine Table )
  1 CREATE SINE-TABLE
  2     00000 , 00175 , 00349 , 00523 , 00698 , 00872 , 01045 ,
  3     01219 , 01392 , 01564 , 01736 , 01908 , 02079 , 02250 ,
  4     02419 , 02588 , 02756 , 02924 , 03090 , 03256 , 03420 ,
  5     03584 , 03746 , 03907 , 04067 , 04226 , 04384 , 04540 ,
  6     04695 , 04848 , 05000 , 05150 , 05299 , 05446 , 05592 ,
  7     05736 , 05878 , 06018 , 06157 , 06293 , 06428 , 06561 ,
  8     06691 , 06820 , 06947 , 07071 , 07193 , 07314 , 07431 ,
  9     07547 , 07660 , 07771 , 07880 , 07986 , 08090 , 08192 ,
 10     08290 , 08387 , 08480 , 08572 , 08660 , 08746 , 08829 ,
 11     08910 , 08988 , 09063 , 09135 , 09205 , 09272 , 09336 ,
 12     09397 , 09455 , 09511 , 09563 , 09613 , 09659 , 09703 ,
 13     09744 , 09781 , 09816 , 09848 , 09877 , 09903 , 09925 ,
 14     09945 , 09962 , 09976 , 09986 , 09994 , 09998 , 10000 ,
 15 \ this page was prepared using the previous definitions

Scr# 514 
  0 ( Sine Cosine using table values )
  1 \ number are scaled by ten thousands
  2 : Sin    ( n -- m )
  3   180 /mod >R dup >R abs
  4   dup 90 > if 90 -  90 swap - then
  5   2* sine-table + @
  6   R> +-
  7   R> 1 and  if negate then
  8 ;
  9 : Cos  ( n -- m )
 10   90 - Sin negate
 11 ;
 12 
 13 
 14 
 15 

Scr# 520 
  0 ( LAYER 2 palette picker )
  1 \
  2 \ These screens defines
  3 \      COLOR-PICKER ( -- )
  4 \ and  PICK-COLOR ( -- b )
  5 \ They passes to Layer2 and let you choose a color
  6 \
  7 MARKER TASK
  8 \
  9 NEEDS INTERRUPT
 10 NEEDS VALUE     NEEDS TO      NEEDS +TO
 11 NEEDS CALL#     NEEDS FLIP
 12 NEEDS LAYER2    NEEDS LAYER12   NEEDS LAYER11
 13 NEEDS CASE
 14 -->
 15 

Scr# 521 
  0 ( LAYER 2 palette picker )
  1 DECIMAL
  2 \ compose Layer2 BRG color given its component b g r
  3 : BGR ( b g r -- n )
  4   8 * + 4 * + ;
  5 \
  6 0 0 5 BGR constant KRED
  7 0 5 0 BGR constant KGRN
  8 2 0 0 BGR constant KBLU
  9 2 5 5 BGR constant KWHT
 10 \
 11 0 value RED   0 value GRN   0 value BLU
 12 0 value dy    0 value dx    0 value COL
 13 0 value x     0 value y
 14 : RGB? RED . GRN . BLU . ;
 15 -->

Scr# 522 
  0 ( LAYER 2 palette picker )
  1 \
  2 \ array that keep track of color behind each cell
  3 \
  4 create ARY  22 22 * ALLOT
  5 : ARY!  ( c x y -- )
  6   22 * + ARY + c! ;
  7 : ARY@  ( x y -- c )
  8   22 * + ARY + c@ ;
  9 \
 10 \ to display big square
 11 create h-bar ,"  ---- "
 12 create v-bar ," |    |"
 13 -->
 14 
 15 

Scr# 523 
  0 ( LAYER 2 palette picker )
  1 \
  2 : condensed 30 emitc 4 emitc ;
  3 : large     30 emitc 8 emitc ;
  4 needs .border     needs .at
  5 needs .paper      needs .ink
  6 -->
  7 \ standard  Colors
  8 HEX
  9 : border.   2297 CALL# DROP ;
 10 DECIMAL
 11 : at.       22 emitc  swap  emitc emitc ;
 12 : ink.      16 emitc   emitc ;
 13 : paper.    17 emitc   emitc ;
 14 \
 15 -->

Scr# 524 
  0 ( LAYER 2 palette picker )
  1 : scr-init
  2   LAYER2  large  7 .border 0 .ink KWHT .paper CLS
  3   22  0 .at  ." Use CURSOR KEYS to move"
  4   23  0 .at  ." ENTER stops and returns byte"
  5    3 22 .at  KRED .ink  ." 32 x RED"
  6    4 22 .at  KGRN .ink  ."  4 x GREEN"
  7    5 22 .at  KBLU .ink  ."  1 x BLUE"     0 .ink
  8    8 24 .at  h-bar count type
  9   13 9 do i 24 .at v-bar count type loop
 10   13 24 .at h-bar count type
 11 ;
 12 : scr-done
 13   1 .border LAYER12
 14 ;
 15 -->

Scr# 525 
  0 ( LAYER 2 palette picker )
  1 \
  2 \ to display and populate ARY
  3 : set-block ( q -- )
  4   case
  5     0 of     red       grn    endof
  6     1 of  15 red -     grn    endof
  7     2 of  15 red -  15 grn -  endof
  8     3 of     red    15 grn -  endof
  9   endcase
 10   3 + to y
 11   3 + to x
 12   x y .at col .ink  143 emitc
 13   col x y ary!
 14 ;
 15 -->

Scr# 526 
  0 ( LAYER 2 palette picker )
  1 \
  2 \ display contour numeric frame
  3 : draw-frame ( -- )
  4   GRN 0= if
  5     KRED .ink
  6     03 RED + 1 .at RED 1 .R  03 RED + 20 .at RED 1 .R
  7     18 RED - 1 .at RED 1 .R  18 RED - 20 .at RED 1 .R
  8   then
  9   RED 0= if
 10     KGRN .ink
 11     20 y .at GRN 1 .R   1 y .at GRN 1 .R
 12   then
 13 ;
 14 -->
 15 

Scr# 527 
  0 ( LAYER 2 palette picker )
  1 \
  2 \ to complete numeric frame
  3 : draw-corner ( q -- )
  4   case
  5     0   of 01 01 endof
  6     1   of 20 01 endof
  7     3   of 01 20 endof
  8     2   of 20 20 endof
  9   endcase
 10   .at  KBLU .ink  BLU 1 .R
 11 ;
 12 -->
 13 
 14 
 15 

Scr# 528 
  0 ( LAYER 2 palette picker )
  1 \
  2 \ each single square: q is the quadrant
  3 : draw-block ( q -- )
  4   BLU GRN RED BGR  TO COL
  5   dup set-block
  6   draw-corner
  7   draw-frame
  8 ;
  9 -->
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 529 
  0 ( LAYER 2 palette picker )
  1 : draw-grid
  2   8 0 do
  3     i to RED
  4     8 0 do
  5       i to GRN
  6       0 to BLU 0 draw-block
  7       1 to BLU 1 draw-block
  8       2 to BLU 2 draw-block
  9       3 to BLU 3 draw-block
 10     loop
 11   loop
 12 ;
 13 -->
 14 
 15 

Scr# 530 
  0 ( LAYER 2 palette picker )
  1 \ display big squared-sample
  2 : sample
  3   x y ary@ .ink
  4   13 09 DO
  5     i 25 .at 143 dup 2dup emitc emitc emitc emitc
  6   LOOP
  7 ;
  8 : display-numbers
  9   0 .ink  [char] 0 to BL
 10   x y ary@  DUP DUP
 11   19 24 .at   2 base ! 8 .R
 12   15 24 .at   [char] $ emit  hex 2 .R
 13   17 24 .at   decimal  3 .R   32 to BL
 14 ;
 15 -->

Scr# 531 
  0 ( mouse test )
  1 HEX 0FFDF P@ FLIP VARIABLE mouse-x      mouse-x !
  2     0FBDF P@ FLIP VARIABLE mouse-y      mouse-y !
  3     0FADF P@      VARIABLE mouse-s      mouse-s !
  4   0 VARIABLE mouse-dx                   mouse-dx !
  5   0 VARIABLE mouse-dy                   mouse-dy !
  6   0 VARIABLE mouse-ds                   mouse-ds !
  7 : mouse-read ( -- ) \ interrupt-service-routine
  8   0FFDF P@ FLIP DUP mouse-x @ SWAP - mouse-dx ! mouse-x !
  9   0FBDF P@ FLIP DUP mouse-y @      - mouse-dy ! mouse-y !
 10   0FADF P@      DUP mouse-s @      - mouse-ds ! mouse-s !
 11   mouse-dy @ mouse-dx @ mouse-ds @ or or if
 12     5C3B C@ 20 OR 5C3B C! 0             \ set FLAGS sys-var
 13     mouse-ds @ 0> if 0D + then 5C08 C!  \ set LASTK sys-var
 14   then
 15 ; ' mouse-read INT-W !     -->

Scr# 532 
  0 ( LAYER 2 palette picker )
  1 DECIMAL
  2 \ decide cursor movement from character given
  3 : direction ( c -- )
  4   case
  5   [char] 7 of x 1 -  3 max to x endof
  6   [char] 8 of y 1 + 18 min to y endof
  7   [char] 5 of y 1 -  3 max to y endof
  8   [char] 6 of x 1 + 18 min to x endof
  9         11 of x 1 -  3 max to x endof
 10          9 of y 1 + 18 min to y endof
 11          8 of y 1 -  3 max to y endof
 12         10 of x 1 + 18 min to x endof
 13   endcase
 14 ;
 15 -->

Scr# 533 
  0 ( LAYER 2 palette picker )
  1 \ handle mouse movement
  2 : mouse-dir
  3   mouse-dx @ ?dup if
  4     1 swap +- x + 3 max 18 min to x
  5   then
  6   mouse-dy @ ?dup if
  7     1 swap +- y + 3 max 18 min to y
  8   then
  9 ;
 10 \
 11 ' mouse-read INT-W !
 12 \
 13 -->
 14 
 15 

Scr# 534 
  0 ( LAYER 2 palette picker )
  1 : PICK-COLOR-HB ( -- )
  2   begin
  3     sample display-numbers
  4     0 .ink  x y .at key \ interupt driven mouse triggers a key
  5     dup 13 -
  6   while
  7     x y ary@ .ink x y .at 143 emitc ( square graphic chr )
  8     direction mouse-dir
  9   repeat drop
 10 ;
 11 -->
 12 
 13 
 14 
 15 

Scr# 535 
  0 ( LAYER 2 palette picker )
  1 : COLOR-PICKER
  2   int-on
  3   scr-init draw-grid  3 to x  3 to y
  4   PICK-COLOR-HB
  5   condensed scr-done int-off
  6 ;
  7 : PICK-COLOR ( -- b )
  8   color-picker x y ary@
  9 ;
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 537 
  0 ( VALUE TO )
  1 NEEDS [']
  2 : (TO) ( xt -- ccc )
  3   ' >BODY  STATE @
  4   IF COMPILE LIT  ,  ,
  5   ELSE SWAP EXECUTE THEN
  6 ;
  7 : TO ( n -- ccc )
  8   ['] !   (TO)
  9 ; IMMEDIATE
 10 \
 11 : +TO ( n -- ccc )
 12   ['] +!  (TO)
 13 ; IMMEDIATE
 14 -->
 15 

Scr# 538 
  0 \ test
  1 : VALUE ( x ccc -- )
  2         ( -- n )
  3  [COMPILE] CONSTANT
  4 ; IMMEDIATE
  5 \
  6 EXIT
  7 123 VALUE XXX
  8 456 VALUE YYY
  9 789 VALUE ZZZ
 10 XXX    TO ZZZ
 11 : TEST
 12  ZZZ TO YYY
 13 ;
 14 
 15 

Scr# 540 
  0 ( LAYER2 )
  1 NEEDS LAYERS
  2 
  3 
  4 
  5 
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 548 
  0 ( Mr Jones' keyboard test )
  1 NEEDS ASSEMBLER
  2 CODE KEYBOARD?
  3   POP   HL|
  4   LD    A'|  L|
  5   ANDN  7    N,
  6   INC   A'|
  7   LD    H'|  A|
  8   SRL    L|
  9   SRL    L|
 10   SRL    L|
 11   LDN   A'|   5  N,
 12   SUBA   L|
 13   LD    L'|  A|
 14   LDN   A'|  HEX FE N,
 15 -->

Scr# 549 
  0 ( Mr Jones' keyboard test )
  1   HERE
  2     RRCA DEC H'|
  3   JRF   NZ'| BACK,
  4   INA   HEX FE P,
  5   HERE
  6     RRA  DEC L'|
  7   JRF   NZ'| BACK,
  8   CCF
  9   RL    L|
 10   PSH1
 11 C;
 12 DECIMAL
 13 
 14 
 15 

Scr# 552 
  0 ( Pitch bend )
  1 CODE PITCH-BEND
  2   PUSH  DE|
  3   PUSH  BC|
  4   LDX   HL|  500  NN,
  5   LDN   B'|  250   N,
  6   HERE
  7     LDX   DE|    1  NN,
  8     PUSH  BC|  PUSH  HL|  PUSH  IX|
  9     CALL  949 AA,
 10     POP   IX|  POP   HL|  POP   BC|
 11     INCX  HL|
 12   DJNZ  BACK,
 13   POP   BC|
 14   POP   DE|
 15   NEXT C;

Scr# 553 
  0 ( KEYBOARD-TEST )
  1 : KEYBOARD-TEST
  2   BEGIN
  3     40 0 DO
  4       I KEYBOARD?
  5       IF I . CR THEN
  6     LOOP
  7     ?TERMINAL
  8   UNTIL
  9 ;
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 557 
  0 ( FRAMES )
  1 HEX CODE 1FRAME 76 C, DD C, E9 C, SMUDGE
  2 : FRAMES ( n -- )  \ equivalent to Basic PAUSE n
  3   0 ?DO
  4     [ HEX ] 5C78 @
  5     BEGIN
  6       DUP [ HEX ] 5C78 @ -
  7     UNTIL
  8     DROP
  9   LOOP ;
 10 \
 11 : FRAMES@
 12   [ HEX ] 5C78 DUP CELL+ C@ >R @ R> ;
 13 \
 14 DECIMAL
 15 

Scr# 558 
  0 ( FRAMES 2 )
  1 NEEDS ms
  2 : T FRAMES@ D. ;
  3 : TT 1 FRAMES 1 FRAMES
  4   FRAMES@ ROT MS FRAMES@
  5   2SWAP DNEGATE D+ . . ;
  6 : TEST ( frames -- )
  7   400 18 DO
  8   I DUP . TT
  9   I 1+ DUP . TT
 10   I 2+ DUP . TT
 11   I 3 + DUP . TT
 12   CR 100 +LOOP
 13 ;
 14 
 15 

Scr# 559 
  0 ( TEST )
  1 HEX 5800
  2 CONSTANT ADDRESS
  3 20 VARIABLE DELAY   DELAY !
  4 : WAIT
  5   DELAY @ 0 DO 1 FRAMES LOOP
  6 ;
  7 : TEST1
  8   87 ADDRESS 2+ C!
  9   BEGIN
 10   00 ADDRESS C! WAIT
 11   3F ADDRESS C! WAIT
 12   ?TERMINAL
 13   UNTIL
 14 ;
 15 DECIMAL

Scr# 560 
  0 ( Convawys Game Of Life )
  1 needs graphics
  2 needs j  needs k
  3 needs choose
  4 \
  5   1 constant void   \  void color
  6 180 constant full   \  full color
  7  30 constant size
  8  40 constant shift
  9 \
 10 \
 11 -->
 12                               \  0   x   y
 13                               \  0   x   y+2  y-1
 14                               \  0   x
 15                               \  0   x   x

Scr# 561 
  0 ( Convawys Game Of Life )
  1 : count-neighb ( x y -- n )
  2   0 -rot                      \  0   x   y
  3   dup 2+ swap 1-              \  0   x   y+2  y-1
  4   do                          \  0   x
  5     dup                       \  0   x   x
  6     dup 2+ swap 1-            \  0   x   x+2  x-1
  7     do                        \  0   x
  8       swap                    \  x   0
  9       i j point               \  x   0   n
 10       full = if 1+ then       \  x   n
 11       swap                    \  n   x
 12     loop                      \  n   x
 13   loop drop                   \  n
 14 ;
 15 -->

Scr# 562 
  0 ( Convawys Game Of Life )
  1 : main-frame> ( -- )
  2   size 1 do         \ x : vert
  3     size 1 do       \ y : horiz
  4       j i point void = if
  5         j i count-neighb 3 = if full else void then
  6       else
  7         j i count-neighb 1-
  8         dup 2 = swap 3 = or  if full else void then
  9       then
 10       to attrib  j i shift + plot
 11     loop
 12   loop
 13 ;
 14 -->
 15 

Scr# 563 
  0 ( Convawys Game Of Life )
  1 : main-frame< ( -- )
  2   size 1 do         \ x : vert
  3     size shift + 1 shift + do     \ y : horiz
  4       j i point void = if
  5         j i count-neighb 3 = if full else void then
  6       else
  7         j i count-neighb 1-
  8         dup 2 = swap 3 = or  if full else void then
  9       then
 10       to attrib  j i shift - plot
 11     loop
 12   loop
 13 ;
 14 -->
 15 

Scr# 564 
  0 ( Convawys Game Of Life )
  1 : rand-setup
  2   full to attrib
  3   size 1 do         \ x : vert
  4     size 1 do       \ y : horiz
  5       7 choose 0= if
  6         j i plot
  7       then
  8     loop
  9   loop
 10 ;
 11 -->
 12 
 13 
 14 
 15 

Scr# 565 
  0 ( Convawys Game Of Life )
  1 : main-life
  2   begin
  3     main-frame>
  4     main-frame<
  5     ?terminal
  6   until
  7 ;
  8 -->
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 566 
  0 ( Convawys Game Of Life )
  1 : crawl-setup
  2   full to attrib
  3   3 2 plot   4 3 plot
  4   4 4 plot   3 4 plot
  5   2 4 plot
  6 ;
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 567 
  0 ( test SOURCE )
  1 needs evaluate
  2 needs s"
  3 source type
  4 : GS0 S" SOURCE .S" ;
  5 : GS1 S" 123 1+ 2+" ;
  6 : GS2 S" SOURCE .S GS0 EVALUATE" ;
  7 : GS3 S" Nfa: " TYPE ;
  8 \ GS1 EVALUATE GS0 .S
  9 
 10 GS2
 11 
 12 
 13 
 14 
 15 

Scr# 568 
  0 ( testing  test/source.f )
  1 needs case
  2 : test ( n -- )
  3   case ource needs evaluate needs compare
  4 : gs1 s" SOURCE" 2dup evaluate
  5   >R swap >R =  R> R>
  6 ;
  7 t{ gs1 -> <true> <true> }T
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 569 
  0 ( SOURCE )
  1 needs testing needs evaluate
  2 : gs0 s" source" 2dup evaluate ;
  3 : gs1 s" source" 2dup evaluate >r swap >r = r> r> = ;
  4 \
  5 gs0 type space type
  6 gs1 .s
  7 \ t{ gs1 -> <true> <true> }t
  8 \ : gs4 source >in ! drop ;
  9 \ t{ gs4 123 456
 10 \    -> }t
 11 
 12 
 13 
 14 
 15 

Scr# 580 
  0 ( TEST )
  1 NEEDS SAVE-BYTES
  2 \ Given an address, compute the relative address from $2000
  3 : DOT-RELATIVE ( a1 -- a2 )
  4   HERE SWAP - [ HEX ] 2000 + \
  5 ; DECIMAL
  6 0 VARIABLE FH       FH !
  7 \ accept volatile filename at PAD
  8 : FILENAME" ( -- )  \
  9   [CHAR] " WORD COUNT    \ a+1 n
 10   TUCK OVER + 0          \ n a+1 a+n+1 0
 11   SWAP !                 \ n a+1
 12   PAD ROT 1+             \ a+1 pad n+1
 13   CMOVE ;
 14 -->
 15 

Scr# 581 
  0 ( DOT example  .var )
  1 needs Assembler
  2 create Org Assembler
  3         ldhl()     #23627 AA,      \ VARS
  4   Here  ld    a'|   (hl)|
  5         cpn  $80 N,
  6         retf   z|
  7         jrf  nc'|  holdplace
  8         cpn  $20 N,
  9         jrf  cy'|  holdplace
 10         rst   10|
 11         incx  hl|
 12 here disp, here disp,
 13         jr    Back,
 14 -->
 15 

Scr# 590 
  0 ( Product routine for 12:4 fixed point )
  1 needs assembler
  2 \
  3 code vars
  4 \
  5   exx
  6   pop   de|
  7   pop   hl|
  8 -->
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 591 
  0 ( Product routine for 12:4 fixed point )
  1 -->
  2 \
  3   bit    7|   h|
  4   jrf   z'|   holdplace
  5   bit    7|   d|
  6   jrf   z'|   holdplace
  7 \
  8 -->
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 592 
  0 ( Product routine for 12:4 fixed point )
  1 \ unsigned * unsigned
  2   ld    b'|   l|
  3   ld    c'|   e|
  4   ld    e'|   l|
  5   ld    l'|   d|
  6   push  hl|
  7   ld    l'|   c|
  8   mul               \ Xx
  9   exdehl
 10   mul               \ Ww
 11   addhl de|
 12 \
 13 -->
 14 
 15 

Scr# 593 
  0 ( Product routine for 12:4 fixed point )
  1 \
  2   ld    e'|   c|
  3   ld    d'|   b|
  4   mul
  5   ldn   b'|   4 N,
  6   bsrade,b
  7   exdehl
  8   bslade,b
  9   addhl de|
 10   pop   de|
 11   mul
 12   ldn   b'| #12 N,
 13   bslade,b
 14 -->
 15 

Scr# 594 
  0 ( Product routine for 12:4 fixed point )
  1 \
  2   ld    e'|   c|
  3   ld    d'|   b|
  4   mul
  5   ldn   b'|   4 N,
  6   bsrade,b
  7   exdehl
  8   bslade,b
  9   addhl de|
 10   pop   de|
 11   mul
 12   ldn   b'| #12 N,
 13   bslade,b
 14 -->
 15 

Scr# 595 
  0 ( Product routine for 12:4 fixed point )
  1 \
  2   addhl de|
  3   push  hl|
  4   exx
  5   jpix
  6 C;
  7 \
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 598 
  0 \ kempston test
  1  marker task
  2 \
  3  : .bin
  4    base @ >r 2 base ! . r> base !
  5  ;
  6  : test
  7    begin
  8      0 0 at.
  9      31  p@
 10      . space
 11    ?terminal
 12    until
 13  ;
 14  \
 15 EXIT

Scr# 599 
  0 \ kempston test
  1 marker task
  2 needs at.
  3 : test
  4   begin
  5     223 p@ 0 0 at. . 3 spaces
  6   ?terminal until
  7 ;
  8 \
  9 EXIT
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 600 
  0 .( Chomp.f )
  1 \ MARKER TASK
  2 FORTH DEFINITIONS CASEOFF
  3 FLUSH EMPTY-BUFFERS
  4 NEEDS GRAPHICS
  5 NEEDS .AT        NEEDS .BORDER
  6 \ NEEDS .PERM
  7 NEEDS SPEED!
  8 NEEDS CHOOSE     \ random numbers
  9 NEEDS CASE
 10 NEEDS BLEEP      \ decimal  50 load \ bleep
 11 decimal 601 load
 12 decimal 610 load
 13 decimal 630 load
 14 decimal 650 load
 15 decimal 660 load

Scr# 601 
  0 ( Chomp.f )
  1 CODE sync-vid HEX
  2  76 C,         \ halt
  3  DD C, E9 C,   \ jp (ix)
  4  smudge
  5 \
  6 : c+! ( n a )
  7   tuck c@ + swap c! ;
  8 \
  9 : d+! ( n a )
 10   tuck 2@      \ a n d
 11   rot s>d d+   \ a d+n
 12   rot 2! ;
 13 decimal
 14 -->
 15 

Scr# 602 
  0 ( Chomp.f )
  1 : b.     ( n -- )
  2   base @ swap 2 base !
  3   8 .r  base ! ;
  4 \ double equals
  5 : D= ( d1 d2 -- f )
  6   rot =      \ l1 l2 h2=h1
  7   swap rot   \ h1=h2 l2 l1
  8   = and ;
  9 \ true if n between a and b
 10 : between ( n a b -- f )
 11   rot tuck < 0= \ a n b>n
 12   swap rot < 0= \ b>n n>a
 13   and ;
 14 -->
 15 

Scr# 603 
  0 ( Chomp.f )
  1 : six-emitc
  2   emitc emitc emitc
  3   emitc emitc emitc ;
  4 \
  5 : sync-emit
  6   sync-vid
  7   emitc emitc emitc emitc
  8   emitc emitc emitc emitc
  9   emitc emitc emitc emitc ;
 10 \
 11 -->
 12 
 13 
 14 
 15 

Scr# 604 
  0 ( Chomp.f )
  1 decimal 23560 constant LASTK
  2    variable total 0 ,
  3    variable score 0 ,
  4    variable high-score 0 ,
  5    variable counting
  6    variable lives
  7    variable hunt
  8 -->
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 605 
  0 ( Chomp.f )
  1 : pill-on
  2   -1 hunt !
  3   10  total d+!
  4   0 counting ! ;
  5 \
  6 : bip ( n1 n2 -- n3 n4 )
  7   beep-pitch
  8   bleep-calc
  9   swap ;
 10 \
 11 : 2lit ( n1 n2 -- )
 12   [compile] literal
 13   [compile] literal
 14 ; immediate -->
 15 

Scr# 606 
  0 ( Chomp.f )
  1 \ cursor keys
  2   char 8  value    key-right
  3   char 5  value    key-left
  4   char 7  value    key-up
  5   char 6  value    key-down
  6 \ cursor keys
  7        9  value    key+right
  8        8  value    key+left
  9       11  value    key+up
 10       10  value    key+down
 11 
 12 
 13 
 14 
 15 

Scr# 610 
  0 .( Chomp.f - UDG )
  1 decimal
  2 : UDG+ ( c1 -- c2 )
  3  upper 79 + ;
  4 \ compile and UDG literal
  5 : [UDG] ( -- )
  6  char UDG+ [compile] literal ;
  7  IMMEDIATE
  8 \ given c return UDG address
  9 : UDG@ ( c -- a )
 10  upper 65 - 8 * 23675 @ + ;
 11 \ given c print binary repres.
 12 : .UDG ( c -- )
 13  cr UDG@ dup 8 + swap do
 14   i c@ b.     cr
 15  loop ; -->

Scr# 611 
  0 ( Chomp.f - UDG )
  1 : UDGize ( a -- )
  2  count over + swap do
  3   i c@ upper [char] A [char] U
  4   between if
  5    i c@ upper UDG+ i c!
  6   then
  7  loop ;
  8 \
  9 : Gtype ( a c -- )
 10  over + swap ?do
 11   i c@ emitc loop ;
 12 : UDGs
 13   [char] V [char] A do
 14    i UDG+ emitc loop ;
 15 -->

Scr# 612 
  0 ( Chomp.f - UDG )
  1 create UDG_1
  2 hex
  3 FF00 , 0000 , 0000 , 0000 , \ A
  4 0000 , 0000 , 0000 , 00FF , \ B
  5 FF00 , 0000 , 0000 , 00FF , \ C
  6 F800 , 0204 , 0202 , 0202 , \ D
  7 1F00 , 4020 , 4040 , 4040 , \ E
  8 3F00 , 8040 , 4080 , 003F , \ F
  9 FC00 , 0102 , 0201 , 00FC , \ G
 10 0202 , 0202 , 0402 , 00F8 , \ H
 11 4040 , 4040 , 2040 , 001F , \ I
 12 0202 , 0202 , 0202 , 0202 , \ J
 13 -->
 14 
 15 

Scr# 613 
  0 ( Chomp.f - UDG )
  1 hex
  2 1800 , 4224 , 4242 , 4242 , \ K
  3 4242 , 4242 , 2442 , 0018 , \ L
  4 4040 , 4040 , 4040 , 4040 , \ M
  5 4242 , 4242 , 4242 , 4242 , \ N
  6 0000 , 7C38 , 7C7C , 0038 , \ O
  7 3E1C , 0F1F , 3E1F , 001C , \ P
  8 2200 , 7F77 , 3E7F , 001C , \ Q
  9 1C00 , 7C3E , 7C78 , 1C3E , \ R
 10 3800 , FE7C , EEFE , 0044 , \ S
 11 7E38 , DB5A , FFFF , 93FF , \ T
 12 0602 , 140A , EE24 , 66EE , \ U
 13 UDG_1 5C7B ! \ UDG
 14 -->
 15 

Scr# 614 
  0 .( Chomp.f - maze )
  1 decimal
  2 21 constant maze-h
  3 21 constant maze-w
  4 create maze-run
  5 24 21 * allot
  6 create maze-base
  7 -->
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 615 
  0 ( Chomp.f - maze )
  1 ," EAAAAAAAAANAAAAAAAAAD "
  2 ," M.........N.........J "
  3 ," M.EAD.EAD.N.EAD.EAD.J "
  4 ," MOM J.M J.N.M J.M JOJ "
  5 ," M.IBH.IBH.L.IBH.IBH.J "
  6 ," M...................J "
  7 ," M.FCG.K.FCACG.K.FCG.J "
  8 ," M.....N...N...N.....J "
  9 ," IBBBB.MCG.L.FCJ.BBBBH "
 10 ,"     J.N.......N.M     "
 11 ," BBBBH.L.E---D.L.IBBBB "
 12 -->
 13 
 14 
 15 

Scr# 616 
  0 ( Chomp.f - maze )
  1 ," /.......M   J.......\ "
  2 ," AAAAD.K.I---H.K.EAAAA "
  3 ,"     J.N.... ..N.M     "
  4 ," BBBBH.L.FCACG.L.IBBBB "
  5 ," M.........N.........J "
  6 ," MOFCD.FCG.L.FCG.ECGOJ "
  7 ," M...N...........N...J "
  8 ," AAD.L.FCCCCCCCG.L.EAA "
  9 ,"   J...............M   "
 10 ,"    AAAAAAAAAAAAAAA    "
 11 -->
 12 
 13 
 14 
 15 

Scr# 617 
  0 ( Chomp.f - maze )
  1 decimal
  2 : maze-copy ( a1 a2 -- )
  3  maze-h 0 do
  4   2dup 24 cmove
  5   dup udgize
  6   swap 24 + swap 24 +
  7  loop
  8  2drop ;
  9 \
 10 : set-maze-run
 11   maze-base
 12   maze-run
 13   maze-copy ;
 14 set-maze-run
 15 -->

Scr# 618 
  0 ( Chomp.f - maze )
  1 : maze^ ( x y -- a )
  2  maze-run + swap 1-
  3  24 * + ;
  4 \
  5 : maze@ ( x y -- c )
  6  maze^ c@ ;
  7 \
  8 : maze! ( c x y -- )
  9  maze^ c! ;
 10 \
 11 -->
 12 
 13 
 14 
 15 

Scr# 619 
  0 ( Chomp.f - maze )
  1 : maze.
  2  0 0 .at
  3  22 1 do
  4   025 23 i - 16 +
  5   beep-pitch bleep-calc
  6  loop
  7  maze-run
  8  22 1 do
  9   cr space sync-vid
 10   dup count gtype 24 +
 11  >R bleep R>
 12  loop
 13  drop
 14 ;
 15 -->

Scr# 620 
  0 .( Chomp.f - Sprite )
  1 create Array   6 08 * allot
  2 0 variable Sprite^            Sprite^   !
  3 0 value    Sprite-no
  4 : sprite# ( n -- )
  5   dup 3 lshift array +
  6   sprite^ ! to sprite-no ;
  7 \
  8 : sprite@ ( -- a )
  9   sprite^ @ ;
 10 \
 11 : all-ghost  ( v i -- )
 12   32 Array  + swap Array  +
 13   do dup i c! 08 +loop
 14   drop ;
 15 -->

Scr# 621 
  0 ( Chomp.f - Sprite )
  1 \ creates an index of Ghost
  2 : index-of ( n -- )
  3   <builds c, does> c@ + ;
  4 \ creates a ghost pointer
  5 : name-of  ( n -- creates )
  6   <builds c, does> c@ dup
  7   3 lshift Array + sprite^ !
  8   to sprite-no ;
  9 -->
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 622 
  0 ( Chomp.f - Sprite )
  1 \ array index by name
  2 0 name-of Inky
  3 1 name-of Pinky
  4 2 name-of Blinky
  5 3 name-of Ted
  6 \
  7 0 index-of face
  8 1 index-of color
  9 2 index-of x-pos
 10 3 index-of y-pos
 11 4 index-of dir
 12 5 index-of x-pre
 13 6 index-of y-pre
 14 7 index-of maze
 15 -->

Scr# 623 
  0 ( chomp.f - Sprite )
  1 \ shorthand for x-pos,y-pos
  2 : xy-pos@  ( -- x y )
  3   sprite@
  4   dup    x-pos c@
  5   swap   y-pos c@ ;
  6 : xy-pre@  ( -- x y )
  7   sprite@
  8   dup    x-pre c@
  9   swap   y-pre c@ ;
 10 : xy-pre! ( x y -- )
 11   >R sprite@ x-pre c!
 12   R> sprite@ y-pre c! ;
 13 \
 14 -->
 15 

Scr# 624 
  0 ( Chomp.f - Sprite )
  1 : Ghost-color ( -- )
  2  Inky   1 sprite@ color c!
  3  Pinky  3 sprite@ color c!
  4  Blinky 5 sprite@ color c!
  5  Ted    2 sprite@ color c!
  6 ;
  7 : Ghost-white ( -- )
  8  7  0 color  all-ghost
  9 ;
 10 ghost-color
 11 -->
 12 
 13 
 14 
 15 

Scr# 625 
  0 ( Chomp.f - Sprite )
  1 : Ghost-init  ( -- )
  2  12 0 x-pos  all-ghost
  3  11 0 y-pos  all-ghost
  4  55 0 dir    all-ghost
  5  bl 0 maze   all-ghost
  6  Inky   10 sprite@ y-pos c!
  7  Inky   xy-pos@ xy-pre!
  8  Pinky  12 sprite@ y-pos c!
  9  Pinky  xy-pos@ xy-pre!
 10  Ted    11 sprite@ x-pos c!
 11  Ted    xy-pos@ xy-pre!
 12  Blinky xy-pos@ xy-pre!
 13  [char] T udg+
 14  0 face all-ghost
 15 ; -->

Scr# 626 
  0 ( Chomp.f - Sprite )
  1 4 name-of Pacman
  2 : pacman-init
  3   Pacman [char] R@ UDG+
  4      sprite@ face  c!
  5   14 sprite@ x-pos c!
  6   12 sprite@ y-pos c!
  7   14 sprite@ x-pre c!
  8   12 sprite@ y-pre c!
  9    6 sprite@ color c!
 10   56 sprite@ dir   c!
 11   bl sprite@ maze  c!
 12 ;
 13 ghost-init
 14 pacman-init
 15 -->

Scr# 627 
  0 ( Chomp.f - Sprite )
  1 5 name-of Cherry
  2 : cherry-init
  3   Cherry [char] U UDG+
  4      sprite@ face  c!
  5   14 sprite@ x-pos c!
  6   12 sprite@ y-pos c!
  7   14 sprite@ x-pre c!
  8   12 sprite@ y-pre c!
  9    2 sprite@ color c!
 10   00 sprite@ dir   c!
 11   bl sprite@ maze  c!
 12 ;
 13 cherry-init -->
 14 
 15 

Scr# 628 
  0 ( Chomp.f - Sprite )
  1 \ draw current sprite
  2 : sprite-put ( -- )
  3   sprite@ face  c@
  4   sprite@ color c@   16
  5   xy-pos@ swap      22
  6   sprite@ maze  c@
  7   xy-pre@ swap      22
  8   4 16
  9   sync-emit
 10 ;
 11 \ usage:
 12 \ Blinky  sprite-put
 13 -->
 14 
 15 

Scr# 629 
  0 ( Chomp.f )
  1 : init-all
  2   ghost-init
  3   pacman-init
  4   cherry-init
  5   00 counting !
  6   1 hunt !
  7   key-right LASTK c!
  8 ;
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 630 
  0 .( Chomp.f - trail )
  1 : ?pac-trail  ( c -- )
  2  case
  3   bl       of 1 endof
  4   [char] . of 1 endof
  5   [udg]  U of 1 endof
  6   [udg]  O of 1 endof
  7   [char] / of 1 endof
  8   [char] \ of 1 endof
  9   0 swap
 10  endcase ;
 11 -->
 12 
 13 
 14 
 15 

Scr# 631 
  0 ( Chomp.f - trail )
  1 : ?ghost-trail  ( c -- )
  2  case
  3   bl       of 1 endof
  4   [char] . of 1 endof
  5   [udg]  U of 1 endof
  6   [udg]  O of 1 endof
  7   [char] - of 1 endof
  8   0 swap
  9  endcase ;
 10 -->
 11 
 12 
 13 
 14 
 15 

Scr# 632 
  0 ( Chomp.f - trail )
  1 : go-right
  2   Pacman
  3   xy-pos@      1+      maze@
  4   dup [char] \ = if
  5    1 sprite@ y-pos c!
  6   then
  7   ?pac-trail if
  8    [char] R@ UDG+
  9    sprite@ face  c!
 10    1  sprite@ y-pos c+!
 11 \ else 2 choose if key-up
 12 \  else key-down then
 13 \  sprite@ dir c!
 14   then ;
 15 -->

Scr# 633 
  0 ( Chomp.f - trail )
  1 : go-left
  2   Pacman
  3   xy-pos@      1-      maze@
  4   dup [char] / = if
  5    21 sprite@ y-pos c!
  6   then
  7   ?pac-trail if
  8    [char] P UDG+
  9     sprite@ face  c!
 10    -1 sprite@ y-pos c+!
 11 \ else 2 choose if key-up
 12 \  else key-down then
 13 \  sprite@ dir c!
 14   then ;
 15 -->

Scr# 634 
  0 ( Chomp.f - trail )
  1 : go-up
  2   Pacman
  3   xy-pos@ swap 1- swap maze@
  4   ?pac-trail if
  5    [char] Q UDG+
  6    sprite@ face  c!
  7    -1 sprite@ x-pos c+!
  8 \ else 2 choose if
  9 \  key-right else key-left then
 10 \  sprite@ dir c!
 11   then ;
 12 -->
 13 
 14 
 15 

Scr# 635 
  0 ( Chomp.f - trail )
  1 : go-down
  2   Pacman
  3   xy-pos@ swap 1+ swap maze@
  4   ?pac-trail if
  5    [char] S UDG+
  6    sprite@ face  c!
  7    1  sprite@ x-pos c+!
  8 \ else 2 choose if
  9 \  key-left else key-right then
 10 \  sprite@ dir c!
 11   then ;
 12 -->
 13 
 14 
 15 

Scr# 636 
  0 ( Chomp.f - trail )
  1 : pacman-move ( c -- )
  2  case
  3  key-right of go-right endof key+right of go-right endof
  4  key-left  of go-left  endof key+left  of go-left  endof
  5  key-up    of go-up    endof key+up    of go-up    endof
  6  key-down  of go-down  endof key+down  of go-down  endof
  7  endcase
  8  31 p@ case
  9  1         of go-right endof
 10  2         of go-left  endof
 11  4         of go-down  endof
 12  8         of go-up    endof
 13  endcase
 14 ;
 15 -->

Scr# 637 
  0 ( Chomp.f - trail )
  1 : pacman-eat-pill ( c -- )
  2   [udg] O = if
  3    -1 hunt !
  4    10 score d+!
  5    10 total d+!
  6    [ 50 25 bip ] 2lit bleep
  7    [ 50 39 bip ] 2lit bleep
  8    0 counting !
  9    ghost-white
 10   then ;
 11 \
 12 -->
 13 
 14 
 15 

Scr# 638 
  0 ( Chomp.f - trail )
  1 : pacman-walk ( c -- )
  2   >r r@ [udg]  O =
  3      r@ [char] . = or
  4      r> [udg]  U = or
  5   0= if
  6    pacman
  7    xy-pos@ xy-pre@ d=
  8    0= if
  9 \   [ 12 -14 bip ] 2lit
 10 \   bleep
 11    then
 12   then
 13 ;
 14 -->
 15 

Scr# 639 
  0 ( Chomp.f - trail )
  1 : pacman-eat-cherry ( c -- )
  2   [udg] U = if
  3    10 score d+!
  4    10 total d+!
  5    [ 50 29 bip ] 2lit bleep
  6    [ 50 36 bip ] 2lit bleep
  7   then ; -->
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 640 
  0 ( Chomp.f - ghost )
  1 : ghost-right ( c -- )
  2   xy-pos@ 1+ maze@
  3   ?ghost-trail if
  4      1  sprite@ y-pos c+!
  5   else
  6    2 choose if
  7     key-down
  8    else
  9     key-up
 10    then
 11    sprite@ dir c!
 12   then
 13 ;
 14 -->
 15 

Scr# 641 
  0 ( Chomp.f - ghost )
  1 : ghost-left  ( c -- )
  2   xy-pos@ 1- maze@
  3   ?ghost-trail if
  4     -1  sprite@ y-pos c+!
  5   else
  6    2 choose if
  7     key-up
  8    else
  9     key-down
 10    then
 11    sprite@ dir c!
 12   then
 13 ;
 14 -->
 15 

Scr# 642 
  0 ( Chomp.f - ghost )
  1 : ghost-down  ( c -- )
  2   xy-pos@ swap 1+ swap maze@
  3   ?ghost-trail if
  4      1  sprite@ x-pos c+!
  5   else
  6    2 choose if
  7     key-right
  8    else
  9     key-left
 10    then
 11    sprite@ dir c!
 12   then
 13 ;
 14 -->
 15 

Scr# 643 
  0 ( Chomp.f - ghost )
  1 : ghost-up    ( c -- )
  2   xy-pos@ swap 1- swap maze@
  3   ?ghost-trail if
  4     -1  sprite@ x-pos c+!
  5   else
  6    2 choose if
  7     key-left
  8    else
  9     key-right
 10    then
 11    sprite@ dir c!
 12   then
 13 ;
 14 -->
 15 

Scr# 644 
  0 ( Chomp.f - ghost )
  1 : ghost-move ( c -- )
  2  case
  3   key-right of
  4    ghost-right endof
  5   key-left  of
  6    ghost-left  endof
  7   key-up    of
  8    ghost-up    endof
  9   key-down  of
 10    ghost-down  endof
 11  endcase ;
 12 \
 13 -->
 14 
 15 

Scr# 645 
  0 ( Chomp.f - ghost )
  1 : ghost-decision ( -- )
  2   xy-pos@ xy-pre@ d= if
  3    4 choose
  4    case
  5    0 of key-left  endof
  6    1 of key-down  endof
  7    2 of key-up    endof
  8    3 of key-right endof
  9    endcase
 10   then
 11   sprite@ dir c!
 12 ;
 13 -->
 14 
 15 

Scr# 646 
  0 ( Chomp.f - trail )
  1 \
  2 : pacman-eat-dot ( c -- )
  3   [char] . = if
  4    1  score d+!
  5 \  [ 12 -12 bip ] 2lit
  6 \  bleep
  7   then ;
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 650 
  0 ( Chomp.f )
  1 : init-display
  2  LAYER11 30 emitc 8 emitc
  3  0 .paper  0 .border  4 .ink
  4  cls maze.
  5  0 20 .at  ." high "
  6  high-score 2@
  7  <# # # # # # # #> type
  8  5 0 do
  9   i  sprite#
 10   sprite-put
 11  loop
 12 ;
 13 -->
 14 
 15 

Scr# 651 
  0 ( Chomp.f )
  1 : inter-hunt
  2   0 27 do
  3    10 i .at  sync-vid
  4    7 16 bl emit emitc emitc
  5    [udg] T emitc sync-vid
  6    bl bl emitc emitc
  7    6 16 emitc emitc
  8    [udg] P emitc
  9    bl emit sync-vid
 10    bleep
 11    ?terminal if quit then
 12   -1 +loop ;
 13  -->
 14 
 15 

Scr# 652 
  0 ( Chomp.f )
  1 : inter-flee
  2   28 1 do
  3    10 i .at  sync-vid
  4    3 16 bl emit emitc emitc
  5    [udg] T emitc sync-vid
  6    bl bl emitc emitc
  7    6 16 emitc emitc
  8    [udg] R@ emitc
  9    sync-vid
 10    bleep
 11    ?terminal if quit then
 12   1 +loop ;
 13  -->
 14 
 15 

Scr# 653 
  0 ( Chomp.f - Interlude )
  1 : inter-sound
  2   27 0 do
  3    012 i bip swap
  4   01 +loop
  5   1 28 do
  6    012 i bip swap
  7   -1 +loop ;
  8 \
  9 : interlude
 10   inter-sound cls
 11   10 30 .at
 12   [udg]  O  emitc
 13   inter-flee
 14   inter-hunt ;
 15 -->

Scr# 654 
  0 ( Chomp.f )
  1 : catch? ( -- f )
  2   pacman xy-pos@
  3   inky   xy-pos@ d=
  4   pacman xy-pos@
  5   pinky  xy-pos@ d=
  6   pacman xy-pos@
  7   blinky xy-pos@ d=
  8   pacman xy-pos@
  9   ted    xy-pos@ d=
 10   or or or ;
 11 -->
 12 
 13 
 14 
 15 

Scr# 655 
  0 ( Chomp.f )
  1 : ghost-eaten ( n -- )
  2   sprite#
  3   12 sprite@ x-pos c!
  4   12 sprite@ y-pos c!
  5   bl sprite@ maze  c!
  6   10 score d+!
  7   10 total d+!
  8   [  5 20 bip ] 2lit bleep
  9   [  5 10 bip ] 2lit bleep
 10   [ 10 10 bip ] 2lit bleep
 11 ;
 12 -->
 13 
 14 
 15 

Scr# 656 
  0 ( Chomp.f )
  1 : ghost-catch
  2   -1 lives +!
  3   lives @ 0= if
  4    high-score 2@ score 2@
  5    dnegate d+ 0< if
  6      score 2@ high-score 2!
  7    then
  8    0. score 2!
  9    180. total 2!
 10   then
 11   init-all
 12   interlude
 13   init-display ;
 14 -->
 15 

Scr# 657 
  0 ( Chomp.f )
  1 : catch!
  2   hunt @ 1 = if
  3    ghost-catch
  4   else
  5    4 0 do
  6     i sprite# xy-pos@
  7     pacman    xy-pos@ d= if
  8      i ghost-eaten
  9     then
 10    loop
 11   then ;
 12 -->
 13 
 14 
 15 

Scr# 658 
  0 ( Chomp.f )
  1 : count-down
  2   hunt @ -1 = if 1 counting +!
  3    56 counting @ < if
  4     ghost-color then
  5    57 counting @ < if
  6     ghost-white then
  7    58 counting @ < if
  8     ghost-color then
  9    59 counting @ < if
 10     ghost-white then
 11    60 counting @ < if
 12     ghost-color
 13     1 hunt ! then
 14   then
 15 ; -->

Scr# 659 
  0 ( Chomp.f )
  1 : put-cherry
  2   100 choose 0= if
  3    cherry sprite-put
  4    [udg] U xy-pos@ maze!
  5   then ;
  6 \
  7 : key-decode ( c1 -- c2 )
  8   case
  9   key+up of key-up endof
 10   key+down of key-down endof
 11   key+left of key-left endof
 12   key+right of key-right endof
 13   dup
 14   endcase ;
 15 

Scr# 660 
  0 ( Chomp.f )
  1 : move-pacman
  2   pacman xy-pos@ xy-pre!
  3   LASTK key-decode c@
  4 \ sprite dir c@
  5   pacman-move sprite-put
  6   xy-pos@ maze@
  7   bl xy-pos@ maze!
  8   catch? if catch! then
  9   dup pacman-eat-dot
 10   dup pacman-eat-pill
 11   dup pacman-eat-cherry
 12       pacman-walk
 13 ;
 14 -->
 15 

Scr# 661 
  0 ( Chomp.f )
  1 : move-four-ghosts
  2   4 0 do
  3     i sprite# xy-pos@ xy-pre!
  4     23672 @ -1 and hunt @ - 1- if
  5   \   ghost-decision
  6       sprite@ dir c@
  7       ghost-move then
  8     sprite-put
  9     xy-pos@ maze@
 10     sprite@ maze c!
 11     catch? if catch! then
 12   loop
 13 ; -->
 14 
 15 

Scr# 662 
  0 ( Chomp.f )
  1 : dashboard
  2   0  1 .at
  3   6 16 emitc emitc \ yellow
  4   [udg] P emitc
  5   7 16 emitc emitc \ white
  6   bl emitc lives ?
  7   0  6 .at  ." score "
  8   score 2@
  9   <# # # # # # # #> type
 10 ;
 11 -->
 12 
 13 
 14 
 15 

Scr# 663 
  0 ( Chomp.f )
  1 needs .s
  2 : debug
  3   2 24 .at  6 16 emitc emitc
  4   pacman xy-pos@ swap . .
  5   3 24 .at  LASTK c@ .
  6 \ 22 1 .at  hex sprite 8 +
  7 \ sprite@ (dump) decimal
  8   5 24 .at  total 2@ D.
  9   7 24 .at  counting @ .
 10   9 24 .at
 11   sprite@ maze c@ emitc
 12   0 0 .at  .s
 13   11 24 .at  hunt @ .
 14 \ 22 22 .at  ." KEY" key drop
 15 ; -->

Scr# 664 
  0 ( Chomp.f )
  1 : heart-beat
  2   move-pacman
  3   move-four-ghosts
  4   put-cherry
  5   count-down
  6   dashboard
  7   debug
  8 ;
  9 : T heart-beat ;
 10 : C catch? . ;
 11 : M init-display ;
 12 -->
 13 
 14 
 15 

Scr# 665 
  0 ( Chomp.f )
  1 : phase-complete
  2   score 2@ total 2@ d= if
  3    180  total D+!
  4    init-all
  5    set-maze-run
  6    interlude
  7    init-display
  8    key-right LASTK c!
  9    1 hunt !
 10   then ;
 11 -->
 12 
 13 
 14 
 15 

Scr# 666 
  0 ( Chomp.f )
  1 : run-game
  2   begin
  3    lives @
  4   while
  5    heart-beat
  6    phase-complete
  7    ?terminal if quit then
  8   repeat
  9 ;
 10 -->
 11 
 12 
 13 
 14 
 15 

Scr# 667 
  0 ( Chomp.f )
  1 : game
  2   UDG_1  $5C7B ! \ UDG
  3   LAYER11 3 SPEED! 30 emitc 8 emitc
  4   3 lives !
  5   0 .paper  0 .border  4 .ink 1 .bright \ .perm
  6   interlude
  7   180. total 2!
  8   0.   score 2!
  9   init-all
 10   set-maze-run
 11   init-display
 12   run-game
 13   22 0 .at
 14   LAYER12 3 SPEED!
 15 ; -->

Scr# 668 
  0 ( Chomp.f )
  1 0 26 emitc emitc  CR CR CR
  2 needs TRUV needs INVV
  3 TRUV  .( Use: )
  4 INVV  .(  GAME )  CR
  5 TRUV  .( Arrorw keys to move. ) CR
  6       .( Cursor Joystick should work. ) CR
  7 INVV  .(  BREAK )
  8 TRUV  .( stops. ) CR .( Give. ) CR
  9 INVV  .(  LAYER12 )
 10 TRUV  .( to go at 64 columns and ) CR
 11 INVV  .(  3 SPEED! )
 12 TRUV  .( to go at 28 MHz. ) CR
 13 
 14 
 15 

Scr# 670 
  0 ( Create standalone executable )
  1 DECIMAL
  2    8 BLOCK  9 BLOCK    \ Screen # 4 error messages
  3   10 BLOCK 11 BLOCK    \ Screen # 5
  4   12 BLOCK 13 BLOCK    \ Screen #6
  5   cr
  6   .( SAVE "heap" BANK 16 ) CR
  7   .( SAVE "core" CODE ) HERE 0 +ORIGIN DUP U. - U. CR
  8   .( SAVE "user" CODE ) $E000  R0 @    DUP U. - U. CR
  9 
 10   ' GAME ' COLD >BODY       !
 11   ' BYE  ' COLD >BODY cell+ !
 12   BYE
 13 
 14 
 15 

Scr# 680 
  0 \ integer approximation of  1 / (2^(1/12))
  1 : L12 ( n1 m d -- )
  2   12 0 do
  3     2dup >r >r
  4     */   r> r>
  5   loop
  6   2drop
  7 ;
  8 : L6
  9   6 0 do
 10     2dup >r >r
 11     */   r> r>
 12   loop
 13   2drop
 14 ;
 15 

Scr# 690 
  0 \ integer approximation of  1 / (2^(1/12))
  1 : L12 ( n1 m d -- )
  2   12 0 do
  3     2dup >r >r
  4     */   r> r>
  5   loop
  6   2drop
  7 ;
  8 : L6
  9   6 0 do
 10     2dup >r >r
 11     */   r> r>
 12   loop
 13   2drop
 14 ;
 15 

Scr# 700 
  0 \ HEAP colon-definition: 128K dictionary space.
  1 NEEDS  ASSEMBLER
  2 : TESTING ;
  3 -->
  4 
  5 
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 701 
  0 \ HEAP colon-definition: 128K dictionary space.
  1 : skip ( n -- )
  2   [COMPILE] :
  3   ;CODE
  4   \ get current MMU7 page
  5   exx
  6   ldx      bc|   hex  243B  NN,
  7   ld       l'|   decimal 87  N,
  8   out(c)   l'|
  9   inc      b'|
 10   in(c)    a'|   \ a contains page in MMU7
 11   exx
 12   -->
 13 
 14 
 15 

Scr# 702 
  0 \ HEAP colon-definition: 128K dictionary space.
  1 \
  2   exdehl
  3   decx     hl|
  4   ldn   (hl)'|   0  N,
  5   decx     hl|
  6   ld    (hl)'|      a|        \ save page
  7   decx     hl|
  8 \
  9   pop      de|                \ obtain next address of IP
 10 \
 11   -->
 12 
 13 
 14 
 15 

Scr# 703 
  0 \ HEAP colon-definition: 128K dictionary space.
  1 \
  2   ld       a'|      d|
  3   exafaf
  4   ld       a'|      d|
  5   rlca
  6   rlca
  7   rlca
  8   andn      hex  07  N,
  9   addn      hex  20  N,
 10   nextrega  decimal 87 P,
 11 \
 12   -->
 13 
 14 
 15 

Scr# 704 
  0 \ HEAP colon-definition: 128K dictionary space.
  1 
  2 
  3 
  4 
  5   ld    (hl)'|      b|
  6   decx     hl|
  7   ld    (hl)'|      c|
  8   decx     hl|
  9   exdehl
 10   next
 11   C;
 12 IMMEDIATE
 13 
 14 
 15 

Scr# 705 
  0 \ HEAP colon-definition: 128K dictionary space.
  1   exx
  2   ldx      bc|   hex  243B  NN,
  3   ld       l'|   decimal 87  N,
  4   out(c)   l'|
  5   inc      b'|
  6   out(c)   a'|   \ a contains page in MMU7
  7   exx
  8   next
  9   C;
 10 -->
 11 
 12 
 13 
 14 
 15 

Scr# 706 
  0 \ HEAP colon-definition: 128K dictionary space.
  1 H-EXIT    ( -- )
  2   exdehl
  3   ld       c'|   (hl)|
  4   incx     hl|
  5   ld       b'|   (hl)|
  6   incx     hl|
  7   ld       a'|   (hl)|
  8   incx     hl|
  9   incx     hl|
 10   exdehl
 11   -->
 12 
 13 
 14 
 15 

Scr# 707 
  0 \ HEAP colon-definition: 128K dictionary space.
  1   exx
  2   ldx      bc|   hex  243B  NN,
  3   ld       l'|   decimal 87  N,
  4   out(c)   l'|
  5   inc      b'|
  6   out(c)   a'|   \ a contains page in MMU7
  7   exx
  8   next
  9   C;
 10 -->
 11 
 12 
 13 
 14 
 15 

Scr# 708 
  0 ( HEAP )
  1 : HEAP    ( n -- ha )
  2   HP@     >R              \ n        R: h0
  3   DUP SKIP-PAGE           \ n
  4   HP@ CELL+ TUCK          \ ha n ha
  5   OVER + FAR >R           \ ha n     R: h0 a1
  6   0 R@ !                  \ ha n                  zero pad
  7   R> CELL+                \ ha n a2  R: h0
  8   R@ SWAP !               \ ha n                  back ptr
  9   6 +      HP +!          \ ha       R: h0        HP: final
 10   HP@ R> FAR !            \ ha                    forwrd ptr
 11 ;
 12 
 13 
 14 
 15 

Scr# 709 
  0 ( HEAP )
  1 : HEAP    ( n -- ha )
  2 \ DUP SKIP-PAGE           \ n                     HP: h0
  3   HP@ DUP FAR             \ n h0 a0
  4   DUP           >R        \ n h0 a0  R: a0
  5   SWAP          >R        \ n a0     R: a0 h0
  6   CELL+ OVER +            \ n a1     R: a0 h0
  7   0 OVER !                \ n a1     R: a0 h0     zero pad
  8   CELL+   R@              \ n a2 h0  R: a0 h0     back ptr
  9   SWAP !                  \ n        R: a0 h0
 10   R> CELL+ SWAP           \ ha n     R: a0
 11   6 +      HP +!          \ ha       R: a0        HP: final
 12   HP@ R> !                \                       forwrd ptr
 13 ;
 14 
 15 

Scr# 710 
  0 ( TERM )
  1 include demo/DEV/TERM0.dot.f
  2 
  3 
  4 
  5 
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 711 
  0 ( TERM0 )
  1 hex
  2 : TERM0
  3   7 1E EMITC EMITC
  4   TERM0-INIT
  5   BEGIN
  6     CURSOR KEYB
  7 -->
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 712 
  0 ( TERM0 )
  1     ?DUP IF
  2       MAP-KEYB
  3       DUP 0D = IF
  4         UART-TX-BYTE
  5         PAD 2000 UART-RX-BURST
  6         PAD SWAP CHUNK-EMIT
  7       ELSE
  8         UART-TX-BYTE
  9        THEN
 10     THEN
 11 -->
 12 
 13 
 14 
 15 

Scr# 713 
  0 ( TERM0 )
  1     ?UART-BYTE-READY IF
  2       UART-RX-BYTE
  3       DUP 0A - IF
  4         DUP 0D = IF SPACE THEN
  5         DUP EMIT
  6         DROP
  7       THEN
  8     THEN
  9 \
 10   ?TERMINAL UNTIL
 11   8 1E EMITC EMITC
 12 ;
 13 decimal
 14 -->
 15 

Scr# 714 
  0 ( TERM0 )
  1 : t uart-tx-byte ;
  2 : r uart-rx-byte dup . emit ;
  3 
  4 
  5 
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 715 
  0 exit

Restarting Supervisor
c [38;5;154mi------------------
  1 -----------------------------------[0m
 [1mDietPi v6.22.3[0m
  2  [38;5;154m:[0m 20:53 - Thu 03/11/16[0m
 [38;5;154mi-------
  3 ----------------------------------------------[0m
 [38;5;154m
  4 -[0m [1mLAN IP [38;5;154m:[0m Use dietpi-config to setup a c
  5 onnection (NONE)
 [38;5;154m-[0m [1mFreespace (RootFS) [38;
  6 5;154m:[0m 164M
 [38;5;154m-[0m [1mFreespace (userdata) [3
  7 8;5;154m:[0m 42M
 [38;5;154m-[0m [1mNextPi [38;5;154m:[0m
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 716 
  0 ( 3CONSTANT )
  1 : does> hex
  2 \ latest pfa dup cell+ here latest pfa -
  3 \ cr latest pfa U. cr here U.
  4   latest pfa >R R@ R@ cell+ here R@ - 2 allot cmove>
  5   r> r> swap ! ;code HEX
  6   EB C, 2B C, 70 C, 2B C, 71 C, EB C, E1 C,
  7   4E C, 23 C, 46 C, 23 C, E5 C, DD C, E9 C,
  8   DECIMAL SMUDGE
  9 \
 10 : <builds create ;
 11 
 12 
 13 
 14 
 15 

Scr# 717 
  0 ( 3CONSTANT )
  1 \
  2 : 3constant  ( n3 n2 n1 -- ) ( -- n1 n2 n3 )
  3   create , , ,
  4   does> ( point A ) dup 4 + @  swap 2@ ;
  5 \
  6 1 2 3 3constant 3foo
  7 3foo .s
  8 \
  9 : 3constant  ( n3 n2 n1 -- ) ( -- n1 n2 n3 )
 10   create , , ,
 11   ;code HEX
 12   D9 C, E1 C, 5E C, 23 C, 56 C, D5 C,
 13         23 C, 5E C, 23 C, 56 C, D5 C,
 14         23 C, 5E C, 23 C, 56 C, D5 C,
 15   D9 C, DD C, E9 C, SMUDGE

Scr# 718 
  0 ( Collatz conjecture )
  1 : hail ( n -- )
  2   0 swap
  3   begin
  4     dup .
  5     dup   1 = NOT
  6     dup  -1 = NOT and
  7     dup  -5 = NOT and
  8     dup -17 = NOT and
  9     ?terminal NOT and
 10   while
 11       swap 1+ swap
 12       dup 1 AND if 3 * 1+ else 2/ then
 13   repeat
 14   drop cr .
 15 ;

Scr# 720 
  0 ( 256 bitmap )
  1 needs layer2 needs layer12
  2 needs wait-key
  3 needs flip
  4 marker xxx
  5 
  6  HEX 12 reg@ 2* CONSTANT Layer2-Base-Page  \ 8K Base
  7  DECIMAL
  8  create filename ," C:/tools/vForth/forum/testbild.bmp"
  9  0 variable fh-BMP    fh-BMP !
 10 -->
 11 
 12 
 13 
 14 
 15 

Scr# 721 
  0 ( 256 bitmap )
  1 DECIMAL
  2 : LOAD-BMP< ( a -- )
  3   1+ 0 01 f_open 41 ?error fh-BMP !
  4   PAD 14 fh-BMP @ f_read swap 14 - or 46 ?error \ read error
  5   PAD @ [ HEX ] 4D42   [ decimal ] -  38 ?error \ not BMP
  6   PAD 10 + 2@ swap fh-BMP @ f_seek    45 ?error \ seek error
  7   6 0 DO
  8     5 I - LAYER2-BASE-PAGE + MMU7! \ CR I .
  9     32 0 DO
 10       31 I - FLIP [ HEX ] E000 or [ DECIMAL ] \ destination addr
 11       256 fh-BMP @ f_read                1 ?error drop
 12     LOOP
 13   LOOP
 14   fh-BMP @ f_close 42 ?error
 15 ; -->

Scr# 722 
  0 ( 256 bitmap )
  1 FILENAME LOAD-BMP<
  2 LAYER2 WAIT-KEY LAYER12
  3 
  4 
  5 
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 723 
  0 ( 256 bitmap )
  1 DECIMAL
  2 : LOAD-BMP ( a -- )
  3   1+ 0 01 f_open 41 ?error fh-BMP !
  4   PAD 14 fh-BMP @ f_read swap 14 - or 46 ?error \ read error
  5   PAD @ [ HEX ] 4D42 - [ decimal ]    38 ?error \ not BMP
  6   PAD 10 + 2@ swap fh-BMP @ f_seek    45 ?error \ seek error
  7   6 0 DO
  8     I LAYER2-BASE-PAGE + MMU7!
  9     [ HEX ] E000 [ DECIMAL ] \ destination address
 10     [ 8 1024 * ] literal
 11     fh-BMP @ f_read 46 ?error drop \ ignore number of byte read
 12   LOOP
 13   fh-BMP @ f_close 42 ?error
 14 ;
 15 

Scr# 777 
  0 ( 0< modified )
  1 needs assembler
  2 code w<
  3   pop   de|
  4   pop   hl|
  5   anda   a|
  6   sbchl de|
  7   sbchl hl|
  8   push  hl|
  9   next
 10 c;
 11 decimal
 12 
 13 
 14 
 15 

Scr# 778 
  0 ( Bernstein - Vazirani )
  1 needs binary
  2 decimal 25 constant a
  3 : f(x)  \  x -- a xor x
  4   a and -1 swap            \ 0  x|a
  5   16 0 do
  6     tuck xor               \ x|a  0/1
  7     swap 1 lshift          \ 0/1  x|a<<
  8   loop drop 0< not ;       \ 0/1
  9 binary
 10 0101010101010101 constant M0
 11 0011001100110011 constant M1
 12 0000111100001111 constant M2
 13 0000000011111111 constant M3
 14 decimal
 15 

Scr# 779 
  0 ( Bernstein - Vazirani )
  1 decimal
  2 m0 f(x)        u. cr
  3 m1 f(x)        u. cr
  4 m2 f(x)        u. cr
  5 m3 f(x)        u. cr
  6 decimal
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 790 
  0 ( ZX-Next Copper )
  1 NEEDS FLIP
  2 NEEDS SPLIT
  3 \
  4 MARKER NO-COPPER
  5 VOCABULARY COPPER IMMEDIATE
  6 COPPER DEFINITIONS
  7 \
  8 HEX 061 CONSTANT COP-CTRL-LO
  9 HEX 062 CONSTANT COP-CTRL-HI
 10 HEX 063 CONSTANT COP-WRITE
 11     VARIABLE COP-IDX
 12 \
 13 -->
 14 
 15 

Scr# 791 
  0 ( ZX-Next Copper )
  1 HEX
  2 \ copy single instruction to copper memory
  3 : UPLOAD ( n -- )
  4   SPLIT \ COP-IDX @ . 3A EMIT SPACE 2dup . . CR
  5   COP-WRITE REG!  COP-WRITE REG!   1 COP-IDX +! ;
  6 \
  7 \ stop copper and set data upload index to 0
  8 : STOP  ( -- )
  9   0 COP-CTRL-LO REG! 0 COP-CTRL-HI REG! 0 COP-IDX ! ;
 10 \
 11 \ start copper in mode %11 - reset on every vertical blank
 12 : START ( -- )
 13   0 COP-CTRL-LO REG! 0C0 COP-CTRL-HI REG! ;
 14 -->
 15 

Scr# 792 
  0 ( ZX-Next Copper )
  1 HEX
  2 \
  3 : WAIT ( v h -- )
  4   3F AND 2* FLIP SWAP 1FF AND OR 8000 OR UPLOAD ;
  5 : MOVE ( v r -- )
  6   7F AND    FLIP SWAP 0FF AND OR         UPLOAD ;
  7 : NOOP ( -- )
  8   0     UPLOAD ;
  9 : HALT ( -- )
 10   0FFFF UPLOAD
 11   [COMPILE] FORTH ;
 12 \
 13 FORTH DEFINITIONS
 14 DECIMAL
 15 

Scr# 793 
  0 ( ZX-Next Copper - Example )
  1 NEEDS LAYERS
  2 COPPER STOP
  3   HEX
  4 \ vert horiz
  5   00   00    WAIT
  6 \ val  reg
  7   02   16    MOVE   \ Layer2 Horizontal Scroll
  8   60   00    WAIT
  9   00   00    WAIT
 10   00   16    MOVE
 11   60   00    WAIT
 12              HALT
 13 FORTH DECIMAL
 14 LAYER2
 15 COPPER START

Scr# 795 
  0 ( ZX-Next Copper - Example )
  1 NEEDS LAYERS
  2 DECIMAL
  3 : COPPER-UP COPPER
  4   100 0 DO
  5     COPPER  STOP
  6      0   0  WAIT
  7      I  22  MOVE   \ Layer2 Horizontal Scroll
  8     311  0  WAIT
  9      0  22  MOVE
 10             HALT
 11     COPPER START KEY
 12   LOOP
 13   COPPER STOP
 14 ;
 15 FORTH

Scr# 796 
  0 ( ZX-Next Copper - Example )
  1 COPPER STOP
  2 COPPER-UPLOAD
  3 COPPER HALD
  4 
  5 
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 798 
  0 ( test )
  1 needs FAR needs POINTER
  2 marker task
  3 \
  4 HERE
  5 ," Cannot unmount, there's something still open."
  6 DUP C@ HEAP
  7 OVER C@ 2+                \ a hp a ha b
  8 CMOVE SWAP                \ hp a
  9 C@ 2+ DUP NEGATE          \ hp b -b
 10 ALLOT HP +!               \ hp
 11 POINTER P1
 12 \
 13 : TEST
 14   P1 COUNT TYPE ;
 15 

Scr# 799 
  0 ( test )
  1 needs FAR needs POINTER
  2 marker task
  3 \
  4 HERE HP@ 2DUP FAR         \ a hp a ha
  5 ," Cannot unmount, there's something still open."
  6 OVER C@ 2+                \ a hp a ha b
  7 CMOVE SWAP                \ hp a
  8 C@ 2+ DUP NEGATE          \ hp b -b
  9 ALLOT HP +!               \ hp
 10 POINTER P1
 11 \
 12 : TEST
 13   P1 COUNT TYPE ;
 14 
 15 

Scr# 800 
  0 \ Brodie - Starting FORTH - Ch. 1 - Fundamental Forth
  1 \ page 8
  2 \ Washer example (page 8)
  3 \ : WASHER  WASH SPIN RINSE SPIN ;
  4 \ : RINSE   FILL AGITATE DRAIN ;
  5 \ : FILL    FAUCETS OPEN TILL-FULL FAUCETS CLOSE ;
  6 \ page 11
  7 \ Star and large letter-F (page 11)
  8   : STAR    42 EMIT ;
  9   : STARS    0 DO STAR LOOP ;
 10   : MARGIN  CR 15 SPACES ;
 11   : BLIP    MARGIN STAR ;
 12   : BAR     MARGIN 5 STARS ;
 13   : F       BAR BLIP BAR BLIP BLIP CR ;
 14 F
 15 

Scr# 801 
  0 \ Brodie - Starting FORTH - Ch. 1 - Fundamental Forth
  1 
  2 \ dot-quote ( page 18 )
  3 
  4   : GREET   ." HELLO, I SPEAK FORTH " ;
  5 
  6 GREET
  7 
  8 \ postfix notation ( page 23 )
  9   : FOUR-MORE   4 + ;
 10 
 11   3 FOUR-MORE
 12 -10 FOUR-MORE
 13 
 14 
 15 

Scr# 802 
  0 \ Brodie - Starting FORTH - Ch. 1 - Fundamental Forth
  1 \
  2 \ Problem 1. Define a word called GIFT which, when executed,
  3 \ will type out the name of some gift.
  4 \ Now define a word called GIVER which will print out a
  5 \ person's name. Finally, define a word called THANKS which
  6 \ include the new Forth words GIFT and GIVER...
  7 
  8   : GIFT     ." BOOKENDS" ;
  9   : GIVER    ." STEPHANIE" ;
 10   : THANKS
 11     CR       ." DEAR "           GIVER  44 EMIT  CR
 12     4 SPACES ." THANKS FOR THE " GIFT   46 EMIT  CR ;
 13 
 14 THANKS
 15 

Scr# 803 
  0 \ Brodie - Starting FORTH - Ch. 1 - Fundamental Forth
  1 
  2 \ Problem 2. Define a word called TEN.LESS which takes a
  3 \ number on the stack, subtracts ten, and return the answer
  4 \ on the stack. (Hint: you can use + )
  5 
  6   : TEN.LESS   ( n1 -- n2 )
  7     -10 +
  8   ;
  9 
 10  3 TEN.LESS .
 11 
 12 
 13 
 14 
 15 

Scr# 804 
  0 \ Brodie - Starting FORTH - Ch. 1 - Fundamental Forth
  1 
  2 \ Problem 3. After entering the words in Prob. 1, enter a
  3 \ new definition for GIVER to print someone else's name,
  4 \ then execute THANKS again. Can you explain why THANKS
  5   still prints out the first giver's name?
  6 
  7   : GIVER  ." ALEXANDRA" ;
  8 
  9 THANKS
 10 \ A: Must FORGET GIVER first and modify from that point.
 11 
 12 
 13 
 14 
 15 

Scr# 805 
  0 \ Brodie - Starting FORTH - Ch. 2 - How to get results
  1 \ Quizzie 2-a  ( page 37 )
  2 
  3 \ Convert the following infix equation to postfix "calculato
  4 \ style." For example,  ab + c  would become  a b * c +
  5 \ 1.  c(a + b)           -->   a b + c *
  6 \ 2.  {(3a - b)/4} + c   -->   3 a * b - 4 / c +
  7 \ 3.  (0.5 ab)/100       -->   a b * 100 / 2 /
  8 \ 4.  (n + 1)/n          -->   n 1 + n /
  9 \ 5.  x(7x + 5)          -->   7 x * 5 + x *
 10                     ;
 11 \ Convert the following postfix expressions to infix:
 12 \ 6. a b - b a + /       -->   (a - b)/(b + a)
 13 \ 7. a b 10 * /          -->   a / 10b
 14 
 15 

Scr# 806 
  0 \ Brodie - Starting FORTH - Ch. 2 - How to get results
  1 \ Forth Arithmetic -- Definition Style ( page 38 )
  2   : YARDS>IN   36 * ;   \ yards to inches
  3   : FT>IN      12 * ;   \ feet to inches
  4 \ supposing the result being always in inches:
  5   : YARDS      36 * ;
  6   : FEET       12 * ;
  7   : INCHES          ;
  8   : YARD      YARDS ;
  9   : FOOT      FEET  ;
 10   : INCH            ;
 11 
 12 10 YARDS 2 FEET + 9 INCHES + .     CR
 13  1 YARD  2 FEET + 1 INCH   + .     CR
 14  2 YARDS 1 FOOT + .                CR
 15 

Scr# 807 
  0 \ Brodie - Starting FORTH - Ch. 2 - How to get results
  1 \ page 39
  2 
  3   : 5#SUM   + + + + +  ;
  4 
  5 17 20 132 3 9 5   5#SUM .
  6 
  7 \ Definition-style Practice Problems   ( page 41 )
  8 \ Quizzie 2-a
  9 \ expression   { a + b } * c
 10   : SOLUTION   ( c a b -- {a+b}*c )  + * ;
 11 
 12 3 -2 1 SOLUTION .
 13 
 14 
 15 

Scr# 808 
  0 \ Brodie - Starting FORTH - Ch. 2 - How to get results
  1 \ Quizzie 2-b (Definition-style Practice Problems)
  2 \ Convert the following infix expresions into Forth
  3 \ definitions and show the stack order required
  4 \ 1    ab + c
  5   : 2B1   ( c b a -- n )           * +          ;
  6 \ 2.  (a - 4b)/6 + c
  7   : 2B2   ( c a b -- n )           4 * - 6 / +  ;
  8 \ 3.  a/8b
  9   : 2B3   ( a b -- n )             / 8 /        ;
 10 \ 4.  0.5 ab/100
 11   : 2B4   ( a b -- n )             2 / * 100 /  ;
 12 \ 5.  a(2a + 3)
 13   : 2B5   ( a a -- n )             2 * 3 +  *   ;
 14 \ 6.  (a - b)/c   (!) Unsolvable without SWAP
 15   : 2B6   ( c a b -- n )           - SWAP /     ;

Scr# 809 
  0 \ Brodie - Starting FORTH - Ch. 2 - How to get results
  1 
  2 \ The Division Operators  ( page 42 )
  3   : QUARTERS  4 /MOD . ." ONES AND " . ." QUARTERS " ;
  4 
  5 22 QUARTERS
  6 
  7 \ A Non-destructive Stack Print  ( page 50 )
  8 \ (for better safety, I added a IF-THEN)
  9   : .S
 10     SP@ S0 @ < IF
 11       CR SP@ S0 @ 2- DO
 12         I @ .
 13       0 2- +LOOP
 14     THEN ;
 15 

Scr# 810 
  0 \ Brodie - Starting FORTH - Ch. 2 - How to get results
  1 
  2 \ Stack Manipulation and Math Definitions ( page 51 )
  3 \ Quizzie 2-c
  4 \ 1. Write a phrase which flips three items on the stack,
  5 \ leaving the middle number in the middle; that is,
  6 \    a b c    becomes    c b a
  7   ROT SWAP     or     -ROT SWAP
  8 \ 2. Write a phrase that does what OVER does, without using
  9 \ it.
 10     SWAP DUP ROT SWAP   or   SWAP DUP -ROT
 11 \ 3. Write a definition called <ROT, which rotates the top
 12 \ three stack items in the opposite direction from ROT;
 13 \ that is    a b c    becomes    c a b
 14     : <ROT   ( a b c -- c a b )  ROT ROT ;
 15 \   but we have -ROT that's equivalent.

Scr# 811 
  0 \ Brodie - Starting FORTH - Ch. 2 - How to get results
  1 \
  2 \ Quizzie 2-c  ( 2nd page )
  3 \ Write definitions for the following equations, given the
  4 \ stack effect shown
  5 \ 4. (n + 1)/n
  6   : 2C4   ( n -- res ) 1 OVER + SWAP / ;
  7 \ 5. x(7x + 5)
  8   : 2C5   ( x -- res ) DUP 7 * 5 + * ;
  9 \ 6. 9a^2 - ba
 10 \    factoring a it's =(9a - b)a
 11   : 2C6   ( a b -- res ) OVER 9 * SWAP - * ;
 12 
 13 
 14 
 15 

Scr# 812 
  0 \ Brodie - Starting FORTH - Ch. 2 - How to get results
  1 
  2 \ Problem 1. What the difference between DUP DUP and 2DUP
  3   1 2 DUP DUP  ==> 1 2 2 2
  4   1 2 2DUP     ==> 1 2 1 2
  5 
  6 \ Problem 2. Write a phrase which will reverse the order of
  7 \ the top four item on the stack;
  8 \ that is, ( 1 2 3 4 -- 4 3 2 1
  9   : 4REV   SWAP 2SWAP SWAP ;
 10 
 11 \ Problem 3. Write a definition called 3DUP wich duplicate
 12 \ the top three numbers on the stack;
 13 \ e.g. ( 1 2 3 -- 1 2 3 1 2 3 )
 14   : 3DUP   ( a b c -- a b c a b c ) DUP 2DUP ROT ;
 15 

Scr# 813 
  0 \ Brodie - Starting FORTH - Ch. 2 - How to get results
  1 
  2 \ Problems.
  3 \ Write definitions for the following infix equations,
  4 \ given the effect shown:
  5 
  6 \ 4. a^2 + ab + c        ( c a b -- res )
  7 \   since ==> a(a+b)+c
  8   : 2P4   ( c a b -- res ) OVER + * + ;
  9 
 10 \ 5. (a - b)/( a + b)    ( a b -- res )
 11   : 2P5   ( a b -- res ) 2DUP - -ROT + / ;
 12 
 13 
 14 
 15 

Scr# 814 
  0 \ Brodie - Starting FORTH - Ch. 2 - How to get results
  1 
  2 \ Problem 6. Write set of words to compute prison sentences
  3 \ for hardened criminals such that the judge can enter:
  4 \   CONVICTED-OF ARSON HOMICIDE TAX-EVASION WILL-SERVE
  5 \ or any series of crimes beginning with the word
  6 \ CONVICTED-OF and ending with WILL-SERVE.
  7 \ Use these sentences:
  8 \   HOMICIDE     20 years
  9 \   ARSON        10 years
 10 \   BOOKMAKING    2 years
 11 \   TAX-EVASION   5 years
 12   : CONVICTED-OF  0   ;    : WILL-SERVE . ." YEARS " ;
 13   : HOMICIDE     20 + ;    : ARSON        10 + ;
 14   : BOOKMAKING    2 + ;    : TAX-EVASION   5 + ;
 15 Convicted-of homicide tax-evasion arson will-serve

Scr# 815 
  0 \ Brodie - Starting FORTH - Ch. 3 - The Editor
  1 \ page 57
  2 
  3 \ v-Forth provides a full-screen editor
  4 
  5 \ To keep the core dictionary as small as posible,
  6 \ some definitions aren't available at startup, but
  7 \ must be loaded as soon as they're needed using NEEDS
  8 
  9   NEEDS EDIT
 10 
 11 \ and a "Large file EDitor"
 12 
 13   NEEDS LED
 14 
 15 

Scr# 816 
  0 \ Brodie - Starting FORTH - Ch. 4 - Decisions, Decisions...
  1 \ page 90
  2   : ?FULL      12 =  IF ." IT'S FULL "  THEN ;
  3  11 ?FULL
  4  12 ?FULL
  5 
  6   : ?TOO-HOT  220 >  IF ." DANGER -- REDUCE HEAT "  THEN ;
  7 220 ?TOO-HOT
  8 221 ?TOO-HOT
  9 \ page 92
 10   : ?DAY    32 <  IF ." LOOKS GOOD "  ELSE ." NO WAY "  THEN ;
 11  31 ?DAY
 12  32 ?DAY
 13 \ page 93
 14   : /CHECK   DUP 0=  IF ." INVALID " DROP  ELSE /  THEN ;
 15  10 0 /CHECK

Scr# 817 
  0 \ Brodie - Starting FORTH - Ch. 4 - Decisions, Decisions...
  1 \ page 93
  2 : EGGSIZE DUP  18 < IF ." REJECT "       ELSE
  3             DUP  21 < IF ." SMALL "        ELSE
  4             DUP  24 < IF ." MEDIUM "       ELSE
  5             DUP  27 < IF ." LARGE "        ELSE
  6             DUP  30 < IF ." EXTRA LARGE "  ELSE
  7                          ." ERROR "
  8                       THEN THEN THEN THEN THEN  DROP ;
  9 25 EGGSIZE
 10 
 11 \ page 96
 12   : /CHECK  DUP IF / ELSE ." INVALID " DROP THEN ;
 13 
 14 8 0 /CHECK
 15 

Scr# 818 
  0 \ Brodie - Starting FORTH - Ch. 4 - Decisions, Decisions...
  1 \ page 98
  2   : VEGETABLE  DUP 0<  SWAP 10 MOD 0= +
  3       IF ." ARTICHOKE " THEN ;
  4 -30 VEGETABLE
  5 
  6   : ?DAY DUP 1 < SWAP 31 > +
  7       IF ." NO WAY " ELSE ." THANK YOU " THEN ;
  8 32 ?DAY
  9 
 10 \ page 100
 11   : BOXTEST   ( length width height -- )
 12      6 >  ROT 22 >  ROT 19 >  AND AND
 13      IF ." BIG ENOUGH " THEN ;
 14 40 30 20 BOXTEST
 15 

Scr# 819 
  0 \ Brodie - Starting FORTH - Ch. 4 - Decisions, Decisions...
  1 \ pag 101
  2   : /CHECK1    DUP  IF  /  ELSE  DROP  THEN ;
  3 10 0 /CHECK1
  4   : /CHECK2   ?DUP  IF  /  THEN ;
  5 10 0 /CHECK2
  6 
  7 \ ** Must use NEED to import ABORT" *
  8 
  9   NEEDS ABORT"
 10   : /CHECK3    DUP 0= ABORT" Zero denominator "  /  ;
 11 
 12 10 0 /CHECK3
 13 \ after receiving the error message, you can type
 14 \   WHERE  to show where the error has originated.
 15 

Scr# 820 
  0 \ Brodie - Starting FORTH - Ch. 4 - Decisions, Decisions...
  1 
  2 \ Problems World! "
  3 \ 1. What will the phrase  0= NOT   leave on the stack
  4 \ when the argument is
  5 \   1 ?   ==> -1
  6 \   0 ?   ==>  0
  7 \  200 ?  ==> -1
  8 
  9 \ 6. Write the definition for a word called WITHIN which
 10 \ expects three arguments ( n low-limit hi-limit -- f )
 11 \ and leaves a "true" flag only if "n" is between  the
 12 \ range  low-limit <= n < hi-limit
 13   : WITHIN ( n low hi -- f )  OVER - -ROT - SWAP U< ;
 14 
 15 

Scr# 821 
  0 \ Brodie - Starting FORTH - Ch. 5 - Philosophy of Fixed Point
  1 \ pag 108
  2   : DIFFERENCE   - ABS ;
  3 
  4 \ page 109
  5   : COMMISSION   10 / 50 MIN ;
  6 
  7 \ page 112
  8   \ ax^2 + bx + c
  9   : QUADRATIC    ( a b c x -- n )
 10     >R SWAP ROT I *  + R> *  + ;
 11 
 12 \ page 16
 13   \ percent
 14   : %   100 */ ;
 15 

Scr# 822 
  0 \ Brodie - Starting FORTH - Ch. 5 - Philosophy of Fixed Point
  1 \ page 118
  2 
  3   \ rounded percent
  4   : R%   10 */ 5 + 10 / ;
  5 
  6 \ page 122 - the footnote
  7 
  8   : pi           355   113 */ ;       \  2.7E-7
  9   : sqrt(2)    19601 13860 */ ;       \  1.8E-9
 10   : sqrt(3)    18817 10864 */ ;       \  2.4E-9
 11   : exp(1)     28667 10546 */ ;       \  1.5E-8  -
 12   : sqrt(10)   22936  7253 */ ;       \  1.8E-8
 13   : 12sqrt(12) 26797 25293 */ ;       \  1.8E-9  -
 14 
 15 

Scr# 823 
  0 \ Brodie - Starting FORTH - Ch. 5 - Philosophy of Fixed Point
  1 
  2 \ Problems.
  3 \ 1. Translate the following algeabric expression into
  4 \ a Forth definition: -(ab/c)
  5 \ given ( a b c -- n )
  6   : -AB/C    ( a b c -- n )  */ NEGATE ;
  7 
  8 \ 2. Given these four numbers on the stack ( 6 7 123 45 -- )
  9 \ write an exprssion that prints the largest value
 10   : 4MAX  ( a b c d -- n )  MAX MAX MAX ;
 11 
 12 
 13 
 14 
 15 

Scr# 824 
  0 \ Brodie - Starting FORTH - Ch. 5 - Philosophy of Fixed Point
  1 
  2 \ Problems.
  3 \ 3. In "calculator style", convert the folowing
  4 \ temperatures using the formulae
  5     C  =  ( F - 32 ) / 1.8
  6     F  =  ( C  1.8 ) + 32
  7     K  =    C  +  273
  8 
  9   0  32 - 10 18 */ .               CR
 10 212  32 - 10 18 */ .               CR
 11 -32  32 - 10 18 */ .               CR
 12  16  18 10 */ 32 + .               CR
 13 233  273 - .                       CR
 14 
 15 

Scr# 825 
  0 \ Brodie - Starting FORTH - Ch. 5 - Philosophy of Fixed Point
  1 
  2 \ Problems.
  3 \ 4. In "calculator style", convert the folowing
  4 \ temperatures using the formulae
  5   : F>C   (  F --  C )  32 - 10 18  */ ;
  6   : C>F   (  C --  F )  10 18  */  32 + ;
  7   : K>C   (  K --  C )  273 - ;
  8   : C>K   (  C --  K )  273 + ;
  9   : F>K   (  F --  K )  F>C  C>K ;
 10   : K>F   (  K --  F )  K>C  C>F ;
 11   0  DUP . ." ~F  "  F>C . ." ~C"  CR
 12 212  DUP . ." ~F  "  F>C . ." ~C"  CR
 13 -32  DUP . ." ~F  "  F>C . ." ~C"  CR
 14  16  DUP . ." ~C  "  C>F . ." ~F"  CR
 15 233  DUP . ." ~K  "  K>C . ." ~C"  CR

Scr# 826 
  0   Brodie - Starting FORTH - Ch. 6 - Throw it for a loop
  1 \ page 127
  2   : TEST   10 0 DO  CR ." HELLO " LOOP ;
  3 TEST       CR
  4 
  5 \ page 130
  6   : DECADE   10 0 DO  I .  LOOP ;
  7 DECADE     CR
  8 
  9   : SAMPLE  -243 -250 DO  I .  LOOP ;
 10 SAMPLE     CR
 11 
 12   : MULTIPLICATIONS   CR 11 1 DO  DUP I * . LOOP  DROP ;
 13 MULTIPLICATIONS    CR
 14 
 15 

Scr# 827 
  0 \ Brodie - Starting FORTH - Ch. 6 - Throw it for a loop
  1 \ page 131
  2 
  3 \ rounded percent
  4   DECIMAL 822 LOAD  \ this loads R% from Screen# 822.
  5 
  6   : COMPOUND  ( amt int -- )
  7     SWAP  21 1 DO ." YEAR " I . 3 SPACES
  8     2DUP  R% + DUP  ." BALANCE " . CR LOOP 2DROP ;
  9 
 10  1000 6 COMPOUND
 11 
 12 
 13 
 14 
 15 

Scr# 828 
  0 \ Brodie - Starting FORTH - Ch. 6 - Throw it for a loop
  1 \ page 131
  2   : RECTANGLE  256 0 DO I  16 MOD 0= IF
  3        CR THEN  ." *" LOOP ;
  4 RECTANGLE   CR
  5 
  6 \ page 132
  7   : POEM   CR 11 1 DO I . ." LITTLE "
  8        I 3 MOD 0= IF ." INDIANS " CR THEN LOOP
  9          ." INDIAN BOYS. " ;
 10 POEM        CR
 11 
 12   : TABLE  CR 11 1 DO I MULTIPLICATION LOOP ;
 13 
 14 TABLE       CR
 15 

Scr# 829 
  0 \ Brodie - Starting FORTH - Ch. 6 - Throw it for a loop
  1 
  2   NEEDS J  NEEDS U.R
  3 
  4 \ page 132
  5   : TABLE  CR 11 1 DO
  6       11 1 DO I J * 5 U.R LOOP CR LOOP ;
  7 TABLE    CR
  8 
  9 \ page 133
 10   : PENTAJUMPS  50 0 DO I . 5 +LOOP ;
 11 PENTAJUMPS    CR
 12 
 13   : FALLING  -10 0  DO I . -1 +LOOP ;
 14 FALLING       CR
 15 

Scr# 830 
  0 \ Brodie - Starting FORTH - Ch. 6 - Throw it for a loop
  1 \ page 133
  2   : INC-COUNT   DO I . DUP +LOOP DROP ;
  3  1   5   0   INC-COUNT  CR
  4  2   5   0   INC-COUNT  CR
  5 -3 -10  10   INC-COUNT  CR
  6 \ page 134
  7   : DOUBLING   32767 1 DO  I .  I +LOOP ;
  8 DOUBLING
  9 \ page 135
 10   : TEST 100 10 DO I . -1 +LOOP ;
 11 \ TEST : this system uses the latest standard DO-LOOP
 12 
 13 \ page 136
 14   : COMPOUND   ( amt int -- )
 15     SWAP 21 1 DO I . 2DUP R% + DUP . CR LOOP 2DROP ;

Scr# 831 
  0 \ Brodie - Starting FORTH - Ch. 6 - Throw it for a loop
  1 
  2 \ page 140
  3   NEEDS U.R
  4   : R%   10 */ 5 + 10 / ;
  5   : DOUBLED   6 1000  21 1  DO  CR
  6       ." YEAR "  I 2 U.R
  7       2DUP R% +  DUP ."   BALANCE " .
  8       DUP 2000 > IF CR CR  ." MORE THAN DOUBLED IN "
  9                      I  . ." YEARS " LEAVE THEN
 10                                 LOOP 2DROP ;
 11 
 12 DOUBLED
 13 
 14 
 15 

Scr# 832 
  0 \ Brodie - Starting FORTH - Ch. 6 - Throw it for a loop
  1 
  2 \ Problems.
  3 \ 1. First create a word named STARS which print out n stars
  4 \ on the same line, given n on the stack.
  5   : STARS   ( n -- )  0 DO  [CHAR] * EMIT  LOOP ;
  6 10 STARS  CR
  7 
  8 \ 2. Next define BOX which prints out a rectangle of stars,
  9 \ given width and height (number of lines), using the stack
 10 \ order ( width height -- )
 11   : BOX  ( w h -- )  0 DO CR DUP STARS  LOOP DROP ;
 12 10 3 BOX  CR
 13 
 14 
 15 

Scr# 833 
  0 \ Brodie - Starting FORTH - Ch. 6 - Throw it for a loop
  1 \
  2 \ 3. Now create a word named \STARS which will print a
  3 \ skewed array of stars (a rhomboid), given the height on
  4 \ the stack. Use a DO loop and, for simplicity, make the
  5 \ width a constant of ten stars.
  6   : \STARS   ( n -- ) 0 DO CR I SPACES 10 STARS LOOP ;
  7 3 \STARS
  8 
  9 \ 4. Now create a word which slants the stars the othe
 10 \ direction; call it /STARS. It would take the height as
 11 \ a stack input and use a constant of ten width. Use a DO
 12 \ loop.
 13   : /STARS   ( n -- )
 14     1- 0 SWAP DO CR I SPACES 10 STARS -1 +LOOP ;
 15 3 /STARS

Scr# 834 
  0 \ Brodie - Starting FORTH - Ch. 6 - Throw it for a loop
  1 
  2 \ 5. Now define this last word, using a BEGIN...UNTL loop.
  3 
  4   : A/STARS   ( n -- )
  5     BEGIN
  6       CR DUP SPACES 10 STARS
  7       1- DUP 0=
  8     UNTIL
  9     DROP ;
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 835 
  0 \ Brodie - Starting FORTH - Ch. 6 - Throw it for a loop
  1 
  2 \ 6. Write a definition called DIAMONDS which will print out
  3 \ the given numbe of diamonds shapes...
  4   : TRIANGLE  ( -- )
  5       DO
  6         CR  9 I - SPACES  I  2* 1+ STARS
  7       DUP +LOOP
  8       DROP ;
  9   : DIAMONDS  ( n -- )
 10       0 DO
 11         1 10 0 TRIANGLE
 12        -1  0 9 TRIANGLE
 13       LOOP ;
 14 
 15 2 DIAMONDS

Scr# 836 
  0 \ Brodie - Starting FORTH - Ch. 6 - Throw it for a loop
  1 
  2 \ 7. Rewrite DOUBLED so that it will expect a starting
  3 \ balance and insterest rate on the stack and will LEAVE
  4 \ when this starting balance has doubled.
  5   NEEDS U.R   NEEDS 2OVER
  6   : R%   10 */ 5 + 10 / ;
  7   : DOUBLED   ( amt int -- )
  8     OVER 2* -ROT SWAP 21 1  DO             \ 2m m n
  9       CR ." YEAR "  I 2 U.R 3 SPACES
 10       2DUP R% +  DUP  ."   BAL " .
 11       DUP 2OVER DROP > IF
 12         CR CR  ." MORE THAN DOUBLED IN "
 13         I  . ." YEARS " LEAVE THEN
 14     LOOP 2DROP DROP ;
 15 1000 5 doubled

Scr# 837 
  0 \ Brodie - Starting FORTH - Ch. 6 - Throw it for a loop
  1 \ 8. Define a word called ** that will compute exponential
  2 \ values like this:
  3 \   7 2 ** .  ==>  49   (seven squared)
  4 \   2 4 ** .  ==>  16   (two to the fourth power)
  5 \ For simplicity, assume positive exponent only.
  6   : **   ( n u -- m )
  7     1 SWAP                   ( n 1 u  )
  8     0 ?DO                    ( n 1    )
  9       OVER *                 ( n m    )
 10     LOOP NIP ;               ( m      )
 11 \
 12   7 2 ** . CR
 13   2 8 ** . CR
 14   3 0 ** . CR
 15 

Scr# 838 
  0 \ Brodie - Starting FORTH - Ch. 7 - A Numbers of Kind of Numbers
  1 
  2 \ page 156
  3   : PRINTABLES   127 32 DO I EMIT SPACE LOOP ;
  4 PRINTABLES
  5 
  6 \ page 158
  7 7 EMIT     ( beep! )
  8 
  9 \ page 166
 10   : UD.   <# #S #> TYPE ;
 11 12,345   UD.    CR
 12 12.      UD.    CR
 13 0.       UD.    CR
 14 372-8493 UD.    CR
 15 

Scr# 839 
  0 \ Brodie - Starting FORTH - Ch. 7 - A Numbers of Kind of Numbers
  1 
  2 \ page 167
  3   : .PH#   <# # # # # 45 HOLD #S #> TYPE SPACE ;
  4 372-8493  .PH#  CR
  5 
  6   : .DATE  <# # # 47 HOLD # # 47 HOLD #S #> TYPE SPACE ;
  7 2023-08-09  .DATE  CR
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 840 
  0 \ Brodie - Starting FORTH - Ch. 7 - A Numbers of Kind of Numbers
  1 
  2 \ page 168
  3   : SEXTAL   6 BASE ! ;
  4   : :00   #  SEXTAL  #  DECIMAL 58 HOLD ;
  5   : SEC  <# :00 :00 #S #> TYPE SPACE ;
  6   60. SEC   CR
  7 1400. SEC   CR
  8 4500. SEC   CR
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 841 
  0 \ Brodie - Starting FORTH - Ch. 7 - A Numbers of Kind of Numbers
  1 
  2 \ page 171
  3   : .$   SWAP OVER  DABS
  4       <# ROT SIGN # # 46 HOLD #S  36 HOLD #> TYPE SPACE ;
  5 
  6  2000.00 .$  CR
  7 2,000.00 .$  CR
  8 
  9 \ the new Forth standard needs ROT before SIGN so that the
 10 \ definition presented at page 171 won't work !
 11 \ \  <# # # 46 HOLD #S SIGN 36 HOLD #> TYPE SPACE ;
 12 
 13 
 14 
 15 

Scr# 842 
  0 \ Brodie - Starting FORTH - Ch. 7 - A Numbers of Kind of Numbers
  1 
  2 \ Standard says  UM*  instead of  U*  etc.
  3   NEEDS M*/  NEEDS M/  NEEDS M+
  4 
  5 \ page 175
  6   : %   100 M*/ ;
  7 200.50 15 % D.       CR
  8 200.50 15 % .$       CR
  9 
 10   : R%  10 M*/ 5 M+ 10 M/ ;
 11 987.65 15 R% .$      CR
 12 200,000 3 1 M*/ D.   CR
 13 200,000 1 4 M*/ D.   CR
 14 
 15 

Scr# 843 
  0 \ Brodie - Starting FORTH - Ch. 7 - A Numbers of Kind of Numbers
  1 
  2 \ page 176
  3 DECIMAL
  4        : SCORE-MORE   20 + ;
  5 
  6 HEX    : SCORE-MORE   14 + ;  DECIMAL
  7 
  8        : EXAMPLE  HEX 20 . DECIMAL ;
  9 EXAMPLE
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 844 
  0 \ Brodie - Starting FORTH - Ch. 7 - A Numbers of Kind of Numbers
  1 
  2 \ Problems.
  3 
  4 \ 1.  Veronica Wainwright couldn't remember the upper limit
  5 \ for a signed single-length number, and she had no book to
  6 \ refer to, only a Forth terminal. So she wrote a defiinition
  7 \ called N-MAX, using BEGIN...UNTIL loop. When she executed
  8 \ she got   32767
  9 \ What was her definition ?
 10 
 11  : N-MAX 0 BEGIN 1+ DUP 0< UNTIL 1- . ;
 12 
 13 
 14 
 15 

Scr# 845 
  0 \ Brodie - Starting FORTH - Ch. 7 - A Numbers of Kind of Numbers
  1 
  2 \ 3. Write a definition that "rings" your terminal's bell
  3 \ three times. Make sure that there is enough of delay
  4 \ between the bells so that they are distinguishable.
  5 \ Each time the bell rings, the word "BEEP" should appear
  6 \ on the terminal screen.
  7 
  8   : 3BELLS
  9     3 BEGIN
 10       ." BEEP " 7 7 7 EMIT EMIT EMIT
 11       1- DUP WHILE
 12          30000 0 DO NOOP LOOP
 13     REPEAT DROP ;
 14 
 15 3BELLS

Scr# 846 
  0 \ Brodie - Starting FORTH - Ch. 7 - A Numbers of Kind of Numbers
  1 
  2 \ Problems.
  3 \ 4. Rewrite the temperatur conversion definitions ...
  4   NEEDS D-  NEEDS M*/  NEEDS M+
  5   : F>C   (  F --  C )  -32.0 D+  10 18  M*/ ;
  6   : C>F   (  C --  F )  10 18 M*/  32.0  D+  ;
  7   : K>C   (  K --  C )  -273.2 M+ ;
  8   : C>K   (  C --  K )   273.2 M+ ;
  9   : F>K   (  F --  K )  F>C  C>K ;
 10   : K>F   (  K --  F )  K>C  C>F ;
 11 
 12   : .DEG   ( d -- )
 13     TUCK DABS
 14     <# # [CHAR] . HOLD #S ROT SIGN #> TYPE SPACE ;
 15 

Scr# 847 
  0 \ Brodie - Starting FORTH - Ch. 7 - A Numbers of Kind of Numbers
  1 
  2 \ Problems.
  3 \ 5.a. Write a routine which evaluates  7x^2 + 20x + 5
  4 \ given x, and returns a double-length value.
  5 \ That is: x(7x +20) + 5
  6   NEEDS D-  NEEDS M*/  NEEDS M+  NEEDS D<
  7   : DPOLY   ( n -- d )
  8     DUP   7 M* 20 M+   ROT 1 M*/   5 M+ ;
  9 
 10 \ 5.b. How large an x will work without overflowing
 11 \ thirty-two bits as a signed number ?
 12 
 13   : ?MAX-DPOLY  ( -- )
 14   0  BEGIN 1+  DUP DPOLY  NIP 0< UNTIL  1- . ;
 15 

Scr# 848 
  0 \ Brodie - Starting FORTH - Ch. 7 - A Numbers of Kind of Numbers
  1 
  2 \ Problems.
  3 \ 6. Write a word which prints the numbes 0 through 16
  4 \ (decimal) in decimal, hexadecimal, and binary form in
  5 \ three columns
  6 
  7   NEEDS BINARY
  8   : NUMS
  9     17 0 DO
 10       DECIMAL  ." DECIMAL "  I  2  .R  3 SPACES
 11       HEX      ." HEX "      I  2  .R  3 SPACES
 12       BINARY   ." BINARY "   I  5  .R  CR
 13     LOOP  DECIMAL ;
 14 
 15 

Scr# 849 
  0 \ Brodie - Starting FORTH - Ch. 7 - A Numbers of Kind of Numbers
  1 
  2 \ Problems
  3 \ 8. Write a definition for phone-number formatting word
  4 \ that will also print the area code with a slash if and
  5 \ only if the number includes an area code. E.g.
  6 \ 555-1234     .PH#  555-1234
  7 \ 213/372-8493 .PH#  213/372-8493
  8 
  9   : .PH#  ( d -- )
 10     <# # # # # [CHAR] - HOLD # # #
 11        OVER IF [CHAR] / HOLD #S THEN #> TYPE SPACE ;
 12 
 13 \ 555.1234     .PH# \  555-1234
 14 \ 213.372.8493 .PH# \  213/372-8493
 15 

Scr# 850 
  0 \ Brodie - Starting FORTH - Ch. 8 - Variables, Constants, Arrays
  1 
  2 \ page 183
  3   VARIABLE  DATE
  4 12  DATE !
  5 
  6 \ page 184
  7 DATE @ . CR
  8 DATE ?   CR
  9 
 10 13  DATE !
 11 DATE ?   CR
 12 
 13 
 14 
 15 

Scr# 851 
  0 \ Brodie - Starting FORTH - Ch. 8 - Variables, Constants, Arrays
  1 
  2 \ pag 184
  3   VARIABLE DATE  VARIABLE MONTH  VARIABLE YEAR
  4   : !DATE  ( month day year -- )
  5     YEAR !  DATE !  MONTH ! ;
  6 7 31 23 !DATE
  7 
  8   : .DATE   MONTH ?   DATE ?   YEAR ?  ;
  9 .DATE
 10 
 11 \ : DECIMAL   10 BASE ! ;
 12 \ : HEX       16 BASE ! ;
 13 \ : OCTAL      8 BASE ! ;
 14 \ : BINARY     2 BASE ! !
 15 

Scr# 852 
  0 \ Brodie - Starting FORTH - Ch. 8 - Variables, Constants, Arrays
  1 
  2 \ page 188
  3   VARIABLE EGGS
  4   : RESET   0 EGGS !  ;
  5   : EGG     1 EGGS +! ;
  6 
  7 \ page 189
  8 RESET
  9 EGG
 10 EGG
 11 EGG
 12 EGGS ?
 13 
 14 
 15 

Scr# 853 
  0 \ Brodie - Starting FORTH - Ch. 8 - Variables, Constants, Arrays
  1 
  2 \ page 190
  3   200 CONSTANT LIMIT     \ LIMIT is an user variable, so you
  4                          \ get a warning message that warns
  5                          \ you about that.
  6 
  7   : ?TOO.HOT  LIMIT > IF ." DANGER -- REDUCE HEAT " THEN ;
  8 201 ?TOO.HOT CR
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 854 
  0 \ Brodie - Starting FORTH - Ch. 8 - Variables, Constants, Arrays
  1 
  2   NEEDS 2VARIABLE
  3 
  4 \ page 193
  5   2VARIABLE DATE
  6 800,000  DATE 2!
  7 DATE 2@ D.    CR
  8 
  9 \ from previous chapter
 10   : .DATE  <# # # 47 HOLD # # 47 HOLD #S #> TYPE SPACE ;
 11 
 12 7/16/23  DATE 2!
 13 DATE 2@ .DATE     CR
 14 
 15 

Scr# 855 
  0 \ Brodie - Starting FORTH - Ch. 8 - Variables, Constants, Arrays
  1 \ page 193
  2   NEEDS 2CONSTANT
  3   200,000  2CONSTANT  APPLES
  4 APPLES @ D.    CR
  5 
  6 \ page 194
  7   400,000  2CONSTANT  MUCH
  8   : MUCH-MORE   MUCH D+  ;
  9 APPLES MUCH-MORE D.     CR
 10 
 11   355 113  2CONSTANT PI
 12 10000 PI */ .           CR
 13 
 14 
 15 

Scr# 856 
  0 \ Brodie - Starting FORTH - Ch. 8 - Variables, Constants, Arrays
  1 \ page 196
  2   VARIABLE LIMITS  8 ALLOT
  3 220 LIMITS     !
  4 340 LIMITS  2+ !
  5 \ page 198
  6   : LIMIT   2* LIMITS ! ;
  7 170  2 LIMIT !
  8 
  9   : ?TOO.HOT  ( burner# temp -- )
 10     LIMIT @ >  IF ." DANGER -- REDUCE HEAT " THEN ;
 11 210  0 ?TOO.HOT   CR
 12 230  0 ?TOO.HOT   CR
 13 310  1 ?TOO.HOT   CR
 14 250  1 ?TOO.HOT   CR
 15 \ etc.

Scr# 857 
  0 \ Brodie - Starting FORTH - Ch. 8 - Variables, Constants, Arrays
  1 
  2   NEEDS U.R    NEEDS PAGE    NEEDS DUMP
  3 
  4 \ page 199
  5   VARIABLE COUNTS  10 ALLOT
  6   COUNTS 12 ERASE
  7 
  8   : RESET     COUNTS  12 ERASE ;
  9   : COUNTER   2*  COUNTS + ;
 10   : TALLY     COUNTER 1  SWAP +! ;
 11 
 12 -->
 13 \ --> definition allows continuing LOADing the next Screen
 14 
 15 

Scr# 858 
  0 \ Brodie - Starting FORTH - Ch. 8 - Variables, Constants, Arrays
  1 \ page 200
  2   : CATEGORY DUP 18 < IF 0 ELSE
  3              DUP 21 < IF 1 ELSE
  4              DUP 24 < IF 2 ELSE
  5              DUP 27 < IF 3 ELSE
  6              DUP 30 < IF 4 ELSE  5
  7              THEN THEN THEN THEN THEN SWAP DROP ;
  8 \ page 201
  9   : LABEL    DUP  0= IF ." REJECT "      ELSE
 10              DUP 1 = IF ." SMALL "       ELSE
 11              DUP 2 = IF ." MEDIUM "      ELSE
 12              DUP 3 = IF ." LARGE "       ELSE
 13              DUP 4 = IF ." EXTRA LARGE " ELSE
 14              THEN THEN THEN THEN THEN DROP ;
 15 -->

Scr# 859 
  0 \ Brodie - Starting FORTH - Ch. 8 - Variables, Constants, Arrays
  1 
  2 \ page 201
  3 1 LABEL    CR
  4 
  5   : EGGSIZE   CATEGORY DUP LABEL TALLY ;
  6 23 EGGSIZE  CR
  7 
  8 \ page 202
  9   : REPORT   PAGE ." QUANTITY    SIZE " CR CR
 10     6 0 DO  I COUNTER @ 5 U.R
 11             7 SPACES I LABEL CR LOOP ;
 12 REPORT
 13 
 14 COUNTS 12 DUMP
 15 

Scr# 860 
  0 \ Brodie - Starting FORTH - Ch. 8 - Variables, Constants, Arrays
  1 
  2 \ page 207
  3   CREATE LIMITS  220 , 340 , 170 , 100 , 190 ,
  4 
  5   CREATE SIZES  18 C,  21 C,  24 C,  27 C,  30 C,  255 C,
  6 
  7   : CATEGORY   ( n1 -- n2 )
  8     6 0 DO
  9       DUP SIZES I + C@ <
 10       IF
 11         DROP I LEAVE
 12       THEN
 13     LOOP ;
 14 
 15 

Scr# 861 
  0 \ Brodie - Starting FORTH - Ch. 8 - Variables, Constants, Arrays
  1 
  2 \ Problems.
  3 \ 1. a) Write two words called BAKE-PIE and EAT-PIE.
  4 \ The 1st word increases the number of available PIES by one
  5 \ The 2nd decreases the number by 1 and thanks you for the pie
  6 \ but if there is no pie, it types "What pie?"
  7 
  8   CREATE PIES 0 ,
  9   : BAKE-PIE  1 PIES +! ;
 10   : EAT-PIE  PIES @  IF ." THANK YOU " -1 PIES +!
 11                    ELSE ." WHAT PIE? "  THEN ;
 12 EAT-PIE      CR
 13 BAKE-PIE     CR
 14 EAT-PIE      CR
 15 

Scr# 862 
  0 \ Brodie - Starting FORTH - Ch. 8 - Variables, Constants, Arrays
  1 
  2 \ Problems.
  3 \ 1. b) Write a words called FREEZE-PIES which takes all the
  4 \ pies availale and adds them to the number of pies in the
  5 \ freezer. Remember that frozen pies cannot be eaten.
  6 
  7   CREATE FROZEN-PIES 0 ,
  8   : FREEZE-PIES  PIES @ FROZEN-PIES +! 0 PIES ! ;
  9 
 10 BAKE-PIE BAKE-PIE FREEZE-PIES     CR
 11 PIES ?                            CR
 12 FROZEN-PIES ?                     CR
 13 
 14 
 15 

Scr# 863 
  0 \ Brodie - Starting FORTH - Ch. 8 - Variables, Constants, Arrays
  1 
  2 \ Problems.
  3 \ 3. Define a word called .BASE which prints the current
  4 \ value of the variable BASE in decimal. Test it by first
  5 \ changing BASE to some value other than ten.
  6 
  7   : .BASE
  8     BASE @ DUP
  9     DECIMAL .
 10     BASE ! ;
 11 
 12 DECIMAL .BASE       CR
 13 HEX .BASE           CR
 14 
 15 

Scr# 864 
  0 \ Brodie - Starting FORTH - Ch. 8 - Variables, Constants, Arrays
  1 \ 3. Define a number-formatting word called M. which prints
  2 \ a double-length number with a decimal point. The position
  3 \ of the decimal point within the number is movable and
  4 \ depends on the value of a variable you will define as
  5 \ PLACES  for example, if you store a 1 into PLACES, you
  6   will get  200,000 M.  20000.0 ok
  7 \ that is, with the decimal point one place from the right.
  8 \ A zero in PLACES should produce no decimal point at all.
  9   VARIABLE PLACES    1 PLACES !
 10   : M.   ( d -- )  SWAP OVER DABS <#
 11         PLACES @ ?DUP IF 0 DO # LOOP [CHAR] . HOLD THEN
 12         #S   ROT   SIGN  #>  TYPE SPACE ;
 13 
 14 0 PLACES ! 200,000 M.    CR
 15 1 PLACES ! 200,000 M.    CR

Scr# 865 
  0 \ Brodie - Starting FORTH - Ch. 8 - Variables, Constants, Arrays
  1 \ 4. In order to keep track of the inventory of colord
  2 \ pencils in your office, create an array, each cell of
  3 \ which contains the count of different colored pencils.
  4 \ Define a set of words so that, for exmple, the phrase
  5 \  RED PENCILS
  6 \ return the address of the cell that contains the count of
  7 \ red pencils etc...
  8   : ENUMERATED   ( n -- ) 0 DO I [COMPILE] CONSTANT LOOP ;
  9   4 ENUMERATED     RED  BLUE  GREEN  ORANGE
 10   CREATE #PENCILS   23 ,  15 ,   12 ,     0 ,
 11   : PENCILS   ( n -- a )  2*  #PENCILS + ;
 12 
 13 RED  PENCILS  @ .    CR
 14 BLUE PENCILS  @ .    CR
 15 

Scr# 866 
  0 \ Brodie - Starting FORTH - Ch. 8 - Variables, Constants, Arrays
  1 \ 5. A histogram is a graphic representation of a series of
  2 \ vaues. Each value is shown by the height or length of a
  3 \ bar. In this exercise you will create an array of values
  4 \ and print a histogram which displays a line of "*"s for
  5 \ each value. First create an array with about ten cells.
  6 \ Initialize each element with a value in the range 0 - 60
  7 \ On each line print the number of the cell followed by a
  8 \ number of "*"s equal to the content of that cell.
  9 
 10   NEEDS U.R
 11   CREATE 'SAMPLES   11 ,  2 ,  5 ,  3 ,  3 ,  2 ,
 12                     15 , 21 ,  3 ,  8 , 10 ,  0 ,  3 ,
 13   : STARS ( n -- ) 0 ?DO [CHAR] * EMIT LOOP ;
 14   : SAMPLE ( n -- a ) 2* 'SAMPLES + ;
 15   : PLOT 11 0 DO CR I 2 U.R SPACE I SAMPLE @ STARS LOOP CR ;

Scr# 867 
  0 \ Brodie - Starting FORTH - Ch. 8 - Variables, Constants, Arrays
  1 \ 6. Tic-tac-toe ...
  2   CREATE BOARD  9 ALLOT  : CLEAR  BOARD 9 ERASE ;  CLEAR
  3   : BOARD@   ( n -- c )  BOARD + C@ ;
  4   : BOARD!   ( b n -- )  BOARD + C! ;
  5   : .HORIZ   DUP 2- 3 MOD 0=  SWAP  6 < AND
  6              IF CR ." --|---|-- " CR THEN ;
  7   : .VERT    3 MOD   IF [CHAR] | EMIT SPACE THEN ;
  8   : DISPLAY     CR 9 0 DO
  9       I .VERT  I BOARD@  ?DUP
 10       IF 1+ 2/ 9 * [CHAR] O + ELSE BL THEN
 11       EMIT SPACE I .HORIZ
 12     LOOP ;
 13   : X!  ( n -- ) 1-   1  SWAP BOARD! DISPLAY ;
 14   : O!  ( n -- ) 1-  -1  SWAP BOARD! DISPLAY ;
 15 

Scr# 868 
  0 \ Brodie - Starting FORTH - Ch. 9 - Under the Hood
  1 
  2   NEEDS SEE
  3 
  4   801 LOAD   ( Load GREET from ch. 1 )
  5 
  6   SEE GREET
  7 
  8 \ page 215
  9   ' GREET EXECUTE
 10 
 11   VARIABLE POINTER
 12   ' GREET POINTER !
 13   POINTER @ EXECUTE
 14 
 15 

Scr# 869 
  0 \ Brodie - Starting FORTH - Ch. 9 - Under the Hood
  1 
  2 \ page 217
  3   : HELLO     ." HELLO " ;
  4   : GOODBYE   ." GOODBYE " ;
  5   VARIABLE 'ALOHA
  6   : ALOHA  'ALOHA @ EXECUTE ;
  7 CR
  8 
  9 ' HELLO   'ALOHA !
 10 ALOHA  CR
 11 
 12 ' GOODBYE 'ALOHA !
 13 ALOHA  CR
 14 
 15 

Scr# 870 
  0 \ Brodie - Starting FORTH - Ch. 9 - Under the Hood
  1 \ page 218
  2 \ Here we adhere to FORTH Inc. standard
  3   : SAY    '   'ALOHA !  ;
  4 
  5 SAY HELLO
  6 ALOHA      CR
  7 
  8 SAY GOODBYE
  9 ALOHA      CR
 10 
 11   : COMING   ['] HELLO    'ALOHA ! ;
 12   : GOING    ['] GOODBYE  'ALOHA ! ;
 13 COMING   ALOHA    CR
 14 GOING    ALOHA    CR
 15 

Scr# 871 
  0 \ Brodie - Starting FORTH - Ch. 9 - Under the Hood
  1 
  2 \ page 219
  3   SEE INTERPRET     CR CR
  4 
  5 \ page 228
  6   SEE QUIT          CR CR
  7 
  8 \ page 233
  9   SEE HERE          CR CR
 10 
 11 \ page 234
 12   SEE PAD           CR CR
 13 
 14 
 15 

Scr# 872 
  0 \ Brodie - Starting FORTH - Ch. 9 - Under the Hood
  1 
  2 \ page 235
  3   : 'S  SP@  ;
  4 
  5 \ page 236
  6   NEEDS DEPTH
  7 
  8 \ page 243
  9   NEEDS FORTH
 10   NEEDS EDITOR
 11   NEEDS ASSEMBLER
 12 
 13   SEE DEFINITIONS
 14 
 15 

Scr# 873 
  0 \ Brodie - Starting FORTH - Ch. 9 - Under the Hood
  1 
  2 \ page 245
  3   NEEDS LOCATE
  4 
  5   LOCATE ASSEMBLER
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 874 
  0 \ Brodie - Starting FORTH - Ch. 9 - Under the Hood
  1 \ Problem 1.
  2 \ First review Chap. 2, Prob. 6.  Without changing any of
  3 \ those definitions, now write a word called COUNTS which
  4 \ will allow the judge to optionally enter the numbe of
  5 \ counts for any crime. For instance the entry
  6 \ CONVICTED-OF BOOKMAKING 3 COUNTS TAX-EVASION WILL-SERVE
  7 \   ==>  17 YEARS
  8 \ will compute the sentence for one count of bookmaking and
  9 \ three counts of tax evasion.
 10   MARKER TASK  DECIMAL 814 LOAD
 11   : COUNTS  ( n -- )
 12     ' -ROT 0 DO OVER EXECUTE LOOP NIP ;
 13 CONVICTED-OF BOOKMAKING
 14 3 COUNTS TAX-EVASION
 15 WILL-SERVE

Scr# 875 
  0 \ Brodie - Starting FORTH - Ch. 9 - Under the Hood
  1 
  2 \ Problem 2. What is the beginning of your private dictionary ?
  3 \ COLD    \ we don't have EMPTY yet.
  4 \ HERE U.
  5 
  6 \ Problem 3. In your system, how far is the pad from the top
  7 \ of your private dictionary ?
  8   PAD HERE - U.
  9 
 10 \ Problem 4. Assuming that DATE has been defined by VARIABLE
 11 \ what is the difference between these two phrases:
 12   DATE    U.
 13   ' DATE  U.
 14   BASE    U.
 15   ' BASE  U.

Scr# 876 
  0 \ Brodie - Starting FORTH - Ch. 9 - Under the Hood
  1 \ Problem 5. In this exercise you will create a "vectored
  2 \ execution ...
  3   MARKER TASK  DECIMAL 832 LOAD
  4   NEEDS EXEC:   \ Vectorized case structure.
  5   : GREET      ." HELLO, I SPEAK FORTH. " ;
  6   : SEQUENCE   11 1 DO I . LOOP ;
  7   : TILE       10 5 BOX ;         \ Ch. 6
  8   : NOTHING    ;
  9   : DO-SOMETHING  ( index -- ) EXEC:  NOOP  \ 0
 10     GREET     \ 1
 11     SEQUENCE  \ 2
 12     TILE      \ 3
 13     NOTHING   \ 4
 14     NOTHING  NOTHING  ;
 15 

Scr# 877 
  0 \ Brodie - Starting FORTH - Ch. 10 - I/O and You
  1 
  2   : TEST    ." SAMPLE " ;
  3 
  4 NEEDS SEE  NEEDS DUMP
  5 
  6 SEE TEST        CR
  7 ' TEST 10 DUMP  CR
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 878 
  0 \ Brodie - Starting FORTH - Ch. 10 - I/O and You
  1 
  2 \    |       |      |      |      |       |
  3   : "LABEL"
  4   ." REJECT  SMALL  MEDIUM LARGE  XTRA LRGERROR   " ;
  5 
  6 ' "LABEL"  5 +
  7 16 + 8 TYPE         \ MEDIUM
  8 
  9   : LABEL   8 *  ['] "LABEL" 5 + + 8 TYPE SPACE ;
 10 
 11   : LABEL  0 MAX 5 MIN  LABEL ;
 12 
 13 
 14 
 15 

Scr# 879 
  0 \ Brodie - Starting FORTH - Ch. 10 - I/O and You
  1 
  2 \ CR 214 BLOCK  512 + 64 TYPE
  3 
  4 CR 214 BLOCK 64 -TRAILING TYPE
  5 
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 880 
  0 \ Brodie - Starting FORTH - Ch. 10 - I/O and You
  1 \ Buzzphrases Generator - ver 1.
  2   needs CHOOSE
  3   : buzzword  ( n -- )
  4     10 CHOOSE 2+  881 (LINE) DROP + 20 -TRAILING TYPE ;
  5   : 1adj    0  buzzword ;
  6   : 2adj   20  buzzword ;
  7   : noun   40  buzzword ;
  8   : phrase     1adj SPACE 2adj SPACE noun ;
  9   : paragraph  CR  ." by using "
 10     phrase    ."  coordinated with "
 11     phrase    ."  it is possible for even the most "
 12     phrase    ."  to function as "
 13     phrase    ."  within the constraint of "
 14     phrase    ." ." CR ;
 15 

Scr# 881 
  0 \ Brodie - Starting FORTH - Ch. 10 - I/O and You
  1 \ Buzzphrases Generator - ver 1.
  2 integrated          management          criteria
  3 total               organization        flexibility
  4 systematized        monitored           capability
  5 parallel            reciprocal          mobility
  6 functional          digital             programming
  7 responsive          logistical          concepts
  8 optimal             transitional        time phasing
  9 synchronized        incremental         projections
 10 compatible          third generation    hardware
 11 qualified           policy              through-put
 12 partial             decision            engineering
 13 
 14 
 15 

Scr# 892 
  0 ( trim routine )
  1 needs assembler
  2 code ltrim  ( a1 -- b )
  3   exx
  4   ldhl()  $5C0B  AA, \ DEFADD
  5   ldx   bc|  4  NN,   addhl bc|
  6   ld    e'|  (hl)|
  7   incx  hl|
  8   ld    d'|  (hl)|
  9   incx  hl|
 10   ld    c'|  (hl)|
 11   incx  hl|
 12   ld    b'|  (hl)|
 13   exdehl
 14   addhl bc|
 15 -->

Scr# 893 
  0 ( trim routine )
  1   decx  hl|
  2   ldn   a'|  BL  N,
  3 here
  4   cpd
  5   jrf   z'|  BACK,
  6   incx  bc|
  7   push bc|
  8   exx
  9   next
 10   c;
 11 
 12 
 13 
 14 
 15 

Scr# 895 
  0 1 RPI0 wrapper )
  1 needs RPi0
  2 : this ( -- a n )
  3   >in @ >R   -2 >in +!  [compile] \
  4   blk @ if    blk @ 1-     if    r@ c/l 1- and c/l swap -
  5                            else  b/buf c/l -   then
  6                            else  span @  then
  7   blk @ if  blk @ block  else  tib @  then  R> + swap ;
  8 : send ( a1 n1 a2 n2 -- n3 )
  9   2dup      uart-send-text  uart-wait-for
 10             uart-send-cr    uart-wait-cr-lf
 11   uart-rx-burst 7 -  0 max ;
 12 : ask  pad 1024 this send ;
 13 : sh  here 1024 this send drop ;
 14 : display cr pad swap type cr ;
 15 

Scr# 896 
  0 ( RPI0 wrapper )
  1 needs RPi0
  2 : ask  ( -- n )
  3   >in @ >R   -2 >in +!  [compile] \
  4   blk @ if    blk @ 1-     if    r@ c/l 1- and c/l swap -
  5                            else  b/buf c/l -   then
  6                            else  span @  then
  7   blk @ if  blk @ block  else  tib @  then  R> + swap
  8 \
  9   2dup      uart-send-text  uart-wait-for
 10   pad 100   uart-send-cr    uart-wait-cr-lf
 11   uart-rx-burst 7 -  0 max ;
 12 : sh ( -- )
 13   ask drop ;
 14 
 15 

Scr# 897 
  0 ( RPI0 wrapper )
  1   needs s"  needs ask  needs sh
  2 \ RPi0-init
  3 \ uart-wait-prompt
  4   send echo 'print 2**300' > temp.py
  5   ask  python temp.py
  6   pad swap type
  7 \
  8 : test
  9   here 200
 10   s"  python -c 'print 2**400'  "
 11   send here swap type
 12 ;
 13 
 14 
 15 

Scr# 898 
  0 ( RPI0 wrapper )
  1 \ RPi0-init
  2 
  3 \ uart-wait-prompt
  4   send echo 'print 2**300' > temp.py
  5   ask  python temp.py
  6   pad swap type
  7 \
  8   ask  python -c 'print 2**400'
  9   pad swap type
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 899 
  0 ( Example for THIS definition )
  1 \
  2   ASK     echo $BASH_VERSION
  3   DISPLAY
  4 \
  5   ASK     date
  6   DISPLAY
  7 \
  8 \ ASK     date -s 2024-07-13
  9 \ ASK     date -s 17:30
 10 \ 2DROP
 11 \
 12   ASK     date
 13   DISPLAY
 14 
 15 

Scr# 900 
  0 ( UART Raspberry PI Zero )
  1 \ hex 300 6633 ! \ 7 emit pitch
  2 \
  3 NEEDS LAYERS                   NEEDS BCOPY
  4 NEEDS TRUV    NEEDS INVV
  5 NEEDS ASSEMBLER
  6 \ NEEDS INTERRUPT
  7 \
  8 MARKER DONE
  9 \
 10 HEX 5C08 CONSTANT LASTK          \ system variable
 11     143B CONSTANT UART-RX-PORT
 12     133B CONSTANT UART-TX-PORT
 13     153B CONSTANT UART-CT-PORT
 14 -->
 15 

Scr# 901 
  0 ( UART Raspberry PI Zero - setup )
  1 \ Table of actual clock speeds depending on video mode
  2 \ These are double precision integers you can read with 2@
  3 HERE
  4 DECIMAL \ values are divided by 100 to better handle them
  5   28.0000   , ,   \ Base VGA timing   28 MHz
  6   28.5714   , ,   \ VGA setting 1     28.571.429 Hz
  7   29.4643   , ,   \ VGA setting 2     29.464.286 Hz
  8   30.0000   , ,   \ VGA setting 3     30 MHz
  9   31.0000   , ,   \ VGA setting 4     31 MHz
 10   32.0000   , ,   \ VGA setting 5     32 MHz
 11   33.0000   , ,   \ VGA setting 6     33 MHz
 12   27.0000   , ,   \ Digital           27 MHz
 13 CONSTANT SYS-CLK-ARY
 14 DECIMAL -->
 15 

Scr# 902 
  0 ( UART Raspberry PI Zero - setup )
  1 HEX
  2 \ compute actual clock speed depending on video mode
  3 : SYS-CLOCK ( -- d )
  4   11 REG@ 7 AND          \ Video timing register: 0-7
  5   4 * SYS-CLK-ARY + 2@   \ fetch from array created before
  6 ;
  7 \ send 14-bits prescalar to UART receive port
  8 \ prescalar = sysclock / baudrate
  9 : UART-SET-PRESCALAR ( n -- )
 10   DUP
 11   7F AND UART-RX-PORT P!      \ send low 7 bits of 14 bits
 12   7 RSHIFT                    \ presclar
 13   80  OR UART-RX-PORT P!      \ send high 7 bits of 14 bits
 14 ;
 15 DECIMAL -->

Scr# 903 
  0 ( UART Raspberry PI Zero - setup )
  1 DECIMAL
  2 \ compute prescalar to be used with previous definition
  3 : UART-BAUD-TO-PRESCALAR ( d -- n )
  4   100 M/          \ divide BAUD by 100 to able to handle it
  5   SYS-CLOCK       \ obtain actual system clock speed / 100
  6   ROT M/
  7 ;
  8 \ usage is: 115200. UART-SET-BAUDRATE
  9 : UART-SET-BAUDRATE ( d -- )
 10   UART-BAUD-TO-PRESCALAR
 11   UART-SET-PRESCALAR
 12 ;
 13 DECIMAL -->
 14 
 15 

Scr# 904 
  0 ( UART Raspberry PI Zero - setup )
  1 HEX
  2 \ Select Raspberry PI Zero UART and set Baudrate
  3 \
  4 : PI0-SELECT  ( d -- )
  5   40 UART-CT-PORT P!    \ select PI Zero UART control port
  6   UART-SET-BAUDRATE     \ uses double integer param
  7   30 A0 REG!            \ PI Pheripeal enable
  8 \ 91 A2 REG!            \ PI I2S Audio control
  9 ;
 10 DECIMAL -->
 11 
 12 
 13 
 14 
 15 

Scr# 905 
  0 ( UART Raspberry PI Zero - transmit )
  1 HEX
  2 \ non-zero when transmitter is busy sending a byte
  3 : ?UART-BUSY-TX ( -- f )
  4   UART-TX-PORT P@   \ UART TX port
  5   02 AND            \ bit is set when busy
  6 ;
  7 \ There is no transmit buffer so program must make sure the
  8 \ last transmission is complete before sending another byte
  9 : UART-TX ( b -- )
 10   BEGIN
 11     ?UART-BUSY-TX  0=  ?TERMINAL OR
 12   UNTIL
 13   UART-TX-PORT P!         \ Transmit
 14 ;
 15 DECIMAL -->

Scr# 906 
  0 ( UART Raspberry PI Zero - transmit )
  1 DECIMAL
  2 \ Utilities
  3 \
  4 : UART-SEND-EOT ( -- )   \ End Of Transmission
  5   04 UART-TX
  6 ;
  7 \
  8 : UART-SEND-ETX ( -- )   \ End of TeXt
  9   03 UART-TX
 10 ;
 11 DECIMAL -->
 12 
 13 
 14 
 15 

Scr# 907 
  0 ( UART Raspberry PI Zero - receive )
  1 HEX
  2 : ?UART-BYTE-READY  ( -- f )  \ non zero when byte ready
  3   UART-TX-PORT  P@  1 AND
  4 ;
  5 : UART-RX  ( -- b | 0 )       \ accept a byte
  6   UART-RX-PORT  P@
  7 ;
  8 : UART-WAIT ( b -- )     \ wait for a specific byte or Break
  9   BEGIN                       \ b
 10     UART-RX OVER =            \ b f
 11     ?TERMINAL OR              \ b f
 12   UNTIL DROP                  \
 13 ;
 14 DECIMAL -->
 15 

Scr# 908 
  0 ( UART Raspberry PI Zero - receive )
  1 \ wait for a byte with timeout in ms
  2 : UART-RX-TIMEOUT ( n -- c | 0 )
  3   0 SWAP                      \ 0 n
  4   1+ 0                        \ 0 n+1 0
  5   DO                          \ 0
  6     ?UART-BYTE-READY IF       \ 0
  7       UART-RX                 \ 0 b
  8       SWAP DROP               \   b
  9       LEAVE                   \   b
 10     THEN                      \ 0
 11     NOOP                      \      minimum delay
 12   LOOP                        \ 0
 13 ;
 14 DECIMAL -->
 15 

Scr# 909 
  0 ( UART Raspberry PI Zero - receive )
  1 HEX
  2 : UART-WAIT-READY
  3   BEGIN
  4     ?UART-BYTE-READY ?TERMINAL OR
  5   UNTIL
  6 ;
  7 \ simple wait for a specific string "SUP> "
  8 : UART-WAIT-PROMPT  ( -- )
  9   [CHAR] S UART-WAIT
 10   [CHAR] U UART-WAIT
 11   [CHAR] P UART-WAIT
 12   [CHAR] > UART-WAIT
 13         BL UART-WAIT
 14 ;
 15 DECIMAL -->

Scr# 910 
  0 ( UART Raspberry PI Zero - receive a block )
  1 \ Accept from I/O  up to n bytes and store them at a.
  2 CODE UART-RX-BURST ( t a n -- )
  3      di
  4      pop     DE|                   \ length counter
  5      Exx
  6      pop     hl|                   \ address
  7      pop     de|                   \ timeout
  8      ldx     bc|  UART-TX-PORT  NN,  \ 133Bh
  9 HERE                               \              a1
 10      decx    de|                   \ check timeout      \ 6
 11      ld      a'|  d|                                    \ 4
 12      ora      e|                                        \ 4
 13      jrf     z'|  HOLDPLACE        \              a1 a2 \ 7
 14      -->
 15 

Scr# 911 
  0 ( UART Raspberry PI Zero - receive a block )
  1      in(c)   a'|                  \ bit 0               \ 12
  2      rra                          \ non-zero when ready \  4
  3      jrf    nc'|  1 PICK BACK,    \ back to a1          \  7
  4      inc     b'|                  \ RX port 143Bh       \  4
  5      ini                          \ bc goes 133Bh       \ 16
  6      ld      a'| (hl)|                                  \  4
  7      anda     a|                  \ check for 0x00      \  4
  8      jrf     z'|  HOLDPLACE       \            a1 a2 a3 \  7
  9      exX                                                \  4
 10      Decx    DE|                  \ dec length counter  \  6
 11      Ld      A'|  D|                                    \  4
 12      Ora      E|                  \ check for zero      \  4
 13      Exx                                                \  4
 14 -->
 15 

Scr# 912 
  0 ( UART Raspberry PI Zero - receive a block )
  1 \ At 115200 Bauds bit duration is 8.68  micro-seconds
  2 \ a 512 bytes-buffer is filled in less than 4.45 ms.
  3 \ The 512 bytes burst-read takes 56832 T-states
  4 \ plus enter-exit time that at 28 MHz is about 2.03 ms
  5 \ so we emtpy the buffer  2 times faster than it fills up.
  6 \
  7      jrf    nz'|  1 PICK BACK,     \ repeat until done  \ 10
  8 HERE DISP,    \ a3
  9 HERE DISP,    \ a2
 10      DROP     \ a1
 11      exx
 12      ei
 13      jpix
 14      C;  -->
 15 

Scr# 913 
  0 ( UART Raspberry PI Zero - receive a block )
  1 HEX
  2 \
  3 CODE  DIS-INT
  4   F3 C,             \ di
  5   DD C, E9 C,       \ jp (ix)
  6 SMUDGE
  7 \   UART-TX-PORT P@ 1 AND
  8 CODE  ENA-INT
  9   FB C,             \ di
 10   DD C, E9 C,       \ jp (ix)
 11 SMUDGE
 12 \
 13 DECIMAL -->
 14 
 15 

Scr# 914 
  0 ( UART Raspberry PI Zero - receive a block )
  1 DECIMAL
  2 : UART-RX-CHUNK ( t a n -- )
  3   DIS-INT                          \ t a n
  4   ROT 0 DO                         \ a n
  5     UART-TX-PORT P@ 1 AND IF       \ a n f   wait ready
  6       SWAP UART-RX-PORT P@         \ n a b   accept byte
  7       ?DUP 0= IF LEAVE THEN        \ n a b   0x00 quits
  8       OVER C! 1+ SWAP 1-           \ a n     store & incr
  9       DUP 0= IF LEAVE THEN         \ a n     decr counter
 10     THEN
 11   LOOP                             \ a n
 12   2DROP                            \
 13   ENA-INT
 14 ;
 15 DECIMAL -->

Scr# 915 
  0 ( UART Raspberry PI Zero - block receive )
  1 DECIMAL
  2 \ receive 1K to Screen n
  3 : UART-RECEIVE    ( n -- )
  4   B/SCR * DUP 1+ SWAP
  5   BLOCK B/BUF -1 UART-RX-CHUNK
  6   BLOCK B/BUF -1 UART-RX-CHUNK
  7 ;
  8 \ prepare Screen # n to accept data from UART burst read
  9 : UART-SCREEN  ( n -- )
 10   B/SCR *       DUP 1+
 11   BLOCK B/BUF BLANK
 12   BLOCK B/BUF BLANK
 13 ;
 14 DECIMAL -->
 15 

Scr# 916 
  0 ( UART Raspberry PI Zero - send a command )
  1 \ send a string
  2 HEX
  3 : UART-SEND ( a n -- )
  4   BOUNDS DO
  5     I C@ UART-TX
  6   LOOP
  7   0D UART-TX
  8 ;
  9 \
 10 HERE
 11 ," perl --help"
 12 CONSTANT CMD
 13 DECIMAL -->
 14 
 15 

Scr# 917 
  0 ( UART Raspberry PI Zero )
  1 -->
  2 
  3 
  4 
  5 
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 918 
  0 ( UART Raspberry PI Zero )
  1 -->
  2 
  3 
  4 
  5 
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 919 
  0 ( UART Raspberry PI Zero )
  1 -->
  2 
  3 
  4 
  5 
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 920 
  0 ( UART Raspberry PI Zero - simple terminal )
  1 HEX   \ map special Symbol-Shift Keys
  2 HERE  \ stop not step to then and or
  3 E2 C, C3 C, CD C, CC C, CB C, C5 C, C5 C, 0C C,
  4  CONSTANT TKB1
  5 HERE  \  ~    |   \   {  }    [   ]
  6 7E C, 7C C, 5C C, 7B C, 7D C, 5B C, 5D C, 08 C,
  7  CONSTANT TKB2
  8 \
  9 : MAP-KEYB ( c -- )
 10   >R TKB2 TKB1 8 R> (MAP)
 11   DUP 6 = IF 8 5C6A TOGGLE THEN  \ handle caps-lock
 12 ;
 13 DECIMAL -->
 14 
 15 

Scr# 921 
  0 ( UART Raspberry PI Zero - simple terminal )
  1 HEX
  2 : TERM0-INIT   ( -- )
  3   0 LASTK C! 0 5C6A C! 0D UART-TX
  4   6 1E EMITC EMITC  \ narrow font
  5   HEX
  6 ;
  7 : TERM0-DONE
  8   8 01E EMITC EMITC \ normal font
  9   DECIMAL
 10 ;
 11 HEX
 12 -->
 13 
 14 
 15 

Scr# 922 
  0 ( UART Raspberry PI Zero - simple terminal )
  1 : TERM0
  2   TERM0-INIT
  3   BEGIN
  4     LASTK C@ ?DUP IF
  5       MAP-KEYB  DUP UART-TX  0 LASTK C!
  6     \ 0D = IF CR 0 2 BLOCK B/BUF UART-RX-BURST THEN
  7     THEN
  8     ?UART-BYTE-READY IF UART-RX
  9       DUP 80 < 0= IF INVV THEN 7F AND  \ force ascii 7-bits
 10       DUP 20 < IF INVV DUP . THEN      \ non-printable
 11       DUP 0D - IF EMIT THEN TRUV       \ ignore CR
 12     THEN
 13   ?TERMINAL UNTIL TERM0-DONE
 14 ;
 15 DECIMAL -->

Scr# 930 
  0 ( UART Raspberry PI Zero - testing )
  1 \ DONE 900 LOAD
  2   DECIMAL 115.200 PI0-SELECT
  3   UART-SEND-ETX
  4   UART-SEND-EOT
  5   UART-WAIT-PROMPT
  6   TERM0
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 931 
  0 ( UART Raspberry PI Zero - testing )
  1 38000 CONSTANT T
  2 : TEST1
  3   2 BLOCK B/BUF BLANK  3 BLOCK B/BUF BLANK
  4   4 BLOCK B/BUF BLANK  5 BLOCK B/BUF BLANK
  5 \ 23672 @
  6   CMD COUNT UART-SEND
  7   10 UART-WAIT
  8   T 2 BLOCK B/BUF   UART-RX-BURST
  9   T 3 BLOCK B/BUF   UART-RX-BURST
 10   T 4 BLOCK B/BUF   UART-RX-BURST
 11   T 5 BLOCK B/BUF   UART-RX-BURST
 12 \ 23672 @
 13   2 list
 14 ;
 15 DECIMAL

Scr# 932 
  0 ( UART Raspberry PI Zero - testing )
  1 10000 CONSTANT T
  2 : TEST2
  3   2 BLOCK B/BUF BLANK  3 BLOCK B/BUF BLANK
  4   4 BLOCK B/BUF BLANK  5 BLOCK B/BUF BLANK
  5 \ 23672 @
  6   CMD COUNT UART-SEND
  7   10 UART-WAIT
  8   T 2 BLOCK B/BUF   UART-RX-CHUNK
  9   T 3 BLOCK B/BUF   UART-RX-CHUNK
 10   T 4 BLOCK B/BUF   UART-RX-CHUNK
 11   T 5 BLOCK B/BUF   UART-RX-CHUNK
 12 \ 23672 @
 13   2 list
 14 ;
 15 DECIMAL

Scr# 940 
  0 ( DOT-RELATIVE + FILENAME" )
  1 \ Given an address, compute the relative address from $2000
  2 : DOT-RELATIVE ( a1 -- a2 )
  3   HERE SWAP - [ HEX ] 2000 + \
  4 ; DECIMAL
  5 \
  6 0 VARIABLE FH       FH !
  7 \ accept volatile filename at PAD
  8 : FILENAME" ( -- )  \
  9   [CHAR] " WORD COUNT    \ a+1 n
 10   TUCK OVER + 0          \ n a+1 a+n+1 0
 11   SWAP !                 \ n a+1
 12   PAD ROT 1+             \ a+1 pad n+1
 13   CMOVE ;
 14 -->
 15 

Scr# 941 
  0 ( SAVE-BYTES TEST )
  1 \ save bytes to filename held in PAD
  2 \ create new file, error if it already exists
  3 \ PAD is volatile
  4 : SAVE-BYTES ( a n -- )
  5   PAD DUP 10 - 06 F_OPEN          \ a n u f
  6   41 ?ERROR                       \ a n u
  7   DUP FH ! F_WRITE                \ m f
  8   47 ?ERROR                       \ m
  9   DROP FH @ F_CLOSE               \ f
 10   42 ?ERROR
 11 ;
 12 \ filename" prova.txt"
 13 \ PAD 64 save-bytes
 14 
 15 

Scr# 942 
  0 ( UART Raspberry PI Zero )
  1 NEEDS ASSEMBLER
  2 \
  3 MARKER DONE
  4 \
  5 HEX 5C08 CONSTANT LASTK          \ system variable
  6     143B CONSTANT UART-RX-PORT
  7     133B CONSTANT UART-TX-PORT
  8     153B CONSTANT UART-CT-PORT
  9 -->
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 943 
  0 ( UART Raspberry PI Zero - setup )
  1 : COMP-PRE-SCALAR ( clock -- bh bl )
  2   1152 ROT M/                 \
  3   DUP  7F AND C,              \ uart-rx-port p! #1
  4   7 RSHIFT 80 OR C,           \ uart-rx-port p! #2
  5 ;
  6 DECIMAL -->
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 946 
  0 ( variables )
  1 VARIABLE MAIN-PROG   \
  2 VARIABLE MAP-KEYB    \ a:chr
  3 VARIABLE CAPS-LOCK   \ a:chr
  4 VARIABLE GET-VIDEO-TIMING   ( -- a:0-7 )
  5 -->
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 947 
  0 ( .python )
  1 Create ORG Assembler
  2   jp MAIN-PROG
  3 -->
  4 
  5 
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 948 
  0 ( UART Raspberry PI Zero - setup )
  1 \ Table of actual clock speeds depending on video mode
  2 \ These are double precision integers you can read with 2@
  3 HERE
  4 DECIMAL \ values are divided by 100 to better handle them
  5  28.0000 comp-pre-scalar \ Base VGA timing   28 MHz
  6  28.5714 comp-pre-scalar \ VGA setting 1     28.571.429 Hz
  7  29.4643 comp-pre-scalar \ VGA setting 2     29.464.286 Hz
  8  30.0000 comp-pre-scalar \ VGA setting 3     30 MHz
  9  31.0000 comp-pre-scalar \ VGA setting 4     31 MHz
 10  32.0000 comp-pre-scalar \ VGA setting 5     32 MHz
 11  33.0000 comp-pre-scalar \ VGA setting 6     33 MHz
 12  27.0000 comp-pre-scalar \ Digital           27 MHz
 13 CONSTANT SYS-CLK-ARY
 14 DECIMAL -->
 15 

Scr# 949 
  0 ( UART Raspberry PI Zero - simple terminal )
  1 HEX   \ map special Symbol-Shift Keys
  2 HERE  \ stop not step to then and or
  3 E2 C, C3 C, CD C, CC C, CB C, C5 C, C5 C, 0C C,
  4  CONSTANT TKB1
  5 HERE  \  ~    |   \   {  }    [   ]
  6 7E C, 7C C, 5C C, 7B C, 7D C, 5B C, 5D C, 08 C,
  7  CONSTANT TKB2
  8 \
  9 : MAP-KEYB ( c -- )
 10   >R TKB2 TKB1 8 R> (MAP)
 11   DUP 6 = IF 8 5C6A TOGGLE THEN  \ handle caps-lock
 12 ;
 13 DECIMAL -->
 14 
 15 

Scr# 950 
  0 ( MAP-KEYB )
  1 HERE MAP-KEYB !  ( a:chr -- a:chr )
  2   ldx  hl|   TKB1  NN,
  3   ldn  bc|   8  N,
  4   ldn  de|   8  N,
  5   cpir
  6   jrf nz'|   HOLDPLACE
  7     addhl de|
  8     decx  hl|
  9     sbchl bc|
 10     ld  a'|  (hl)|
 11   HERE DISP,
 12   ret
 13 -->
 14 
 15 

Scr# 951 
  0 ( CAPS-LOCK )
  1 HERE CAPS-LOCK !  ( a:chr )
  2   cpn  06   N,
  3   jrf  nz'|  HOLDPLACE
  4     lda()  hex  5C6A  AA, ( FLAGS )
  5     xorn  08  N,
  6     ld()a  hex  5C6A  AA,
  7   HERE DISP,
  8   ret
  9 -->
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 952 
  0 ( VIDEO-TIMING )
  1 HERE GET-VIDEO-TIMING ! ( -- a:0-7 )
  2   \ read video timing register 0-7
  3   ldx    bc|   hex 243B NN,
  4   ld     a'|   hex 11  N,
  5   out(c) a'|
  6   inc    b'|
  7   in(c)  l'|
  8   ret
  9 -->
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 953 
  0 ( UART-SELECT )
  1 HERE UART-SELECT !
  2   \ select PI-ZERO UART control port
  3   ldx    bc|  UART-CT-PORT  NN,
  4   ldn    a'|  hex 40  N,
  5   out(c) a'|
  6   call   GET-VIDEO-TIMING
  7   ldn    h'|  0  N,
  8   addhl  hl|
  9   ldx    de|  SYS-CLK-ARY  NN,
 10   addhl  de|
 11 -->
 12 
 13 
 14 
 15 

Scr# 954 
  0 ( UART-SELECT )
  1   ldx    bc|  UART-RX-PORT  NN,
  2   ld     a'|  (hl)|
  3   out(c) a'|
  4   incx   hl|
  5   ld     a'|  (hl)|
  6   out(c) a'|
  7 \ PI Pheripheal enable
  8   ldn    a'| hex 30 N,
  9   nextrega hex A0  P,
 10   ret
 11 
 12 
 13 
 14 
 15 

Scr# 960 
  0 ( traverse heap )
  1 variable dir-base
  2 $2002 dir-base !
  3 : trav-heap ( p -- )
  4   dir-base
  5   begin
  6     @  \ dup u.
  7     dup cell+ dir-last @ = >R
  8     far
  9     dup cell+ 1+ 8 dump
 10     key drop ?terminal
 11     R> OR
 12   until
 13 ;
 14 
 15 

Scr# 961 
  0 ( dir sort )
  1 : dir-sort ( -- )
  2   here dir-save-dp @ do
  3     i 2+ @ far i @ far 64 (compare) 0<
  4     if  i @ 2+ i @ i 2+ ! i !  then
  5   2 +loop ;
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 962 
  0 ( combsort gap tester )
  1 : test
  2   begin
  3     dup .
  4   \ 10 13 */
  5     dup dup + + 2 rshift   \ 3/4
  6   dup not
  7   ?terminal or
  8   until
  9   drop
 10 ;
 11 
 12 
 13 
 14 
 15 

Scr# 989 
  0 ( AY  Sound )
  1 AYsetup
  2   binary 00110100 HEX 7 AY!
  3    03f 0 AY!!      00 6 AY!      0F 8 AY!
  4    097 0 AY!!      00 6 AY!      0A 8 AY!
  5    100 0 AY!!      00 6 AY!      06 8 AY!
  6    000 0 AY!!      1f 6 AY!      04 8 AY!
  7    000 0 AY!!      11 6 AY!      04 8 AY!
  8    04C 0 AY!!      00 6 AY!      0A 8 AY!
  9    07E 0 AY!!      00 6 AY!      07 8 AY!
 10    0C9 0 AY!!      1f 6 AY!      04 8 AY!
 11    100 0 AY!!      11 6 AY!      04 8 AY!
 12    000 0 AY!!      00 6 AY!      02 8 AY!
 13 0ff 7 AY!     decimal
 14 
 15 

Scr# 990 
  0 ( AY  Sound )
  1 NEEDS BINARY  NEEDS SPLIT  NEEDS ms
  2 \
  3 \ ayreg must be between 0 and 13
  4 : AY!     ( b ayreg -- )
  5   [ HEX ] FFFD P! BFFD P! ;
  6 \
  7 \ ayreg is 0, 2 or 4 for channel A, B or C
  8 : AY!!     ( n ayreg -- )
  9   >R SPLIT R@ AY! R> 1+ AY! ;
 10 \
 11 DECIMAL -->
 12 
 13 
 14 
 15 

Scr# 991 
  0 ( AY  Sound )
  1 : AYSETUP
  2   \ setup mapping of chip channels to stereo channels
  3   [ HEX    ] 8 REG@
  4   [ BINARY ] 00000010 OR  \ enable NextSound
  5   [ HEX    ] 8 REG!
  6   [ HEX    ] 9 REG@
  7   [ BINARY ] 11100000 OR  \ enable Mono for A,B and C
  8   [ HEX    ] 9 REG!
  9   \ enable left-right audio, select AY2
 10   [ BINARY ] 11111101  [ HEX ] 0FFFD P!
 11 ;
 12 -->
 13 
 14 
 15 

Scr# 992 
  0 ( AY  Sound )
  1 : SHH     [ HEX ] FF 7 AY!
  2   0 8 ay! 0 9 ay! 0 A ay! ;
  3 : PLAY
  4    1F 8 AY!  \ A full volume
  5   1ff 0 AY!! \ A freq
  6    0f 9 ay!  \ B
  7   1ff 2 ay!! \ B
  8    0F A AY!  \ C
  9   1ff 4 AY!! \ C
 10    ff 7 - 7 AY!
 11 ;
 12 decimal
 13 -->
 14 
 15 

Scr# 993 
  0 ( AY  Sound )
  1 : gunshot
  2    [ hex ]  0fa0  0B  AY!!    \ quite long envelope period
  3    11  06  AY!                \ noise period
  4    [ binary ] 00101111 [ hex ] 7 AY!  \ B noise
  5    00  0D  AY!      \ shape |\__
  6    1F  09  AY!      \ chanel B volume
  7 ;
  8 decimal
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 994 
  0 ( AY  Sound )
  1 : DT 20 MS ;
  2 : AYFRAME ( a -- )
  3   [ BINARY ] 00000000 [ HEX ] 7 AY!
  4    03f 2 AY!!    00 6 AY!    0F 9 AY!  DT
  5    097 2 AY!!    00 6 AY!    0A 9 AY!  DT
  6    100 2 AY!!    00 6 AY!    06 9 AY!  DT
  7    000 2 AY!!    1f 6 AY!    04 9 AY!  DT
  8    000 2 AY!!    11 6 AY!    04 9 AY!  DT
  9    04C 2 AY!!    00 6 AY!    0A 9 AY!  DT
 10    07E 2 AY!!    00 6 AY!    07 9 AY!  DT
 11    0C9 2 AY!!    1f 6 AY!    04 9 AY!  DT
 12    100 2 AY!!    11 6 AY!    04 9 AY!  DT
 13    000 2 AY!!    00 6 AY!    02 9 AY!  DT
 14 FF 7 AY! ; DECIMAL
 15 

Scr# 996 
  0 ( ?break )
  1 code ?break
  2   exx
  3   ldx   bc|   hex 7ffe nn,
  4   in(c) d'|
  5   ld    b'|   c|  \ fefe
  6   in(c) a'|
  7   ora    d|
  8   rra
  9   ccf
 10   sbchl hl|
 11   push  hl|
 12   exx
 13   next
 14   c;
 15 

Scr# 997 
  0 ( Sound )
  1 needs binary
  2 binary 11111101 \ enable left-right audio, select AY1
  3 hex 0fffd p!
  4 binary 00010010 8 reg! \ use ABC, enable internal speaker
  5 binary 11100000 9 reg! \ enable mono for AY1-3
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 998 
  0 ( Layer2 Clip Example )
  1 needs GRAPHICS
  2 hex
  3  1 1C REG!  \ reset clip window reg index
  4 20 18 REG!  \ X1 position
  5 C0 18 REG!  \ X2 position
  6 30 18 REG!  \ Y1 position
  7 A0 18 REG!  \ Y2 position
  8 layer2 4 list key layer12
  9 hex
 10 00 18 REG!  \ X1 position
 11 H-RANGE 1- 18 REG!  \ X2 position
 12 00 18 REG!  \ Y1 position
 13 V-RANGE 1- 18 REG!  \ Y2 position
 14 layer2 4 list key layer12
 15 

Scr# 999 
  0 ( Sinus )
  1 sinus definitions
  2 : sin ( grad -- sinus )
  3   dup >r            \ n
  4   abs 360 mod       \ r
  5   dup 180 > if 180 -  -1  else   0   then >r
  6   dup  90 > if 180 swap - then
  7   sinus@
  8   r> +- \     if negate then
  9   r> +- \  0< if negate then
 10 ;
 11 : cos 90 + sin ;
 12 : tan dup sin swap cos 10000  swap */    ;
 13 
 14 
 15 

Scr# 1000 
  0 ( custom KEY )
  1 HEX 5C08 CONSTANT LAST-K
  2 : KEYPRESS
  3   0 LAST-K C!
  4   BEGIN
  5     LAST-K C@
  6   UNTIL
  7   LAST-K C@
  8 ;
  9 DECIMAL
 10 -->
 11 
 12 
 13 
 14 
 15 

Scr# 1001 
  0 ( at. ink. paper. )
  1 : at. 22 emitc swap emitc emitc ;
  2 : ink. 16 emitc emitc ;
  3 : paper. 17 emitc emitc ;
  4 -->
  5 : los
  6   begin
  7   keypress
  8   .
  9   ?terminal
 10   until
 11 ;
 12 
 13 
 14 
 15 

Scr# 1002 
  0 ( test )
  1 -->
  2 0 value wert
  3 : isr-test
  4   23672 ( frames ) @ 7 and 0=
  5   if
  6     wert 1 + to wert
  7     0 0 at. wert .
  8   then ;
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 1003 
  0 ( plot layer2 )
  1 hex
  2 : pixeladd ( x y --   )  \ x: vertical  y:horizontal
  3   over FF and 5 rshi t   \ divide x by 32
  4   12 reg@ 2* + mmu7!     \ fit correct 8K page
  5   swap 1F and            \ x mod 32
  6   8 lshift +             \ turn it high byte part
  7   E000 or
  8 ;
  9 hex
 10 : plot  ( x y c -- )     \ x: vertical  y:horizontal
 11   -rot over 8 lshift over +
 12   C000 U< if pixeladd c! else drop 2drop then
 13 ;
 14 decimal -->
 15 

Scr# 1004 
  0 ( plot layer2 )
  1 needs J needs CHOOSE needs LAYERS
  2 layer2 1 paper. 216 ink.
  3 : pause0
  4   begin ?terminal until ;
  5 -->
  6 : test
  7   LAYER2
  8   100 0 do
  9     0C0 0 do
 10       FF choose
 11       i j pixeladd c!
 12     loop
 13   loop
 14   pause0
 15   LAYER12 ;

Scr# 1005 
  0 ( draw-line )
  1 \ draw a line using LAYER 2 mode
  2 \
  3 needs VALUE  needs TO needs +TO
  4 needs 2OVER  needs DNEGATE
  5 needs LAYERS
  6 \
  7 0    value dx       \ x-distance between P1 and P2
  8 0    value dy       \ y-distance between P1 and P2
  9 0    value sx       \ x-direction from P1 to P2
 10 0    value sy       \ y-direction from P1 to P2
 11 0    value err      \ error at each stage
 12 255  value color
 13 \
 14 -->
 15 

Scr# 1006 
  0 ( draw-line )
  1 : draw-line        ( x2 y2 x1 y1 c -- )
  2   to color   rot swap                   ( x2 x1 y2 y1 )
  3   \ determines sx, dx, sy, dy and err
  4   2over -  1 over +- to sx  abs to dx
  5   2dup  -  1 over +- to sy  abs negate to dy
  6   dx dy + to err
  7   swap -rot                             ( x2 y2 x1 y1 )
  8   begin
  9     2dup 256 u< swap 192 u< and  >R     \ pixel in range?
 10     \ plot current pixel and...
 11     2dup color plot 2over 2over         \ x2 y2 x1 y1 x2 y2
 12     \ check if final pixel is reached
 13     rot - -rot - or  R> AND      \ x2 y2 x1 y1 y1-y2|x2-x1|f
 14 -->
 15 

Scr# 1007 
  0 ( draw-line )
  1   while
  2     err dup + >R                   \ x2 y2 x1 y1  R:2err
  3     R@ dy < not if
  4       dy +to err swap sx + swap
  5     then
  6     R> dx > not if
  7       dx +to err      sy +
  8     then
  9     ?terminal if 2drop 2drop exit then
 10   repeat
 11   2drop color plot
 12 ;
 13 
 14 
 15 

Scr# 1008 
  0 ( draw-line example )
  1 LAYER2
  2 000 255  000 000  255      draw-line
  3 000 255  191 255  255      draw-line
  4 191 000  191 255  255      draw-line
  5 191 000  000 000  255      draw-line
  6 191 255  000 000  255      draw-line
  7 191 000  000 255  255      draw-line
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 1009 
  0 ( beep example )
  1 needs beep   needs speed!
  2 0 SPEED!
  3 1000 0 beep
  4 1000 2 beep
  5 1000 4 beep
  6 1000 5 beep
  7 1000 7 beep
  8 1000 9 beep
  9 1000 11 beep
 10 1000 12 beep
 11 3 SPEED!
 12 
 13 
 14 
 15 

Scr# 1010 
  0 ( D+ )
  1 needs assembler
  2 code 12/mod ( n -- rem quot )
  3   pop     hl|       \ h1
  4   xora     a|       ld h'| a|  ld e'| a|
  5   ld      a'|   l|
  6   ldn     d'|   12  N,
  7 here
  8   inc     e'|    suba  d|
  9   jrf    nc'|    back,
 10   adda     d|    dec e'|
 11   ld      d'|    h|    ld l'| a|
 12   push    hl|
 13   push    de|
 14   jpix
 15 c;

Scr# 1011 
  0 ( mouse test )
  1 NEEDS INTERRUPT
  2 HEX 0FBDF P@ VARIABLE mouse-x      mouse-x !
  3 HEX 0FFDF P@ VARIABLE mouse-y      mouse-y !
  4 HEX 0FADF P@ VARIABLE mouse-s      mouse-s !
  5 000 VARIABLE mouse-dx              mouse-dx !
  6 000 VARIABLE mouse-dy              mouse-dy !
  7 00F VARIABLE mouse-ds              mouse-ds !
  8 : mouse-read
  9   0FBDF P@ DUP mouse-x C@ - mouse-dx ! mouse-x C!
 10   0FFDF P@ DUP mouse-y C@ - mouse-dy ! mouse-y C!
 11   0FADF P@ DUP mouse-s C@ - mouse-ds ! mouse-s C!
 12 ;
 13 ' mouse-read INT-W !
 14 
 15 

Scr# 1012 
  0 ( mouse test )
  1 NEEDS AT.
  2 : display
  3   0 0 AT. HEX
  4   mouse-x  @ 6 .R mouse-y  @ 6 .R mouse-s  @ 6 .R CR
  5   mouse-dx @ 6 .R mouse-dy @ 6 .R mouse-ds @ 6 .R
  6 ;
  7 \
  8 : monitor
  9   begin
 10    display ?terminal
 11   until
 12 ;
 13 
 14 
 15 

Scr# 1013 
  0 ( FLIP )
  1 CODE FLIP ( n1 -- n2 ) \ exchange hi-lo bytes
  2   hex
  3   E1 C,  \ pop  hl
  4   7D C,  \ ld   a,l
  5   6C C,  \ ld   l,h
  6   67 C,  \ ld   h,a
  7   E5 C,  \ push hl
  8   DD C, E9 C, \ jp (ix)
  9 SMUDGE DECIMAL
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 1015 
  0 ( Bresenhams' Circle )
  1 needs layers
  2 needs value needs to needs +to
  3 \
  4 0 value cx \ xc
  5 0 value cy \ yc
  6 0 value sx \  x
  7 0 value sy \  y
  8 0 value color
  9 0 value diff
 10 \
 11 -->
 12 
 13 
 14 
 15 

Scr# 1016 
  0 ( Bresenhams' Circle )
  1 : circle-draw ( -- )
  2   to sy   to sx
  3   cx sx + cy sy + color plot
  4   cx sx - cy sy + color plot
  5   cx sx + cy sy - color plot
  6   cx sx - cy sy - color plot
  7   cx sy + cy sx + color plot
  8   cx sy - cy sx + color plot
  9   cx sy + cy sx - color plot
 10   cx sy - cy sx - color plot
 11   ?terminal if quit then
 12 ;
 13 -->
 14 
 15 

Scr# 1017 
  0 ( Bresenhams' Circle )
  1 : circle ( xc yc r c -- )
  2   to color   0 to sx   to sy   to cy   to cx
  3   3  sy 2* - to diff   sx sy draw-circle
  4   begin
  5     1 +to sx
  6     diff 0< if
  7       sx 4 * 6 + +to diff
  8     else
  9       -1 +to sy
 10       sx sy - 4 * 10 + +to diff
 11     then
 12     sx sy draw-circle
 13   sy sx < until
 14 ;
 15 

Scr# 1018 
  0 ( Bresenhams' Circle )
  1 : test
  2   200 0 do
  3     100 100 i i circle
  4   4 +loop
  5 ;
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 1020 
  0 ( AY-3-8910 )
  1 hex : AY-CTRL  0FFFD P! ;
  2     : AY-DATA  0BFFD P! ;
  3 decimal
  4 needs ms needs binary
  5 create Frequency
  6 22000 , 23308 ,     \ A and A#
  7 24694 ,             \ B
  8 26163 , 27718 ,     \ Middle C and C#
  9 29366 , 31113 ,     \ D and D#         \ 293.33 Hz
 10 32963 ,             \ E                \ 330.00 Hz
 11 34923 , 36999 ,     \ F and F#
 12 39200 , 41530 ,     \ G and G#
 13 -->
 14 
 15 

Scr# 1021 
  0 ( AY-3-8910 )
  1 decimal
  2 07  AY-ctrl         \ select mixer register
  3 111100  AY-data     \ enable A and B
  4 01  AY-ctrl         \ channel A coarse pitch
  5 04  AY-data         \
  6 03  AY-ctrl         \ channel B coarse pitch
  7 04  AY-data
  8 08  AY-ctrl         \ channel C volume
  9 15  AY-data         \ maximum
 10 09  AY-ctrl
 11 15  AY-data
 12 200 ms 200 ms 200 ms 200 ms
 13 07  Ay-ctrl
 14 255 AY-data
 15 

Scr# 1022 
  0 ( AY-3-8910 )
  1 \ Regs   Bits  Function
  2 \ -----  ----  ------------------------
  3 \  0-1    12   Channel A pitch
  4 \  2-3    12   Channel B pitch
  5 \  4-5    12   Channel C pitch
  6 \  6       5   Noise Pitch
  7 \  7       8   Mixer - - - - - - - - 0  Tone A
  8 \  8       4   Channel A volume      1  Tone B
  9 \  9       4   Channel B volume      2  Tone C
 10 \ 10       4   Channel C volume      3  Noise A
 11 \ 11-12   12   Envelope duration     4  Noise B
 12 \ 13       4   Envelope shape        5  Noise C
 13 \ 14       8   I/O port A            6  I/O A
 14 \ 15       8   I/O port B            7  I/O B
 15 -->

Scr# 1034 
  0 ( mod65537 )
  1 : mod7     ( d -- n )
  2   begin
  3     [ -65537. ] dliteral D+
  4   dup 0< until
  5   [ +65537. ] dliteral D+
  6   drop
  7 ;
  8 : modt    ( d -- n )
  9   2dup - >R - R> +-
 10 ;
 11 
 12 
 13 
 14 
 15 

Scr# 1035 
  0 ( RND tester )
  1 needs graphics needs rnd
  2 decimal  23670 constant SEED
  3 : next 1+ ?dup if 75 um* 2dup U< if - else - 1- then
  4                else -75 then ;
  5 : tester
  6   256 0 do
  7     256 0 do
  8   \   RND DUP 9 rshift 24 + swap 511 and
  9     SEED @ next      SEED ! SEED @ 9 rshift 24 + seed @ 511 and
 10       plot  \  2dup point if quit then plot
 11     loop
 12     ?terminal if leave then
 13   loop
 14 ;
 15 

Scr# 1036 
  0 ( RND tester )
  1 needs graphics   needs RND   needs J  HEX
  2 : loader
  3   60 40 do
  4     i MMU7! FFFF E000 do
  5       RND DUP 9 rshift 18 + swap 1ff and
  6       i ! i 2+ !
  7     4 +loop
  8   loop
  9 ;
 10 : tester
 11   60 40 do FFFF E000 do
 12     j mmu7!  i 2+ @ i @ plot
 13   4 +loop loop
 14 ;
 15 

Scr# 1037 
  0 ( RND )
  1 : I-NEXT ( n1 -- n2 )
  2   1+ 75 UM* - 1-
  3 ;
  4 
  5 
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 1038 
  0 ( Example: RND Test )
  1 needs rnd   needs graphics  needs split  needs j
  2 : TEST
  3   192 0 do
  4     -1 rnd    split
  5     to attrib
  6     i swap plot
  7     ?TERMINAL IF LEAVE THEN
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 1039 
  0 ( CHOOSE - Brodie )
  1 DECIMAL
  2 23670 CONSTANT SYS-SEED
  3 : RANDOM
  4   SYS-SEED @ 31421 *
  5   6927 + DUP SYS-SEED !
  6 ;
  7 : CHOOSE ( u1 -- u2 )
  8   RANDOM UM* NIP
  9 ;
 10 \
 11 : RANDOMIZE
 12   SYS-SEED ! ;
 13 
 14 
 15 

Scr# 1040 
  0 .(            RND ) CR
  1 DECIMAL
  2 23670 CONSTANT SYS-SEED
  3 \ gives a pseudo-random
  4 \ between 0 and n
  5 : RND ( n -- rnd(n)
  6   1+ SYS-SEED @
  7   8191 UM* \ it was U*
  8   1.  D+
  9   16381 UM/MOD
 10   DROP DUP SYS-SEED !
 11   SWAP MOD ;
 12 \
 13 : RANDOMIZE
 14   SYS-SEED ! ;
 15 

Scr# 1100 
  0 ( L11-pixeladd )
  1 needs assembler
  2 code tt
  3   exx
  4   pop   hl|         \ horizontal
  5   pop   de|         \ vertical
  6   ld    a'|  e|
  7   subn  hex  30 n,
  8   jrf  nc'|  holdplace
  9   addn  hex  30 n,
 10 here disp,
 11   ld    e'|  a|
 12   ldn   a'|  hex 0B n,
 13   sbcn  hex  00 n,
 14   -->
 15 

Scr# 1101 
  0 ( L11-pixeladd )
  1 \
  2   nextrega   hex 57 p,
  3   sla    l|
  4   srl    e|
  5   rr     l|
  6   ldn   a'|  hex E0 n,
  7   ora    e|
  8   ld    h'|  a|
  9   push  hl|
 10   exx
 11   Next
 12   C;
 13 
 14 
 15 

Scr# 1111 
  0 ( fm/mod )
  1 marker task needs I'
  2 : fm/mod ( d n -- r q )
  3   2dup xor >R >R              \ d       \ x n
  4   dabs R@ abs um/mod swap     \ q r
  5   I' 0< 1 and +               \ q r
  6   R> +- swap                  \ +r q    \ x
  7   R@ 0< 1 and +               \ +r +q
  8   R> +-
  9 ;
 10  10.  7  fm/mod swap . .  cr
 11 -10.  7  fm/mod swap . .  cr
 12  10. -7  fm/mod swap . .  cr
 13 -10. -7  fm/mod swap . .  cr
 14 
 15 

Scr# 1112 
  0 ( test )
  1 needs testing
  2 needs evaluate
  3 \ interp. state
  4 : ge1 s" 123" ; immediate
  5 : ge2 s" 123 1+" ; immediate
  6 : ge3 s" : ge4 345 ;" ;
  7 : ge5 evaluate ; immediate
  8 t{ ge1 evaluate -> 123 }t
  9 t{ ge2 evaluate -> 124 }t
 10 t{ ge3 evaluate ->     }t
 11 t{ ge4          -> 345 }t
 12 -->
 13 
 14 
 15 

Scr# 1113 
  0 ( test )
  1 \ compile state
  2 t{ : ge6 ge1 ge5 ; -> }t
  3 t{ ge6 -> 123 }t
  4 t{ : ge7 ge2 ge5 ; -> }t
  5 t{ ge7 -> 124 }t
  6 : ge8 s" : ge9 678 ;" evaluate ;
  7 t{ ge8 -> }t
  8 t{ ge9 -> 678 }t
  9 \
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 1114 
  0 ( test )
  1  needs s"
  2  needs evaluate
  3 \
  4 cr ." loading 14 "
  5   : test S" include  test0.f " evaluate ;
  6   test
  7 cr ." loaded 14 "
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 1115 
  0 ( test )
  1 needs evaluate
  2 cr ." loading 15 "
  3 : str     S" 16 load test16 " ;
  4 : test15  S" : tt str ; tt evaluate " evaluate ;
  5 cr ." loaded  15
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 1116 
  0 ( test )
  1 needs evaluate
  2 needs view
  3 cr ." loading 16 "
  4 : test16
  5   cr  ." this is test16 "
  6   S"  view  test2.f" evaluate
  7   cr  ." done    test16 "
  8 ;
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 1118 
  0 ( RND )
  1   ld     a'|  d|
  2   addhl,a           \ HLE is  (hl+1)*75
  3   ld     d'|  l|
  4   ld     l'|  h|
  5   xora    a|
  6   ld     h'|  a|
  7   exdehl
  8   sbchl  de|
  9   ldx    de| -1  NN,
 10   adchl  de|
 11   push   hl|
 12   jpix
 13   c;
 14 
 15 

Scr# 1601 
  0 ( test )
  1 needs Assembler
  2 code test
  3   pop     hl|
  4   ld      a'|  h|
  5   andn    hex 0c0  N,
  6   ldx     hl|  0000  NN,
  7   jrf     z'|  holdplace
  8   decx    hl|
  9 here DISP,
 10   push    hl|
 11   Next
 12   C;
 13 
 14 
 15 

Scr# 1602 
  0 ( test )
  1 needs Assembler
  2 code test
  3   pop     hl|
  4   ld      a'|  h|
  5   orn     hex 01F  N,
  6   inc     a'|
  7   ldx     hl|  0000  NN,
  8   jrf     z'|  holdplace
  9   decx    hl|
 10 here DISP,
 11   push    hl|
 12   Next
 13   C;
 14 
 15 

Scr# 1615 
  0 latest -- smudge   immediate (;code)   does>    -find
  1           :noname  marker   hide-word  recurse  ay  mouse
  2           code     mose
  3 -find  -- context  (find)  2find
  4 code
  5 <name  --
  6 >body  -- :noname  see   value to   defer   interrupts floating
  7 LFA    -- :noname  see   set-fence  words   hide-word
  8 CFA    -- :noname  see   recurse    .word   interrupts
  9 PFA    --      recurse   value to   words   hide-word
 10 NFA    -- :noname  see   .vocab     .word   rename
 11 
 12 
 13 
 14 
 15 

Scr# 1616 
  0 ( DP and HP model )
  1 Dictionary
  2   xt-2   --> heap pointer to name
  3   xt     --> that is actual machine code or CALL aa
  4   xt+3   --> in which case the definition follows
  5 
  6 Heap
  7   nfa    --> byte + name, same current format
  8   lfa    --> link to previous heap entry
  9   lfa+2  --> xt
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 1617 
  0 ( h-latest )
  1 \
  2 NEEDS HEAP
  3 \
  4 : latest current @ @ FAR ;
  5 -->
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 1618 
  0 ( heap dictionary )
  1 \
  2 : >BODY ( xt  -- pfa )
  3   3 + ;
  4 \
  5 : CFA   ( pfa -- xt  )
  6   3 - ;
  7 \
  8 : <NAME ( xt  -- nfa )
  9   cell- @ FAR ;
 10   \ 3 - -1 traverse ;
 11 -->
 12 
 13 
 14 
 15 

Scr# 1619 
  0 ( heap dictionary )
  1 \
  2 : NFA ( pfa -- nfa )
  3   CFA
  4   <NAME ;
  5 \
  6 : LFA ( pfa -- lfa )
  7   NFA
  8   1 traverse 1+ ;
  9 \
 10 : PFA ( nfa -- pfa )
 11   1 traverse
 12   3 + @ >BODY ;
 13 \
 14 -->
 15 

Scr# 1620 
  0 ( heap dictionary )
  1 needs HEAP  HEX
  2 : CODE
  3   here                             \ a
  4   dup c@ width @ min 1+            \ a  n
  5       dup allot                    \ a  n
  6       dup negate >R 4 + >R         \ a       R: -n  4+n
  7   dup 00A0 toggle                  \ a
  8   here 1- 0080 toggle              \ a
  9   latest , dup cell+ ,             \ a    compile hlfa and xt
 10   R@ HEAP dup current @ !          \ a  hp   R: -n  4+n
 11   FAR R> cmove                     \
 12   R> negate allot
 13   current @ ,
 14 ;
 15 

Scr# 1621 
  0 ( heap dictionary )
  1 : (;code)
  2 
  3 
  4 
  5 
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 1998 
  0 ( SHADOW SCREEN )
  1 needs assembler
  2 code demo
  3   ldx   hl|  $5800 nn,
  4   nextreg $52 p, 10 n,
  5   ld  (hl)'|     a|
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 1999 
  0 ( touch.f )
  1 : touch ( -- cccc )
  2   bl word count      \ a  n
  3   over + dup         \ a  n+a  n+a
  4   0 swap !           \ a  n+a
  5   [ 8 3 + ] literal  \ a  n+a  b
  6   f_open drop        \ fh
  7   f_close drop
  8 ;
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2022 
  0 ( Christmas Star )
  1 needs LAYERS
  2 4 constant m  variable x  variable y
  3 : XMAS* LAYER0 CR
  4   m 2* 1+ m 2* NEGATE DO
  5     i ABS  y !
  6     m 2* 1+ m 2* NEGATE DO
  7       i ABS  x !
  8       m  x @ <   m  y @ <  AND
  9       x @  y @   m  -   <   OR
 10       y @  x @   m  -   <   OR
 11       IF BL ELSE [CHAR] * THEN EMIT
 12     LOOP CR
 13   LOOP CR KEY
 14 ;
 15 

Scr# 2200 
  0 ( tutorial afx loader )
  1 \
  2 \ Screen from 2201 to 2344 are filled of afx files
  3 \ using each Block (from 4402 to 4682)
  4 \
  5   include tutorial/afx/zxgames.f
  6   include tutorial/afx/zxmsxdemo.f
  7   include tutorial/afx/streetsofrage.f
  8   include tutorial/afx/sfx-test.f
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2201 
  0 ( tutorial/afx/zxgames/arcanoid2_1.afx
  1   a # a # a # a # a #
  2 a # a # a # a # 
  3 
  4 
  5 
  6 
  7 
  8 ( tutorial/afx/zxgames/arcanoid2_2.afx
  9 #  # # # # #
 10  # # # # 
 11 
 12 
 13 
 14 
 15 

Scr# 2202 
  0 ( tutorial/afx/zxgames/arcanoid2_3.afx
  1  +Qw5[?
  2 Dj(Nt27]
  3 Ag%7]Ag
  4 %7]Ag%
  5   
  6 
  7 
  8 ( tutorial/afx/zxgames/arcanoid2_4.afx
  9 # %')+)GIKMOM
 10 GIKMOM
 11 
 12 
 13 
 14 
 15 

Scr# 2203 
  0 ( tutorial/afx/zxgames/arcanoid2_5.afx
  1 d  ]   M q  h a   Q u  l e
  2   U y  p i   Y }  t m 
  3 
  4 
  5 
  6 
  7 
  8 ( tutorial/afx/zxgames/captainfizz_1.afx
  9 ,BXn
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2204 
  0 ( tutorial/afx/zxgames/captainfizz_2.afx
  1 < h    Dp< h    Dp< h   
  2 Dp< h    Dp< h    Dp< h 
  3    Dp< h    Dp< h    Dp
  4 < h    Dp< h    D
  5 
  6 
  7 
  8 ( tutorial/afx/zxgames/captainfizz_3.afx
  9 v x { } ~ } | { y w u s q 
 10 q q q 
 11 
 12 
 13 
 14 
 15 

Scr# 2205 
  0 ( tutorial/afx/zxgames/captainfizz_4.afx
  1  Bp Bp Bp Bp B
  2 p Bp Bp
  3 
  4 
  5 
  6 
  7 
  8 ( tutorial/afx/zxgames/captainfizz_5.afx
  9      ~$ ~ ~ } } } |$ | | { { 
 10 { z$ z z y y y x$ x x w w w v$ v v
 11 u u u t$ t t s s s r$ r r q q q q$ 
 12 q q 
 13 
 14 
 15 

Scr# 2206 
  0 ( tutorial/afx/zxgames/clickmania_1.afx
  1 ( % # !          (x (z '} ' & & %
  2  % $ $ # # " " ! 
  3 
  4 
  5 
  6 
  7 
  8 ( tutorial/afx/zxgames/clickmania_2.afx
  9 
 .
,+*
)	('&%
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2207 
  0 ( tutorial/afx/zxgames/clickmania_3.afx
  1 o/d .Z .\ -_ -a ,d ,f +i +k *n *p )s )u (x (z '} ' & & %
  2  % $ $ # # " " ! 
  3 
  4 
  5 
  6 
  7 
  8 ( tutorial/afx/zxgames/clickmania_4.afx
  9  5 : ? D 5  D ? : 5 : 
 10 ? D 5 D ? : 5 : ? D 5 	D ? 
: 5 : ? D
 11  5 D ? : 5 : ? D 5 D ? : 5 : ? D 5 
 12 D ? : 5 : ? D 5 D ? : 
 13 
 14 
 15 

Scr# 2208 
  0 ( tutorial/afx/zxgames/clickmania_5.afx
  1 
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( tutorial/afx/zxgames/cybernoid_1.afx
  9 : ? D 5 D ? : 5 : ? D 5  D ? : 5 : 
 10 ? D 5 D ? : 5 : ? D 5 	D ? 
: 5 : ? D
 11  5 D ? : 5 : ? D 5 D ? : 5 : ? D 5 
 12 D ? : 5 : ? D 5 D ? : 
 13 
 14 
 15 

Scr# 2209 
  0 ( tutorial/afx/zxgames/cybernoid_10.afx
  1 # .  8  B 	 L E P ? Z 5 
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( tutorial/afx/zxgames/cybernoid_11.afx
  9 eJo	O/////,,,,,)	)	))	)
 10 	&&&&&&########"" "
 11 """" *- ))- i	)- ))- ))- )(- ((- h(-
 12  ((- ((- ''- ''- g'- 
 13 
 14 
 15 

Scr# 2210 
  0 ( tutorial/afx/zxgames/cybernoid_12.afx
  1 m2 -? 2 ? &             
  2               	  
  
  3                   
  4                   
  5     
  6 
  7 
  8 ( tutorial/afx/zxgames/cybernoid_2.afx
  9 a"- #$- %&- '(- )*- k,- --- --- --- --- m
 10 ,- ,,- ,,- ,,- ,,- k+- ++- ++- ++- +*- j
 11 *- **- **- **- ))- i	)- ))- ))- )(- ((- h(-
 12  ((- ((- ''- ''- g'- 
 13 
 14 
 15 

Scr# 2211 
  0 ( tutorial/afx/zxgames/cybernoid_3.afx
  1 { z ~ }                
  2               	  
  
  3                   
  4                   
  5     
  6 
  7 
  8 ( /sfx/zxgames/cybernoid_6.afx
  9 l , , , ,,=,^,,,+++$+E+f+++++
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2212 
  0 ( /sfx/zxgames/cybernoid_7.afx
  1                  
  2  
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxgames/cybernoid_8.afx
  9             
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2213 
  0 ( /sfx/zxgames/cybernoid_9.afx
  1 oH /S /B /] /8 /g /. /q /j /u .d . .Z . -P - - - - - -|
  2 , ,r , , , , , + + + + + + + + + + + + * * *
  3  ** ** *****)))3) )=)6)A)0)K)&)U))_
  4 (X(c(R(m(H(w(>((z((t('j''`''''''
  5 '''''''''''''&
  6 
  7 
  8 ( /sfx/zxgames/exolon_1.afx
  9 o   . - ,)R'{%
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2214 
  0 ( /sfx/zxgames/exolon_2.afx
  1 o~/{////..-8-Z,~+*)	(S'&1
  2 %$G#"!w
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxgames/exolon_3.afx
  9 m	
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2215 
  0 ( /sfx/zxgames/exolon_4.afx
  1 m   ,2 

  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxgames/exolon_5.afx
  9 *  - 2 5 < ? G P T _ d q         
 10 -Rf8Z$1pG
 11 G
 12 
 13 
 14 
 15 

Scr# 2216 
  0 ( /sfx/zxgames/exolon_6.afx
  1 nw /.w 

			
	


			
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxgames/exolon_7.afx
  9  / K w  / K w  / K w  / K w 
 10 / K w  / K w 
 11 
 12 
 13 
 14 
 15 

Scr# 2217 
  0 ( /sfx/zxgames/exolon_8.afx
  1 ( ? d  ( ? d  ( ? d  ( ? d  (
  2  ? d  ( ? d  
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxgames/fireandice_1.afx
  9    a I 7 *   
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2218 
  0 ( /sfx/zxgames/fireandice_2.afx
  1       w 
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxgames/fireandice_3.afx
  9 g  \  m g \  m g \  m g \  m g \  m g
 10  \  m g \ 
 11 
 12 
 13 
 14 
 15 

Scr# 2219 
  0 ( /sfx/zxgames/fireandice_4.afx
  1 n%7 `H0$i%  F
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxgames/fireandice_5.afx
  9 o- o na ?jUF94
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2220 
  0 ( /sfx/zxgames/fireandice_6.afx
  1             
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxgames/licensetokill_1.afx
  9 a 															
 10 				
 11 
 12 
 13 
 14 
 15 

Scr# 2221 
  0 ( /sfx/zxgames/licensetokill_2.afx
  1    ~ ~ } } { { z z y y x x 
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxgames/licensetokill_3.afx
  9 oW NMKJIHGFEDC BAA
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2222 
  0 ( /sfx/zxgames/licensetokill_4.afx
  1 n4
mV
lx
k
j
i

  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxgames/megatetris2k_1.afx
  9 `  X P @ ` X P @ ` X P @ ` X
 10 P @ ` X P @ ` X P @ 
 11 
 12 
 13 
 14 
 15 

Scr# 2223 
  0 ( /sfx/zxgames/megatetris2k_2.afx
  1 kp   p 
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxgames/megatetris2k_3.afx
  9 R  S U ^ R S U ^ R S U ^ R S
 10 U ^ 
 11 
 12 
 13 
 14 
 15 

Scr# 2224 
  0 ( /sfx/zxgames/megatetris2k_4.afx
  1 x  z | ~                 
  2          
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxgames/mineman2_1.afx
  9 n  )@,     - 
	%  
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2225 
  0 ( /sfx/zxgames/mineman2_2.afx
  1 i@. / n0  .1 -/ -. l- ,. k/ +0 *1 
*2 
i3 		(4 '5
  2  &6 &7 &8 &9 %: 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxgames/mineman2_3.afx
  9 k * Z h %  
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2226 
  0 ( /sfx/zxgames/mineman2_4.afx
  1 i0  	) 	*P 
* 
k + ,( , me - -: - -L - - -
  2  -a - ," , , , ,D , k2 
+ k' + j 
* 
iH
  3  	) 	i 	
  4 
  5 
  6 
  7 
  8 ( /sfx/zxgames/mineman2_5.afx
  9 k8++|+@++ + + +r +_ +P +G )r
 10 		)_ 		)P 		)G 		(r (_ (P (G &r &_ &P &G $r $_
 11  $P $G 
 12 
 13 
 14 
 15 

Scr# 2227 
  0 ( /sfx/zxgames/mkdemo_1.afx
  1 n  .
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxgames/mkdemo_2.afx
  9 ooFnn-mFll k jF h %
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2228 
  0 ( /sfx/zxgames/netherworld_1.afx
  1 momonmm
llkk
k	j
  2 
j
j

i		i	i		h
h	hggg	ff
  3 feeeddddd
  4 
  5 
  6 
  7 
  8 ( /sfx/zxgames/netherworld_2.afx
  9 mKo?nKmWmKl?lKkWkKk?jK
jW
jK
 10 
i?	iK	iW	hKh?hKgWgKg?fKfWfKe?
 11 eKeWdKd?dKdWdKd?dKdWdK
 12 
 13 
 14 
 15 

Scr# 2229 
  0 ( /sfx/zxgames/netherworld_3.afx
  1 m  ONMMLLKKKJ
J
J
I	I	I	HHHGG
  2 GFFFEEEDDDDDDDDDDDDDD
  3 DD
  4 
  5 
  6 
  7 
  8 ( /sfx/zxgames/netherworld_4.afx
  9 m l k js 
i 		h ( ( ( ' ' ' 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2230 
  0 ( /sfx/zxgames/netherworld_5.afx
  1 m?   Y 
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxgames/netherworld_6.afx
  9 gW g  
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2231 
  0 ( /sfx/zxgames/netherworld_7.afx
  1 L	d	
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxgames/netherworld_8.afx
  9 B     
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2232 
  0 ( /sfx/zxgames/netherworld_9.afx
  1 et j 
/r oD .p n -n m@ ,l l +j k< +h k
  2 +f k8 +d k 
*b 
j4 	
*` 
j 
*^ 
j0 
*\ 
j 
)Z 	i, 	)
  3 X 	i 	)V 	i( 	)T 	i 	(R h$ (P h|  (N   L x J
  4   H t F  D p B  @ l >  <
  5 h :  8 d 6 
  6 
  7 
  8 ( /sfx/zxgames/rainbowislands_1.afx
  9 z  n z n z n z n z n z n z n z n
 10 z n z 
 11 
 12 
 13 
 14 
 15 

Scr# 2233 
  0 ( /sfx/zxgames/rainbowislands_2.afx
  1         t \ P 8 , 
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxgames/rainbowislands_3.afx
  9   J  J  J  J 
 10  J 
 11 
 12 
 13 
 14 
 15 

Scr# 2234 
  0 ( /sfx/zxgames/rainbowislands_4.afx
  1 b       b      
  2 b  
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxgames/rodland_1.afx
  9 o` P@0        
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2235 
  0 ( /sfx/zxgames/rodland_2.afx
  1  
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxgames/rodland_3.afx
  9                   
 10    
 11 
 12 
 13 
 14 
 15 

Scr# 2236 
  0 ( /sfx/zxgames/rodland_4.afx
  1 p  ___
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxgames/rodland_5.afx
  9   __
` @     
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2237 
  0 ( /sfx/zxgames/rodland_6.afx
  1  dlDL$,     
  2   t | T \ 4 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxgames/saintdragon_1.afx
  9    ;B
: S y %0
 10 % q  	I 33 
 11 
 12 
 13 
 14 
 15 

Scr# 2238 
  0 ( /sfx/zxgames/saintdragon_2.afx
  1      X
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxgames/saintdragon_3.afx
  9 o
/
/E.P..@--! -# ,( /* .0 -4 ,< ,@ +K *Q
 10 )` )h 	)r )} ) ) ) 		( ( (,'N't'
 11 
 12 
 13 
 14 
 15 

Scr# 2239 
  0 ( /sfx/zxgames/saintdragon_4.afx
  1 o


		
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxgames/silkworm_1.afx
  9 q RSTV[^
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2240 
  0 ( /sfx/zxgames/silkworm_2.afx
  1  ____
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxgames/silkworm_3.afx
  9 

_\ZUR
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2241 
  0 ( /sfx/zxgames/silkworm_4.afx
  1 q RST________
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxgames/silkworm_5.afx
  9 \ZXVR
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2242 
  0 ( /sfx/zxgames/silkworm_6.afx
  1 o NJHONJHO
HOOOOO






  2 LKJIHGEEDDC
BA
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxgames/wizball_1.afx
  9   % + 1 7 = C I O U [ a g m s y     
 10           
 11 
 12 
 13 
 14 
 15 

Scr# 2243 
  0 ( /sfx/zxgames/wizball_2.afx
  1 #  < U n      6Oh  
 # <
  2 U n     
 # < U n     
 # 
  3 < U n     
 # < U n     
 #
  4  < U n     
 # < U n     
  5 # < U n     
 # < U n     
  6 
 # < U n     
 # < U 
  7 
  8 ( /sfx/zxgames/wizball_3.afx
  9  
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2244 
  0 ( /sfx/zxgames/wizball_4.afx
  1 X  ` h p x                
  2  # ( - ( #   
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxgames/wizball_5.afx
  9 _  Z U P K F U P d _ Z U d _ d _ Z U d _ d
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2245 
  0 ( /sfx/zxgames/wizball_6.afx
  1 c ^ Y T O J E J O T Y ^ c ^ Y c ^ Y T Y
  2 ^ c h m r m h c ^ Y T Y ^ c h m r m h c ^ 
  3 Y T Y ^ c h m r m h c ^ Y T Y ^ c h m r m h
  4  
  5 
  6 
  7 
  8 ( /sfx/zxgames/wizball_7.afx
  9  
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2246 
  0 ( /sfx/zxgames/wizball_8.afx
  1 +  . 1 4 7 : = @ C F I L O R U X [ ^ a d g
  2 j m p n l 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxgames/wizball_9.afx
  9 +  . 1 4 7 : = @ C F I L O R U X [ ^ a d g
 10 j m p n l j h f d b ` ^ \ Z X [ ^ a d g j 
 11 m p s v y | z x v t r p n l j h f d g j m p
 12  s v y |         ~ | z x v t r p s
 13 v y |         
 14 
 15 

Scr# 2250 
  0 ( /sfx/zxmsxdemo/aleste_1.afx
  1 
   r  e j Z B P 
  2 r G  e ?  Z 9  P 2  G -  ?
  3 (  9 # 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/aleste_10.afx
  9 ?  _   ?  _ 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2251 
  0 ( /sfx/zxmsxdemo/aleste_11.afx
  1 o /1. .- - ,,+ +* * 
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/aleste_12.afx
  9 oonm]l-kj
i	hha

 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2252 
  0 ( /sfx/zxmsxdemo/aleste_13.afx
  1  
` H ` H 
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/aleste_14.afx
  9  
`  ` H ` H 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2253 
  0 ( /sfx/zxmsxdemo/aleste_2.afx
  1  
 x e U G     r   x e U G  
  2   r _ P 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/aleste_3.afx
  9 o/. .` -0 - , , + * * 
..- -` +0 + * * * )
 10  ) 	,,+ +` *0 * ) ) ( ' ' ++* *` (0 ( ' ' '
 11  & & ))( (` '0 ' & & % $ $ ((' '` %0 % $
 12 $ $ # # &&% %` $0 $ # # " ! ! %%$ $` "0 "
 13  ! ! !      ##" "` !0 !            ""! !` 
 14 
 15 

Scr# 2254 
  0 ( /sfx/zxmsxdemo/aleste_4.afx
  1 n ..-]--,,+++a*?*))((
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/aleste_5.afx
  9 o  OOOO	O
OOOOO
 10 
 11 


	
	
	
	
	
	
	
	
 12 
	
	
	

	
				
 13        
 14                             
 15 

Scr# 2255 
  0 ( /sfx/zxmsxdemo/aleste_6.afx
  1   a     a I 7 *    
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/aleste_7.afx
  9   a I 7 *    
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2256 
  0 ( /sfx/zxmsxdemo/aleste_8.afx
  1   z  z \  ` H l Q = 
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/aleste_9.afx
  9 oL/~//.[.|.-:-f-K,,R,++>+**-*t*)
 10 )4)(((( 
 11 
 12 
 13 
 14 
 15 

Scr# 2257 
  0 ( /sfx/zxmsxdemo/druid_1.afx
  1 }M]	][[ [Y YYWWWUUU
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/druid_2.afx
  9 }M	]]	[[	YY	WW	UU	
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2258 
  0 ( /sfx/zxmsxdemo/druid_3.afx
  1 S|@g@    
  2    
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/druid_4.afx
  9 |@     j 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2259 
  0 ( /sfx/zxmsxdemo/druid_5.afx
  1 \gSgS            
  2 @S@S        @S
  3 @S        @S@S'W
  4 5u5uMM'W5
  5 u5uMM'W5u5uM
  6 M
  7 
  8 ( /sfx/zxmsxdemo/firebird_1.afx
  9 5  5  5  5  5  5  5  5 
 10  
 11 
 12 
 13 
 14 
 15 

Scr# 2260 
  0 ( /sfx/zxmsxdemo/firebird_10.afx
  1 m {  YZXm  y  \[Z	{   XZYX
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/firebird_11.afx
  9 @  P  	@  P  	@  P   
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2261 
  0 ( /sfx/zxmsxdemo/firebird_12.afx
  1 ( ) (  
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/firebird_13.afx
  9 h  ' )$ ( *$ ) +$ ) *$ ) *$ ( )$ ' ($ & '$ % &$ $ %$
 10 # $$ # #$  
 11 
 12 
 13 
 14 
 15 

Scr# 2262 
  0 ( /sfx/zxmsxdemo/firebird_14.afx
  1 %  @ % @   [      C    C  
  2   C  P 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/firebird_15.afx
  9 `  	L 	` 	L 	` 	L  
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2263 
  0 ( /sfx/zxmsxdemo/firebird_16.afx
  1 l"  +! j" 	l!  +  j! 	l   + j  	Hl  + j 	Hl  + j l
  2   + j ) l  
	* 	) 	( 	' 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/firebird_17.afx
  9 0  @ 	0 @ 	0 @ 	
 10 0 @ 	0 @ 	0 @  
 11 
 12 
 13 
 14 
 15 

Scr# 2264 
  0 ( /sfx/zxmsxdemo/firebird_18.afx
  1 E  @ E @ : 0 ( P E @ : 0 ( T J E @ : 0 ( 
  2  !  "  (   
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/firebird_19.afx
  9   E @ 8 1   1 P Q P   P 8 0   8 ( ) (  
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2265 
  0 ( /sfx/zxmsxdemo/firebird_2.afx
  1 |  h0  |  h0  	<   
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/firebird_20.afx
  9 }   ) ( z   
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2266 
  0 ( /sfx/zxmsxdemo/firebird_21.afx
  1 ln  -0,`+*k j0 )`('i 
h0 '`&%' &0%`$
  2 # 
  3 
  4 
  5 
  6 
  7 
  8 2AT9b8Jw|'Tb!Kk-e28C?
  9 .B.lNyh"jJP>y.('K5RFrMsjtsX
 10 m-3__b}-3S>WLTSW8eUUm9lzY
 11 pxq)CqD pS4AyR@|pn}mR
 12 qw]4Yz	363qB/iE>
/<Prt14k_
 13 <$;Qy!!<R~Q ay:g6PK9pLr]vK0;>
 14 ZDFIfx3yn";	f^}[[RA([VMP}4&
 15 
%'5YxCDbd5_yn:,'j$i$q>; R}-%

Scr# 2267 
  0 ( /sfx/zxmsxdemo/firebird_23.afx
  1 *  5 # $ # $ # $ # 
  2  
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/firebird_24.afx
  9 *  5 * 5 * # $ # $ # 
 10 $ # $ #  
 11 
 12 
 13 
 14 
 15 

Scr# 2268 
  0 ( /sfx/zxmsxdemo/firebird_25.afx
  1 m`  m0 - -0 l@  l  , ,  k0  k + + j0  
i 
  2 ( ' &0 %  
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/firebird_26.afx
  9 % @   [      C    C   
 10 C  P 
 11 
 12 
 13 
 14 
 15 

Scr# 2269 
  0 ( /sfx/zxmsxdemo/firebird_3.afx
  1      
  2  
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/firebird_4.afx
  9 m  	, j h v  U 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2270 
  0 ( /sfx/zxmsxdemo/firebird_5.afx
  1 z  m  *j+ +@l+* i 	)`	( h (( 
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/firebird_6.afx
  9 m 
. - . , 	`	)		)		* 

*

++p+*
 10  

) 		( ' &  
 11 
 12 
 13 
 14 
 15 

Scr# 2271 
  0 ( /sfx/zxmsxdemo/firebird_7.afx
  1 p
o 		@j `  		@j `
  2    
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/firebird_8.afx
  9 j: 
p J @ E 0 
	< : 0 
	< : 0 
	
 10 < : 0  
 11 
 12 
 13 
 14 
 15 

Scr# 2272 
  0 ( /sfx/zxmsxdemo/firebird_9.afx
  1 m m {   [Z ZZ ZZ ZZ ZZ ZZ ZZ ZZ ZZ ZZ ZY YW W
  2 V VU U 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/girlyblock_1.afx
  9 x  
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2273 
  0 ( /sfx/zxmsxdemo/girlyblock_10.afx
  1 o
///f/ ////f/ ////f/ /////f/
  2 ///....---,,++***
*)
  3 ))	(((''&&&&
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/girlyblock_11.afx
  9   <  <  <  <  < 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2274 
  0 ( /sfx/zxmsxdemo/girlyblock_12.afx
  1                    
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/girlyblock_13.afx
  9 f   			
	




	
			
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2275 
  0 ( /sfx/zxmsxdemo/girlyblock_14.afx
  1  Z 
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/girlyblock_15.afx
  9 o//                   > ///                   
 10  ///b                     //b/
 11  a///b
 12 
 13 
 14 
 15 

Scr# 2276 
  0 ( /sfx/zxmsxdemo/girlyblock_2.afx
  1     y   q x  k q x d j p _ d j Z _ d
  2 U Z _ P U Z K O S G K O B F J ? B F < ? B 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/girlyblock_3.afx
  9 j  j j j j j j j j j j
 10  j j j j 
 11 
 12 
 13 
 14 
 15 

Scr# 2277 
  0 ( /sfx/zxmsxdemo/girlyblock_4.afx
  1 o?//j// / / /r 
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/girlyblock_5.afx
  9 o[ .,.,+F,[+)+)(F)[(&(&%F&[%$
 10 &%$F
 11 
 12 
 13 
 14 
 15 

Scr# 2278 
  0 ( /sfx/zxmsxdemo/girlyblock_6.afx
  1 o 
. -H /$ /" .  . - - , , +r**c)j)k(l(U'V&Q &
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/girlyblock_7.afx
  9 o-
.- /.- ,` +0 * ( & $ 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2279 
  0 ( /sfx/zxmsxdemo/girlyblock_8.afx
  1 o	
//~.	..~-	-,~,	,+~+	+*~*	))~)	((~
  2 (	''~&	&&~
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/girlyblock_9.afx
  9 o	
//~/	//~/	/.~.	..~.	..~.	--~-	--~
 10 -	--~,	,,~,	,,~,	,+~+	++~+	++~+	**~*
 11 	**~*	**~)	))~)	))~)	)(~(	((~(	((~(
 12 	''~'	''~'	''~&	&&~&	&&~&	&&~
 13 
 14 
 15 

Scr# 2280 
  0 ( /sfx/zxmsxdemo/metalgear_1.afx
  1 v  Z]
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/metalgear_10.afx
  9 ~   =   =  
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2281 
  0 ( /sfx/zxmsxdemo/metalgear_11.afx
  1 n
,( ..,( .,p;  
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/metalgear_12.afx
  9 ~  
>  |  
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2282 
  0 ( /sfx/zxmsxdemo/metalgear_13.afx
  1 }   =   }   ]]]]]Z ZZZZZW W
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/metalgear_14.afx
  9 ~  ]\^^^
 10 ^]\
 11 Y
 12 
 13 
 14 
 15 

Scr# 2283 
  0 ( /sfx/zxmsxdemo/metalgear_2.afx
  1 0Pp0   P  0Pp0   P
  2   
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/metalgear_3.afx
  9 P  P  P  P  P  P  P  P    
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2284 
  0 ( /sfx/zxmsxdemo/metalgear_4.afx
  1 k@    HrY !Fp   
  2   
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/metalgear_5.afx
  9 j
,0+(   
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2285 
  0 ( /sfx/zxmsxdemo/metalgear_6.afx
  1 }  
]]]]]]]
]]
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/metalgear_7.afx
  9 P  @  h   @  h  
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2286 
  0 ( /sfx/zxmsxdemo/metalgear_8.afx
  1 P8  
  2   
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/metalgear_9.afx
  9 i   			)! 	)" 	*# 
*$ 
*% 
+& +' +( +) ,* ,+ ,, ,- ,. -
 10 / -0   
 11 
 12 
 13 
 14 
 15 

Scr# 2287 
  0 ( /sfx/zxmsxdemo/nemesis_1.afx
  1 P T X ` T X ` P T X ` T X ` X ` X ` 
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/nemesis_10.afx
  9 o  
. -/  . -, o% / / . .* -  - ,
 ,% + + * ** *
 10  ) )
 )% ) 
 11 
 12 
 13 
 14 
 15 

Scr# 2288 
  0 ( /sfx/zxmsxdemo/nemesis_11.afx
  1 jP
+P,PnP
      lP-P.P	oR

      lP	- 
.P
  2 oR

  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/nemesis_12.afx
  9  
   @   ` 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2289 
  0 ( /sfx/zxmsxdemo/nemesis_13.afx
  1   
 p 0P`o.-o-+. ,@
  2 *




(' &@%$
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/nemesis_14.afx
  9    p 0P``  p 0P``  
 10 p 0P``  p 0P``  p 
 11 0P`
 12 
 13 
 14 
 15 

Scr# 2290 
  0 ( /sfx/zxmsxdemo/nemesis_15.afx
  1                  q U G B
  2 G B G B G B G B G B G B G B 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/nemesis_16.afx
  9             x  x p x p h
 10 p h ` h \ 
 11 
 12 
 13 
 14 
 15 

Scr# 2291 
  0 ( /sfx/zxmsxdemo/nemesis_17.afx
  1  @  ` @    @  ` @    @ 
  2 ` @    @  ` @    @  ` @    
  3 @  ` @   
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/nemesis_18.afx
  9 o / / . . . - , o // .. .- -/ /@
 10 ..- ,@,+* 




)@
 11 		('& 
 12 
 13 
 14 
 15 

Scr# 2292 
  0 ( /sfx/zxmsxdemo/nemesis_19.afx
  1 P T P T X ` T X ` P T X ` T X ` X ` X ` 
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/nemesis_2.afx
  9 @ X x    8 `    H   H 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2293 
  0 ( /sfx/zxmsxdemo/nemesis_20.afx
  1          
  2      
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/nemesis_3.afx
  9 P T X ` T X ` P T X ` T X ` X ` X ` 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2294 
  0 ( /sfx/zxmsxdemo/nemesis_4.afx
  1 @  @  @@@  @@ @@@@ @
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/nemesis_5.afx
  9   `   `   ` 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2295 
  0 ( /sfx/zxmsxdemo/nemesis_6.afx
  1 :?g  j e j e   T    
  2   k 5 k 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/nemesis_7.afx
  9 @ P p  @ P p 0 @ 0 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2296 
  0 ( /sfx/zxmsxdemo/nemesis_8.afx
  1 `  `    @@   `    @@ 
  2  ` 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/nemesis_9.afx
  9           @   @ 
 10    @    @   
 11 
 12 
 13 
 14 
 15 

Scr# 2297 
  0 ( /sfx/zxmsxdemo/penguinadventure_1.afx
  1 x  W
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/penguinadventure_10.afx
  9 5 , / *  ! 2 #  5 
 10 , / *  ! 2 #  / 5 , 
 11 % / 5 , % *  ! 2 #  / * 
 12  ( * 
 13 
 14 
 15 

Scr# 2298 
  0 ( /sfx/zxmsxdemo/penguinadventure_11.afx
  1 |   ^]\[[[[[[[[
[[[[[ 
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/penguinadventure_12.afx
  9         w f U 	     z i X 
 10 	     ~ m \ 	      
 11 
 12 
 13 
 14 
 15 

Scr# 2299 
  0 ( /sfx/zxmsxdemo/penguinadventure_2.afx
  1 {   Z
X	z  XV
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/penguinadventure_3.afx
  9 wfw
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2300 
  0 ( /sfx/zxmsxdemo/penguinadventure_4.afx
  1 V U V n m n o p I H I 8	X W X W X p
  2 o p q r K 8	Y Z Y Z [ r s t s N 8
  3 ] ^ ] ^ ] ^ w v w S T 3 T 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/penguinadventure_5.afx
  9 V U V n m n m n I H I 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2301 
  0 ( /sfx/zxmsxdemo/penguinadventure_6.afx
  1  p w b P C 	C 	C 
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/penguinadventure_7.afx
  9 C X F J O U \ 	D G K P V ] 	E H L Q
 10 W ^ 
 11 
 12 
 13 
 14 
 15 

Scr# 2302 
  0 ( /sfx/zxmsxdemo/penguinadventure_8.afx
  1 }  [ ZYX^ \[ZY	z   [ZY	x   YXW
  2 	v   WVU
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/penguinadventure_9.afx
  9 o` {  YZXo  y  \[Z	{   XZYX	y
 10  VXWV
 11 
 12 
 13 
 14 
 15 

Scr# 2303 
  0 ( /sfx/zxmsxdemo/treasureofusas_1.afx
  1   @  * : p @  * : U @  
  2 * : U @  * : U @  * : U
  3 @  * 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/treasureofusas_2.afx
  9 j (  -- ,    l , , -    l 	, 
   k + 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2304 
  0 ( /sfx/zxmsxdemo/treasureofusas_3.afx
  1 @ : @ D J 
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/treasureofusas_4.afx
  9 m kj 
k, k%j 
i*	
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2305 
  0 ( /sfx/zxmsxdemo/treasureofusas_5.afx
  1 ` j ` j e ` P S T U V Z 
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/vampirekiller_1.afx
  9 H V H V H V H V 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2306 
  0 ( /sfx/zxmsxdemo/vampirekiller_10.afx
  1 Y=  4  
  2 4  4  
  3 4
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/vampirekiller_11.afx
  9 ~  ^^^^^^^^^^^^^^3  w  3  w  3
 10  w  3  w  3 . ) $     3 - ' !   
 11  	 w     7W3 - ' !    	 w   
 12   7W3 - ' !    w    3 - ' !  
 13  	 
 14 
 15 

Scr# 2307 
  0 ( /sfx/zxmsxdemo/vampirekiller_12.afx
  1 ~  ^^^^^^^^^^^^^
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/vampirekiller_13.afx
  9 P 5   P 5   P 5   P 5   
 10 P 5 
 11 
 12 
 13 
 14 
 15 

Scr# 2308 
  0 ( /sfx/zxmsxdemo/vampirekiller_14.afx
  1 ( p ` @   ( p ` @   
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/vampirekiller_15.afx
  9 I b 2 % l Q < -   I b 2 % l Q < -   
 10     
 11 
 12 
 13 
 14 
 15 

Scr# 2309 
  0 ( /sfx/zxmsxdemo/vampirekiller_16.afx
  1 P `  P `      P `   P `      P
  2  `   P `      P `   P `      P
  3  `   
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/vampirekiller_17.afx
  9 3  w 3  w  3  w  3  w  3  w  3 .
 10 ) $     3 - ' !    	 w     7
 11 W3 - ' !    	 w     7W3 - ' ! 
 12    w    3 - ' !    	 
 13 
 14 
 15 

Scr# 2310 
  0 ( /sfx/zxmsxdemo/vampirekiller_18.afx
  1  F   F  F  F  F P         f
  2 U D 3 "  
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/vampirekiller_19.afx
  9         - < Q l %
 10 2 b I 
 11 
 12 
 13 
 14 
 15 

Scr# 2311 
  0 ( /sfx/zxmsxdemo/vampirekiller_2.afx
  1     __^^]
]\
[
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/vampirekiller_20.afx
  9 n .0 . . .` .P .@ .0 -  - -P -@ ,0 ,  , ,
 + +@ +0 *  *
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2312 
  0 ( /sfx/zxmsxdemo/vampirekiller_3.afx
  1  p0P``p 0P` 
  2 p  P``p 0P`
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/vampirekiller_4.afx
  9 f U D f U D 3 " C ; 3 + #  w f U w f U D
 10 ? 0 (   g W G 7  w f U w f U D o _ O ? 
 11 
 12 
 13 
 14 
 15 

Scr# 2313 
  0 ( /sfx/zxmsxdemo/vampirekiller_5.afx
  1 D   D   D   D   D   D   D  
  2 D   D   D   D   D   D   D   
  3 D   D   
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/vampirekiller_6.afx
  9 U 3  U 3 U 3  U 3  U 3  U 3  U 3  U
 10 3  U 3  U 3  U 3  U 3  U 3  U 3  U 
 11 3  U 3  U 3  U 3 
 12 
 13 
 14 
 15 

Scr# 2314 
  0 ( /sfx/zxmsxdemo/vampirekiller_7.afx
  1 ,,,,,
  2 ,
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/vampirekiller_8.afx
  9   _^Z]Y]^
^\_^
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2315 
  0 ( /sfx/zxmsxdemo/vampirekiller_9.afx
  1 p p   _X^
\[
\\
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/zanac_1.afx
  9 j B          
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2316 
  0 ( /sfx/zxmsxdemo/zanac_10.afx
  1 H 6 )  
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/zanac_11.afx
  9  `  ` 0  
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2318 
  0 ( /sfx/zxmsxdemo/zanac_3.afx
  1 e e e e e e e e e e e
  2 e e e e e e e e e e 
  3 e e e e e e e e e e e 
  4 e e e e e e e e e e e
  5 e e e e e 
  6 
  7 
  8 ( /sfx/zxmsxdemo/zanac_4.afx
  9 C    y  l  `  V  l 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2319 
  0 ( /sfx/zxmsxdemo/zanac_5.afx
  1 o //A///5/.,* (
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/zanac_6.afx
  9 o/////w/b/M.8.$......---z-i-X
 10 -G-6-&,,,,,,,,++++t+g+Z+M+@*3*'*
 11 *****))))))))((y(p(g(^(U(L(C
 12 ':'2'*'"'''
'&&&&&&&&%%%%%
 13 %%%$$$$$z$u$p$k
 14 
 15 

Scr# 2320 
  0 ( /sfx/zxmsxdemo/zanac_7.afx
  1  V +  L &  V +  L &  V +  L &  V +
  2  L &  V +  L &  V +  L &  V +  L & 
  3  V +  L &  V +  L &  V +  L &  V + 
  4  L &  V +  L &  V +  L &  V +  L & 
  5 
  6 
  7 
  8 ( /sfx/zxmsxdemo/zanac_8.afx
  9 o




						
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2321 
  0 ( /sfx/zxmsxdemo/zanac_9.afx
  1 _  
  2 
  3 
  4 
  5 
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2323 
  0 ( /sfx/streetsofrage_2/noname003.afx
  1 z
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/streetsofrage_2/noname004.afx
  9 ______________________________
 10 _^^]]\\[[ZZYYXXWWVVUUTTSSRRQQ
 11 
 12 
 13 
 14 
 15 

Scr# 2324 
  0 ( /sfx/streetsofrage_2/noname005.afx
  1 y
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/streetsofrage_2/noname006.afx
  9 6
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2325 
  0 ( /sfx/streetsofrage_2/noname007.afx
  1 wWXXYYZZ[[\\]]^^__^^]]\\[
  2 [ZZYYXXWWVVUUTTSSRRQQ
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/streetsofrage_2/noname008.afx
  9 {z
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2326 
  0 ( /sfx/streetsofrage_2/noname009.afx
  1  { { { { {
  2  { { { {
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/streetsofrage_2/noname010.afx
  9 _
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2327 
  0 ( /sfx/streetsofrage_2/noname011.afx
  1 }
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/streetsofrage_2/noname012.afx
  9 P{{_^{~^]
 10 {}]\{|\[{{
 11 [Z{zZY{yYX{
 12 xXW{wWV{vVU
 13 {uUT{tTS{sSR
 14 {rRQ{qQ
 15 

Scr# 2328 
  0 ( /sfx/streetsofrage_2/noname013.afx
  1  P{|\ P{yY P{vV P
  2 {sS
  3 
  4 
  5 
  6 
  7 
  8 0y+W3)6[}sl
c~j	JdM{V[
  9 2NFwAtAFy-n&L 'vWJto^NP@Y
 10 
8Khg#\+Q*ZYfo<ge~}f 
 11 E%kiCR>'(plBOK>@LI*Ixt>KZlzYSt
 12 edW()&%c$"TU<,Cb2--}	V4
 13 -zR9#(lu'W[VyS2{5H3CR3(0p<M9 #
 14 EbHBE7_,|u'LbSffQ]moHC_aJd>
 15 {z6zc";hf'	oMB2ViY^J qp&|R

Scr# 2329 
  0 ( /sfx/streetsofrage_2/noname015.afx
  1 w
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/streetsofrage_2/noname016.afx
  9 w
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2330 
  0 ( /sfx/streetsofrage_2/noname017.afx
  1 } > c O B 7 } > c O B 7 } > c O
  2 B 7 } > c O B 7 } > c O B 7 } >
  3 c O B 7 } > c O B 7 
  4 
  5 
  6 
  7 
  8 ( /sfx/streetsofrage_2/noname018.afx
  9 ) 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2331 
  0 ( /sfx/streetsofrage_2/noname019.afx
  1    m<     y <  
  2    y <     y <    
  3  y 
  4 
  5 
  6 
  7 
  8 ( /sfx/streetsofrage_2/noname020.afx
  9 7 5 2 0 - +       7 5 2 0 - +   
 10    7 5 2 0 - +       7 5 2 0 - + 
 11       7 5 2 0 - +       7 5 2 0
 12  - +       7 5 2 0 - +       
 13 
 14 
 15 

Scr# 2332 
  0 ( /sfx/streetsofrage_2/noname021.afx
  1   . } . { . y
  2  . w . u . s . 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/streetsofrage_2/noname022.afx
  9 x
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2333 
  0 ( /sfx/streetsofrage_2/noname023.afx
  1 
  2 
  3 
  4 
  5 
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2336 
  0 ( /sfx/test/test2.afx
  1 on@5g		8	 i	
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/test/test3.afx
  9 ?    DDL  ~ d d  .`
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2337 
  0 ( /sfx/test/test4.afx
  1 e   
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/test/test5.afx
  9 o n  I 0 !  
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2338 
  0 ( /sfx/test/test6.afx
  1 ik  		G / k G / k G / k G / k
  2 G / k G / k G / k G / k G
  3  / 
  4 
  5 
  6 
  7 
  8 ( /sfx/test/test7.afx
  9 o NLJIh g & e
 e d c b) "E ag 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2339 
  0 ( /sfx/test/test8.afx
  1               
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/test/test9.afx
  9 %  
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2340 
  0 ( /sfx/test/test11.afx
  1  h  x h  x 
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/test/test12.afx
  9 Z  x  Z x  Z x  Z x  
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2341 
  0 ( /sfx/test/test13.afx
  1 h @ @         
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/test/test14.afx
  9 o2    H2   F5F5F
 10 5
 11 
 12 
 13 
 14 
 15 

Scr# 2342 
  0 ( /sfx/test/test15.afx
  1 T  D < : T D < : T D < : 
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/test/test16.afx
  9 o> NMMk% Jh> HGFd% Df> EDCb% A
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2343 
  0 ( /sfx/test/test17.afx
  1 2  K 2 % 
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/test/test18.afx
  9     u w y k G k G k G 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2344 
  0 ( /sfx/test/test19.afx
  1 \ Z
  2 
  3 
  4 
  5 
  6 
  7 
  8 ( /sfx/test/test10.afx
  9 h   h  h  h  h  h  h
 10   h  h
 11 
 12 
 13 
 14 
 15 

Scr# 2350 
  0 ( AFX demo )
  1 \
  2    include  forum/aydemo.f
  3 \
  4 \
  5 \ setup interrupt routine
  6 \
  7    isr-off
  8    ' afxframe isr-xt !
  9    isr-on
 10 \
 11 
 12 
 13 
 14 
 15 

Scr# 2351 
  0 ( AFX demo )
  1 \
  2 \ echo example
  3 \
  4    decimal isr-on
  5    4516 0 play-block
  6     60 ms
  7    4516 1 play-block
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2380 
  0 filename" L2_10_1113.bin" hex 10 mmu7! print1 save-page
  1 filename" L2_10_1311.bin" hex 10 mmu7! print2 save-page
  2 filename" L2_11_1113.bin" hex 11 mmu7! print1 save-page
  3 filename" L2_11_1311.bin" hex 11 mmu7! print2 save-page
  4 
  5 
  6 
  7 
  8    [CHAR] I OF  NROW @ INS ENDOF  \ insert row from PAD
  9    [CHAR] D OF  NROW @ D   ENDOF  \ delete row + copy to PAD
 10    [CHAR] N OF  1 SCR +! HOMEC ENDOF  \ next screen
 11    [CHAR] B OF -1 SCR +! HOMEC ENDOF  \ prev screen
 12   [CHAR] Z OF  UNDO ENDOF
 13   ENDCASE CLS PUTPAGE EDIT-FRAME ;
 14 -->
 15 

Scr# 2872 
  0     CR DECIMAL U. HEX U.
  1        DECIMAL U. HEX U.
  2   LOOP
  3   2DROP
  4 ;
  5 
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 2873 
  0 ( CHOOSE - Brodie )
  1 DECIMAL
  2 23670 CONSTANT SYS-SEED
  3 : RANDOM
  4   SYS-SEED @ 31421 *
  5   6927 + DUP SYS-SEED !
  6 ;
  7 : CHOOSE ( u1 -- u2 )
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 3333 
  0 ( disk free )              needs f_getfree
  1 : df ( d -- )
  2   ?dup if
  3     dup 29 > if     nip 3 /        0    [char] G
  4              else   200 um/mod nip 0    [char] M  then
  5   else
  6     5 um* over 9995 swap u<
  7              if    1024 um/mod nip 0   [char] M
  8              else                      [char] K  then
  9   then >R
 10   <# # [char] . hold #s #> type space R> emit
 11 ;
 12 
 13 
 14 
 15 

Scr# 3916 
  0 RS loading error.
  1 Cannot open stream.
  2 Error at postit time.
  3 Inconsistent fixup.
  4 Unexpected fixup/commaer.
  5 Commaer data error.
  6 Commaer wrong order.
  7 Programming error.
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 3918 
  0     CR DECIMAL U. HEX U.
  1        DECIMAL U. HEX U.
  2   LOOP
  3   2DROP
  4 ;
  5 
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 3968 
  0 x     xxx x xxx x xxx x xxx x xxx x xxx x xxx x xxx x xxx x xxx
  1 x xxx x xxx x xxx x xxx x xxx x xxx x xxx x xxx x xxx x xxx x xx
  2 x x xxx x xxx x xxx x xxx x xxx x xxx x xxx x xxx x xxx x xxx x
  3 xxx x xxx x xxx x xxx x xxx x xxx x xxx x xxx x xxx x xxx x xxx
  4 x xxx x xxx x xxx x xxx x xxx x xxx x xxx x xxx x xxx x xxx x xx
  5 x x xxx x xxx x xxx x xxx x xxx x xxx x xxx x xxx x xxx x xxx x
  6 xxx x xxx x xxx x xxx x xxx x xxx x xxx x xxx x xxx x xxx x xxx
  7 x xxx x xxx x xxx x xxx x xxx x xxx x xxx x xxx x xxx x xxx x xx
  8 x     x xxx x x xxxxxxx x x xxx x x x xxx xxx x xxx x x x xxx x
  9 xxx xxx x x x xxx x x xxxxx x xxx xxx x x x xxx x x x xxxxx x x
 10 xxxxx x x xxx x x xxxxx xxx x xxx x x x xxx xxxxx xxx x x x xxx
 11 x x xxxxx x x x xxx x x x xxx x xxx xxx x x x xxxxx x x xxxxx x
 12 x xxx xxx x xxx x x xxxxx x xxx xxx x x x xxx xxx xxxxx x x x xx
 13 x x x x xxx x x x xxx x x x xxxxx xxx xxx x x x xxx xxx x xxxxx
 14 x x xxx x xxx xxx x x xxxxx x x xxxxx x x x xxx xxx x xxx x x x
 15 xxx x x x xxxxx x x xxx x x x xxx xxxxx xxx x x x xxx x xxx xxxx

Scr# 3969 
  0 x     x x x x xxx x x x xxx x x x x xxx x x x x x xxx x x xxx x
  1 x x x x x x xxx xxx x x x x x x x x x xxx x x x x x x x x x xxx
  2 xxx x x x x x x x xxx x x xxx x x x x x xxx x x x x xxx x x x xx
  3 x x x x x x x xxx x xxx x x x x x x x x xxxxx x x x x x x x x x
  4 xxxxx x x x x x x x x xxx x xxx x x x x x x xxx x x x xxx x x x
  5 x xxx x x x x x xxx x x xxx x x x x x x x xxx xxx x x x x x x x
  6 x x xxx x x x x x x x x x xxx xxx x x x x x x x xxx x x xxx x x
  7 x x x xxx x x x x xxx x x x xxx x x x x x x xxx x xxx x x x x x
  8 x     xxxxx x x x x x x x x x xxxxx x x x x x x x x xxx x xxx x
  9 x x x x x xxx x x x xxx x x x x xxx x x x x x xxx x x xxx x x x
 10 x x x x xxx xxx x x x x x x x x x xxx x x x x x x x x x xxx xxx
 11 x x x x x x x xxx x x xxx x x x x x xxx x x x x xxx x x x xxx x
 12 x x x x x xxx x xxx x x x x x x x x xxxxx x x x x x x x x x xxxx
 13 x x x x x x x x x xxx x xxx x x x x x x xxx x x x xxx x x x x xx
 14 x x x x x x xxx x x xxx x x x x x x x xxx xxx x x x x x x x x x
 15 xxx x x x x x x x x x xxx xxx x x x x x x x xxx x x xxx x x x x

Scr# 3970 
  0 x
  1                                             x
  2 
  3                                     x
  4 
  5                             x
  6 
  7                     x
  8 
  9             x                               x
 10 
 11     x                               x
 12                                                             x
 13                             x
 14                                                     x
 15                     x

Scr# 3971 
  0      x            x            x            x            x
  1       x     x      x            x            x            x
  2        x            x            x  x         x            x
  3     x   x            x            x            x            x
  4          x            x     x      x            x           xx
  5           x            x            x            x            x
  6            x        x   x            x            x x          x
  7             x            x            x            x
  8             x                               x
  9 
 10     x                               x
 11                                                             x
 12                             x
 13                                                     x
 14                     x
 15                                             x

Scr# 3972 
  0             x
  1                                     x
  2     x
  3                             x                               x
  4 
  5                     x                               x
  6 
  7             x                               x
  8 
  9     x                               x
 10                                                             x
 11                             x
 12                                                     x
 13                     x
 14                                             x
 15             x

Scr# 3973 
  0 
  1     x
  2                                                             x
  3 
  4                                                     x
  5 
  6                                             x
  7 
  8 x
  9                                                             x
 10 
 11                                                     x
 12 
 13                                             x
 14 
 15                                     x

Scr# 3974 
  0 x
  1                             x                               x
  2 
  3                     x                               x
  4 
  5             x                               x
  6 
  7     x                               x
  8                                                             x
  9                             x
 10                                                     x
 11                     x
 12                                             x
 13             x
 14                                     x
 15     x

Scr# 3975 
  0                             x                               x
  1 
  2 
  3 
  4 
  5 
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 4000 
  0 xx  x x xxx x xxx x xxx xxxxx x xxxxx xxx x xxx xxxxx xxxxx x xx
  1 xxx xxx x xxxxx xxx xxxxx xxxxxxx xxx x xxx x xxx xxxxxxxxxxxxx
  2 xxx xxxxx x xxxxxxxxx x xxxxx xxxxx xxx xxxxx xxxxx x xxxxxxxxx
  3 x xxx x xxxxxxxxxxx xxxxxxxxxxx xxx x xxx xxxxx x xxxxxxxxx xxxx
  4 x xxxxx xxxxx x xxxxx xxx x xxxxxxxxx xxxxxxxxxxxxx xxx x xxx xx
  5 xxxxxxxxxxx xxxxx xxxxxxxxx x xxx xxxxx xxxxxxx xxxxx xxxxx xxx
  6 xxxxx xxxxxxx xxx xxxxxxx xxxxxxxxx x xxxxxxxxx x xxxxx xxx xxxx
  7 x xxxxxxx xxx x xxx xxxxxxxxxxx xxxxxxx xxx xxxxxxx xxx xxxxx xx
  8 xxxxxxxxx x xxxxxxxxxxxxxxxxx xxxxx xxxxxxxxx xxxxx xxxxx x xxxx
  9 x xxxxxxxxx xxxxx xxxxx x xxxxx xxxxx xxx x xxxxxxxxxxx xxxxxxxx
 10 x x xxx xxxxx xxxxx x xxxxxxxxxxx xxx xxxxx xxxxxxx xxxxxxxxx xx
 11 xxxxx xxxxxxxxx xxxxxxx xxxxx xxxxx xxx xxxxxxx xxxxx xxx xxxxxx
 12 x xxx xxxxxxxxxxxxx xxxxxxxxx xxxxxxxxxxx x xxxxxxxxx x xxx x xx
 13 xxxxxxx xxxxxxxxxxxxx xxx x xxx xxxxxxxxxxxxx xxx x xxx xxxxxxxx
 14 xxxxxxxxxxx xxx xxxxxxx xxxxxxxxx xxxxxxx xxx xxxxx xxxxx xxxxxx
 15 xxxxxxx xxx xxxxx xxxxx xxxxxxx xxxxx xxxxxxxxxxx xxx xxxxx x xx

Scr# 4001 
  0 xxxxxxx x xxxxx xxxxxxxxx x xxxxxxxxx x xxxxx xxxxxxxxxxxxxxxxx
  1 xxx x xxx xxxxx xxxxx xxxxxxx xxxxx xxxxx xxxxxxxxxxxxxxxxxxxxx
  2 x xxxxxxxxx xxxxxxx xxxxxxxxx xxxxx xxxxx xxxxxxx xxxxxxxxxxx xx
  3 x xxxxx xxxxx x xxxxx xxxxxxxxxxx xxxxxxxxx xxxxxxxxxxxxxxxxx x
  4 xxx xxxxx x xxxxx xxx x xxx xxxxxxxxxxx x xxxxx xxxxxxxxxxxxxxxx
  5 xxxxxxxxxxxxxxxxx xxxxx xxxxx xxxxxxx xxxxxxxxxxxxxxxxx xxxxxxxx
  6 x xxxxxxxxxxxxx xxx x xxx xxxxx xxxxxxx xxx x xxxxx xxxxxxxxxxx
  7 xxxxxxxxx x xxx x xxx xxxxx xxxxxxxxxxx xxxxxxxxxxx xxxxxxx xxxx
  8 xxxxxxx xxxxx xxx xxxxx xxxxxxx xxx xxxxxxx xxx xxxxxxxxxxxxx xx
  9 x xxxxx x xxx xxxxx x xxxxx xxxxxxxxx xxxxxxxxxxxxxxxxxxx xxxxx
 10 xxx x xxxxxxxxxxxxxxxxxxxxxxx xxx x xxxxxxxxx xxxxxxxxxxx x xxxx
 11 xxxxx xxxxxxx xxxxx xxxxx xxxxx xxxxxxxxxxxxxxxxx xxxxx xxx x xx
 12 xxxxxxxxx xxxxxxxxx xxxxxxxxxxx xxxxxxx xxxxxxxxxxxxxxx xxxxxxxx
 13 xxxxx xxxxx xxx x xxx x xxxxxxxxx xxxxxxxxxxx xxxxx xxxxx xxxxxx
 14 xxxxxxxxxxx x xxxxxxxxxxxxxxx x xxxxxxxxxxxxxxxxxxxxx xxxxx xxxx
 15 xxx xxxxx xxx x xxx xxxxxxx xxxxx xxxxxxxxx x xxxxxxxxx xxxxxxxx

Scr# 4002 
  0 xxxxx xxxxxxxxx xxxxx xxxxxxxxxxx x xxx x xxxxxxxxx xxxxxxxxxxx
  1 x xxxxxxxxxxxxxxx x xxxxx xxx x xxxxxxxxx xxxxxxx xxxxxxxxxxxxxx
  2 xxx xxxxxxxxxxxxxxxxxxxxxxx xxx xxxxx xxxxxxx xxxxxxxxxxxxxxx x
  3 xxx xxxxxxx xxxxxxxxxxxxxxx x xxx xxxxxxx xxxxx xxxxx xxx xxxxxx
  4 xxxxx x xxxxxxxxxxxxxxxxxxxxx xxxxx x xxxxx xxx xxxxx xxxxxxxxxx
  5 xxx xxxxx xxx x xxxxx xxx xxxxx xxxxxxxxxxx xxxxx xxxxx xxxxxxxx
  6 xxxxx xxx xxxxx xxxxxxxxxxx xxxxxxx xxxxx xxx xxxxxxxxxxxxxxxxxx
  7 xxxxxxx xxxxxxxxxxxxxxxxx xxxxxxxxx xxxxxxx xxx xxxxx x xxxxx xx
  8 xxxxxxxxxxxxxxxxxxx xxxxxxxxxxx x xxxxxxxxxxxxxxx xxxxxxx xxx xx
  9 xxxxxxxxx xxxxxxxxxxxxx xxxxxxxxx x xxx xxxxxxx xxxxx xxxxx xxx
 10 x xxx xxxxx xxxxxxx xxx x xxxxx xxxxxxxxx x xxxxxxxxx xxxxxxx xx
 11 x xxxxxxxxxxxxx xxxxxxxxx xxxxxxxxxxx x xxxxx xxx x xxxxxxxxxxxx
 12 xxx xxxxxxxxxxxxx xxx xxxxx xxxxxxx xxxxx xxx xxxxxxxxxxxxxxxxx
 13 xxxxxxx xxxxxxxxx xxxxx xxxxx xxxxxxx xxxxxxxxx xxxxxxxxxxx xxxx
 14 xxxxxxxxx xxx xxxxx xxxxx x xxxxxxxxxxxxxxxxxxxxxxxxxxx x xxxxxx
 15 xxx xxxxxxx xxx xxxxxxxxxxxxx xxx xxxxxxx xxxxxxxxxxx xxxxx xxxx

Scr# 4003 
  0 xxxxxxx xxx xxxxx xxxxxxxxxxxxxxxxxxx xxxxxxxxx x xxxxxxxxxxxxxx
  1 x xxxxxxxxxxxxxxxxxxxxxxxxx xxx x xxxxxxxxxxx xxxxx xxx xxxxxxxx
  2 xxx xxxxx xxxxxxx xxx xxxxxxx xxxxxxxxxxxxxxxxxxxxx x xxx x xxxx
  3 xxxxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxx x xxxxx xxxxx xxxxx xxx xxxx
  4 x x xxxxxxxxxxx xxx xxxxxxxxxxx x xxxxxxxxx x xxxxxxxxxxxxxxx x
  5 xxxxxxxxxxxxxxx xxxxx xxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxx xxxxxx
  6 x xxx x xxx x xxxxxxxxxxxxxxxxxxxxx xxxxxxx xxxxxxxxxxx xxxxx xx
  7 xxxxxxx x xxx xxxxx x xxxxx xxxxxxxxx x xxxxxxxxxxx xxxxxxxxx x
  8 xxxxxxxxx xxxxxxxxxxxxx xxxxx xxx xxxxx xxxxxxx xxxxx xxxxx xxxx
  9 xxxxxxxxxxx xxxxxxxxxxx x xxx xxxxxxxxxxxxx xxxxx xxx xxxxxxx xx
 10 xxxxxxx xxxxxxx xxxxx xxxxx xxxxxxxxxxxxxxxxxxxxx xxxxx x xxxxxx
 11 xxx xxxxxxxxxxxxx xxx xxxxx xxxxxxxxxxxxxxxxx x xxxxxxxxx xxxxxx
 12 xxxxxxx xxx x xxxxxxxxx xxxxxxxxxxxxx xxx xxxxxxx xxxxxxxxxxxxxx
 13 xxx xxx xxxxx x xxx xxxxx x xxxxxxxxxxx xxx xxxxxxxxxxxxxxxxxxx
 14 xxxxxxxxxxxxxxxxxxxxx xxxxxxxxxxx x xxx xxxxx xxxxx x xxxxx xxxx
 15 xxxxxxxxxxxxxxxxx x xxxxx xxxxxxxxxxxxxxx xxxxx xxxxxxxxxxx x xx

Scr# 4004 
  0 xxx xxxxxxxxxxx xxxxxxxxxxxxxxx x xxx xxxxx xxxxxxxxxxxxx xxx x
  1 xxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxxxxxx xxxxxxxxx xxxxx x xxxx
  2 xxxxx x xxxxxxxxx x xxxxxxxxx xxxxx x xxxxxxxxx x xxxxxxxxx xxxx
  3 x xxxxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxxxxxx x xxxxxxxxx xx
  4 xxxxx xxxxx xxxxxxxxx xxxxxxxxxxxxxxxxx xxxxx xxxxxxxxxxx xxxxxx
  5 xxxxx x xxxxxxxxxxxxxxxxx xxxxx xxx xxxxx xxxxx xxxxxxxxxxxxxxxx
  6 x x xxxxxxxxx xxxxxxxxxxxxx xxxxx xxx x xxx xxxxxxxxxxxxxxxxxxxx
  7 xxx x xxxxxxxxxxx xxxxx xxxxxxxxxxxxxxx xxxxxxx xxxxx xxxxx xxxx
  8 xxxxxxxxxxxxx xxxxxxxxxxxxxxx x xxx xxxxx x xxxxx xxxxx xxxxxxxx
  9 x xxxxx xxxxxxxxxxx xxxxxxxxxxx xxxxxxxxxxxxxxxxx x xxxxx xxx xx
 10 xxxxxxxxxxxxxxx xxxxxxx xxxxxxxxxxxxxxxxxxxxxxx xxx x xxx xxxxx
 11 x xxxxxxxxxxx xxx xxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxx xx
 12 xxxxxxx xxxxx xxxxxxxxxxx xxxxxxxxxxxxx xxxxx xxxxxxxxx xxxxxxxx
 13 xxx x xxx xxxxx xxxxxxx xxxxx xxxxxxxxx x xxx xxxxxxxxxxxxx xxxx
 14 x xxxxx xxx xxxxx x xxxxxxxxx x xxxxxxxxxxxxxxx xxxxxxxxxxx xxxx
 15 xxx xxxxxxxxxxxxxxxxx xxx xxxxx xxxxxxxxxxx x xxxxx xxxxx xxxxx

Scr# 4005 
  0 xxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxx xxxxxxxxxxxxx xxx xxxxxxx xxxx
  1 xxxxx xxxxxxx xxxxxxxxxxx xxxxxxxxxxxxxxxxx xxx x xxx xxxxxxxxxx
  2 xxxxxxxxxxxxx xxxxxxxxxxx xxxxx x xxxxxxxxxxxxxxx xxxxx xxxxx xx
  3 xxxxxxxxxxx xxxxxxxxx xxxxxxxxxxxxx xxx xxxxxxxxxxxxxxxxxxxxxxxx
  4 xxxxx xxxxx xxxxx xxxxx xxxxxxx xxxxx xxx x xxxxxxxxxxx xxxxx xx
  5 x x xxxxx xxxxxxxxxxxxxxxxxxxxx xxxxx x xxx xxxxxxxxxxxxxxxxx x
  6 xxx xxxxxxxxxxx x xxxxx xxx xxxxxxxxxxxxxxxxxxxxxxxxx xxxxx xxxx
  7 x xxx xxxxxxx xxxxxxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxxxxx
  8 xxxxxxx x xxxxx xxx x xxx x xxxxxxxxx xxxxxxxxxxxxx xxxxx xxx xx
  9 xxxxx xxxxxxxxx xxxxx xxxxxxxxxxxxxxxxxxx xxx x xxxxx xxxxxxxxxx
 10 xxxxxxxxxxxxxxxxxxx xxx xxxxxxx xxxxxxxxx xxxxx xxxxx xxxxxxx xx
 11 xxx xxxxxxxxxxx xxx xxxxx x xxxxx xxx xxxxx x xxxxxxxxx x xxxxxx
 12 xxxxxxxxx xxxxx xxxxxxxxxxxxxxxxxxx xxx xxxxxxxxxxx xxxxxxxxxxxx
 13 x xxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxx xxxxxxxxxxxxxxxxxxx xxx xxxx
 14 xxxxxxxxxxxxx xxxxxxx xxxxx xxx xxxxx xxxxxxxxxxxxx xxxxx xxxxx
 15 xxxxxxxxx x xxxxxxxxx xxxxxxxxxxx xxxxxxx xxxxxxxxx x xxxxxxxxx

Scr# 4006 
  0 xxxxxxx xxxxxxxxxxx xxxxxxxxx xxxxxxxxxxxxxxxxxxxxxxx x xxx xxxx
  1 xxx xxxxx xxx xxxxxxx xxxxxxxxxxxxxxxxx xxxxxxxxx xxxxx xxxxx x
  2 xxxxx xxxxxxxxx xxxxxxxxxxx x xxxxxxxxx xxxxx xxxxx xxxxx xxxxxx
  3 x xxxxx xxxxxxxxx xxxxx x xxxxx xxxxx xxxxx xxxxxxxxx xxxxxxx xx
  4 xxxxxxxxxxxxxxxxxxxxx xxxxx xxxxxxxxxxxxxxxxxxxxx x xxxxxxxxxxxx
  5 xxxxx xxx xxxxxxx xxxxxxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxxx
  6 x xxxxxxxxxxxxxxxxx xxx x xxxxxxxxx xxxxx x xxxxx xxx xxxxxxxxxx
  7 xxxxxxx xxxxxxx xxxxxxxxxxx xxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxx xx
  8 xxx x xxxxxxxxxxx xxxxx xxxxxxxxx x xxxxxxxxx x xxxxx xxxxxxxxx
  9 xxxxxxxxxxxxx xxx xxxxxxxxxxxxxxxxxxxxxxx x xxxxxxxxxxxxxxx x xx
 10 xxxxxxx x xxxxxxxxx xxxxxxxxxxxxxxxxxxx xxx x xxx xxxxxxx xxxxxx
 11 xxxxxxxxx xxxxx xxxxx x xxxxxxxxxxx xxxxxxxxxxxxxxx xxxxxxx xxx
 12 xxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxx x xxxxxxxxx x xxxxx xxx xxxx
 13 x xxxxx xxxxxxx xxxxx xxx xxxxxxxxxxx xxxxx xxxxxxx xxxxxxxxxxx
 14 xxx xxxxxxxxxxxxx xxxxxxxxxxx xxxxxxxxx xxxxxxxxxxxxxxxxxxxxxxx
 15 xxxxx xxxxxxxxxxx xxxxx x xxxxxxxxxxxxxxxxxxxxx xxxxxxx xxxxxxxx

Scr# 4007 
  0 xxxxxxxxx xxxxxxxxx xxxxx xxxxxxxxxxxxx xxx x xxxxx xxxxxxxxx xx
  1 xxxxx xxxxx xxx xxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxxxxxxxxx
  2 x xxxxxxxxx x xxxxxxxxxxx xxxxxxxxx x xxxxxxxxxxxxxxx x xxxxxxxx
  3 xxxxxxxxx xxxxxxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxx xxxxx xxxxxx
  4 xxxxxxxxx xxxxxxxxxxxxxxxxx xxxxx x xxxxxxxxxxxxxxxxx xxx xxxxx
  5 x xxxxxxxxx xxxxxxx xxxxxxxxx xxxxx xxxxx xxxxxxx xxx xxxxx x xx
  6 xxxxxxx x xxxxxxxxxxx xxx xxxxx xxxxx x xxxxxxxxxxx xxx xxxxxxxx
  7 xxxxx xxxxxxxxxxxxxxxxx xxx xxxxx xxxxxxxxxxxxxxxxxxx xxx xxxxxx
  8 x xxxxx xxx xxxxxxx xxx xxxxxxxxxxxxx xxxxx xxx xxxxxxxxxxxxx xx
  9 xxxxxxxxx xxx x xxxxxxxxxxxxxxxxxxxxxxxxxxxxx xxx xxxxxxxxxxxxxx
 10 xxxxxxxxx xxxxx xxxxx xxxxxxxxxxx xxxxxxxxxxx xxxxxxxxxxxxx xxxx
 11 x xxx x xxx xxxxxxxxxxxxxxxxx xxxxx xxxxxxxxxxx xxxxxxx xxxxx xx
 12 x xxxxxxxxxxx x xxxxxxxxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxxx
 13 xxxxxxxxx x xxxxx xxxxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxx xxxxx xxxx
 14 xxxxx xxxxxxxxxxx xxxxx x xxx xxxxxxx xxxxxxxxx xxxxx xxxxx xxxx
 15 xxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxx xxxxx xxx xxxxxxx xxxxxxxxxxx

Scr# 4008 
  0 xxxxxxxxxxxxxxxxx xxxxxxxxx x xxxxxxxxx x xxx xxxxx xxxxxxxxxxxx
  1 xxxxxxx xxxxx xxx xxxxxxxxxxxxx xxx x xxx xxxxxxxxxxxxx xxxxx xx
  2 xxxxxxxxx xxxxxxxxxxxxxxxxxxxxxxx xxxxxxxxx xxxxx xxxxxxx xxxxxx
  3 xxx x xxxxxxxxxxxxxxxxxxxxxxxxxxxxx xxx xxxxx x xxxxxxxxxxx xxx
  4 xxxxxxxxxxxxx xxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxxxxxxx
  5 x xxxxxxx xxxxx xxxxxxxxx x xxx xxxxxxxxxxxxxxxxxxx xxxxxxxxx xx
  6 xxxxx xxxxxxxxxxxxxxx x xxxxxxxxx xxxxxxxxxxxxx xxx x xxxxxxxxxx
  7 x xxxxx xxxxxxxxxxxxxxx xxxxx xxxxxxx xxx xxxxxxx xxx xxxxx xxxx
  8 xxx xxxxx xxxxx xxxxxxxxxxx xxxxx xxx xxxxx xxxxx xxxxxxx xxxxxx
  9 xxxxxxxxxxx xxx xxxxxxxxxxxxxxxxxxx xxx xxxxxxxxxxx x xxxxxxxxx
 10 xxxxx x xxxxxxxxx xxxxxxxxxxx x xxx xxxxxxxxxxxxxxxxxxx xxxxx xx
 11 xxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxx xxx xxxxxxx xxxxxxxxx xxxxxxxx
 12 xxx xxxxx x xxxxxxxxxxxxxxxxxxxxxxxxxxx x xxxxx xxx x xxxxxxxxxx
 13 xxxxx xxxxxxxxxxx x xxxxx xxxxxxxxx xxxxxxx xxxxxxxxxxxxxxxxxxxx
 14 xxx xxxxxxxxxxx xxxxx xxxxxxxxxxxxxxxxx xxxxx xxx xxxxxxxxxxxxx
 15 xxxxx xxx xxxxxxxxxxx xxxxxxx xxxxx xxxxxxxxxxx xxx xxxxx xxxxxx

Scr# 4009 
  0 xxxxx xxxxx xxxxxxxxxxx x xxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxx xx
  1 x x xxxxxxxxx xxxxxxxxxxxxxxxxx xxxxxxx xxx xxxxxxxxxxxxx xxx x
  2 xxxxx xxxxxxxxxxxxxxxxxxxxx xxxxx xxxxxxxxxxxxx xxxxx xxxxx xxxx
  3 xxxxx xxxxx x xxxxxxxxx x xxx x xxxxxxxxxxxxxxxxxxxxx x xxx xxxx
  4 x xxxxx xxxxxxxxxxx xxxxx xxxxxxxxxxxxx xxxxxxxxx xxxxxxxxxxx xx
  5 xxx xxxxxxx xxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxxxxxxxxx
  6 x xxxxxxxxxxx xxxxx xxx xxxxx x xxxxxxxxxxx xxxxx xxxxxxxxxxx xx
  7 xxxxxxxxxxxxx x xxxxxxxxx xxxxxxx xxxxxxxxxxxxxxxxxxxxx x xxxxxx
  8 xxxxx xxxxx xxx xxxxx xxxxxxxxxxxxxxxxx x xxxxxxxxxxx xxxxx xxx
  9 xxxxxxxxxxx xxxxxxx xxxxx xxxxxxxxxxx xxx xxxxx xxxxxxxxxxx xxxx
 10 x x xxxxxxxxxxx xxxxxxxxxxx xxx xxxxxxxxxxxxx xxxxx xxxxxxxxxxxx
 11 xxx xxxxx x xxxxxxxxx xxxxxxx xxxxxxxxxxxxxxxxx xxxxx xxxxxxxxxx
 12 xxxxxxxxxxxxxxxxxxxxxxx x xxxxxxxxxxxxxxxxxxxxxxxxxxx x xxxxxxxx
 13 xxxxxxxxxxxxx xxxxx x xxxxxxxxx xxxxxxxxxxx x xxxxx xxx xxxxxxx
 14 xxxxxxxxxxxxxxxxxxxxx xxxxx x xxxxxxxxx xxxxxxx xxx xxxxx xxxxxx
 15 x xxx xxxxxxxxxxx xxxxxxxxxxxxxxxxx xxxxxxxxxxx xxxxxxxxxxxxxxxx

Scr# 4010 
  0 xxx xxx xxxxx xxxxx xxxxxxx xxx x xxxxxxxxxxxxxxx xxxxxxxxxxx x
  1 xxxxxxxxx xxxxxxx xxxxxxxxx x xxx xxxxx xxxxxxxxxxxxx xxxxxxxxxx
  2 x xxxxxxxxxxxxxxxxxxxxx xxxxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxx x xx
  3 x xxxxxxxxxxxxxxxxxxx xxx x xxx xxxxxxxxxxxxx xxxxxxxxx xxxxxxxx
  4 xxx x xxxxxxxxxxx xxxxxxxxxxxxxxx x xxxxxxxxxxxxxxxxxxxxxxxxxxx
  5 xxxxxxx xxxxxxxxxxxxxxxxxxxxx xxxxxxx xxx xxxxx xxxxx xxxxxxxxxx
  6 xxx xxx xxxxxxx xxxxxxxxxxx xxxxx xxxxx xxx xxxxxxxxxxxxxxxxxxx
  7 xxx xxxxxxxxxxxxxxxxx x xxxxxxxxxxx xxxxx xxx xxxxx xxxxxxxxxxxx
  8 x xxxxxxxxxxxxxxxxx xxxxxxxxx xxxxxxx xxxxxxxxx xxxxxxxxxxxxxxxx
  9 xxxxxxxxxxxxxxx xxxxx xxxxxxxxx xxxxx xxxxx x xxxxx xxxxxxxxxxxx
 10 xxx xxxxx x xxxxxxxxxxx xxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxx x xxxx
 11 xxxxx xxxxxxx xxxxxxxxxxxxxxx xxxxx xxxxxxx xxxxx xxxxxxxxx xxxx
 12 xxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxx xxxxxxxxx x xxxxxxxxx x
 13 xxxxxxxxxxx xxx xxxxx xxxxxxxxxxxxxxxxxxx xxx x xxxxxxxxxxx xxxx
 14 xxxxxxxxxxxxx xxxxxxxxx x xxxxxxxxx x xxx xxxxxxxxxxxxxxxxxxx xx
 15 xxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxxxxxxxx xxx xxxxxxx xxxxx xxx xx

Scr# 4011 
  0 xxxxxxxxx xxxxx xxxxxxx xxxxxxxxxxx xxxxxxxxxxx xxxxx xxx xxxxxx
  1 x xxxxxxxxxxxxxxxxxxxxx x xxxxxxxxxxxxxxx xxxxxxxxxxxxx xxxxxxxx
  2 x xxxxx xxxxxxxxxxx xxxxxxxxxxx xxxxxxxxxxxxx xxxxx xxx xxxxxxxx
  3 xxxxxxxxxxx xxx xxxxxxxxxxx xxxxx x xxxxx xxxxx xxxxxxxxxxxxxxx
  4 xxxxxxx xxxxxxxxxxxxxxxxxxxxx x xxxxxxxxxxxxxxxxxxxxxxxxxxx xxxx
  5 xxx xxxxx xxx xxxxxxxxxxxxxxxxxxx xxx xxxxxxxxxxx xxxxxxxxxxxxxx
  6 xxxxxxxxx xxxxxxxxxxxxxxxxxxx xxx xxxxxxx xxxxxxxxx x xxxxxxxxxx
  7 xxxxx x xxxxxxxxxxx xxxxxxxxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
  8 x x xxx xxxxx xxxxxxxxxxx xxxxx xxxxx xxxxxxx xxxxx xxx x xxxxx
  9 xxxxxxxxxxxxxxxxxxxxxxx xxx xxxxxxxxxxxxxxxxxxx xxxxxxxxx xxxxx
 10 xxxxx xxxxxxxxxxxxx xxx xxxxx xxxxx x xxxxxxxxxxx xxxxx xxxxxxxx
 11 x x xxxxxxxxx xxxxx xxxxxxxxxxxxxxxxxxx xxx xxxxxxxxxxxxxxxxxxxx
 12 xxxxx xxx x xxxxx xxxxxxxxxxxxxxxxxxxxx x xxxxxxxxxxxxxxxxxxxxxx
 13 x xxx xxxxx x xxx xxxxx xxxxxxxxxxxxxxxxxxxxxxx xxxxx xxxxxxx xx
 14 x x xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxx xxxxxxx xxxxxxxxxxxx
 15 xxx xxxxxxxxxxx x xxxxxxxxx x xxxxxxxxx xxxxx xxxxxxx xxx xxxxxx

Scr# 4012 
  0 x xxxxxxxxxxx xxxxxxxxxxxxxxxxxxxxx xxxxx xxxxxxxxxxxxx xxx xxxx
  1 xxxxxxxxxxxxxxxxxxxxx xxx x xxxxxxxxxxx xxxxxxxxx xxxxxxx xxx xx
  2 xxxxx xxxxxxxxxxx xxx xxxxxxxxxxxxx xxxxx xxxxxxxxxxxxxxx xxxxx
  3 xxxxxxx xxx xxxxx xxxxx xxxxxxx xxxxx xxxxxxxxx xxxxxxxxxxx x xx
  4 xxx xxxxx xxxxxxxxxxxxxxx xxxxxxx xxxxx xxxxx xxxxxxxxxxx xxxxxx
  5 xxx x xxxxx xxxxxxxxxxxxxxxxx xxx xxxxx xxxxx xxxxx xxxxxxxxxxx
  6 xxxxxxxxxxxxxxxxx xxxxxxx xxxxx xxxxxxxxx xxxxxxx xxxxxxxxxxxxxx
  7 xxx xxx xxxxxxxxxxxxx xxxxx xxxxxxxxxxxxxxxxx xxxxxxxxx xxxxxxx
  8 xxxxxxxxx xxxxxxxxxxx x xxxxx xxxxxxxxxxx xxxxxxxxxxx xxxxxxxxxx
  9 xxxxxxxxxxxxxxxxxxxxxxxxx xxx xxxxx xxxxxxx xxx xxxxx x xxx xxxx
 10 xxxxxxxxxxxxx xxxxxxxxxxx xxxxx xxxxxxx xxxxx xxxxx xxx xxxxxxxx
 11 xxxxxxxxx x xxx x xxxxxxxxxxxxxxxxxxxxxxx xxx xxxxx xxxxx xxxxxx
 12 xxxxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxx xxx xxxxx xxxxxxxxxx
 13 x xxxxx xxxxxxxxxxxxxxxxxxx xxx xxxxxxx xxx xxxxxxx xxxxx xxxxx
 14 xxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxx x xxxxxxxxx xxxxxxxxxxx xxxxxx
 15 x xxxxxxxxx xxxxxxx xxxxxxxxxxxxxxxxxxxxxxx xxxxx xxxxxxxxxxx xx

Scr# 4013 
  0 x xxxxxxxxxxxxx xxx xxxxx x xxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxxxxx
  1 xxxxx xxxxxxxxxxxxxxx x xxxxxxxxxxx xxxxx xxx xxxxxxxxxxxxxxxxxx
  2 x xxxxxxxxx xxxxx xxxxx xxxxx xxxxxxx xxxxxxxxx xxxxxxxxxxx xxxx
  3 xxxxxxxxx xxxxxxxxx xxxxxxxxxxxxx xxxxxxxxxxxxxxx xxxxxxxxxxxxx
  4 xxxxxxxxx xxxxxxxxxxxxx xxxxx xxxxxxxxxxxxxxx xxxxx xxxxxxx xxxx
  5 x xxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxx xxxxxxxxx x xxxxx xxx x xx
  6 x xxxxxxxxxxx x xxxxxxxxx x xxxxx xxxxxxxxxxxxxxxxxxxxx xxxxx x
  7 xxx xxxxxxxxxxxxxxxxx xxxxxxx xxxxxxxxx xxxxxxx xxxxxxxxxxxxxxxx
  8 xxxxx x xxxxxxxxx xxxxxxxxxxxxxxxxx xxxxxxxxxxxxx xxx x xxx xxxx
  9 xxxxxxxxxxxxx x xxx xxxxx xxxxxxx xxxxxxxxx x xxxxxxxxxxxxxxxxxx
 10 xxxxxxxxxxx xxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxx x xxxxxxxxx x xxxx
 11 xxxxxxxxxxxxx xxx xxxxxxxxxxxxxxxxx xxxxx xxxxxxxxxxxxx xxxxxxxx
 12 x x xxx xxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
 13 xxxxx xxx xxxxx xxxxxxxxxxxxx xxx xxxxxxxxxxxxxxxxxxx xxxxxxxxx
 14 xxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxxxx xxxxx x xxxxxxxxxxxxxxxxxxxx
 15 xxxxxxxxx xxxxxxxxxxx xxxxxxxxx xxxxxxxxxxxxxxxxx x xxx xxxxxxxx

Scr# 4014 
  0 xxxxx xxxxx xxxxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxx x xxxxxxxxxx
  1 x xxxxx xxx xxxxxxx xxx xxxxxxx xxxxx xxxxxxxxx x xxxxxxxxxxx xx
  2 xxxxxxxxxxxxxxx xxxxxxxxx xxxxxxxxxxxxx xxxxxxxxxxxxxxx xxxxxxxx
  3 xxxxx xxx xxxxx xxxxx x xxxxx xxx x xxxxxxxxxxxxxxxxxxxxxxxxxxx
  4 x xxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxx x xxx xxxxx xxxxxxxxxxxxx xx
  5 x xxxxxxxxxxx xxxxxxxxxxxxx xxxxxxxxxxxxxxx xxxxxxxxxxxxx xxx xx
  6 xxx xxxxxxx xxxxx xxx xxxxx xxxxx xxxxx xxxxxxx xxx xxxxxxx xxx
  7 xxxxxxxxxxxxx xxxxxxxxxxxxxxx xxxxxxx xxxxx xxx xxxxxxxxxxx xxxx
  8 xxx xxxxxxxxxxxxxxx x xxxxxxxxx xxxxxxx xxx xxxxx xxxxxxxxxxxxxx
  9 xxxxxxxxxxx xxxxx xxxxxxxxx xxxxxxx xxx xxxxx xxxxxxxxxxx xxxxxx
 10 xxxxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxx xxx xxxxxxxxxxxxx xxxxxxxx
 11 xxxxxxxxxxxxx xxxxxxx xxxxxxxxxxx xxx xxxxx xxxxxxx xxxxxxxxx xx
 12 xxx xxxxxxxxxxxxx xxxxxxxxx xxxxx x xxxxxxxxx xxxxxxxxxxx xxxxxx
 13 xxxxx xxxxxxxxxxxxx xxxxx xxxxx xxxxxxxxxxxxxxxxx xxxxxxxxx xxxx
 14 x xxxxxxx xxxxxxxxxxxxxxxxx xxx xxxxx x xxxxx xxxxxxxxx x xxxxxx
 15 xxx xxxxxxx xxxxx xxxxx xxxxxxxxx x xxxxxxxxxxxxxxxxx xxxxxxxxx

Scr# 4015 
  0 x xxxxxxxxxxx xxx xxxxx xxxxxxx xxxxxxxxx xxxxxxxxxxx xxxxxxxxxx
  1 xxx xxxxxxxxxxx xxx xxxxxxx xxxxxxxxx xxxxx xxxxx xxxxxxxxxxxxxx
  2 xxxxx xxx xxxxxxxxxxxxx xxxxxxxxxxxxxxx xxxxxxxxxxxxx xxxxxxxxx
  3 xxxxxxx xxxxxxxxx xxxxxxxxxxx x xxxxxxxxxxxxxxxxx xxxxx xxxxxxxx
  4 xxx xxxxxxxxx xxxxxxxxxxx x xxx x xxxxxxxxxxx xxxxx xxx xxxxxxx
  5 xxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx xxx x xxx x xxxx
  6 xxxxx xxxxxxxxxxx xxxxx xxxxx xxxxxxxxxxxxx xxx xxxxx xxxxx xxxx
  7 x xxxxxxx xxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxxxxxxxxx
  8 xxxxx xxx xxxxx x xxxxxxxxxxx xxxxx xxxxx xxxxx xxx xxxxxxxxxxxx
  9 x xxxxxxxxxxxxxxxxxxxxx xxxxxxxxxxx x xxxxxxxxxxxxxxxxx xxxxxxxx
 10 x xxxxx xxxxxxxxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxxxxxx xxx x
 11 xxx x xxx xxxxxxxxxxxxx xxx xxxxx xxxxx xxxxxxx xxxxxxxxxxxxxxx
 12 xxxxxxxxxxx x xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx xxx x xx
 13 x xxxxxxxxxxxxxxxxxxxxxxx xxxxx xxxxx x xxxxxxxxxxxxxxxxx xxx xx
 14 xxxxxxxxxxx xxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxx
 15 xxxxxxxxxxxxx xxxxx xxxxxxxxx xxxxxxxxxxx x xxxxx xxxxxxxxxxx xx

Scr# 4016 
  0 xxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxx xxx xxxxx xxxxx xxxxxxxxxxxxx
  1 xxx x xxxxxxxxxxxxxxxxxxxxxxx xxx xxxxx xxxxx xxxxxxxxxxxxxxxxxx
  2 xxxxxxx xxxxxxxxx xxxxxxxxxxxxxxxxx xxxxx xxxxxxx xxxxx xxxxx xx
  3 xxxxxxxxxxxxxxxxxxxxxxxxxxx xxx xxxxxxxxxxx xxxxxxxxxxx x xxxxxx
  4 xxxxxxxxx x xxxxx xxx xxxxxxxxxxx xxxxxxxxxxxxxxxxx x xxxxx xxx
  5 xxxxxxxxxxxxxxxxxxxxxxxxx xxxxxxxxxxx xxxxx xxxxxxxxxxx xxx xxxx
  6 xxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxxxxxx xxxxxxxxxxx xxxxx x
  7 xxxxxxxxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxxxx xxx xxxxx xxxxxx
  8 xxxxx x xxxxxxxxxxxxxxxxx xxxxx xxx xxxxx xxxxx xxxxxxxxxxxxxxxx
  9 xxx xxxxxxxxxxxxxxx x xxxxx xxxxx xxxxxxxxxxxxxxxxx xxxxxxxxx xx
 10 xxx x xxx xxxxxxx xxxxx xxxxx xxxxxxxxxxxxxxxxxxxxxxx xxxxxxxxxx
 11 xxxxx xxxxx xxxxxxx xxxxxxxxx xxxxx xxxxxxxxxxxxx xxxxxxxxxxxxxx
 12 xxxxxxx xxxxxxx xxxxxxxxxxxxxxx xxxxx x xxxxxxxxxxx xxx x xxxxxx
 13 xxxxxxxxxxxxxxx xxxxxxx xxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxxxxx
 14 xxxxxxxxxxx x xxxxx xxxxxxxxxxxxxxxxx xxx xxxxx xxxxx xxxxxxx xx
 15 xxxxxxx xxxxxxx xxxxxxxxxxxxxxxxx xxxxx xxx x xxx xxxxxxx xxxxxx

Scr# 4017 
  0 xxxxxxxxx x xxxxxxxxxxx xxxxxxxxxxx xxxxx xxxxxxxxxxxxxxxxx xxx
  1 xxxxx xxxxx xxxxx x xxxxx xxxxxxxxxxx xxxxxxxxx xxxxxxxxxxxxxxxx
  2 xxx xxxxxxxxxxx xxxxxxxxxxxxxxxxx xxx xxxxx x xxxxxxxxxxxxxxx x
  3 xxxxxxxxx xxxxxxxxxxxxx xxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxx x xxxx
  4 xxxxx xxxxxxxxxxx x xxxxxxxxxxxxxxxxxxxxxxx xxxxx xxxxxxxxxxxxxx
  5 x xxxxxxx xxxxxxxxx x xxxxxxxxxxx xxxxxxxxxxxxxxxxxxxxx xxxxx x
  6 xxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxx xxxxxxxxx x xxxxxxxxxxx xxxx
  7 xxxxxxx xxxxxxxxxxxxxxxxx xxxxxxxxx xxxxxxxxxxx xxxxx x xxxxxxxx
  8 x x xxxxx xxxxxxxxx xxxxxxxxxxxxxxxxx x xxxxxxxxxxx xxxxx xxx xx
  9 xxx x xxxxxxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxx x xxx
 10 x xxxxxxxxx x xxxxxxxxxxxxxxx xxxxxxxxxxx xxxxxxx xxxxxxxxxxxxxx
 11 xxxxxxx x xxxxx xxx x xxxxxxxxx xxxxx xxxxxxxxxxxxxxxxxxx xxxxxx
 12 xxxxx xxxxxxxxx xxxxxxx xxxxxxxxxxx xxxxx xxxxx xxxxx xxx xxxxxx
 13 xxxxxxxxxxx x xxx xxxxxxxxxxx xxxxxxxxxxxxxxxxx x xxxxxxxxxxx xx
 14 xxx xxx x xxxxxxxxxxxxxxx xxxxxxxxxxx xxxxxxxxxxx xxxxxxxxxxxxx
 15 xxx xxxxxxx xxxxxxxxxxxxxxxxx xxx xxxxxxxxxxx xxxxxxxxxxxxx xxxx

Scr# 4018 
  0 x xxxxx xxx xxxxxxx xxxxx xxx xxxxxxxxxxxxxxxxxxx xxxxxxxxxxx xx
  1 xxxxxxx xxxxxxxxxxxxx xxx x xxxxxxxxxxxxxxx x xxxxxxxxxxx xxxxxx
  2 xxxxxxxxxxxxxxxxxxxxxxx xxx xxxxx xxxxxxxxxxxxxxxxxxxxxxx xxxxxx
  3 xxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxxxxxx xxxxxxxxx xxxxxxx xxxxxxxx
  4 xxx xxxxxxxxx xxxxxxxxxxx xxxxx xxxxxxxxxxx xxxxxxxxxxx xxxxx xx
  5 xxxxx xxxxxxxxxxxxxxx xxxxxxxxxxxxx xxxxx xxx xxxxx xxxxxxxxxxxx
  6 xxxxxxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxx xxxxxxxxx xxxxxxxxxx
  7 xxxxxxxxxxxxxxxxxxx xxxxxxxxxxx x xxx x xxxxxxxxxxxxxxxxxxxxxxxx
  8 xxx xxxxxxxxxxx xxxxxxxxxxxxx xxxxx xxxxxxxxxxxxxxxxxxxxx xxxxxx
  9 x xxx xxxxxxxxxxxxxxxxx xxxxx xxxxxxxxxxxxx xxxxxxxxxxxxxxxxx xx
 10 x xxxxx x xxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxx
 11 xxx x xxxxxxxxxxxxxxx xxxxx xxxxxxxxxxxxxxxxx x xxxxxxxxxxxxxxxx
 12 xxxxxxx xxx x xxxxx xxxxxxxxxxx xxxxx xxxxxxxxxxx xxxxxxxxx xxxx
 13 xxx xxxxx xxxxxxxxxxxxxxx xxxxxxxxxxx xxxxxxx xxxxxxxxx xxxxxxxx
 14 xxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxx x xxxxx xxx
 15 xxxxxxxxxxx xxxxxxxxxxxxx xxx x xxx x xxx xxxxxxx xxxxx xxxxxxxx

Scr# 4019 
  0 x xxxxx xxxxx x xxxxx xxxxx xxxxx xxxxxxxxxxx xxxxx xxxxxxxxxxxx
  1 xxxxxxxxxxx xxxxxxxxx x xxxxxxxxx xxxxx xxxxxxxxxxx xxxxx xxxxx
  2 xxxxxxxxxxxxx xxxxx xxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
  3 xxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxx xxxxx xxxxxxxxx x xxxxxxxxx xx
  4 xxxxx xxxxxxxxx xxxxxxxxxxx xxxxxxxxxxx x xxxxx xxx xxxxxxxxxxxx
  5 x xxxxxxxxxxxxxxx xxxxxxx xxxxxxxxxxx xxxxx xxxxxxxxxxxxxxxxxxxx
  6 x x xxxxxxxxx xxxxxxx xxxxx xxxxxxxxxxxxxxxxxxxxx x xxxxxxxxxxxx
  7 xxxxxxxxx xxxxx xxxxxxx xxxxxxxxx xxxxxxxxxxx xxxxxxxxxxx x xxxx
  8 xxxxx xxxxx xxxxxxxxxxx x xxx xxxxxxxxxxxxx xxxxxxxxx x xxxxx xx
  9 xxxxxxxxxxxxxxx xxx xxxxxxxxxxx xxxxxxx xxxxxxxxxxxxxxxxx xxxxxx
 10 xxxxx xxxxx xxxxx xxx xxxxx xxxxx xxxxxxxxxxxxx xxx x xxxxxxxxxx
 11 x xxxxxxxxxxx xxx xxxxx xxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxx xxxx
 12 xxxxxxx x xxxxxxxxxxxxxxx xxxxxxxxxxx xxxxxxx xxxxxxxxxxxxxxxxx
 13 xxxxxxxxx xxxxxxxxxxxxxxxxxxxxxxxxx xxx xxxxx xxxxxxx xxxxx xxxx
 14 x xxx x xxxxxxxxx xxxxxxxxxxxxxxxxxxx xxx xxxxx xxxxxxx xxx xxxx
 15 xxxxxxxxxxxxxxx xxxxxxxxx x xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx x

Scr# 4020 
  0 xxx xxxxxxxxxxxxxxxxxxxxxxx x xxxxxxxxxxx xxxxxxxxxxx xxxxxxxxx
  1 xxxxx x xxxxxxxxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxx xxxxxxxx
  2 xxx xxxxxxxxxxxxxxx xxxxxxxxxxx x xxxxxxxxxxxxxxxxxxxxx xxxxxxxx
  3 xxxxxxxxx xxxxxxxxxxx xxxxxxxxxxxxx xxxxxxxxx x xxxxxxxxxxx xxxx
  4 xxxxxxx xxx x xxx xxxxx xxxxxxxxxxx x xxxxxxxxxxxxxxx xxxxxxxxxx
  5 xxxxxxx x xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxxxx xxxxxx
  6 xxxxxxxxx xxxxx xxxxxxx xxxxxxxxx x xxx xxxxxxxxxxxxxxxxx xxxxxx
  7 x xxxxxxxxx xxxxxxx xxxxxxxxxxx xxx xxxxxxxxxxxxxxxxx x xxxxxxxx
  8 xxxxxxxxx xxxxxxxxx x xxx x xxx xxxxxxx xxxxxxxxxxxxxxxxxxxxxxxx
  9 xxx x xxxxx xxxxxxxxxxxxxxxxxxxxx xxxxxxxxxxx xxxxx xxxxxxxxxxxx
 10 x xxxxxxxxxxxxxxxxx xxx xxxxx xxxxxxx xxxxx xxxxx xxxxxxxxx xxxx
 11 xxx xxx x xxxxxxxxxxxxxxxxx xxxxxxxxx xxxxx xxxxxxxxxxxxxxxxxxx
 12 xxxxxxxxxxxxxxxxxxxxx xxxxxxx xxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxxx
 13 x xxx x xxx xxxxxxxxxxxxxxxxx xxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxxx
 14 x x xxx xxxxxxx xxxxx xxx xxxxx xxxxxxxxxxx xxxxxxxxxxxxx xxxxxx
 15 xxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxx xxxxx xxx x xxxxx xxx

Scr# 4021 
  0 xxxxxxxxxxxxx xxx x xxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxx x xxx xxxx
  1 x xxxxxxx xxxxxxxxx x xxxxxxxxx x xxxxxxxxx x xxx xxxxxxxxxxxxxx
  2 xxxxxxxxxxxxxxx x xxxxxxxxxxx xxxxxxxxxxx xxxxxxxxx xxxxxxxxxxxx
  3 xxxxx xxxxxxxxxxx xxxxxxxxxxxxx xxxxxxxxx x xxxxxxxxxxx xxxxx xx
  4 xxxxxxx xxxxx xxxxxxxxxxxxx xxxxxxxxxxx xxx xxxxxxxxxxxxx xxx xx
  5 xxxxxxxxxxxxxxx x xxxxxxxxx xxxxxxx xxx xxxxxxx xxxxxxxxx xxxxxx
  6 xxxxx xxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxx xxxxxxx xxxxx xxxxxxxx
  7 xxxxxxxxx xxxxxxxxxxxxxxx xxxxxxxxxxxxx xxxxx xxxxx xxxxxxxxx xx
  8 xxxxxxxxxxx xxx xxxxx x xxxxxxxxxxx xxxxxxxxxxx xxx xxxxx xxxxx
  9 xxxxxxxxxxx x xxxxxxxxxxxxxxx x xxxxxxxxxxx xxxxx xxx xxxxxxxxxx
 10 xxx xxxxx xxx x xxxxxxxxxxx xxxxxxxxxxxxxxxxx xxx xxxxxxxxxxxxxx
 11 xxxxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxx xxxxxxxxxxx xxxxxxxxxxx
 12 x xxx x xxx xxxxxxx xxxxxxxxxxx xxx xxxxxxxxxxxxxxxxxxxxxxxxxxxx
 13 xxxxxxx xxxxx xxxxxxxxxxxxxxxxx x xxxxxxxxxxx xxxxxxxxx xxxxx xx
 14 xxxxxxxxx xxxxxxxxxxxxxxxxxxxxxxx xxxxxxx xxxxx xxxxx xxxxxxxxxx
 15 xxxxx xxxxxxxxxxx x xxxxxxxxxxxxxxxxx xxxxxxxxx xxxxxxxxxxxxxxxx

Scr# 4022 
  0 xxx xxxxxxxxx x xxxxx xxxxxxxxxxxxxxxxx xxx x xxxxxxxxxxxxxxxxxx
  1 xxxxxxxxxxxxxxxxxxxxx xxxxx x xxxxxxxxxxxxxxx x xxx xxxxxxx xxxx
  2 xxxxxxxxxxxxx xxxxxxxxx xxxxxxxxxxx xxxxx x xxxxxxxxx xxxxxxx xx
  3 x xxxxx xxxxxxxxxxx x xxxxxxxxx xxxxxxxxxxxxxxxxx xxxxxxx xxxxx
  4 xxx xxxxxxxxxxxxxxxxxxx xxx xxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
  5 xxxxx xxxxx x xxxxxxxxx xxxxx xxxxxxxxxxxxxxxxxxxxxxx xxxxx xxxx
  6 xxxxxxxxx xxxxxxxxxxxxxxx xxxxx xxxxxxxxxxxxxxxxx x xxxxxxxxx xx
  7 xxxxxxxxxxxxxxxxx xxxxxxxxx xxxxxxx xxxxx xxx xxxxx x xxxxxxxxx
  8 x xxxxxxxxxxx xxx x xxx xxxxxxx xxxxxxxxx xxxxx xxxxxxxxxxx xxxx
  9 xxxxxxxxxxxxx xxxxxxxxxxxxx xxxxxxxxxxx xxxxxxxxxxxxxxx xxxxxxx
 10 xxxxx xxxxxxxxxxxxxxx xxxxxxx xxx x xxxxx xxxxxxxxxxxxxxxxx xxxx
 11 xxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxx xxxxxxxxx xxxxxxxxxxx x xx
 12 x xxxxxxxxxxxxx xxxxxxxxx xxxxx xxxxx xxxxx xxxxxxxxxxxxxxxxx xx
 13 xxxxxxxxx x xxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxx xxxxxx
 14 xxxxxxx xxxxxxxxxxxxxxx xxxxxxxxxxx xxxxxxxxxxxxx xxxxxxxxxxxxxx
 15 xxxxxxxxx xxxxxxxxxxx xxxxxxxxxxxxxxxxxxxxx xxxxx x xxxxxxxxx xx

Scr# 4023 
  0 xxxxx xxx x xxx xxxxxxxxxxxxx xxxxxxxxxxx xxxxx xxx xxxxx xxxxxx
  1 xxxxxxx xxx x xxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxx x xxxxx xx
  2 xxxxxxx x xxxxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxxxx x
  3 xxx xxxxx xxxxxxx xxxxx xxxxx xxxxxxxxxxxxxxx xxxxxxxxxxx xxxxxx
  4 xxxxx xxxxx xxxxxxx xxx x xxxxxxxxxxxxxxxxxxxxxxx xxxxxxxxxxx xx
  5 x xxxxx xxxxxxx xxxxx xxxxx xxxxxxxxx x xxxxx xxxxxxxxxxx xxxxxx
  6 xxxxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxx xxxxx xxx xxxxxxxxxxx xxxxxx
  7 x xxxxx xxxxxxxxxxx xxx xxxxx xxxxxxxxxxxxx xxxxx xxxxxxxxxxx xx
  8 xxxxxxx xxxxx xxxxx xxxxxxx xxxxx xxxxx xxx x xxx xxxxxxx xxxxxx
  9 xxxxx xxx xxxxxxxxxxxxx xxxxxxxxxxxxxxxxx xxxxxxxxx x xxxxxxxxxx
 10 xxxxx xxxxx xxxxxxxxxxxxxxxxxxx xxxxx xxxxxxxxx xxxxxxx xxx xxxx
 11 xxxxxxxxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx xx
 12 xxxxxxxxx xxxxxxx xxxxxxxxxxxxxxxxxxxxx xxxxxxxxxxx x xxxxx xxxx
 13 xxxxxxx xxxxxxxxxxxxxxx xxxxx xxxxx x xxxxxxxxxxxxxxxxx xxx xxxx
 14 xxxxxxxxxxxxxxxxxxxxx xxx xxxxxxx xxxxxxxxxxxxxxxxx xxxxxxxxx xx
 15 xxxxx xxxxxxxxx xxxxx xxxxxxxxxxxxx xxx xxxxxxxxxxxxxxxxxxx xxxx

Scr# 4024 
  0 xxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxx xxxxxxxxxxx xxxxxxx xxxxxxxx
  1 xxxxxxxxxxxxxxxxxxx xxxxxxxxxxx xxxxx xxxxx xxxxxxx xxxxx xxxxxx
  2 xxxxx xxxxxxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxx xxxxxxxxxxxxx xxx
  3 xxxxxxxxxxxxx xxxxxxxxxxx xxxxx xxxxxxxxx xxxxxxxxxxx xxxxxxxxxx
  4 xxxxxxxxx xxxxx xxx xxxxxxx xxxxxxxxxxxxxxxxx xxxxxxxxxxx xxxxxx
  5 xxxxxxxxxxx xxxxxxxxx x xxx xxxxxxxxxxxxxxxxxxx xxxxxxxxx xxxxxx
  6 xxxxxxx xxx xxxxx x xxxxxxxxx xxxxxxxxxxxxxxxxxxxxxxx xxxxxxxxxx
  7 xxxxxxx x xxx xxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxx xxxxxxxxxxxxx
  8 xxxxxxxxx xxxxxxxxxxxxx xxxxx xxx xxxxx xxxxxxxxxxxxxxxxxxx xxxx
  9 x xxxxxxxxx xxxxx x xxxxxxxxxxx xxxxx xxxxxxxxxxxxxxxxxxxxxxxxxx
 10 xxx xxxxxxxxx xxxxxxx xxxxx xxx xxxxx xxxxxxx xxxxxxxxxxxxxxxxxx
 11 xxxxxxxxxxxxxxxxxxxxx x xxx x xxxxxxxxxxx xxxxxxxxxxxxxxxxx xxx
 12 xxxxx xxxxxxx xxxxxxxxx xxxxx xxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxx
 13 x x xxxxxxxxxxx xxxxxxxxxxxxxxx xxxxxxx xxxxx xxx xxxxx xxxxx x
 14 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxxxxxxxxx
 15 x xxx xxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxx x xxx xxxxx xxxxxxxxxx

Scr# 4025 
  0 x x xxxxx xxxxxxxxxxx xxxxxxxxxxx xxxxx xxx xxxxxxxxxxxxx xxxxxx
  1 xxx xxxxx xxxxx xxxxxxxxxxxxx xxxxxxxxx xxxxxxxxxxxxx xxxxxxxxxx
  2 xxxxx xxxxxxx xxxxx xxxxxxxxxxx xxx xxxxxxx xxxxxxxxxxxxxxxxxxxx
  3 x xxxxx x xxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxxxx xxxxx x xxxxxx
  4 xxxxxxxxxxx xxxxx xxxxxxxxxxxxxxx xxxxxxxxxxxxx xxxxxxxxx xxxxx
  5 xxxxxxxxxxx x xxxxx xxx xxxxxxx xxxxxxxxxxxxxxxxx xxxxxxxxxxx xx
  6 xxxxxxxxxxxxx x xxx xxxxxxxxxxxxx xxx xxxxxxx xxxxxxxxxxx xxxxxx
  7 xxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxx xxxxxxx xxx
  8 x xxxxx xxxxxxxxxxxxxxxxxxxxx xxxxxxxxxxx xxxxxxx xxxxxxxxx xxxx
  9 x xxxxx xxxxx xxxxxxxxxxxxx xxxxx xxxxxxxxxxxxxxxxx xxxxxxxxx xx
 10 xxxxxxxxx x xxxxxxxxx x xxx xxxxxxxxxxxxxxxxxxxxxxxxx xxx xxxxxx
 11 xxxxx xxxxxxx xxx xxxxxxxxxxxxxxxxx xxxxxxx xxxxxxxxx xxxxxxxxxx
 12 xxx xxxxxxxxxxxxxxx xxxxx xxxxx xxxxxxx xxxxxxxxx xxxxx xxxxxxx
 13 xxxxx xxxxxxxxxxx xxxxxxxxx xxxxxxxxxxxxxxxxxxx xxxxxxxxx xxxxxx
 14 x xxx xxxxxxxxxxx xxxxxxxxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxx xx
 15 x xxxxxxxxxxx xxxxxxxxxxxxxxxxx xxxxx xxxxxxxxxxxxxxxxxxxxxxxxxx

Scr# 4026 
  0 xxx xxxxx xxxxxxx xxxxx xxxxxxxxxxxxxxxxxxxxx xxxxxxxxxxx x xxx
  1 xxxxx xxxxx x xxxxxxxxx x xxx xxxxx xxxxx x xxxxx xxxxxxxxxxxxxx
  2 xxxxxxx xxxxxxxxxxxxxxxxx xxxxx xxxxxxxxxxxxxxxxx xxxxxxxxxxx xx
  3 xxxxx xxxxxxxxxxx xxxxx xxxxxxxxx xxxxxxxxxxx x xxxxxxxxxxxxxxx
  4 x xxxxxxxxx x xxxxxxxxx xxxxxxxxxxxxxxxxx xxxxx xxxxxxxxxxxxxxxx
  5 xxx xxx x xxxxx xxxxxxxxxxxxxxxxxxxxx xxxxx xxxxx xxxxxxxxxxxxxx
  6 xxx xxxxx xxxxxxxxxxxxx xxxxxxxxxxx xxxxxxxxxxxxxxx x xxxxx xxxx
  7 x xxx xxxxxxxxxxxxx xxxxxxxxxxx xxx x xxxxxxxxxxxxxxxxx xxxxxxxx
  8 xxxxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxxxxxxxx xxxxx xx
  9 xxxxxxxxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxx x xxxxxxxxxxx xxxxx xxxx
 10 xxxxxxx xxxxx xxx x xxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxxx
 11 x xxxxxxx xxxxxxxxxxxxxxxxxxxxxxx xxxxx xxxxxxxxxxxxxxxxxxxxxxxx
 12 xxxxx xxxxxxxxx x xxxxxxxxxxxxxxxxx xxx xxxxx xxxxxxxxxxx xxxxxx
 13 x xxxxxxxxxxxxxxxxxxxxx x xxxxx xxxxxxxxxxxxxxxxxxxxx xxxxxxxxxx
 14 xxxxxxx x xxxxxxxxx x xxxxxxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxx x
 15 xxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxx xxxxxxxxxxxxx xxxxxxxxxxxxxxx

Scr# 4027 
  0 xxxxx xxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxx x xxxxx xxx xxxxxxxxxx
  1 xxxxxxxxxxxxxxxxxxxxx xxx x xxx xxxxx x xxxxxxxxxxx xxx xxxxx xx
  2 xxx xxxxxxxxxxx x xxxxx xxx xxxxx xxxxxxx xxxxx xxx xxxxxxxxxxxx
  3 xxxxxxx xxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxxxxxx xxxxxxx xx
  4 xxxxxxxxxxxxx x xxxxxxxxxxxxxxxxxxxxx x xxx xxxxx xxxxxxx xxxxx
  5 xxxxxxxxxxxxxxx xxxxxxxxxxxxx xxx xxxxxxxxxxxxxxxxx xxxxxxx xxx
  6 xxxxxxxxxxxxxxxxxxx xxxxx xxxxxxxxxxx xxxxxxxxxxx xxxxx xxxxxxxx
  7 x x xxxxxxxxx x xxxxxxxxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxxxxx
  8 xxx xxxxxxxxxxxxxxxxx x xxxxxxxxxxxxxxxxx xxxxxxxxx xxxxxxx xxxx
  9 xxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx x xxx xxxx
 10 x xxxxxxx xxxxxxxxx x xxxxxxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxx x
 11 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxx xxxxxxxxx xxxxx x xxxx
 12 xxxxxxxxxxxxx xxx xxxxx xxxxxxx xxxxxxxxxxxxxxx xxxxxxxxxxxxx xx
 13 xxxxxxxxxxxxx xxxxx xxxxxxxxxxxxx xxx xxxxxxxxxxxxxxxxxxx xxx xx
 14 xxx x xxxxxxxxx xxxxxxxxxxx x xxxxx xxxxxxxxxxx xxxxx xxxxx xxx
 15 xxxxxxxxxxx x xxxxx xxx xxxxxxxxxxx xxxxx xxxxxxx xxx x xxxxx xx

Scr# 4028 
  0 xxxxxxxxxxxxxxxxxxxxxxxxx xxxxx xxxxxxx xxxxxxxxxxx xxxxx xxxxxx
  1 xxxxxxxxxxxxxxx x xxxxx xxxxxxxxxxx xxxxxxxxxxxxxxxxx xxx xxxxxx
  2 xxxxxxx xxxxx xxxxxxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxxxx xxxx
  3 xxx xxx xxxxxxx xxxxxxxxxxxxxxxxxxxxx xxxxxxx xxxxxxxxxxxxxxxxx
  4 xxxxx xxxxxxxxxxxxxxx xxxxxxxxxxx xxxxxxxxxxxxxxxxx xxxxxxxxxxxx
  5 xxxxxxxxxxxxxxxxx xxxxxxx xxx x xxx xxxxx xxxxxxxxxxxxxxxxxxxxxx
  6 xxx xxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxxx
  7 xxx xxxxxxx xxxxx xxxxxxxxx xxxxx xxxxxxxxxxxxx xxxxx xxxxx xxxx
  8 xxxxxxx xxxxxxxxx xxxxx x xxxxxxxxxxx xxxxxxxxx xxxxxxxxxxx xxxx
  9 xxx xxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxx xxxxxxxxx xxxxx xxxxxxx
 10 xxxxxxxxxxxxxxx xxxxx xxxxx xxxxxxx xxxxxxxxxxxxxxx xxxxxxxxxxxx
 11 xxxxxxx xxx x xxxxxxxxx x xxxxxxxxx xxxxxxxxxxx xxxxx xxxxxxx xx
 12 xxx xxxxxxxxx xxxxxxxxxxxxxxxxxxx xxxxxxxxx xxxxxxxxxxxxxxxxx xx
 13 xxxxxxxxxxxxxxxxxxxxxxx xxx xxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxx
 14 x xxx xxxxxxx xxxxx xxxxxxxxxxx xxxxxxxxxxx xxxxxxxxxxxxxxxxx xx
 15 x xxxxxxx xxxxxxxxxxxxxxxxxxxxx xxxxx x xxxxxxxxxxx xxxxxxxxxxxx

Scr# 4029 
  0 xxxxxxxxxxxxxxxxxxxxx xxxxx xxxxxxxxxxxxxxxxx xxxxxxxxxxx xxxxx
  1 x xxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxx xxxxxxxxxxxxxxx xxxx
  2 xxxxxxxxx xxx xxxxxxxxxxxxx xxxxxxxxxxx xxx xxxxx xxxxx x xxxxxx
  3 xxxxxxxxxxxxxxxxxxxxxxxxxxxxx xxx xxxxx xxxxxxxxxxxxxxxxxxx xxxx
  4 xxxxxxx xxxxxxxxxxxxxxxxxxxxxxx xxxxx xxxxxxxxxxxxxxxxxxxxx x xx
  5 xxxxxxxxxxxxx xxxxxxxxxxxxxxxxx xxxxxxxxxxx xxxxxxxxxxx xxxxxxxx
  6 xxxxxxxxx x xxxxx xxxxx xxxxx xxx xxxxx xxxxxxxxxxxxx xxx x xxxx
  7 xxxxxxxxxxxxxxxxx xxxxxxx xxxxxxxxxxx xxxxx xxxxxxxxx xxxxx xxxx
  8 xxx xxxxxxxxxxx xxxxxxxxxxxxxxxxx xxxxxxxxxxx xxxxx xxxxxxxxx x
  9 xxxxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxx xxxxx xxxxx xxx xxxxxxxxxxxx
 10 xxxxx xxxxx xxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxxxx x xxxxxxxx
 11 xxx xxxxxxxxxxxxxxxxxxxxxxx xxx xxxxxxxxxxxxxxxxx xxxxxxxxxxxxxx
 12 xxx x xxxxxxxxxxxxxxxxxxxxx x xxx xxxxxxxxxxx xxxxxxx xxxxxxxxxx
 13 x xxxxxxxxx xxxxxxxxxxxxx xxx x xxxxxxxxxxxxxxxxx xxxxxxxxxxxxxx
 14 x xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxx xxxxx xxxxx xxxxxx
 15 xxxxx xxxxxxxxx xxxxx xxxxxxxxxxx xxxxxxx xxxxx xxx xxxxx xxxxxx

Scr# 4030 
  0 xxxxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxx xxxxxxxxx xxxxxxx xx
  1 xxxxxxxxxxxxxxxxxxx xxxxx xxxxxxx xxxxxxxxxxx xxxxxxxxx x xxxxxx
  2 xxx x xxxxx xxxxxxxxx x xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
  3 xxxxxxxxxxxxxxxxxxx xxxxx xxxxxxxxxxx xxxxxxxxxxxxxxxxxxxxxxxxxx
  4 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxx
  5 xxxxxxxxxxx xxxxxxxxxxx xxxxx xxxxxxxxxxx xxxxxxxxxxxxxxxxxxxxxx
  6 xxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxxxxxx xxxxx xxxxx xxxxxxxx
  7 xxxxxxxxx xxxxx xxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxxxxxxxx
  8 xxxxx xxxxxxxxxxx xxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxxx
  9 xxxxxxxxxxxxxxxxxxxxxxxxx xxxxx xxxxx xxxxxxxxxxxxxxxxxxxxxxx xx
 10 xxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
 11 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxxxxxxx
 12 x xxxxxxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxx xxxxxxxxxxx xxxxxxxx
 13 xxxxxxxxxxxxxxx xxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
 14 xxxxxxxxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxx xxxxxxxxxxxxxxxx
 15 xxxxxxx xxxxxxxxxxx xxxxxxxxxxxxxxxxxxxxxxx xxxxx xxxxxxxxxxx xx

Scr# 4031 
  0 xxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
  1 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxxxxx
  2 x xxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
  3 xxxxxxxxxxxxxxxxxxxxx xxxxx xxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxxx
  4 xxxxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxx xxxx
  5 xxxxxxxxxxxxx xxxxx xxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxxxxx
  6 xxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxx
  7 xxxxxxxxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxx xxxx
  8 x xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxxx
  9 xxx xxxxxxxxxxxxxxxxx xxxxxxxxxxx xxxxx xxxxxxxxxxxxxxxxxxxxxxxx
 10 xxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxxxxxx xxxx
 11 x xxxxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxxxxxxxx xxxxxxxxxxxxxxxxx xx
 12 xxxxxxxxx xxxxxxxxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxxxxxxxxx
 13 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxxx
 14 xxxxxxxxxxxxx xxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxx xxxxxxxxxxxxxx
 15 xxxxxxxxx xxxxx xxxxxxxxxxx xxxxxxxxxxx xxxxxxxxxxxxxxxxx xxxxxx

Scr# 4646 
  0 ( reply )
  1 
  2 
  3 
  4 
  5 
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 6475 
  0 ( solid circle )
  1 needs graphics
  2 marker task
  3 : solid-circle-eight
  4   cx sx xy-ratio + cy sy +
  5   cx sx xy-ratio - cy sy - draw-line
  6 \ cx sx xy-ratio - cy sy + plot
  7 \ cx sx xy-ratio + cy sy - plot
  8 \ cx sy xy-ratio + cy sx + plot
  9 \ cx sy xy-ratio - cy sx + plot
 10 \ cx sy xy-ratio + cy sx - plot
 11 \ cx sy xy-ratio - cy sx - plot
 12 ;
 13 -->
 14 
 15 

Scr# 6476 
  0 : solid-circle ( x y r -- )
  1   0 to sx  to sy  to cy  to cx
  2   sy if
  3     3 sy 2* - to diff
  4     solid-circle-eight
  5     begin
  6       1 +to sx  diff 0<  if
  7         sx      2* 2*  6 + +to  diff
  8       else
  9         sx sy - 2* 2* 10 + +to  diff -1 +to sy
 10       then
 11       solid-circle-eight
 12     sy sx < until
 13   else
 14     cx cy plot
 15   then ;

Scr# 6989 
  0 ( new SPLASH with string on Heap )
  1 needs HEAP  needs PAD"  needs POINTER
  2 \
  3 hex HP@ u.
  4 DECIMAL 40 HEAP pointer P1
  5 PAD" v-Forth 1.7 NextZXOS version"
  6 PAD P1 40 CMOVE
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 8990 
  0 ( PRESENTATION )
  1 \
  2 : LINER
  3   CR
  4   62 0 DO
  5     [CHAR] _ EMIT
  6   LOOP
  7   CR
  8 ;
  9 \
 10 -->
 11 
 12 
 13 
 14 
 15 

Scr# 8991 
  0 ( PRESENTATION )
  1 \
  2 : SHOW1  ( n -- )
  3   CLS
  4   0 OVER .LINE
  5   LINER
  6   16 1 DO
  7     CR   I OVER .LINE
  8   LOOP
  9   LINER
 10   CR CR ." [ N ]-ext  [ P ]-rev   [ Break ] "
 11   8999 - 25 .R SPACE
 12 ;
 13 \
 14 -->
 15 

Scr# 8992 
  0 ( PRESENTATION )
  1 \
  2 9000 VARIABLE SLIDE#
  3 \
  4 \
  5 : DECIDE ( c -- )
  6   UPPER
  7   DUP [CHAR] N = IF  1 SLIDE# +! THEN
  8       [CHAR] B = IF -1 SLIDE# +! THEN
  9 \
 10 ;
 11 -->
 12 
 13 
 14 
 15 

Scr# 8993 
  0 ( PRESENTATION )
  1 \
  2 decimal
  3 : SHOW ( n -- )
  4   8999 + SLIDE# !
  5   BEGIN
  6     SLIDE# @ SHOW1
  7     KEY DECIDE
  8   ?TERMINAL
  9   UNTIL
 10 ;
 11 
 12 
 13 
 14 
 15 

Scr# 8998 
  0 ( wait )
  1 NEEDS INVERT HEX
  2 : ?STOP ?TERMINAL IF QUIT THEN ;
  3 : WAIT-KEY
  4   BEGIN ?STOP
  5     0FE P@ 01F AND
  6   1F = UNTIL
  7   ." HERE "
  8   BEGIN
  9     ?TERMINAL IF QUIT THEN
 10     0FE P@ 01F AND
 11   1F - UNTIL
 12 ;
 13 
 14 
 15 

Scr# 8999 
  0 ---  D I R E C T O R Y  ---
  1 
  2 This is SD card dir tree
  3 
  4 C:/
  5     Tools /
  6             vForth /
  7                      doc /
  8                      inc /
  9                      lib /
 10                      src /
 11                      test /
 12                      util /
 13 
 14 
 15 

Scr# 9000 
  0 ---  T I M E L I N E  ---
  1 
  2 1990  Disassembly of White Lightning - Oasis Software
  3 
  4 1991  ZX-Microdrive version compiled with GENS-3
  5 
  6 1998  Z80 Emulator - Gerton Lunter's Emulator
  7 
  8 2001  ASSEMBLER VOCABULARY - Albert van der Horst's porting
  9 
 10 2018  DiSCIPLE version (Emulator)
 11 
 12 2020  Spectrum NextZXOS version (Real thing)
 13 
 14 
 15 

Scr# 9001 
  0 ---  D I R E C T O R Y  ---
  1 
  2 This is SD card dir tree
  3 
  4 C:/
  5     Tools /
  6             vForth /
  7                      demo /
  8                      doc /
  9                      inc /
 10                      lib /
 11                      src /
 12                      test /
 13                      util /
 14 
 15 

Scr# 9002 
  0 ---  M E M O R Y   M A P  ---
  1 0000 - 3FFF  ROM
  2 4000 - 5AFF  Display File  &  Attribute File
  3 5B00 - 5CB4  ZX Spectrum System variables
  4 5CB6 - 61FF  Streams Area  and  Basic Program Area till RAMTOP
  5 6200 - 630F  IM2 Interrupt vector to $6363
  6 6366 -       Forth Origin                  0 +ORIGIN
  7     DP       Top of Dictionary             HERE   or  DP @
  8 
  9     SP       Calculator Stack              SP@
 10 D0E8 - D187  Text Input Buffer             TIB @  or  S0 @
 11     RP       Return Stack: 80 cells deep   RP@
 12 D188 - D1E3  Forth User Variables
 13 D1E4 - DFFF  First of 7 disk buffer  from  FIRST @  to  LIMIT
 14 E000 - FFFF  8 KB RAM page to fit any 8 KB of 2 MB RAM
 15 

Scr# 9003 
  0 ---  U T I L I T I E S  ---
  1   Full Screen Editor               NEEDS EDIT
  2 
  3   Search & Locate Utility          NEEDS LOCATE  NEEDS GREP
  4 
  5   SEE Inspect Utility              NEEDS SEE
  6 
  7   Z80n Assembler                   NEEDS ASSEMBLER
  8 
  9   Heap Memory Managent             NEEDS HEAP
 10 
 11   Interrupt Sevice Routine         NEEDS INTERRUPT
 12 
 13   Floating Point Option            NEEDS FLOATING
 14 
 15   Test suite                       INCLUDE TEST/CORE-TESTS.F

Scr# 9004 
  0 ---  E X A M P L E S  ---
  1 
  2   246 load    Buzzphrases, smart use of BLOCKs
  3   279 load    Fibonacci, first 46 elements of series
  4   281 load    Primality test
  5   400 load    Sprite movement example - Interrupt driven
  6   420 load    Tilemap example
  7   511 load    Sine-Cosine table example.
  8   520 load    Layer 2 palette color picker.
  9   770 load    BMP format
 10 
 11   600 load    Chomp2  ( Pac Man style game )
 12 
 13   brot13.f    Mandelbrot set example
 14 
 15 

Scr# 9005 
  0 ---  A S S E M B L E R   1  ---
  1 00 0000  030  T!
  2 10 00  4  XFAMILY,  BC|   DE|   HL|   AF|
  3 00 0000  030  T!
  4 04 C1  2  1FAMILY,  POP   PUSH
  5 
  6   push    af|
  7   pop     hl|
  8 
  9 00 1000  000  T!
 10 08 10  2  1FAMILY,  DJNZ  JR
 11 
 12 0 1 0 1000  C,  COMMAER  D,
 13 
 14   djnz  BACK,
 15 

Scr# 9006 
  0 ---  A S S E M B L E R   2  ---
  1 00 0000  007  T!
  2 01 00  8  XFAMILY,  B|   C|   D|   E|   H|   L|   (HL)|  A|
  3 00 0000  007  T!
  4 08 00  8 CBFAMILY,  RLC  RRC  RL   RR   SLA  SRA  SLL    SRL
  5 
  6   rlc  (hl)|
  7   sla     c|
  8 
  9     0000  438  T!
 10 08 00  8  XFAMILY,  0|   1|   2|   3|   4|   5|   6|   7|
 11 00 0000  43F  T!
 12 00 40  3 CBFAMILY,  BIT  RES  SET
 13 
 14   bit      4|    a|
 15   set      6| (hl)|

Scr# 9007 
  0 ---  A S S E M B L E R   3  ---
  1   adca  (hl)|                   ld()x   bc|  3FFF  AA,
  2   andn    1F    N,              ldx()   bc|  3FFF  AA,
  3                                 ld()a        3FFF  AA,
  4   addhl   bc|                   lda()        3FFF  AA,
  5 
  6   decx    de|                   dec   (IY'+  03  )|
  7   incx    hl|                   inc     a'|
  8 
  9   ex(sp)hl                      ldsphl
 10   exafaf
 11                                 ldia
 12   ld      a'|    b|
 13   ldn     c'|   3F   N,         halt
 14   ldx     bc|   1FFF NN,
 15 

Scr# 9008 
  0 ---  A S S E M B L E R   4  ---
  1   CODE DUP ( n -- n n )
  2        pop     hl|
  3        push    hl|
  4        push    hl|
  5        jpix          C;
  6 
  7   CODE !   ( n a -- )
  8        pop     hl|
  9        pop     de|
 10        ld   (hl)'|     e|
 11        incx    hl|
 12        ld   (hl)'|     d|
 13        jpix          C;
 14 
 15 

Scr# 9009 
  0 ---  D I R E C T   v s   I N D I R E C T ---
  1  NEXT: ld  a,(bc)    ld  a,(bc)    ;  7      =     IP: bc reg.
  2        inc bc        inc bc        ;  6      =     SP: sp reg.
  3        ld  l,a       ld  l,a       ;  4      =     RP: memory
  4        ld  a,(bc)    ld  a,(bc)    ;  7      =
  5        inc bc        inc bc        ;  6      =
  6        ld  h,a       ld  h,a       ;  4      =     _
  7                      ld  e,(hl)    ;         7      |
  8                      inc hl        ;         6      |_ 24
  9                      ld  d,(hl)    ;         7      |
 10                      ex  de,hl     ;         4     _|
 11        jp  (hl)      jp  (hl)      ;  4      =
 12 
 13   CFA: call ENTER    DW  ENTER:    ; 17      0     IP: bc reg.
 14                                     ---    ---
 15                                      55 T   62 T   diff. -12%

Scr# 9010 
  0 ---  D I R E C T   v s   I N D I R E C T ---
  1   CFA: the_code      DW  $+2       ;         0     IP: bc reg.
  2                                                    SP: sp reg.
  3 ENTER: ex  de,hl     ld  hl,(RP)   ;  =     16     RP: memory
  4        ld  (hl),b    ld  (hl),b    ;  7      7
  5        inc hl        inc hl        ;  6      6
  6        ld  (hl),c    ld  (hl),c    ;  7      7
  7        inc hl        inc hl        ;  6      6
  8        ex  de,hl     ld  (RP),hl   ;  =     16
  9                      inc de        ;         6
 10                      ld  c,e       ;         4
 11                      ld  b,d       ;         4
 12        pop bc                      ; 10
 13        jp  (ix)      jp  (ix)      ;  8      8
 14                                     ---    ---
 15        107=55+52     144=62+82       76 T   82 T   diff. -07%

Scr# 9012 
  0 ---  H E A P   C O N C E P T  ---
  1 
  2  224  pages    8 KB each      1.792 KB  in total
  3 
  4  200  pages                   1.600 KB  available
  5 
  6 
  7 |                    |     16 - bit Heap Pointer             |
  8 |                    |  P P P b  b b b b   b b b b  b b b b  |
  9 |                    |  . . .                                |
 10 |        Page        |                Offset                 |
 11 |  0 0 1 0  0 P P P  |  1 1 1 b  b b b b   b b b b  b b b b  |
 12 |             . . .  |                                       |
 13 |                    |
 14 | Pages: $20 - $27   |  Offset: $E000 - $EFFF
 15 

Scr# 9013 
  0 ---  H E A P   D E F I N I T I O N S  ---
  1 
  2 HEAP-INIT      Ask 64K of Memory from NextZXOS
  3 HEAP-DONE      Free 64K of Memory to NextZXOS
  4 
  5 S"             Accept a string and store it to Heap
  6 
  7 POINTER        Create a CONSTANT heap-pointer that return a
  8                resolved Offset to the right Page
  9 
 10 HEAP           Reserve bytes on Heap and return a heap-pointer
 11                suitable for POINTER
 12 
 13 FAR            Converts a heap-pointer into an Offset and
 14                performs the correct 8K paging at $E000
 15 

Scr# 9058 
  0    8 24 at. h-bar count type
  1   13 9 do i 24 at. v-bar count type loop
  2   13 24 at. h-bar count type
  3 ;
  4 -->
  5 
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 9990 
  0 ( splash screen )
  1 needs remount
  2 needs graphics
  3 splash
  4 marker go
  5 : chunk-h ( x y -- )
  6   over 1- over 2+ over     over 26 + draw-line
  7   over 1+ over 2+ over     over 26 + draw-line
  8                   over     over 30 + draw-line ;
  9 : chunk-v ( x y -- )
 10   over 1- over 1+ over 10 + over      draw-line
 11   over    over 2+ over  8 + over      draw-line
 12   over 1- over 1- over 10 + over      draw-line
 13   over    over 2- over  8 + over      draw-line
 14   swap 1- swap    over 10 + over      draw-line ;
 15 -->

Scr# 9991 
  0 ( splash screen )
  1 : chunk-o ( x y -- )
  2   over 1- over 1- over     over  2 + draw-line
  3   over 1+ over 1- over     over  2 + draw-line
  4                2- over     over  4 + draw-line ;
  5 : down-1 ( x y -- x y )
  6   swap 2 + swap ;
  7 -->
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 9992 
  0 ( splash screen )
  1 : letter-i  ( x y -- )
  2   2dup chunk-v
  3   swap 5 - swap chunk-o ;
  4 : letter-r  ( x y -- )
  5   2dup chunk-v
  6   1+   chunk-h ;
  7 : letter-n  ( x y -- )
  8   2dup letter-r
  9   30 + chunk-v ;
 10 -->
 11 
 12 
 13 
 14 
 15 

Scr# 9993 
  0 ( splash screen )
  1 : letter-s  ( x y -- )
  2           2dup chunk-h
  3   down-1  2dup  1 + chunk-o
  4   down-1  2dup chunk-h
  5   down-1  2dup 29 + chunk-o
  6   down-1       chunk-h ;
  7 -->
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 9994 
  0 ( splash screen )
  1 100 100 letter-s
  2 100 140 letter-i
  3 100 150 letter-n
  4 
  5 
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 9999 
  0 ( MIT License )
  1 NEEDS PAD"
  2 DECIMAL
  3 : LICENSE
  4   PAD" LICENSE.MD"
  5   PAD DUP 10 - 01 F_OPEN 41 ?ERROR >R
  6   30 EMITC 6 EMITC
  7   BEGIN
  8    1 BLOCK B/BUF BLANK
  9    1 BLOCK B/BUF R@ F_GETLINE
 10    DUP IF 1 BLOCK B/BUF 2- -TRAILING TYPE CR THEN
 11   0= UNTIL
 12   30 EMITC 8 EMITC
 13   R> F_CLOSE 42 ?ERROR
 14 ;
 15 

Scr# 10000 
  0 ( splash screen )
  1 marker go
  2 needs remount
  3 needs graphics
  4 splash
  5 : chunk ( x y -- )
  6   over 1- over 1+ 2dup 20 + draw-line .s
  7   over 1+ over 1+ 2dup 20 + draw-line .s
  8                   2dup 22 + draw-line .s
  9 ;
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 10001 
  0 ( Table of contents 1/2 ) ;S
  1  10 Editor Case-Of Call
  2  20 Debugger Stack Esc Voc
  3  30 Floating point functions
  4  40 Rnd Color Draw Exists
  5  50 Bleep Tape Frame ms
  6  60 Interrupt Handler
  7  70 Microdrive utilities
  8  80 Tape RS232
  9  90 String
 10 100 Assembler
 11 110  "  "
 12 120  "  "
 13 130  "  "
 14 140  "  "
 15 150 Tester for Assembler

Scr# 10002 
  0 ( Table of contents 2/2 ) ;S
  1 ( Screen 1 is index for    )
  2 (  screens from 10 to 159  )
  3 ( Screen 2 is index for    )
  4 (  screens from 160 to 254 )
  5 ( ------------------------ )
  6 160
  7 170
  8 180
  9 190
 10 200
 11 210
 12 220
 13 230
 14 240
 15 250

Scr# 10003 
  0 .( Autoexec. )            CR
  1 ." Loading screen #3 " CR
  2 DECIMAL 10 LOAD \ Line edit
  3 DECIMAL 17 LOAD \ Case-Of
  4 DECIMAL 20 LOAD \ Debugger
  5 \ DECIMAL 19 LOAD \ Call#
  6 ." 9 LOAD for assembler." CR
  7 \
  8 \ ZXNEXTOS version
  9 \ BLOCKs are stored in file
 10 \ !Blocks.bin
 11 DECIMAL 1024 16 * 1 -
 12 ' #SEC >BODY !
 13 ." #SEC is "
 14 DECIMAL #SEC . CR
 15 

Scr# 10004 
  0 ( Error messages    1/3 )
  1 Stack is empty. # 1
  2 Dictionary full. # 2
  3 No such line. # 3
  4  has already been defined. # 4
  5 Invalid stream. # 5
  6 No such block. # 6
  7 Stack is full! # 7
  8 Old dictionary is full. # 8
  9 Tape error. # 9
 10 Wrong array index. # 10
 11 Invalid floating point. # 11
 12 msg # 12
 13 msg # 13
 14 msg # 14
 15 msg # 15

Scr# 10005 
  0 ( Error messages    2/3 )
  1 Can't be executed. # 17
  2 Can't be compiled. # 18
  3 Syntax error. # 19
  4 Bad definition end. # 20
  5 is a protected word. # 21
  6 Aren't loading now. # 22
  7 Forget across vocabularies. # 23
  8 RS loading error. # 24
  9 Cannot open stream. # 25
 10 Error at postit time. # 26
 11 Inconsistent fixup. #27
 12 Unexpected fixup/commaer. # 28
 13 Commaer data error. # 29
 14 Commaer wrong order. # 30
 15 Programming error. # 31

Scr# 10006 
  0 ( Error messages    3/3 )
  1 Programming error. # 33
  2 
  3 
  4 
  5 
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 ZXNEXTOS SET POS error.
 14 ZXNEXTOS READ error.
 15 ZXNEXTOS WRITE error.

Scr# 10007 
  0 ( Get the list of errors )
  1 DECIMAL
  2 : LIST-OF-ERRORS
  3   3 0 DO
  4    I 1+ 16 * I 16 * DO
  5     I MESSAGE CR
  6    LOOP
  7    ."   press any key..."
  8    KEY CR
  9   LOOP
 10 ;
 11 
 12 
 13 
 14 
 15 

Scr# 10008 
  0 ( DR0 )
  1 
  2 
  3 
  4 
  5 
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 10009 
  0 ." Assembler. "           CR
  1 \
  2 \ Loads ASSEMBLER vocabulary
  3 \
  4 DECIMAL 100 LOAD
  5 DECIMAL 120 LOAD
  6 DECIMAL 140 LOAD
  7 DECIMAL 160 LOAD \ Z80N
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 10010 
  0 .( Line editor. )         CR
  1 \ Inverse/True Video
  2 : INVV
  3   [ HEX 14 ] LITERAL EMITC
  4   1 EMITC
  5 ;
  6 : TRUV
  7   [ HEX 14 ] LITERAL EMITC
  8   0 EMITC
  9 ;
 10 DECIMAL
 11 -->
 12 
 13 
 14 
 15 

Scr# 10011 
  0 ( Line Editor          2/6 )
  1 B/SCR B/BUF C/L */ DECIMAL
  2 CONSTANT L/SCR
  3 : TEXT
  4   HERE C/L 1+ BLANKS
  5   WORD      PAD C/L 1+
  6   CMOVE ;
  7 : LINE DUP 0 < 3 ?ERROR
  8   DUP L/SCR < 0= 3 ?ERROR
  9   SCR @ (LINE) DROP ;
 10 : -MOVE
 11   LINE C/L CMOVE UPDATE ;
 12 : H
 13   LINE PAD 1+ C/L DUP PAD
 14   C! CMOVE ;
 15 --> \ continues to next

Scr# 10012 
  0 ( Line Editor          3/6 )
  1 : E
  2   LINE DUP C/L BLANKS
  3   1 ERASE UPDATE ;
  4 : RE
  5   PAD 1+ SWAP -MOVE ;
  6 : D
  7   DUP H L/SCR 1 - DUP ROT
  8   DO I 1+ LINE I -MOVE
  9   LOOP E ;
 10 : S
 11   DUP 1 - L/SCR 2 - DO I
 12   LINE I 1+ -MOVE -1 +LOOP
 13   E ;
 14 : INS
 15   DUP S RE ; -->

Scr# 10013 
  0 ( Line Editor          4/6 )
  1 : P ( n -- ) \ put line n
  2   126 TEXT RE ;
  3 : L ( -- ) \ list current
  4   SCR @ LIST ;
  5 : N ( -- ) \ next screen
  6   1 SCR +! L ;
  7 : B ( -- ) \ back screen
  8   -1 SCR +! L ;
  9 : BCOPY ( scr dest -- )
 10   DUP SCR ! SWAP BLOCK SWAP
 11   BLOCK B/BUF CMOVE UPDATE ;
 12 -->
 13 : BCLEAR ( scr --- )
 14   SCR ! L/SCR 0 DO
 15   I E LOOP ;

Scr# 10014 
  0 ( Line Editor          5/6 )
  1 : WHERE
  2   DUP B/SCR / DUP SCR !
  3   ." Screen# " DECIMAL .
  4   SWAP C/L /MOD CR DUP
  5   [ 3 ] LITERAL .R SPACE
  6   ROT (LINE) DROP
  7   SWAP 1 - DUP >R
  8   HERE C@ - 2DUP TYPE +
  9   HERE C@ INVV 2DUP TYPE +
 10   64 R> - TRUV TYPE QUIT ;
 11 -->
 12 \ quick reference
 13 [TIB]    [PAD]      [BLOCK]
 14      TEXT     H E RE
 15               D S INS

Scr# 10015 
  0 ( Line Editor          6/6 )
  1 : .PAD
  2   PAD C/L -TRAILING TYPE ;
  3 : SAVE
  4   UPDATE FLUSH ;
  5 : UNUSED SP@ PAD - ;
  6 : ROOM UNUSED U.
  7   ." bytes free." CR ;
  8 ;S
  9 
 10 : BMOVE OVER SWAP BCOPY
 11   BCLEAR ;
 12 ;S
 13 
 14 
 15 

Scr# 10016 
  0 ( Editor utility           )
  1 \ multiple BCOPY
  2 : MBCOPY ( b1 b2 n --- )
  3 FLUSH
  4 >R 2DUP > IF
  5   R> 0 DO 2DUP BCOPY
  6   1 + SWAP 1 + SWAP
  7   46 EMIT LOOP
  8 ELSE
  9   R@ + 1 - SWAP R@ + 1 - SWAP
 10   0 R> DO 2DUP BCOPY
 11   1 - SWAP 1 - SWAP
 12   46 EMIT -1 +LOOP
 13 THEN
 14 2DROP ;
 15 

Scr# 10017 
  0 .( Case-of structure. )   CR
  1 : CASE
  2   ?COMP CSP @ !CSP 4 ;
  3   IMMEDIATE
  4 : (OF)
  5   OVER = DUP IF SWAP DROP
  6   ENDIF ;
  7 : OF
  8   4 ?PAIRS COMPILE (OF)
  9   COMPILE 0BRANCH HERE 0 ,
 10   5 ; IMMEDIATE
 11 : ENDOF
 12   5 ?PAIRS COMPILE BRANCH
 13   HERE 0 , SWAP 2 [COMPILE]
 14   THEN 4 ; IMMEDIATE
 15 -->

Scr# 10018 
  0 ( Case-Of structure  2/2 )
  1 : ENDCASE
  2   4 ?PAIRS COMPILE DROP
  3   BEGIN SP@ CSP @ -
  4   WHILE 2 [COMPILE] THEN
  5   REPEAT CSP ! ; IMMEDIATE
  6 ;S
  7 
  8 x CASE
  9 1 OF ... ENDOF
 10 2 OF ... ENDOF
 11 (else) ... ENDCASE
 12 
 13 
 14 
 15 

Scr# 10019 
  0 .( Call utility. )        CR
  1 \ CALL# ( n a -- n2 )
  2 CREATE CALL# HEX
  3 E1 C,  ( POP HL )
  4 D1 C,  ( POP DE )
  5 C5 C,  ( PUSH BC )
  6 4B42 , ( LD BC,DE )
  7 7B C,  ( LD A,E )
  8 CD C,  (NEXT) 0A + ,
  9        ( CALL [HL] )
 10 6960 , ( LD HL,BC )
 11 C1 C,  ( POP BC )
 12 C3 C,  (NEXT) 1 - ,
 13 SMUDGE
 14 DECIMAL
 15 

Scr# 10020 
  0 .( Debugger. )            CR
  1 DECIMAL
  2 : (DUMP)
  3   DO I C@ 2 .R LOOP ;
  4 : DUMP
  5   BASE @ SWAP HEX
  6   DUP 64 + SWAP DO CR
  7   I 0 4 D.R SPACE
  8   I 4 + I (DUMP) SPACE
  9   I 8 + I 4 + (DUMP) SPACE
 10   I 8 + I DO I C@
 11   127 AND DUP 32 <
 12   IF SPACE DROP
 13   ELSE EMIT THEN LOOP
 14   ?TERMINAL IF LEAVE THEN
 15   8 +LOOP BASE ! ; -->

Scr# 10021 
  0 ( Debugger             2/6 )
  1 : .WORD 2+ NFA ID. ;
  2 : DEB-N ." Nfa: "
  3   NFA DUP U. C@ . CR ;
  4 : DEB-C ." Cfa: "
  5   CFA DUP U. @ U. CR ;
  6 : DEB-L ." Lfa: "
  7   LFA DUP U. @ ID. CR ;
  8 : DEB-P ." Pfa: " DUMP ;
  9 : DEB-LIT 2+ DUP @ . ;
 10 : DEB-BRN DUP @ .WORD INVV
 11   DEB-LIT TRUV ;
 12 : DEB-DOT DUP @ .WORD 2+
 13   COUNT 2DUP INVV TYPE + 2 -
 14   TRUV SPACE ;
 15 -->

Scr# 10022 
  0 ( Debugger             3/6 )
  1 ' : @ CONSTANT <:>
  2 ' ABORT CONSTANT <AB>
  3 ' ;S CONSTANT <;S>
  4 ' (+LOOP) CONSTANT <+L>
  5 ' (LOOP) CONSTANT <L>
  6 ' BRANCH CONSTANT <B>
  7 ' 0BRANCH CONSTANT <0B>
  8 ' Lit CONSTANT <LIT>
  9 ' (.") CONSTANT <.">
 10 ' QUIT CONSTANT <Q>
 11 ' CONSTANT CONSTANT <C>
 12 ' VARIABLE CONSTANT <V>
 13 ' WARM CONSTANT <!>
 14 : ?FWD DUP DUP @ U< IF
 15   INVV THEN ; -->

Scr# 10023 
  0 ( Debugger             4/6 )
  1 ' (?DO) CONSTANT <D>
  2 : DELOAD
  3   BEGIN ?FWD
  4   DUP @ CASE
  5   <D> OF DEB-BRN ENDOF
  6   <+L> OF DEB-BRN ENDOF
  7   <L> OF DEB-BRN ENDOF
  8   <B> OF DEB-BRN ENDOF
  9   <0B> OF DEB-BRN ENDOF
 10   <LIT> OF DEB-LIT ENDOF
 11   <."> OF DEB-DOT ENDOF
 12   DUP .WORD ENDCASE 2+
 13   TRUV
 14   ?TERMINAL   [ --> ]
 15 \ [ --> ] is a trick -->

Scr# 10024 
  0 ( Debugger             5/6 )
  1 ] OVER @ <AB> = OR
  2   OVER @ <Q> = OR
  3   OVER @ <;S> = OR
  4   OVER @ <!> = OR
  5   UNTIL ;
  6 -->
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 10025 
  0 ( Debugger             6/6 )
  1 : (SEE)
  2   2+ BASE @ SWAP HEX
  3   DUP DEB-N DUP DEB-L
  4   DUP DEB-C
  5   DUP CFA @ <:> =
  6   IF DECIMAL DELOAD
  7   DROP BASE !
  8   ELSE SWAP BASE ! DEB-P
  9   ENDIF ;
 10 \
 11 : SEE
 12   -FIND 0= 0 ?ERROR
 13   . CR (SEE) ;
 14 -->
 15 

Scr# 10026 
  0 ( Stack viewer             )
  1 : DEPTH
  2   S0 @ SP@ - 2 / 1 - ;
  3 : .S
  4   DEPTH IF CR SP@ 2 - S0 @
  5   2 - DO I @ U. -2 +LOOP
  6   ELSE 1 MESSAGE CR ENDIF ;
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 10027 
  0 ( ?ESCAPE experiment       )
  1 CREATE ?ESCAPE
  2 HEX
  3 3E C, FE C, DB C, FE C,
  4 2F C, 5F C,
  5 3E C, F7 C, DB C, FE C,
  6 2F C,
  7 A3 C, E6 C, 01 C,
  8 26 C, 00 C, 6F C,
  9 C3 C, (NEXT) 1- ,
 10 SMUDGE DECIMAL ;S
 11 : ESCAPE-TEST
 12 1000 0 DO 2E EMIT
 13 ?ESCAPE IF LEAVE THEN
 14 LOOP ;
 15 DECIMAL

Scr# 10028 
  0 ( Vocabulary viewer        )
  1 : ?VOCAB
  2  CR ." Current "
  3  CURRENT @ 4 - NFA ID.
  4  CR ." Context "
  5  CONTEXT @ 4 - NFA ID.
  6 ;
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 10029 
  0 ( Simple Word RENAMEr )
  1 HEX
  2 ( NEEDS 200 LOAD PATCH )
  3 : RENAME
  4  ' 2 + NFA DUP C@ 1F AND
  5  2DUP + >R
  6  BL WORD      20 ALLOT
  7  COUNT 1F AND ROT MIN
  8  >R SWAP 1+ R>
  9  CMOVE
 10  R@ C@ 80 OR R> C!
 11  -20 ALLOT ;
 12 DECIMAL
 13 
 14 
 15 

Scr# 10030 
  0 .( Floating point utility. )
  1 : FLOATING 1 NMODE ! ;
  2 : INTEGER  0 NMODE ! ;
  3 : F- 2SWAP >W >W 3 FOP W> ;
  4 : FMOD F/MOD 2DROP ;
  5 : F0< SWAP DROP 0< ;
  6 : F0> SWAP DROP 0> ;
  7 : F< F- F0< ;
  8 : F> 2SWAP F< ;
  9 FLOATING
 10 : ?FNEG 2DUP F0< 11 ?ERROR ;
 11 : ?FTRG 2DUP 1. F> 11 ?ERROR
 12   2DUP -1. F< 11 ?ERROR ;
 13 -->
 14 
 15 

Scr# 10031 
  0 ( FLOATING             2/7 )
  1 DECIMAL
  2 : FABS >W 42 FOP W> ;
  3 : FSGN >W 41 FOP W> ;
  4 : F^ 2SWAP ?FNEG >W >W 6 FOP
  5   W> ;
  6 : FSQRT ?FNEG >W 40 FOP W> ;
  7 : FFIX >W 58 FOP W> ;
  8 : FLN >W 37 FOP W> ;
  9 : FEXP >W 38 FOP W> ;
 10 -->
 11 
 12 
 13 
 14 
 15 

Scr# 10032 
  0 ( FLOATING             3/7 )
  1 DECIMAL FLOATING
  2 : FSIN
  3   >W 31 FOP W> ;
  4 : FCOS
  5   >W 32 FOP W> ;
  6 : TAN
  7   >W 33 FOP W> ;
  8 : ARCSIN
  9   >W 34 FOP W> ;
 10 : ARCCOS
 11   >W 35 FOP W> ;
 12 : ARCTAN
 13   >W 36 FOP W> ;
 14 -->
 15 

Scr# 10033 
  0 ( FLOATING             4/7 )
  1 DECIMAL FLOATING
  2 : D>F
  3   DUP 0< >R DABS 0 SWAP 0
  4   65536. F* F+ 1.0 F/ R>
  5   IF FMINUS ENDIF ;
  6 : F>D
  7   DUP 0< >R FABS 65536.
  8   F/MOD FINT SWAP 2SWAP FINT
  9   D+ R> IF DMINUS ENDIF ;
 10 : FLOAT
 11   S->D D>F ;
 12 : FIX
 13  F>D DROP ;
 14 -->
 15 

Scr# 10034 
  0 ( FLOATING             5/7 )
  1 : F.R
  2   >R 2DUP FABS 2DUP OR IF
  3   FLN 2.302585 F/ FINT F>D
  4   ENDIF
  5   SWAP OVER 2DUP >R >R DABS
  6   <# #S SIGN 2DROP 10. R> R@
  7   DABS F^ R> 0< IF F* ELSE
  8   F/ ENDIF 69 HOLD SWAP OVER
  9   FABS 10. PLACE @ 0 F^ F*
 10   0.5 F+ F>D PLACE @ -DUP
 11   IF 0 DO # LOOP 46 HOLD
 12   #S SIGN #> ENDIF R>
 13   OVER - SPACES TYPE ;
 14 : F. 0 F.R SPACE ;
 15 -->

Scr# 10035 
  0 ( FLOATING             6/7 )
  1 : PLACES
  2  PLACE ! ;
  3 : PI
  4  [ FLOATING 1.0 ARCTAN
  5    4.0 F* SWAP ]
  6  LITERAL LITERAL ;
  7 ;S
  8 
  9 : FIX.R
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 10036 
  0 ( FLOATING             7/7 )
  1 : F.R
  2   >R 2DUP FABS 2DUP OR IF
  3   FLN 2.302585 F/ FINT F>D
  4   ENDIF
  5   SWAP OVER 2DUP >R >R DABS
  6   <# #S SIGN 2DROP 10. R> R@
  7   DABS F^ R> 0< IF F* ELSE
  8   F/ ENDIF 69 HOLD SWAP OVER
  9   FABS 10. PLACE @ 0 F^ F*
 10   0.5 F+ F>D PLACE @ -DUP
 11   IF 0 DO # LOOP 46 HOLD
 12   #S SIGN #> ENDIF R>
 13   OVER - SPACES TYPE ;
 14 : F. 0 F.R SPACE ;
 15 

Scr# 10037 
  0 ( VALUE TO )
  1 : VALUE ( x ccc -- )
  2         ( -- n )
  3  [COMPILE] CONSTANT
  4 ; IMMEDIATE
  5 \
  6 : TO ( n -- ccc )
  7  ' CELL+
  8  STATE @ IF
  9   , COMPILE !
 10  ELSE
 11             !
 12  ENDIF
 13 ; IMMEDIATE
 14 
 15 

Scr# 10038 
  0 ( BEHAVE )
  1 : BEHAVE
  2  LATEST PFA CFA !
  3 ;
  4 
  5 
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 10040 
  0 ( RND                      )
  1 DECIMAL
  2 : RND ( n -- rnd(n)
  3   1+ 8195 23670 @
  4 \ U*
  5   UM* \ it was U*
  6   1 0 D+ 16383
  7 \ U/
  8   UM/MOD
  9   DROP DUP 23670 !
 10   SWAP MOD ;
 11 \
 12 : SEED
 13   23670 ! ;
 14 ;S
 15 

Scr# 10041 
  0 ( COLOR                    )
  1 DECIMAL 19 LOAD \ CALL#
  2 HEX
  3 : PERM 0 1CAD CALL# DROP ;
  4 : BORDER. 2297 CALL# DROP ;
  5 DECIMAL
  6 : (COLOR)
  7   ROT AND SWAP EMITC EMITC
  8   PERM ;
  9 : INK. 16 7 (COLOR) ;
 10 : PAPER. 17 7 (COLOR) ;
 11 : FLASH. 18 1 (COLOR) ;
 12 : BRIGHT. 19 1 (COLOR) ;
 13 : INVERSE. 20 1 (COLOR) ;
 14 : OVER. 21 1 (COLOR) ;
 15 -->

Scr# 10042 
  0 ( AT TAB                   )
  1 : AT.
  2   22 EMITC 31 AND SWAP
  3   21 MIN EMITC EMITC ;
  4 : TAB.
  5   23 EMITC EMITC 0 EMITC ;
  6 : LVIDEO
  7   2 23659 C! 1 SELECT ;
  8 : ATTR  ( x y --- b )
  9   SWAP 32 * + 22528 + C@ ;
 10 : VIDEO
 11   2 DEVICE !
 12   1 23659 C! 2 SELECT ;
 13 -->
 14 
 15 

Scr# 10043 
  0 ( POINT SCREEN$ )
  1 CREATE POINT  HEX
  2 E1 C, D1 C, C5 C, 454B ,
  3 CD C, 22AA , 47 C, 04 C,
  4 7E C, 07 C, 10 C, -3 C,
  5 E6 C, 01 C, 6F C, 26 C, 0 C,
  6 C1 C, C3 C, (NEXT) 1- ,
  7 SMUDGE
  8 \
  9 CREATE SCREEN$  HEX
 10 E1 C, D1 C, C5 C, 454B ,
 11 CD C, 2538 , CD C, 2BF1 ,
 12 1A C, 6F C, 26 , C1 C,
 13 C3 C, (NEXT) 1- ,
 14 SMUDGE
 15 -->

Scr# 10044 
  0 ( PLOT )
  1 \ 18 LOAD for CALL#
  2 HEX
  3 CREATE PLOT   HEX
  4   E1 C, D1 C, C5 C,
  5   45 C, 4B C, CD C, 22E5 ,
  6   C1 C, C3 C, (NEXT) ,
  7   SMUDGE
  8 \
  9 -->
 10 : CIRCLE
 11   ROT 0 >W SWAP 0 >W 0 >W
 12   232D CALL#
 13   ;
 14 \
 15 -->

Scr# 10045 
  0 ( DRAW                     )
  1 CREATE (DRAW) HEX
  2   D1 C, E1 C, C5 C,
  3   4D C, 43 C, 5C C,
  4   CD C, 24BA ,
  5   C1 C, C3 C, (NEXT) ,
  6   SMUDGE
  7 : DRW1
  8   100 OVER +- SWAP ABS + ;
  9 : DRAW
 10   SWAP DRW1 SWAP DRW1
 11   (DRAW)
 12 ;
 13 -->
 14 
 15 \

Scr# 10046 
  0 ( PAINT )
  1 HEX
  2 : HIT ( x y d -- )
  3   >R
  4   BEGIN
  5    2DUP PLOT
  6    R@ + ABS 0B0 MOD
  7    2DUP POINT
  8   UNTIL
  9   R> DROP 2DROP ;
 10 : HIT2 ( x y -- )
 11   2DUP 1 HIT -1 HIT
 12   ?TERMINAL IF QUIT THEN
 13 ;
 14 -->
 15 

Scr# 10047 
  0 ( PAINT )
  1 DECIMAL
  2 : HITX ( x y d -- )
  3   >R
  4   BEGIN
  5    SWAP R@ + 255 AND SWAP
  6    2DUP POINT 0=
  7   WHILE
  8    2DUP HIT2
  9   REPEAT
 10   R> DROP 2DROP
 11 ;
 12 : PAINT ( x y -- )
 13   2DUP HIT2
 14   2DUP 1 HITX -1 HITX
 15 ;

Scr# 10048 
  0 ( Mr Jones' keyboard test )
  1 CODE KEYBOARD?
  2  POP   HL|
  3  LD    A'|  L|
  4  ANDN  7    N,
  5  INC   A'|
  6  LD    H'|  A|
  7  SRL    L|
  8  SRL    L|
  9  SRL    L|
 10  LDN   A'|   5  N,
 11  SUBA   L|
 12  LD    L'|  A|
 13  LDN   A'|  HEX FE N,
 14 -->
 15 

Scr# 10049 
  0 ( Mr Jones' keyboard test )
  1  HERE
  2   RRCA DEC H'|
  3  JRF   NZ'| BACK,
  4  INA   HEX FE P,
  5  HERE
  6   RRA  DEC L'|
  7  JRF   NZ'| BACK,
  8  CCF
  9  RL    L|
 10  PSH1
 11 C;
 12 DECIMAL
 13 
 14 
 15 

Scr# 10050 
  0 ( BLEEP )
  1 \
  2 ( n1 = {3.5M/Hz-241}/8 )
  3 ( n2 = 1000 * ms / Hz )
  4 \
  5 CREATE BLEEP HEX SMUDGE
  6 E1 C, \ POP HL
  7 D1 C, \ POP DE
  8 C5 C, \ PUSH BC
  9 CD C, 03B5 , \ CALL 03B5
 10 C1 C, \ POP BC
 11 C3 C, (NEXT) ,
 12 DECIMAL
 13 -->
 14 
 15 

Scr# 10051 
  0 ( BLEEP )
  1 ( ms Hz -- n1 n2 )
  2 : BLEEP-CALC
  3 >R R@ 1000 */
  4 3500.000 R> UM/MOD
  5 241 - 8 /
  6 SWAP DROP ;
  7 ( BEEP pitch -- freq )
  8 : BEEP-PITCH
  9 69 SWAP -
 10 12 /MOD 14080
 11 SWAP 0 ?DO 2/ LOOP
 12 SWAP 0 ?DO 269 286 */ LOOP
 13 ;
 14 
 15 

Scr# 10052 
  0 ( Pitch bend )
  1 CODE PITCH-BEND
  2 PUSH  BC|
  3 LDX   HL|  500  NN,
  4 LDN   B'|  250   N,
  5 HERE
  6 LDX   DE|    1  NN,
  7 PUSH  BC|  PUSH  HL|
  8 CALL  949 AA,
  9 POP   HL|  POP   BC|
 10 INCX  HL|
 11 DJNZ  BACK,
 12 POP   BC|
 13 NEXT C;
 14 
 15 

Scr# 10053 
  0 ( KEYBOARD-TEST )
  1 : KEYBOARD-TEST
  2 BEGIN
  3  40 0 DO
  4   I KEYBOARD?
  5   IF I . CR THEN
  6  LOOP
  7  ?TERMINAL
  8 UNTIL
  9 ;
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 10055 
  0 ( MS delay )
  1 DECIMAL
  2 CODE MS ( N -- )
  3  POP DE|
  4  LD  D'|  B|
  5  LDN H'|  205  N,
  6  HERE   \ BEGIN,
  7   LD  B'|  H|
  8   HERE
  9    NOP
 10   DJNZ BACK,
 11   DEC  E'|
 12  JRF NZ'| BACK,
 13  LD  B'| D|
 14  NEXT C;
 15 

Scr# 10057 
  0 ( FRAMES )
  1 CODE FRAMES@
  2  LDX  HL| HEX 5C78 NN,
  3  LD E'| (HL)|
  4  INCX HL|
  5  LD D'| (HL)|
  6  INCX HL|
  7  LD L'| (HL)|
  8  LDN H'| 0 N,
  9 PSH2 C;
 10 CODE 1FRAME
 11  LDX HL| HEX 5C78 NN,
 12  LD A'| (HL)|
 13  HERE CPA (HL)|
 14  JRF Z'| BACK,
 15  NEXT C; -->

Scr# 10058 
  0 ( FRAMES )
  1 : T FRAMES@ D. ;
  2 : TT 1FRAME 1FRAME
  3   FRAMES@ ROT MS FRAMES@
  4   2SWAP DMINUS D+ . . ;
  5 : TEST ( frames -- )
  6   400 18 DO
  7   I DUP . TT
  8   I 1+ DUP . TT
  9   I 2+ DUP . TT
 10   I 3 + DUP . TT
 11   CR 100 +LOOP
 12 ;
 13 
 14 
 15 

Scr# 10059 
  0 ( TEST )
  1 HEX 5800
  2 CONSTANT ADDRESS
  3 20 VARIABLE DELAY
  4 : WAIT
  5  DELAY @ 0 DO 1FRAME LOOP
  6 ;
  7 : TEST1
  8  87 ADDRESS 2+ C!
  9  BEGIN
 10  00 ADDRESS C! WAIT
 11  3F ADDRESS C! WAIT
 12  ?TERMINAL
 13  UNTIL
 14 ;
 15 DECIMAL

Scr# 10060 
  0 ( Interrupt Handler )
  1 HEX
  2 CREATE EI
  3  FB C,
  4  C3 C, (NEXT) , SMUDGE
  5 CREATE DI
  6  F3 C,
  7  C3 C, (NEXT) , SMUDGE
  8 CREATE IM1
  9  56ED , ( IM 1 )
 10  C3 C, (NEXT) , SMUDGE
 11 CREATE IM2
 12  5EED , ( IM 2 )
 13  C3 C, (NEXT) , SMUDGE
 14 -->
 15 

Scr# 10061 
  0 ( Interrupt Handler )
  1 HEX
  2 CREATE SETIREG
  3  E1 C, ( POP HL )
  4  7D C, ( LD A,L )
  5  47ED , ( LD I,A )
  6  C3 C, (NEXT) , SMUDGE
  7 \
  8 : INT-OFF
  9   DI 3F SETIREG IM1 EI
 10 ;
 11 \
 12 0 VARIABLE INT-SAVE
 13 -->
 14 
 15 

Scr# 10062 
  0 ( Interrupt Handler )
  1 HEX
  2 CREATE INT-RET
  3  ED C, 7B C, INT-SAVE ,
  4  E1 C, \ POP HL
  5  22 C, (NEXT) 4 - ,
  6  C1 C, D1 C, E1 C, \ BCDEHL
  7  D9 C, \ EXX
  8  C1 C, D1 C, E1 C, \ BCDEHL
  9  F1 C, 08 C, F1 C, \ AF
 10  DD C, E1 C, \ POP IX
 11 \
 12  C3 C, 0038 , \ CALL 38
 13  FB C, C9 C, \ EI RET
 14 SMUDGE
 15 -->

Scr# 10063 
  0 ( Interrupt Handler )
  1 ' NOOP VARIABLE INT-W
  2 ' INT-RET ,
  3 -->
  4 
  5 
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 10064 
  0 ( Interrupt Handler )
  1 HEX
  2 CREATE INT-SUB
  3  DD C, E5 C, \ PUSH IX
  4  F5 C, 08 C, F5 C, \ AF
  5  E5 C, D5 C, C5 C, \ HLDEBC
  6  D9 C, \ EXX
  7  E5 C, D5 C, C5 C, \ HLDEBC
  8 \ RP
  9  2A C, (NEXT) 4 - ,
 10  E5 C,
 11 \
 12  11 C, -10 ,
 13  19 C, ( ADD HL,DE )
 14  22 C, (NEXT) 4 - ,
 15 -->

Scr# 10065 
  0 ( Interrupt Handler )
  1 \ SP
  2  ED C, 73 C, INT-SAVE ,
  3 \
  4  21 C, -10 ,
  5  39 C, ( ADD HL,SP )
  6  F9 C, ( LD  SP,HL  )
  7 \
  8  01 C, INT-W ,
  9        ( LD BC, INT-W )
 10  C3 C, (NEXT) ,
 11 SMUDGE
 12 -->
 13 
 14 
 15 

Scr# 10066 
  0 ( Interrupt Handler )
  1 -->
  2 HEX
  3 : INT-ON
  4 [ ' INT-SUB 2+ ] LITERAL
  5 \ 63FF !
  6 0 +ORIGIN 1- !
  7 \ 63 LDIA
  8 0 + ORIGIN 1- 100 /
  9 SETIREG
 10  IM2
 11  EI
 12 ;
 13 DECIMAL
 14 
 15 

Scr# 10068 
  0 ( INTERRUPT - TEST )
  1 HEX
  2 : TEST
  3 55 4700 C!
  4 4700 4701 FF CMOVE
  5 4700 4F00 100 CMOVE
  6 4700 5700 100 CMOVE
  7 ;
  8 DECIMAL
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 10069 
  0 ( INTERRUPT )
  1 INT-OFF
  2 ' TEST INT-W !
  3 INT-ON
  4 
  5 
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 10070 
  0 ." Microdrives " CR
  1 : (DR) CHNL @ 25 + C! ;
  2 : MDRCDRV ( n -- )
  3   DUP DRV @ 1+ -
  4   IF
  5    FLUSH EMPTY-BUFFERS
  6    4 MDRR1 \ messages block
  7    DUP (DR) MDRGET
  8   ENDIF
  9   1 - DRV !
 10 ;
 11 
 12 
 13 
 14 
 15 

Scr# 10071 
  0 ( MICRODRIVE )
  1 : DR-BCOPY ( dr b --- )
  2   OVER DRV @ - IF
  3    FLUSH MDRGET
  4    FLUSH BLOCK DROP SWAP
  5    1+ (DR) MDRGET
  6    BLOCK DROP UPDATE FLUSH
  7    DRV @ 1+ (DR) MDRGET
  8   ELSE 2DROP THEN ;
  9 : DR-MBCOPY ( dr b n --- )
 10   0 DO
 11    2DUP DR-BCOPY
 12    4 BLOCK DROP \ messages
 13    1+ 46 EMIT
 14   LOOP
 15 ;S

Scr# 10072 
  0 ( MICRODRIVE )
  1 : BLIST
  2   LIMIT @ FIRST @ DO
  3    I C@ .
  4   516 +LOOP ;
  5 ;S
  6 \
  7 : DR0 1 (DRN) ;
  8 : DR1 2 (DRN) ;
  9 : DR2 3 (DRN) ;
 10 : DR3 4 (DRN) ;
 11 : DR4 5 (DRN) ;
 12 : DR5 6 (DRN) ;
 13 : DR6 7 (DRN) ;
 14 
 15 

Scr# 10073 
  0 ( COMPARE )
  1 CODE (COMPARE) ( a b n -- )
  2 POP HL| LD A'| L|
  3 POP DE| POP HL| PUSH BC|
  4 LD B'| A|
  5 HERE
  6  LDA(X) DE| CPA (HL)|
  7  INCX DE| INCX HL|
  8  JRF Z'| HOLDPLACE
  9     JRF CY'| HOLDPLACE
 10           LDX  HL|  1 NN,
 11     ELSE, LDX  HL| -1 NN,
 12     THEN, POP BC| PSH1
 13  THEN, DJNZ BACK,
 14 LDX HL| 0 NN,
 15 POP BC| PSH1 C; -->

Scr# 10074 
  0 ( COMPARE )
  1 : COMPARE
  2 ( a1 c1 a2 c2 -- -1|0|1 )
  3   2SWAP ROT 2DUP - >R MIN
  4   (COMPARE)
  5   R> OVER IF DROP ELSE
  6   DUP IF 1 SWAP +- THEN
  7   + THEN ;
  8 : TRACE BLK ? IN ? ;
  9 -->
 10 : TEST
 11   S" CIAO" S" CIOA"
 12   COMPARE .
 13   S" CIAO" S" CIAI"
 14   COMPARE .
 15 ;

Scr# 10075 
  0 ( BSEARCH )
  1 : SEARCH.SHOW ( -- )
  2   TRACE IN @ C/L / .
  3   6 EMITC
  4 ;
  5 \
  6 : SEARCH.SCR ( -- f )
  7   BL WORD COUNT
  8   PAD COUNT COMPARE ;
  9 \
 10 : LOCATE.SCR ( -- f )
 11   BL WORD @ 14849 =
 12   IF SEARCH.SCR
 13   ELSE 1 THEN ;
 14 -->
 15 

Scr# 10076 
  0 ( SEARCH )
  1 : SEARCH.BLOCK ( b -- )
  2   BLK @ >R IN @ >R
  3   0 IN ! B/SCR * BLK !
  4   BEGIN
  5    SEARCH.SCR
  6    0= IF SEARCH.SHOW THEN
  7    ?TERMINAL \ ?ESCAPE
  8    IF BLK ? IN ? QUIT THEN
  9    HERE 1+ C@ 0=
 10   UNTIL
 11   R> IN ! R> BLK !
 12 ;
 13 -->
 14 
 15 

Scr# 10077 
  0 ( BSEARCH SEARCH-ALL )
  1 : BSEARCH ( n m "word" --)
  2   BL TEXT
  3   CR ." Searching for "
  4   PAD COUNT TYPE CR
  5   ." Scr#  Offs  Line" CR
  6   SWAP DO
  7   I SEARCH.BLOCK
  8   ?TERMINAL \ ?ESCAPE
  9   IF TRACE LEAVE THEN
 10   LOOP
 11 ;
 12 : SEARCH-ALL
 13   1 #SEC BSEARCH
 14 ;
 15 -->

Scr# 10078 
  0 ( LOCATE )
  1 : LOCATE.BLOCK ( b -- )
  2   BLK @ >R IN @ >R
  3   0 IN ! B/SCR * BLK !
  4   BEGIN
  5    LOCATE.SCR
  6    0= IF BLK @ LIST
  7     QUIT THEN
  8    ?TERMINAL \ ?ESCAPE
  9    IF ." Halt" QUIT THEN
 10    HERE 1+ C@ 0=
 11   UNTIL
 12   R> IN ! R> BLK !
 13 ;
 14 -->
 15 

Scr# 10079 
  0 ( LOCATE )
  1 : LOCATE ( "word" -- )
  2   BL TEXT
  3   #SEC 1 DO
  4    I LOCATE.BLOCK
  5   LOOP
  6   ." Not found. " ;
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 10080 
  0 ( MDRR2   n -- )
  1 DECIMAL
  2 : MDRR2
  3   4 MDR CHNL @ >R
  4   254 /MOD
  5   DUP 48 + R@ 53 + C!
  6   2+  \ first drive is #2
  7   R@ 25 + C!
  8   1- R> 13 + C!
  9   MDRGET
 10 ;
 11 ' MDRR2 ' MDRWR 2+ !
 12 ' MDRR2 ' MDRRD 2+ !
 13 
 14 
 15 

Scr# 10081 
  0 ( UPPER )
  1 CODE UPPER ( c1 -- c2 )
  2 POP   HL|
  3 LD A'| L|
  4 CPN HEX 61 N,
  5 JRF CY'| HOLDPLACE
  6  CPN HEX 7A N
  7  JRF NC'| HOLDPLACE
  8   SUBN HEX 20 N,
  9  HERE DISP,
 10 HERE DISP,
 11 LD L'| A|
 12 PSH1
 13 C;
 14 DECIMAL
 15 

Scr# 10085 
  0 ( SET-FENCE )
  1 \ protects vocabulary
  2 \
  3 HEX
  4 \
  5   HERE   1E +ORIGIN !
  6   LATEST 0C +ORIGIN !
  7 \
  8 DECIMAL
  9 HERE MINUS +ORIGIN MINUS .
 10 ." bytes."
 11 
 12 
 13 
 14 
 15 

Scr# 10086 
  0 ( CHECK NULL               )
  1 : J RP@ 6 + @ ;
  2 : CHECKNULL
  3 #SEC 1 DO
  4 I .
  5 I BLOCK @ 2020 = IF
  6 ." WRONG " ENDIF
  7 CR
  8 ?ESCAPE IF QUIT ENDIF
  9 LOOP
 10 ;
 11 
 12 
 13 
 14 
 15 

Scr# 10087 
  0 ( USED-BY )
  1 : USED-BY ( xt -- )
  2   HERE 0 +ORIGIN DO
  3   DUP I @ =
  4    IF I U. THEN
  5   LOOP
  6   -1 S0 @ DO
  7   DUP I @ =
  8    IF I U. THEN
  9   LOOP
 10   DROP ;
 11 HEX : EXAM FF58 EA40
 12   DO CR 2B EMIT I U.
 13   I USED-BY ?TERMINAL
 14   IF LEAVE THEN LOOP ;
 15 

Scr# 10088 
  0 ( DUMP WORDS )
  1 : NW
  2 0 HEX CONTEXT @ @
  3 BEGIN
  4  DUP PFA LFA @
  5  DUP 0= ?TERMINAL OR
  6 UNTIL DROP
  7 BEGIN VIDEO DUP ID. PRINTER
  8  CR ." \  " DUP ID. CR
  9  PFA DUP DEB-N DUP DEB-L
 10  DUP DEB-C DUP CFA @ <:> =
 11  IF DELOAD DROP
 12  ELSE DEB-P THEN
 13  DUP 0= ?TERMINAL OR
 14 CR CR UNTIL VIDEO
 15 ;

Scr# 10089 
  0 ( HIDE )
  1 : HIDE
  2   ' >BODY LFA
  3   CONTEXT @
  4   BEGIN
  5   @ PFA LFA
  6   2DUP = OVER @ AND
  7   UNTIL
  8 ;
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 10090 
  0 ( STRING )
  1 \ STRING"  ( -- a )
  2 : STRING"
  3   [CHAR] " WORD
  4   COUNT 1+ ALLOT ;
  5 : .STRING
  6   COUNT TYPE ;
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 10091 
  0 ( Word List )
  1 : WORD-LIST
  2   LATEST
  3   BEGIN
  4     CR DUP PFA U. DUP ID.
  5     DUP PFA LFA @
  6     CR DUP PFA CFA (SEE)
  7   WHILE
  8     PFA LFA @
  9     ?TERMINAL IF QUIT THEN
 10   REPEAT
 11   DROP ;
 12 
 13 
 14 
 15 

Scr# 10092 
  0 ( RS to MDR mover )
  1 : RS2MDR
  2   BEGIN
  3    3 DUP DEVICE ! SELECT
  4    INKEY
  5    5 DUP DEVICE ! SELECT
  6    DUP EMITC
  7   WHILE
  8    ?TERMINAL
  9    IF VIDEO QUIT THEN
 10   REPEAT
 11 ;
 12 
 13 
 14 
 15 

Scr# 10093 
  0 ( RS-LIST )
  1 : RS-LIST
  2   DECIMAL CR DUP SCR !
  3   ." \ Screen# " .
  4   CR
  5   16 0 DO
  6    CR I SCR @ .LINE
  7    ?ESCAPE IF LEAVE THEN
  8   LOOP
  9   CR CR ;
 10 \
 11 : RS?
 12   RS-LOADING OFF
 13   RS-LINES @
 14   U. ;
 15 

Scr# 10098 
  0 ( MOVE SP & RP )
  1 HEX BF00 MOVE-SP
  2 HEX BFA0 MOVE-RP
  3 \
  4 HEX B900 MOVE-SP
  5 HEX B9A0 MOVE-RP
  6 HEX C000 MOVE-LIMIT
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 10099 
  0 ( SET-FENCE )
  1 HERE FENCE !
  2 HERE HEX 1C +ORIGIN !
  3 LATEST   0C +ORIGIN !
  4 HERE HEX 1E +ORIGIN !
  5 VOC-LINK @ 20 +ORIGIN !
  6 DECIMAL
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 10100 
  0 .( Z80 Assembler. ) CR
  1 : INVERT -1 XOR ;
  2 : @+ >R R@ CELL+ R> @ ;
  3 : !+ >R R@ ! R> CELL+ ;
  4 : @- 0 CELL+ - >R R@ @ R> ;
  5 1 VARIABLE TABL1 1 ,
  6 : ROTLEFT  TABL1 + @
  7   UM* \ U*
  8   OR ;
  9 \
 10 CHAR - CONSTANT &-
 11 CHAR ~ CONSTANT &~
 12 -->
 13 
 14 
 15 

Scr# 10101 
  0 ( Z80 Utility - Sys depend )
  1 VOCABULARY ASSEMBLER IMMEDIATE
  2 FORTH DEFINITIONS HEX
  3 : % COMPILE ' <NAME ;
  4 \ : % POSTPONE ' <NAME ;
  5 : %ID. ID. ;
  6 : %>BODY PFA CELL+ ;
  7 : %BODY> 0 CELL+ - NFA ;
  8 : %>CODE PFA CFA CELL+ ;
  9 : IGNORE? 1+ C@ &~ = ;
 10 : (>NEXT%) PFA LFA @ ;
 11 : VOCEND?
 12   @ FFFF AND A081 = ;
 13 : >NEXT% BEGIN (>NEXT%)
 14   DUP 1+ C@ &- - UNTIL ;
 15 -->

Scr# 10102 
  0 ( Z80 Utility - Sys depend )
  1 : STARTVOC ' ASSEMBLER 2 +
  2   CELL+ @ ;
  3 : IS-A <BUILDS
  4   0 ,
  5   DOES>
  6   @ SWAP %>CODE @ = ;
  7 : REMEMBER HERE LATEST
  8   (>NEXT%) %>BODY ! ;
  9   IMMEDIATE
 10 : CONTAINED-IN OVER AND = ;
 11 -->
 12 
 13 
 14 
 15 

Scr# 10103 
  0 ( Z80 System independ. )
  1 \ 0 VARIABLE TABLE FF ,
  2 \ FFFF , FFFFFF , FFFFFFFF ,
  3 \ : FIRSTBYTES CELLS TABLE
  4 \   + @ AND ;
  5 0 VARIABLE TALLY-BI
  6 0 VARIABLE TALLY-BY
  7 0 VARIABLE TALLY-BA
  8 0 VARIABLE ISS
  9 0 VARIABLE ISL
 10 0 VARIABLE PREVIOUS
 11 : !TALLY 0 TALLY-BY !
 12  0 TALLY-BI ! 0 TALLY-BA !
 13  0 PREVIOUS ! ;
 14 -->
 15 

Scr# 10104 
  0 ( Z80 System independ. )
  1 : AT-REST? TALLY-BI @ 0=
  2  TALLY-BY @ 0= AND ;
  3 : BADPAIRS? DUP 2 * AND
  4  AAAAAAAA AND ;
  5 : BAD?
  6  TALLY-BA @ BADPAIRS? ;
  7 : COMPATIBLE?
  8  TALLY-BA @ OR BADPAIRS?
  9  0= ;
 10 DECIMAL
 11 -->
 12 
 13 
 14 
 15 

Scr# 10105 
  0 ( Z80 Generate errors )
  1 : CHECK26 AT-REST? 0=
  2   26 ?ERROR ;
  3 : CHECK27 BAD? 27 ?ERROR ;
  4 : CHECK31 2DUP SWAP
  5   CONTAINED-IN 0= 31 ?ERROR ;
  6 : CHECK33 2DUP SWAP INVERT
  7   CONTAINED-IN 0= 33 ?ERROR ;
  8 : CHECK28 2DUP AND 28 ?ERROR ;
  9 : CHECK29 2DUP OR -1 -
 10   29 ?ERROR ;
 11 : CHECK30 DUP PREVIOUS @ <
 12   30 ?ERROR DUP PREVIOUS ! ;
 13 HEX
 14 -->
 15 

Scr# 10106 
  0 ( Assembler Z80 )
  1 : OR!
  2   >R R@ @ CHECK28 OR R> ! ;
  3 : OR!U >R R@ @ OR R> ! ;
  4 : AND! >R INVERT R@ @
  5   CHECK29 AND R> ! ;
  6 -->
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 10107 
  0 ( Assembler Z80 )
  1 : >DATA %>BODY ;
  2 : >BI %>BODY CELL+ ;
  3 : >BY %>BODY 2 CELLS + ;
  4 : >BA %>BODY 3 CELLS + ;
  5 : >CNT %>BODY 4 CELLS + ;
  6 : >DIS %>BODY 5 CELLS ;
  7 : CORRECT,-
  8   ISL @ 1 CELLS - ALLOT ;
  9 : !POSTIT
 10   HERE ISS ! 0 PREVIOUS ! ;
 11 : TALLY:, @+ TALLY-BI !
 12   @+ TALLY-BY ! @+ TALLY-BA !
 13   @ ISL ! ;
 14 -->
 15 

Scr# 10108 
  0 ( Assembler Z80 )
  1 : POSTIT CHECK26 !POSTIT
  2   HERE ISS ! @+ , TALLY:,
  3   CORRECT,- ;
  4 IS-A IS-CBPI : CBPI CHECK33
  5 <BUILDS , , , , 1 , DOES>
  6 REMEMBER CB C, POSTIT ;
  7 IS-A IS-EDPI : EDPI CHECK33
  8 <BUILDS , , , , 1 , DOES>
  9 REMEMBER ED C, POSTIT ;
 10 IS-A IS-DDPI : DDPI CHECK33
 11 <BUILDS , , , , 1 , DOES>
 12 REMEMBER DD C, POSTIT ;
 13 IS-A IS-FDPI : FDPI CHECK33
 14 <BUILDS , , , , 1 , DOES>
 15 REMEMBER FD C, POSTIT ; -->

Scr# 10109 
  0 ( Assembler Z80 )
  1 IS-A IS-1PI : 1PI CHECK33
  2 <BUILDS , , , , 1 , DOES>
  3 REMEMBER POSTIT ;
  4 IS-A IS-2PI : 2PI CHECK33
  5 <BUILDS , , , , 2 , DOES>
  6 REMEMBER POSTIT ;
  7 IS-A IS-3PI : 3PI CHECK33
  8 <BUILDS , , , , 3 , DOES>
  9 REMEMBER POSTIT ;
 10 : IS-PI >R R@ IS-1PI
 11  R@ IS-2PI  R@ IS-3PI OR OR
 12  R@ IS-CBPI R@ IS-EDPI OR OR
 13  R@ IS-DDPI R@ IS-FDPI OR OR
 14  R> DROP ;
 15 -->

Scr# 10110 
  0 ( Assembler Z80 )
  1 : TALLY:|
  2   @+ TALLY-BI AND!
  3   @+ TALLY-BY OR!
  4   @  TALLY-BA OR!U ;
  5 : FIXUP> @+ ISS @ OR!
  6   TALLY:| CHECK27 ;
  7 IS-A IS-XFI : XFI CHECK31
  8 <BUILDS , , , , DOES>
  9 REMEMBER FIXUP> ;
 10 : CORRECT-R 0 CELL+ ISL @
 11 - ROTLEFT ;
 12 -->
 13 
 14 
 15 

Scr# 10111 
  0 ( Assembler Z80 )
  1 : TALLY:|R @+ CORRECT-R
  2  TALLY-BI AND! @+ TALLY-BY OR!
  3  @ TALLY-BA OR!U ;
  4 : FIXUP< @+ CORRECT-R ISS
  5  @ OR! TALLY:|R CHECK27 ;
  6 IS-A IS-XFIR : XFIR CHECK31
  7 <BUILDS , , , , DOES>
  8 REMEMBER FIXUP< ;
  9 : TALLY:,, CELL+ @+ CHECK30
 10 TALLY-BY AND! @ TALLY-BA
 11 OR!U ;
 12 : COMMA @+ >R TALLY:,,
 13  CHECK27 R> EXECUTE ;
 14 -->
 15 

Scr# 10112 
  0 ( Assembler Z80 )
  1 IS-A IS-COMMA
  2 : COMMAER
  3 <BUILDS , 0 , , , , , DOES>
  4 REMEMBER COMMA ;
  5 0 VARIABLE PRO-TALLY
  6   2 CELLS ALLOT
  7 : T! PRO-TALLY !+ !+ !+ DROP ;
  8 : T@ PRO-TALLY 3 CELLS +
  9   @- @- @- DROP ;
 10 -->
 11 
 12 
 13 
 14 
 15 

Scr# 10113 
  0 ( Assembler Z80 )
  1 : 1FAMILY, 0 DO DUP >R T@
  2   R> 1PI OVER + LOOP
  3   DROP DROP ;
  4 : 2FAMILY, 0 DO DUP >R T@
  5   R> 2PI OVER + LOOP
  6   DROP DROP ;
  7 : 3FAMILY, 0 DO DUP >R T@
  8   R> 3PI OVER + LOOP
  9   DROP DROP ;
 10 : XFAMILY| 0 DO DUP >R T@
 11   R> XFI OVER + LOOP
 12   DROP DROP ;
 13 : XFAMILY|R 0 DO DUP >R T@
 14   R> XFIR OVER + LOOP
 15   DROP DROP ; -->

Scr# 10114 
  0 ( Assembler Z80 )
  1 : CBFAMILY, 0 DO DUP >R T@
  2   R> CBPI OVER + LOOP
  3   DROP DROP ;
  4 : EDFAMILY, 0 DO DUP >R T@
  5   R> EDPI OVER + LOOP
  6   DROP DROP ;
  7 -->
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 10115 
  0 ( Assembler Z80 )
  1 : DDFAMILY, 0 DO DUP >R T@
  2   R> DDPI OVER + LOOP
  3   DROP DROP ;
  4 : FDFAMILY, 0 DO DUP >R T@
  5   R> FDPI OVER + LOOP
  6   DROP DROP ;
  7 \
  8 -->
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 10116 
  0 ( Assembler Z80 )
  1 ' ASSEMBLER ' ;CODE >BODY
  2 4 CELLS + ! ( PATCH! )
  3 : CODE ?EXEC CREATE
  4   [COMPILE] ASSEMBLER
  5   !TALLY !CSP ; IMMEDIATE
  6 : C; CURRENT @ CONTEXT !
  7   ?EXEC CHECK26 CHECK27
  8   SMUDGE ; IMMEDIATE
  9 : LABEL ?EXEC 0 VARIABLE
 10   SMUDGE -2 ALLOT
 11   [COMPILE] ASSEMBLER !CSP ;
 12   IMMEDIATE
 13 DECIMAL
 14 \ -->
 15 

Scr# 10117 
  0 ( Assembler z80 )
  1 FORTH DEFINITIONS
  2 ;S
  3 : CODE-NONAME
  4   ?EXEC :NONAME
  5   [COMPILE] ASSEMBLER
  6   !TALLY !CSP ; IMMEDIATE
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 10120 
  0 .( Z80 definitions. ) CR
  1 ASSEMBLER DEFINITIONS HEX
  2 0 1 0 800 ' C,
  3   COMMAER N,
  4 0 0 CELL+ 0 200 ' ,
  5   COMMAER NN,
  6 0 0 CELL+ 0 400 ' ,
  7   COMMAER AA,
  8 0 1 0 100 ' C,
  9   COMMAER P,
 10 0 1 0 1000 ' C,
 11   COMMAER D,
 12 -->
 13 
 14 
 15 

Scr# 10121 
  0 ( Z80 ) HEX
  1 00 00 00 T!
  2 08 07 8 1FAMILY,
  3   RLCA RRCA RLA  RRA
  4   DAA  CPL  SCF  CCF
  5 08 00 2 1FAMILY,
  6   NOP  EXAFAF
  7 08 E3 4 1FAMILY,
  8   EX(SP)HL  EXDEHL  DI  EI
  9 00 00 238 T!
 10 08 00 8 XFAMILY|
 11    00| 08| 10| 18|
 12    20| 28| 30| 38|
 13 00 00 238 C7 1PI    RST
 14 -->
 15 \ RST 38|  DAA

Scr# 10122 
  0 ( Z80 ) HEX
  1 00 00 07 T!
  2 01 00 8 XFAMILY|
  3   B|  C|    D|  E|
  4   H|  L| (HL)|  A|
  5 08 80 8 1FAMILY,
  6  ADDA ADCA SUBA SBCA
  7  ANDA XORA ORA  CPA
  8 00 00 00 76 1PI HALT
  9 -->
 10 \ ADDA B|
 11 \ HALT
 12 
 13 
 14 
 15 

Scr# 10123 
  0 ( Z80 ) HEX
  1 00 00 30 T!
  2 10 00 4 XFAMILY|
  3   BC| DE| HL| SP|
  4 01 02 2 1FAMILY,
  5   LD(X)A INCX
  6 01 09 3 1FAMILY,
  7   ADDHL  LDA(X)  DECX
  8 00 0200 30 01 1PI LDX
  9 00 00 30 30 XFI AF|
 10 00 00 30 T!
 11 04 C1 2 1FAMILY,
 12   POP PUSH
 13 -->
 14 \ LD(X)A BC|
 15 \ LDX BC| nn NN,

Scr# 10124 
  0 ( Z80 immediate data )
  1 HEX
  2 00 0100 00 T!
  3 08 D3 2 1FAMILY,
  4   OUTA  INA
  5 00 0800 00 T!
  6 08 C6 8 1FAMILY,
  7   ADDN ADCN SUBN SBCN
  8   ANDN XORN ORN  CPN
  9 00 00 00 T!
 10 10 C9 4 1FAMILY,
 11   RET EXX JPHL LDSPHL
 12 -->
 13 \ OUTA n P,   INA n P,
 14 \ ADDN n N,
 15 

Scr# 10125 
  0 ( Z80 address )
  1 00 0400 00 T!
  2 08 22 4 1FAMILY,
  3   LD()HL LDHL() LD()A LDA()
  4 0A C3 2 1FAMILY,
  5   JP CALL
  6 00 00 38 T!
  7 08 00 8 XFAMILY|
  8   B'| C'| D'| E'|
  9   H'| L'| (HL)'| A'|
 10 01 04 2 1FAMILY,
 11   INC DEC
 12 00 00 3F 40 1PI LD
 13 00 0800 38 06 1PI LDN
 14 -->
 15 \ LD B'| C| LD()A nn AA,

Scr# 10126 
  0 ( Z80 ) HEX
  1 00 00 138 T!
  2 08 00 8 XFAMILY|
  3   NZ|  Z|  NC|  CY|
  4   PO| PE|   P|   M|
  5 00 00 138 C0 1PI  RETF
  6 00 0400 138 T!
  7 02 C2 2 1FAMILY,
  8  JPF CALLF
  9 -->
 10 \ JPF Z| aa AA,
 11 \ CALLF PO| aa AA,
 12 \ RETF NC|
 13 \ and CY| instead of C|
 14 
 15 

Scr# 10127 
  0 ( Z80 relative jump )
  1 HEX
  2 00 1000 00 T!
  3 08 10 2 1FAMILY,
  4   DJNZ JR
  5 00 00 218 T!
  6 08 00 4 XFAMILY|
  7   NZ'| Z'| NC'| CY'|
  8 00 1000 218 20 1PI JRF
  9 -->
 10 \ JRF Z'| d D,
 11 \ JR d D,
 12 \ DJNZ d D,
 13 
 14 
 15 

Scr# 10128 
  0 ( ED prefix )
  1 00 00 30 T!
  2 08 42 2 EDFAMILY,
  3  SBCHL  ADCHL
  4 00 0400 30 T!
  5 08 43 2 EDFAMILY,
  6   LD()X  LDX()
  7 00 00 38 T!
  8 01 40 2 EDFAMILY,
  9   IN(C)  OUT(C)
 10 -->
 11 \ SBCHL BC| ADCHL SP|
 12 \ LDX() BC| nn AA,
 13 \ LD()X SP| nn AA,
 14 \ IN(C) L'|
 15 \ OUT(C) H'|

Scr# 10129 
  0 ( ED )
  1 00 00 00 T!
  2 01 44 4 EDFAMILY,
  3   NEG RETN IM0 LDIA
  4 02 4D 2 EDFAMILY,
  5   RETI LDRA
  6 01 56 2 EDFAMILY,
  7   IM1 LDAI
  8 01 5E 2 EDFAMILY,
  9   IM2 LDAR
 10 08 67 2 EDFAMILY,
 11   RRD RLD
 12 -->
 13 
 14 
 15 

Scr# 10130 
  0 ( ED )
  1 00 00 00 T!
  2 01 A0 4 EDFAMILY,
  3   LDI  CPI  INI  OUTI
  4 01 A8 4 EDFAMILY,
  5   LDD  CPD  IND  OUTD
  6 01 B0 4 EDFAMILY,
  7   LDIR CPIR INIR OTIR
  8 01 B8 4 EDFAMILY,
  9   LDDR CPDR INDR OTDR
 10 -->
 11 
 12 
 13 
 14 
 15 

Scr# 10131 
  0 ( CB )
  1 00 00 07 T!
  2 08 00 8 CBFAMILY,
  3   RLC  RRC  RL  RR
  4   SLA  SRA  SLL SRL
  5 00 00 43F T!
  6 40 40 3 CBFAMILY,
  7   BIT  RES  SET
  8 00 00 438 T!
  9 08 00 8 XFAMILY|
 10   0| 1| 2| 3| 4| 5| 6| 7|
 11 -->
 12 \ RLC B|
 13 \ BIT 3| B|
 14 \ RES 3| B|
 15 \ SET 3| B|

Scr# 10132 
  0 ( IX IY )
  1 HEX
  2 00 00 00 T!
  3 02 E3 1 DDFAMILY,
  4   EX(SP)IX
  5 02 E3 1 FDFAMILY,
  6   EX(SP)IY
  7 \
  8 10 E9 2 DDFAMILY,
  9   JPIX  LDSPIX
 10 10 E9 2 FDFAMILY,
 11   JPIY  LDSPIY
 12 \
 13 -->
 14 \
 15 

Scr# 10133 
  0 ( IX IY )
  1 HEX
  2 00 00 30 T!
  3 00 09 1 DDFAMILY, ADDIX
  4 00 09 1 FDFAMILY, ADDIY
  5 \
  6 00 0400 00 T!
  7 08 22 2 DDFAMILY,
  8   LD()IX LDIX()
  9 08 22 2 FDFAMILY,
 10   LD()IY  LDIY()
 11 -->
 12 \ ADDIX IX|  ADDIX SP|
 13 \ LD()IY aa AA,
 14 \ LDIY() aa AA,
 15 

Scr# 10134 
  0 ( IX IY )
  1 : I)
  2 HERE 1 - C@
  3 HERE 2 - C@ CB - IF
  4 -1 ALLOT SWAP C, C,
  5 ELSE
  6 -2 ALLOT SWAP C, CB C, C,
  7 ENDIF ;
  8 00 00 07 T!
  9 00 06 1 XFAMILY| (I
 10 : (IX+  (I  DD I) ;
 11 : (IY+  (I  FD I) ;
 12 -->
 13 \ LD B'| (IY+ d )|
 14 \ ADCA   (IY+ d )|
 15 \ SRA    (IY+ d )|

Scr# 10135 
  0 ( IX IY )
  1 HEX
  2 : )|
  3   HERE 1 - C@
  4   HERE 2 - C@
  5   CB = IF SWAP ENDIF
  6   HERE 1 - C! C, ;
  7 \
  8 : IXY| ( n -- )
  9  DUP HERE 2 - C@ - IF
 10   HERE 1- C@
 11   -1 ALLOT SWAP C, C,
 12  ENDIF ;
 13 -->
 14 
 15 

Scr# 10136 
  0 ( IX IY )
  1 HEX
  2 \ INC DEC  (IX'+ d )|
  3 \ LDN  (IX'+ d )|  n N,
  4 00 00 38 T!
  5 00 30 1 XFAMILY|   (I'
  6 : (IX'+ (I' DD I) ;
  7 : (IY'+ (I' FD I) ;
  8 \
  9 \ LD(IX+ d )|  r|
 10 00 00 07 T!
 11 00 70 1 DDFAMILY, LD(IX+
 12 00 70 1 FDFAMILY, LD(IY+
 13 : )'| ' EXECUTE )| ;
 14 -->
 15 

Scr# 10137 
  0 ( IX IY )
  1 \ LDIXL A|
  2 00 00 07 T!
  3 08 60 2
  4    DDFAMILY, LDIXH LDIXL
  5 08 60 2
  6    FDFAMILY, LDIYH LDIYL
  7 -->
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 10138 
  0 ( IX IY )
  1 HEX
  2 : IX| HL| DD IXY| ;
  3 : IY| HL| FD IXY| ;
  4 : IXL| L| DD IXY| ;
  5 : IXH| H| DD IXY| ;
  6 : IYL| L| FD IXY| ;
  7 : IYH| H| FD IXY| ;
  8 \ LDX IY| nn NN,
  9 \ POP IY|  LD A'| IXL|
 10 FORTH DEFINITIONS
 11 DECIMAL
 12 
 13 
 14 
 15 

Scr# 10140 
  0 .( Z80 near structure )   CR
  1 ASSEMBLER DEFINITIONS HEX
  2 \
  3 \ LIST 250
  4 : NEXT JP (NEXT) AA, ;
  5 : PSH1 JP (NEXT) 1 - AA, ;
  6 : PSH2 JP (NEXT) 2 - AA, ;
  7 \
  8 : HOLDPLACE HERE 0 D, ;
  9 : DISP, OVER -
 10   1 - SWAP C! ;
 11 : BACK,
 12  HOLDPLACE SWAP DISP, ;
 13 \
 14 -->
 15 

Scr# 10141 
  0 ( Z80 Near struct. )
  1 : THEN, HERE DISP, ;
  2 : ELSE, JR HOLDPLACE
  3   SWAP THEN, ;
  4 FORTH DEFINITIONS
  5 DECIMAL ;S
  6 \
  7 : IF, JRF Z'|
  8   HOLDPLACE ;
  9 : -IF, JRF NZ'|
 10   HOLDPLACE ;
 11 : <IF, JRF CY'|
 12   HOLDPLACE ;
 13 : -<IF, JRF NC'|
 14   HOLDPLACE ;
 15 

Scr# 10142 
  0 ( Z80 Near struct. )
  1 : BEGIN, HERE ;
  2 : UNTIL, IF, SWAP DISP, ;
  3 : -UNTIL, -IF, SWAP DISP, ;
  4 : <UNTIL, <IF, SWAP DISP, ;
  5 : -<UNTIL, -<IF, SWAP DISP, ;
  6 : WHILE, IF, ;
  7 : -WHILE, -IF, ;
  8 : <WHILE, <IF, ;
  9 : -<WHILE, -<IF, ;
 10 : REPEAT, JR HOLDPLACE
 11   ROT DISP, THEN, ;
 12 -->
 13 
 14 
 15 

Scr# 10143 
  0 ( Z80 Near struct. )
  1 : DJNZ,
  2   DJNZ HOLDPLACE
  3   SWAP DISP, ;
  4 FORTH DEFINITIONS
  5 DECIMAL
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 10144 
  0 ." Z80 far struct "
  1 : THEN' HERE SWAP ! ;
  2 : HOLDPLACE' HERE 0 AA, ;
  3 : IF' JPF Z| HOLDPLACE' ;
  4 : ELSE' JP HOLDPLACE
  5         SWAP THEN' ;
  6 : BEGIN' HERE ;
  7 : UNTIL' IF' DROP THEN' ;
  8 : WHILE' IF' ;
  9 : REPEAT' ELSE' DROP THEN' ;
 10 DECIMAL
 11 FORTH DEFINITIONS
 12 
 13 
 14 
 15 

Scr# 10146 
  0 ( TESTING )
  1 : T?
  2  TALLY-BY ?
  3  TALLY-BI ?
  4  TALLY-BA ?
  5 ;
  6 : H?
  7  HEX
  8  HERE 8 - DUMP
  9 ;
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 10149 
  0 ( 128K Bank )
  1 CODE BANK!
  2 LDAR DI EXAFAF
  3 LD D'| B| LD E'| C| POP BC|
  4 LDX   HL| HEX 5B5C NN,
  5 LD    A'| (HL)|
  6 ANDN  HEX F8 N,
  7 ORA    C|
  8 LDX   BC| HEX 7FFD NN,
  9 OUT(C) A'|
 10 LD    (HL)'| A|
 11 LD B'| D| LD C'| E|
 12 EXAFAF
 13 JPF PO| HERE 3 + AA,
 14 EI NEXT C;
 15 : BANK@ 5B5C @ 7 AND ;

Scr# 10150 
  0 ( TEST )
  1 CODE TEST
  2  RLCA RRCA RLA RRA
  3  DAA CPL SCF CCF
  4  NOP EXAFAF EX(SP)HL EXDEHL
  5  DI EI HALT RET EXX
  6  JPHL LDSPHL
  7  RST 00| RST 38|
  8  ADDA B| ADCA C| SUBA D|
  9  SBCA E| ANDA H| XORA L|
 10  ORA (HL)| CPA A|
 11  LD(X)A BC| LDA(X) DE|
 12  INCX HL| DECX SP|
 13  ADDHL BC| ADDHL SP|
 14 C;
 15 -->

Scr# 10151 
  0 ( TEST1 )
  1 CODE TEST1
  2  LDX  BC| 1234 NN,
  3  LDX  SP| 5678 NN,
  4  PUSH AF| POP HL|
  5  OUTA 254 P, INA 254 P,
  6  ADDN 1 N, ADCN 2 N,
  7  SUBN 3 N, SBCN 4 N,
  8  ANDN 5 N, XORN 6 N,
  9  ORN  7 N, CPN  8 N,
 10  LD()HL 1234 AA,
 11  LDHL() 1234 AA,
 12  LD()A  1234 AA,
 13  LDA()  1234 AA,
 14 C;
 15 -->

Scr# 10152 
  0 ( TEST2 )
  1 CODE TEST2
  2  JP 1234 AA, CALL 1234 AA,
  3  INC B'| DEC A'|
  4  LD D'| E|  LD (HL)'| A|
  5  LDN B'| 1 N, LDN A'| 8 N,
  6  JPF Z| 1234 AA,
  7  CALLF M| 1234 AA,
  8  RETF PE|
  9  DJNZ -10 D, JR +10 D,
 10  JRF NZ'| +10 D,
 11  JRF CY'| -10 D,
 12  SBCHL DE| ADCHL SP|
 13  LDX() BC| 1234 AA,
 14  LD()X SP| 1234 AA,
 15 C; -->

Scr# 10153 
  0 ( TEST3 )
  1 CODE TEST3
  2  IN(C) D'|  OUT(C) E'|
  3  NEG RETN IM0 LDIA RETI LDRA
  4  IM1 LDAI IM2 LDAR RRD RLD
  5  LDI   CPI   INI   OUTI
  6  LDD   CPD   IND   OUTD
  7  LDIR  CPIR  INIR  OTIR
  8  LDDR  CPDR  INDR  OTDR
  9  RLC B| RRC C| RL D| RR E|
 10  SLA H| SRA L| SRL (HL)|
 11  BIT 2| D|  BIT 3| E|
 12  RES 4| H|  RES 5| L|
 13  SET 6| (HL)| SET 7| A|
 14 C;
 15 ;S

Scr# 10154 
  0 ( TEST IF, THEN, )
  1 CODE TEST4
  2 BEGIN,
  3 NOP NOP NOP
  4 END,
  5 NEXT
  6 C;
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 10155 
  0 \ TEST
  1 CODE TEST5
  2 INCX IX|  DECX IY|
  3 PUSH IX|  POP  IY|
  4 EX(SP)IX  JPIY
  5 LDSPIX    LDSPIY
  6 ADDIX BC| ADDIX DE|
  7 ADDIX IX| ADDIX SP|
  8 ADDIY BC| ADDIY DE|
  9 ADDIY IY| ADDIY SP|
 10 LD()IX 4 AA, LDIX() 3 AA,
 11 LD()IY 5 AA, LDIY() 6 AA,
 12 LDX IX| 7 NN,
 13 LDX IY| 8 NN,
 14 C;
 15 

Scr# 10156 
  0 \ TEST6
  1 CODE TEST6
  2  ADCA (HL)|
  3  ADCA (IY+ 9 )|
  4  INC (HL)'|
  5  INC (IY'+ 9 )|
  6  LDN (HL)'|      5 N,
  7  LDN (IY'+ 9 )|  5 N,
  8  SRA  (HL)|
  9  SRA (IY+  9 )|
 10  SET 0| (HL)|
 11  SET 0| (IY+ 9 )|
 12  LDIX() 1234 AA,
 13 C;
 14 ;S
 15 

Scr# 10157 
  0 \ TEST7
  1 CODE TEST7
  2     LDX HL| 0 NN,
  3     BIT 5| (IY+ 1 )|
  4     IF, INC L'| THEN,
  5 PSH1 C;
  6 \
  7 : KEYIN
  8   BEGIN
  9   TEST7
 10   ?ESCAPE
 11   UNTIL ;
 12 
 13 
 14 
 15 

Scr# 10158 
  0 \ TEST Z80N
  1 HEX CODE TEST8
  2  TESTN FF N,
  3  SWAPNIB MIRRORA
  4  LDIX LDDX LDIRX LDDRX
  5  LDWS LDPIRX
  6  OUTINB JP(C)
  7  PIXELDN PIXELAD SETAE
  8  BSLADE,B BSRADE,B BSRLDE,B
  9  BSRFDE,B BRLCDE,B
 10  MUL
 11  ADDHL,A ADDDE,A ADDBC,A
 12  ADDBC, 07654 NN,
 13  NEXTREGA 3 P,
 14  NEXTREG  3 P, 4 N,
 15  PUSHN 07654 LH,  NEXT C;

Scr# 10159 
  0 \ TEST Z80N
  1 HEX CODE TEST9
  2  DECIMAL
  3  NEXTREG 87 P, 1 N,
  4  NEXTREGA 87 P,
  5 NEXT C;
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 10160 
  0 ( Z80N Next extension )
  1 ASSEMBLER DEFINITIONS HEX
  2 : <, 100 /MOD C, C, ;
  3 0 1 0 4000 ' <, COMMAER LH,
  4 \
  5 00 0900 00 91 EDPI NEXTREG
  6 \ NEXTREG reg P, n N,
  7 00 0100 00 92 EDPI NEXTREGA
  8 \  NEXTREGA r P,
  9 00 4000 00 8A EDPI PUSHN
 10 \   PUSHN nn LH,
 11 00 0100 00 27 EDPI TESTN
 12 \  TESTN n N,
 13 -->
 14 
 15 

Scr# 10161 
  0 ( Z80N Next extension )
  1 ASSEMBLER DEFINITIONS HEX
  2 00 00 00 T!
  3 01 23 2 EDFAMILY,
  4  SWAPNIB MIRRORA
  5 08 A4 4 EDFAMILY,
  6  LDIX LDDX LDIRX LDDRX
  7 12 A5 2 EDFAMILY,
  8  LDWS LDPIRX
  9 08 90 2 EDFAMILY,
 10  OUTINB JP(C)
 11 01 93 3 EDFAMILY,
 12  PIXELDN PIXELAD SETAE
 13 -->
 14 
 15 

Scr# 10162 
  0 ( Z80N Next extension )
  1 01 28 5 EDFAMILY,
  2  BSLADE,B BSRADE,B BSRLDE,B
  3  BSRFDE,B BRLCDE,B
  4 01 30 4 EDFAMILY,
  5  MUL
  6  ADDHL,A ADDDE,A ADDBC,A
  7 00 0200 00 T!
  8 01 34 3 EDFAMILY,
  9  ADDHL, ADDDE, ADDBC,
 10 \ ADDBC, nn NN,
 11 \
 12 FORTH DEFINITIONS DECIMAL
 13 
 14 
 15 

Scr# 10163 
  0 ( DAA )
  1 HEX
  2 CODE TEST-DAA
  3  POP HL|
  4  LD A'| L|
  5  CPN 10 N,
  6  SBCN 69 N,
  7  DAA
  8  LD L'| A|
  9  PSH1
 10  C;
 11 
 12 
 13 
 14 
 15 

Scr# 10164 
  0 ( 2CONSTANT )
  1 : 2CONSTANT
  2  <BUILDS SWAP , , DOES>
  3  2@
  4 ;
  5 : 2VARIABLE
  6  VARIABLE , ;
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 10165 
  0 ( Fibonacci )
  1 ( n -- d )
  2 \ n must be between 0 and 46
  3 : FIBO
  4  0. ROT
  5  ?DUP IF
  6   1- 1. ROT
  7   0 DO
  8    2SWAP 2OVER
  9    D+
 10   LOOP
 11   2SWAP 2DROP
 12  ENDIF
 13 ;
 14 
 15 

Scr# 10166 
  0 ( White noise Egghead 3 )
  1 CODE WHITE-NOISE
  2  DI  PUSH BC|
  3 HERE CALL HERE AA,
  4  EI  POP  BC|  NEXT
  5 HERE SWAP 1+ !
  6 HERE LDN  E'|  250  N,
  7      LDX  HL|    0 NN,
  8 HERE PUSH DE|
  9      LDN  B'|   32  N,
 10 HERE PUSH BC|
 11      LD   A'| (HL)|
 12      INCX HL|
 13      ANDN 248 N,
 14      OUTA 254 P,
 15      LD   A'|   E|  -->

Scr# 10167 
  0 ( White noise Egghead 3 )
  1      CPL
  2 HERE DEC  A'|
  3      JRF NZ'| BACK,
  4      POP  BC|
  5      DJNZ     BACK,
  6      POP  DE|
  7      LD   A'|    E|
  8      SUBN 24 N,
  9      CPN  30 N,
 10      RETF  Z|
 11      RETF CY|
 12      LD   E'|    A|
 13 -->
 14 
 15 

Scr# 10168 
  0 ( White noise Egghead 3 )
  1      CPL
  2 \
  3 HERE LDN  B'| 40 N,
  4 HERE DJNZ BACK,
  5      DEC  A'|
  6      JRF NZ'| BACK,
  7      JR       BACK,
  8 C;
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 10169 
  0 ( Checksum of a RAM chunk )
  1 CODE CHECKSUM ( a n -- n2 )
  2  POP    DE|
  3  POP    HL|
  4  XORA    A|
  5  INC    D'|
  6 HERE DUP
  7  XORA (HL)|
  8  INCX   HL|
  9  DEC    E'|
 10  JRF   NZ'|  BACK,
 11  DEC    D'|
 12  JRF   NZ'|  BACK,
 13  LD     E'|  A|
 14  PUSH  DE|
 15  NEXT  C;

Scr# 10170 
  0 \ BURP
  1 \ Example
  2 : BURP
  3 [ HEX ] 7999 6000
  4 DO
  5  I HEX . I DECIMAL . CR
  6  ?TERMINAL IF QUIT THEN
  7 [ HEX ] 100
  8 +LOOP
  9 ;
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 10171 
  0 ( U* )
  1 CODE U*
  2  POP DE|
  3  POP HL|
  4  PUSH BC|
  5 \
  6  LD  C'|  L|
  7  LD  B'|  H|
  8  LDX HL| 0 NN,
  9  LDN A'| DECIMAL 16 N,
 10  HERE \ BEGIN,
 11   ADDHL HL|
 12   RL E|
 13   RL D|
 14   JRF NC'| HOLDPLACE
 15 -->

Scr# 10172 
  0 ( U* )
  1    ADDHL BC|
  2    JRF NC'| HOLDPLACE
  3     INCX DE|
  4    HERE DISP, \ THEN,
  5   HERE DISP, \ THEN,
  6   DEC A'|
  7  JRF NZ'| HOLDPLACE
  8  SWAP DISP, \ -UNTIL,
  9  EXDEHL
 10 \
 11  POP BC|
 12  PSH2
 13  C;
 14 
 15 

Scr# 10173 
  0 ( U/   dn n -- r dq )
  1 CODE U/
  2  POP  DE| \ Divisor
  3  POP  HL| \ High
  4  POP  IX| \ Low
  5  PUSH BC|
  6  LD   A'|    H|
  7  LD   C'|    L|
  8  LDX  HL|    0  NN,
  9  LDN  B'| DECIMAL 32 N,
 10  HERE DUP \ BEGIN,
 11   ADDIX IX|
 12   RL     C|
 13   RLA
 14   ADCHL HL|
 15 -->

Scr# 10174 
  0 ( U/ )
  1   JRF CY'| HOLDPLACE
  2    SBCHL DE|
  3    JRF NC'| HOLDPLACE
  4     ADDHL DE|
  5     ROT DJNZ HOLDPLACE
  6     SWAP DISP,
  7    SWAP ELSE,
  8     ORA A|  SBCHL DE|
  9    SWAP THEN,
 10    INC IX|
 11   THEN,
 12  DNJZ BACK,
 13 -->
 14 
 15 

Scr# 10175 
  0 ( U/ )
  1  LD   D'|  A|
  2  LD   E'|  C|
  3  POP  BC|
  4  PUSH HL|
  5  PUSH IX|
  6  PUSH DE|
  7  NEXT
  8 C;
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 10176 
  0 ( DSQRT )
  1 : D- DMINUS D+ ;
  2 0 0 VARIABLE SQX ,
  3 : DSQRT ( d -- n )
  4  1. D+ SQX 2! 0 BEGIN
  5  1+ DUP DUP UM*
  6  SQX 2@ D- SWAP DROP 0<
  7  0= UNTIL 1 - ;
  8 : ?PRIME ( d -- f )
  9  2DUP DSQRT 1+ 2 DO
 10  2DUP I UM/MOD DROP
 11  0= IF 0. SQX 2! LEAVE THEN
 12  LOOP SQX 2@ OR 0= 0= ;
 13 : TEST 36 16 DO
 14   I . I S->D DSQRT .
 15   CR LOOP ;

Scr# 10177 
  0 ( DSQRT )
  1 : D- DMINUS D+ ;
  2 0 0 VARIABLE SQX ,
  3 : DSQRT ( d -- n )
  4  1. D+ SQX 2! 0 BEGIN
  5  1+ DUP DUP UM*
  6  SQX 2@ D- SWAP DROP 0<
  7  0= UNTIL 1 - ;
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 10178 
  0 ( D2* )
  1 code D2* ( d1 -- d2 )
  2   exx
  3   pop    de|
  4   pop    hl|
  5   addhl  hl|
  6   push   hl|
  7   exdehl
  8   adchl  hl|
  9   push   hl|
 10   exx
 11   jpix
 12 c;
 13 
 14 
 15 

Scr# 10179 
  0 ( D2/ )
  1 code D2/ ( d1 -- d2 )
  2   exx
  3   pop    hl|
  4   pop    de|
  5   sra     h|
  6   rr      l|
  7   push   hl|
  8   exdehl
  9   rr      h|
 10   rr      l|
 11   push   hl|
 12   exx
 13   jpix
 14 c;
 15 

Scr# 10180 
  0 ( LARGE LETTER-F )
  1 : STAR   42 EMIT ;
  2 : STARS   0 DO STAR LOOP ;
  3 : MARGIN CR 15 SPACES ;
  4 : BLIP   MARGIN STAR ;
  5 : BAR    MARGIN 5 STARS ;
  6 : F      BAR BLIP BAR
  7          BLIP BLIP CR ;
  8 F
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 10202 
  0 ( DAA )
  1 HEX
  2 CODE T
  3  POP HL|
  4  CPL CPL
  5  LD A'| L|
  6  DAA
  7  LD L'| A|
  8  PSH1
  9  C;
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 10211 
  0 \ S" ( strings )
  1 : (S")
  2   R@ COUNT
  3   DUP 1+ R> + >R
  4 ;
  5 : S"
  6   ?COMP
  7   COMPILE (S")
  8   [CHAR] " WORD
  9   C@ 1+ ALLOT
 10 ; IMMEDIATE
 11 -->
 12 : TEST_S"
 13   S" CIAO" ;
 14 
 15 

Scr# 10220 
  0 ( MOVE SP )
  1 \ Use: HEX D900 MOVE-SP
  2 \ or   HEX F840 MOVE-SP
  3 HEX
  4 : MOVE-SP ( a -- )
  5   DUP 16 +ORIGIN !
  6   DUP 12 +ORIGIN !
  7   DUP        TIB !
  8   S0 @ SP!
  9 ;
 10 DECIMAL
 11 
 12 
 13 
 14 
 15 

Scr# 10221 
  0 ( MOVE RP )
  1 \ Use: HEX D9A0 MOVE-RP
  2 \ or   HEX F8E0 MOVE-RP
  3 HEX
  4 : MOVE-RP ( a -- )
  5   DUP R0 @ 80 -
  6   SWAP 80 - C0 CMOVE
  7   DUP 14 +ORIGIN !
  8   DUP 2E +ORIGIN !
  9   DUP         R0 !
 10 ;
 11 \
 12 DECIMAL
 13 
 14 
 15 

Scr# 10222 
  0 ( MOVE LIMIT )
  1 \ Use: HEX E000 MOVE-LIMIT
  2 \ or   HEX FF58 MOVE-LIMIT
  3 HEX
  4 : MOVE-LIMIT ( a -- )
  5   DUP LIMIT !
  6   DUP 24 +ORIGIN !
  7   60C - DUP FIRST !
  8   DUP USE !
  9   DUP PREV !
 10   22 +ORIGIN !
 11  3 [ ' #BUFF 2 + ] LITERAL !
 12 ;
 13 DECIMAL
 14 
 15 

Scr# 10223 
  0 ( UP AND DOWN )
  1 HEX
  2 : UP
  3   FF58 MOVE-LIMIT
  4   F8E0 MOVE-RP
  5   F840 MOVE-SP
  6 ;
  7 : DOWN
  8   D900 MOVE-SP
  9   B9A0 MOVE-RP
 10   E000 MOVE-LIMIT
 11 ;
 12 
 13 
 14 
 15 

Scr# 10224 
  0 ( BANK! TEST )
  1 HEX
  2 \ BANKM : 5B5C
  3 : ?BANK BASE @
  4   5B5C C@ 2 BASE ! .
  5   BASE ! ;
  6 : TEST
  7   BANK!
  8   C000 @ U.
  9   10 BANK!
 10 ;
 11 
 12 
 13 
 14 
 15 

Scr# 10230 
  0 ( DOS CALL# )
  1 \ DOS# ( bc de hl a -- )
  2 \      ( -- bc de hl f )
  3 CODE DOS#
  4 POP   HL|  \ dos call entry
  5 HERE  LD()HL 0 AA,
  6 LD    H'|   B|
  7 LD    L'|   C|
  8 POP   BC|  \ bc argument
  9 POP   DE|  \ de argument
 10 EX(SP)HL   \ hl argument
 11 LD    A'|   L|
 12 HERE  CALL HERE AA,
 13  1+ SWAP 1+ ! \ patch
 14 -->
 15 

Scr# 10231 
  0 ( DOS CALL# )
  1 EX(SP)HL   \ hl argument
  2 PUSH  DE|  \ de argument
  3 PUSH  BC|  \ bc argument
  4 LD    C'|   L|
  5 LD    B'|   H|
  6 LDX   HL| 0 NN,
  7 JRF   NC'| HOLDPLACE
  8  LD   L'|   A|
  9 HERE DISP,
 10 PSH1
 11 C;
 12 
 13 
 14 
 15 

Scr# 10239 
  0 ( Rainbow effects )
  1 HEX CREATE SYNC
  2  76 C,
  3  C3 C, (NEXT) , SMUDGE
  4 : RAINBOW
  5 BEGIN
  6  SYNC
  7  09 0 DO
  8    8 0 DO
  9       I FFFE P!
 10     LOOP
 11   LOOP
 12  ?TERMINAL
 13 UNTIL
 14 ;
 15 DECIMAL

Scr# 10240 
  0 ( +3DOS TEST )
  1 HEX : BANKM! BANK! ;
  2 : 3TEST
  3   07 BANKM!
  4   10 BANKM!
  5 ;
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 10251 
  0 ( block move reorder )
  1 \ Utility used while
  2 \ reordering all screens
  3 DECIMAL  3 LOAD
  4 DECIMAL 41 LOAD
  5 : MOVE-BLOCKS-UP
  6  CLS
  7  350 1 DO
  8   0. AT. I . SPACE
  9   I I 10000 +
 10   BCOPY
 11   ?TERMINAL IF LEAVE THEN
 12  LOOP
 13 ;
 14 
 15 

Scr# 10252 
  0 \ Print all blocsks to #13
  1 \ The "blocks2txt.pl" Perl script does the same faster
  2 : >OUTPUT 13
  3   DUP DEVICE ! SELECT ;
  4 : PRINT-ALL-BLOCKS
  5   >OUTPUT
  6   ." This list is produced via Scr# 252 " CR CR
  7   1 1000 INDEX CR CR
  8   1001 1 DO
  9     VIDEO I 5 .R
 10     I BLOCK >OUTPUT I LIST CR
 11     VIDEO 5 0 DO 8 EMITC LOOP
 12     ?TERMINAL IF LEAVE THEN
 13   LOOP
 14   VIDEO CR ;
 15 

Scr# 10254 
  0 ( MICRODRIVE CARTRIDGE )
  1 ( LAST BLOCK )
  2 \ At least one block should
  3 \ be unusable due to the
  4 \ ring-junction on the tape
  5 \ so this block shouldn't be
  6 \ available.
  7 \ More: Real cartridges can
  8 \ have up to 85-90 K
  9 \ This means 170-180 blocks.
 10 
 11 
 12 
 13 
 14 
 15 \ TEST

Scr# 10259 
  0 ( POSTPONE )
  1 DECIMAL
  2 : POSTPONE
  3  ?COMP -FIND \ xt b f
  4  0= 0 ?ERROR
  5  192 < IF
  6   COMPILE COMPILE
  7  THEN
  8 
  9 ; IMMEDIATE
 10 ;S
 11 : TIF
 12  POSTPONE 0BRANCH HERE 0 ,
 13  2 ; IMMEDIATE
 14 
 15 

Scr# 10270 
  0 ( PICK )
  1 CODE PICK ( n -- v-nth )
  2  POP   HL|
  3  ADDHL HL|
  4  ADDHL SP|
  5  LD    A'|  (HL)|
  6  INCX  HL|
  7  LD    H'|  (HL)|
  8  LD    L'|     A|
  9  PSH1
 10 C;
 11 
 12 
 13 
 14 
 15 

Scr# 10287 
  0 ( GREY-SCREEN example )
  1 HEX
  2 CODE GREY-SCREEN
  3  PUSH BC|
  4  LDX  HL|  4000  NN,
  5  LDX  DE|  AA55  NN,
  6  LDX  BC|  000C  NN,
  7 HERE HERE
  8  LD   A'|  (HL)|
  9  XORA  E|
 10  LD (HL)'|    A|
 11  INCX HL|
 12  DJNZ BACK,
 13 -->
 14 
 15 

Scr# 10288 
  0 ( GREY-SCREEN example )
  1 HERE
  2  LD   A'|  (HL)|
  3  XORA  D|
  4  LD (HL)'|    A|
  5  INCX HL|
  6  DJNZ BACK,
  7  DEC  C'|
  8  JRF NZ'| BACK,
  9  POP BC|
 10 NEXT C;
 11 DECIMAL
 12 
 13 
 14 
 15 

Scr# 10292 
  0 ( GREY-SCREEN example )
  1 HERE
  2  LD   A'|  (HL)|
  3  XORA  D|
  4  LD (HL)'|    A|
  5  INCX HL|
  6  DJNZ BACK,
  7  DEC  C'|
  8  JRF NZ'| BACK,
  9  POP BC|
 10 NEXT C;
 11 DECIMAL
 12 
 13 
 14 
 15 

Scr# 10293 
  0 ( MMU7 = 40h )
  1 ( MMU7 = 41h )
  2 ( MMU7 = 42h )
  3 ( MMU7 = 43h )
  4 ( MMU7 = 44h )
  5 
  6 
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 ( DEFAULT = 01h )

Scr# 10300 
  0 ( FAR-HL )
  1 CODE FAR-HL
  2  POP  HL|
  3  LD   A'|  H|
  4  ANDN HEX 0C0 N,
  5  JPF  NZ| (NEXT) 1- AA,
  6  LD   A'|  H|
  7  RRA
  8  ORN  HEX 080 N,
  9  RRA
 10  NEXTREGA DECIMAL 87 P,
 11  ADDHL HL|
 12  ADDHL HL|
 13  ADDHL HL|
 14 -->
 15 

Scr# 10301 
  0 ( FAR-HL )
  1  LD   A'|  H|
  2  ORN  HEX 0E0 N,
  3  LD   H'|  A|
  4  PSH1
  5 C;
  6 \
  7 DECIMAL
  8 CODE NEAR-HL
  9  LDN  A'|  1  N,
 10  NEXTREGA 87 REG,
 11  NEXT
 12 C;
 13 
 14 
 15 

Scr# 10305 
  0 ( MMU7 banking study )
  1 \
  2 \ reset MMU7 to default 1
  3 \
  4 CODE MMU7-01
  5  NEXTREG 87 P, 1 N,
  6  NEXT
  7 C;
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 10306 
  0 ( MMU7 banking study )
  1 \
  2 \ set MMU7 to 64+n  8K block
  3 \ n between 0 and 63
  4 \
  5 CODE MMU7 ( n -- )
  6  POP  HL|
  7  LD   A'|  H|
  8  ANDN HEX 3F N,
  9  ORN  HEX 040 N,
 10  DECIMAL
 11  NEXTREGA 87 P,
 12  NEXT
 13 C;
 14 \
 15 -->

Scr# 10307 
  0 ( MMU7 banking study )
  1 \ Given a lower 16K address
  2 \ determines 8K block n
  3 \ and offset a from E000
  4 CODE +FAR ( a1 -- a2 n )
  5  LDX  DE|  0 NN,
  6  POP  HL|
  7  LD   A'|  H|
  8  ANDN HEX 0C0 N,
  9  JRF NZ'| HOLDPLACE
 10  LD   A'|  H|
 11  RRA
 12  ORN  HEX 080 N,
 13  RRA
 14 -->
 15 

Scr# 10308 
  0 ( MMU7 banking study )
  1  LD   E'|  A|
  2  ADDHL HL|
  3  ADDHL HL|
  4  ADDHL HL|
  5  LD   A'|  H|
  6  ORN  HEX 0E0 N,
  7  LD   H'|  A|
  8 \
  9  HERE DISP,
 10  EXDEHL
 11  PSH2
 12 C;
 13 
 14 
 15 

Scr# 10309 
  0 ( MMU7 banking study )
  1 CODE -FAR ( a2 b -- a1 )
  2  POP  DE|
  3  POP  HL|
  4  LD   A'|  E|
  5  DEC  E'|
  6  JRF  Z'| HOLDPLACE
  7  ANDN HEX 0F N,
  8  RLA RLA RLA
  9  RR H|  RR L|
 10  RR H|  RR L|
 11  RR H|  RR L|
 12  ANDA H|
 13  LD  H'|  A|
 14  PSH1
 15 C;

Scr# 10310 
  0 ( MMU7 banking study )
  1 \ Decode 5 high bits as 8K
  2 \ block for MMU7 and takes
  3 \ lower bits x 8
  4 CODE FAR ( a1 -- a2 n )
  5  POP  HL|
  6  LD   A'|  H|
  7  ANDN HEX FC N,
  8  RRA RRA
  9  ORN  HEX 40 N,
 10  LDN  D'| 0 N,
 11  LD   E'|  A|
 12  ADDHL HL|
 13  ADDHL HL|
 14  ADDHL HL|
 15 -->

Scr# 10311 
  0 ( MMU7 banking study )
  1  LD   A'|  H|
  2  ORN  HEX E0 N,
  3  LD   H'|  A|
  4  EXDEHL
  5  PSH2
  6 C;
  7 
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 15360 
  0 
  1 
  2 
  3 
  4 
  5 
  6 
  7 
  8 x    xx xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx xx
  9 xxx xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx
 10 xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx xxxx
 11 x xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx xx
 12 xxx xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx
 13 xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx xxxx
 14 x xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx xx
 15 xxx xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx

Scr# 15361 
  0 x     x x x x x x x x x x x x x x x x x x x x x x x x x x x x x
  1 x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x
  2 x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x
  3 x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x
  4 x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x
  5 x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x
  6 x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x
  7 x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 15362 
  0 x             x          x          x          x          x
  1      x          x          x          x     x    x          x
  2        x          x          x          x          x          x
  3          x          x          x    x     x          x
  4 x          x          x          x          x          x
  5   x          x          x   x      x          x          x
  6     x          x          x          x          x          x
  7       x          x  x       x          x          x          x
  8 
  9 
 10 
 11 
 12 
 13 
 14 
 15 

Scr# 16000 
  0 ( porting page 1 to blocks )
  1 : porting>
  2   $10 0 do i .
  3     $E000 i b/buf * +   1 mmu7!
  4     $7D02 i + block     b/buf cmove update flush
  5   loop
  6 ;
  7 : <porting
  8   $20 mmu7!
  9   $10 0 do i .
 10     $7D02 i + block     $20 mmu7!
 11     $E000 i b/buf * +   b/buf cmove
 12   loop
 13 ; decimal
 14 
 15 


Index:

    1 98BLOCK system - introduction )
    2 ( Error messages    from -31 to -17 )
    3 ( Error messages    from -15 to -1  )
    4 is undefined.
    5 ( Error messages    from #17 to #31 )
    6 ( Error messages    from #33 to #47 )
    7 ( Error messages    from #49 to #63 )
    8 ( Error messages    from #65 to #79 )
    9 ( Print a complete error list )
   10 .( AUX )
   11 ( Autoexec )
   20 ( LOADG )
   21 ( LOADG )
   22 ( LOADG )
   23 ( LOADG )
   24 ( LOADG )
   25 ( LOADG )
   26 ( restore default )
   35 
  100 .( Assembler. Use NEEDS ASSEMBLER instead )
  101 .( Z80 Assembler. ) CR
  102 ( Z80 Utility - Sys depend )
  103 ( Z80 Utility - Sys depend )
  104 ( Z80 System independ. )
  105 ( Z80 System independ. )
  106 ( Z80 Generate errors )
  107 ( Assembler Z80 )
  108 ( Assembler Z80 )
  109 ( Assembler Z80 )
  110 ( Assembler Z80 )
  111 ( Assembler Z80 )
  112 ( Assembler Z80 )
  113 ( Assembler Z80 )
  114 ( Assembler Z80 )
  115 ( Assembler Z80 )
  116 ( Assembler Z80 )
  117 ( Assembler z80 )
  118 ( Assembler MMU config -- seems bugged: don't use )
  119 ( Assembler vocabulary checksum )
  120 .( Z80 definitions. ) CR
  121 ( Z80 ) HEX
  122 ( Z80 ) HEX
  123 ( Z80 ) HEX
  124 ( Z80 immediate data )
  125 ( Z80 address )
  126 ( Z80 ) HEX
  127 ( Z80 relative jump )
  128 ( ED prefix )
  129 ( ED prefix )
  130 ( ED prefix )
  131 ( CB prefix )
  132 ( IX IY prefix )
  133 ( IX IY prefix )
  134 ( IX IY prefix )
  135 ( IX IY prefix )
  136 ( IX IY prefix )
  137 ( IX IY prefix )
  138 ( IX IY prefix )
  139 ( Page-in and Page-out - development )
  140 .( Z80 near structure )   CR
  141 ( Z80 Near struct. )
  142 ( Z80 Near struct. )
  143 ( Z80 Near struct. )
  144 ( Z80 Near struct. )
  145 ." Z80 far struct "
  146 ( Testing & Debugging this vocabulary )
  147 ( 128K memory BANK! test )
  148 ( 128K memory BANK! test )
  149 ( 128K memory BANK! test )
  150 ( Assembler test - 0 )
  151 ( Assembler test - 1 )
  152 ( Assembler test - 2 )
  153 ( Assembler test - 3 )
  154 ( Assembler test - 4 )
  155 ( Assembler test - 5 )
  156 ( Assembler test - 6 )
  157 ( Assembler test - 7 )
  158 ( Assembler test - 8 - Z80N )
  159 ( Assembler test - 9 - Z80N )
  160 .( Z80N Next extensions )
  161 ( Z80N Next extension )
  162 ( Z80N Next extension )
  163 ( ROLL development )
  164 ( ROLL development )
  165 ( M*/ - development )
  166 ( Assembler example - White noise Egghead 3 )
  167 ( Assembler example - White noise Egghead 3 )
  168 ( Assembler example - White noise Egghead 3 )
  169 ( Assemble example -  Checksum of a RAM chunk )
  170 \ BURP
  171 ( Example - Dump many pages )
  172 ( NEEDS - development )
  173 ( NEEDS - development )
  174 ( NEEDS - development )
  175 ( NEEDS - development )
  176 ( NEEDS - development )
  177 ( INCLUDE - development )
  178 ( DEFER IS - EXIT UNLOOP - development )
  179 ( CHECK NULL - search any 0x00 in blocks )
  180 .( Line editor -- Use NEEDS EDITOR instead  )
  181 ( Line Editor          2/6 )
  182 ( Line Editor          3/6 )
  183 ( Line Editor          4/6 )
  184 ( Line Editor          5/6 )
  185 ( Line Editor          6/6 )
  186 ( VOCABULARY exploration )
  187 ( Utility: Restore AUTOEXEC )
  188 ( Editor utility           )
  189 .( Call utility. )        CR
  190 .( EDIT - Full Screen Editor )
  191 ( EDIT - Full Screen Editor   2/8 )
  192 ( EDIT - Full Screen Editor   3/8 )
  193 ( Full Screen Editor   4/8 )
  194 ( Full Screen Editor   5/8 )
  195 ( Full Screen Editor   6/8 )
  196 ( Full Screen Editor   7/8 )
  197 ( Full Screen Editor   8/8 )
  198 ( \\ comment - example )
  199 ( MARKER - development )
  200 .( example - .RESET & CPU SPEED )  CR
  201 ( Test - Z80 op-code DAA test )
  202 ( PICK - development )
  203 ( U* - development )
  204 ( U* - development )
  205 ( U/ - development )
  206 ( U/ - development )
  207 ( U/ - development )
  208 ( UPPER - development )
  209 ( "NUL" - development )
  210 \ 1. F_GETLINE from handle( via F_READ and F_SEEK ) DECIMAL
  211 \ 2. include from handle
  212 \ 2. include from handle
  213 \ 3. an INCLUDE wrapper
  214 ( UM* using MUL new OP-code - development )
  215 ( UM* using MUL new OP-code - development )
  216 ( UM* using MUL new OP-code - development )
  217 ( TEST )
  218 ( UM* using MUL new OP-code - development )
  219 ( UM* using MUL new OP-code - development )
  220 ( Utility -  MOVE SP )
  221 ( Utility - MOVE RP )
  222 ( Utility - MOVE LIMIT )
  223 ( Utility - UP AND DOWN )
  224 ( Test - 128K BANK! TEST )
  225 ( ?DO LOOP - development )
  226 ( ?DO LOOP - development )
  227 ( ?DO LOOP - development )
  228 ( ?DO LOOP - development )
  229 ( POSTPONE - development )
  230 \ 0. F_GETLINE from handle( F_READ and F_SEEK )
  231 \ 1. include from handle
  232 \ 2. include from handle
  233 \ 3. include from handle
  234 \ 4. an INCLUDE wrapper
  235 ( Study - Long memory dump )
  236 ( Example - Save RAM to BLOCKS )
  237 code s*/  ( b1 b2 b3 -- b4 := b1 * b2 / b3 )
  238 \ s*/
  239 ( Example - Rainbow effects )
  240 ( test )
  241 \ Leo Brodie - Starting Forth - Square
  242 ( Example - CUBES )
  243 ( Example - CUBES )
  244 ( Example - CUBES )
  245 \ Leo Brodie - Starting Forth - Vectored execution
  246 \ Leo Brodie - Starting Forth - Buzzphrases Generator - ver 1.
  247 \ Leo Brodie - Starting Forth - Buzzphrases Generator - ver 1.
  248 ( Simple Word RENAMEr )
  249 ( ENUM - development
  250 \ BLOCK-SHIFT - utility
  251 ( block move reorder - utility )
  252 \ Print all blocsks to #13
  253 ( INITIALIZE-MMC )
  254 ( MICRODRIVE CARTRIDGE LAST BLOCK )
  256 ( +loop standardization )
  257 ( +loop standardization )
  258 ( +loop standardization )
  259 \ Forth Application Tecniques - 5.1.1
  260 ( TRACE )
  261 ( TRACE )
  262 ( TRACE )
  263 ( TRACE )
  264 ( TRACE )
  265 ( TRACE )
  266 ( TEST )
  267 ( GO-TO )
  268 ( GO-TO )
  269 ( GO-TO )
  270 \ SCREEN-FROM-FILE.f
  271 \ SCREEN-TO-FILE.f
  275 ( Eratostenes )
  276 ( Eratostenes )
  279 ( Fibonacci )
  280 ( SQRT )
  281 ( Primality Test )
  282 ( Primality Test )
  283 ( LOAD-BYTES TEST )
  284 ( TEST )
  285 ( SAVE-BYTES TEST )
  286 ( DOT example  .helloworld )
  287 ( search for AT position )
  288 ( TEST )
  289 ( TEST )
  290 ( map - character replacing )
  291 ( map - character replacing )
  292 ( map - character replacing )
  293 ( map - character replacing )
  294 ( GREY-SCREEN example )
  300 ( Study: MMU7 / set or get bank )
  301 ( Study: MMU7 / simplest )
  302 ( Study: MMU7 / simplest )
  303 ( Study: MMU7 / simplest )
  304 ( Study: MMU7 / simplest )
  305 ( Study: MMU7 / 16th byte )
  306 ( Study: MMU7 / 16th byte )
  307 ( Study: MMU7 / 16th byte )
  308 ( Study: MMU7 / 16th byte )
  309 ( example < asm )
  310 ( LED - Large EDitor  1/18 )
  311 ( LED - Large EDitor  2/18 )
  312 ( LED - Large EDitor  3/18 )
  313 ( LED - Large EDitor  4/18 )
  314 ( LED - Large EDitor  5/18 )
  315 ( LED - Large EDitor  6/18 )
  316 ( LED - Large EDitor  7/18 )
  317 ( LED - Large EDitor  8/18 )
  318 ( LED - Large EDitor  9/18 )
  319 ( LED - Large EDitor 10/18 )
  320 ( LED - Large EDitor 11/18 )
  321 ( LED - Large EDitor 12/18 )
  322 ( LED - Large EDitor 13/18 )
  323 ( LED - Large EDitor 14/18 )
  324 ( LED - Large EDitor 15/18 )
  325 ( LED - Large EDitor 16/18 )
  326 ( LED - Large EDitor 17/18 )
  327 ( LED - Large EDitor 18/18 )
  328 ( MMU7 HEAP )
  329 ( MMU7 HEAP STRING )
  330 ( MMU7 HEAP STRING )
  331 ( MMU7 HEAP STRING )
  332 ( MMU7 HEAP POINTER )
  333 ( S" Counted Strings in Heap )
  334 \ TEST
  335 ( Testing where $6000 is paged )
  336 ( Testing where $6000 is paged )
  340 ( TILEMAP study )
  341 ( R/W : BLK-READ )
  342 ( R/W : BLK-WRITE )
  343 ( R/W : BLK-INIT )
  344 ( blk-fname )
  345 ( r/w patch )
  346 ( +loop standardization )
  347 ( +loop standardization )
  348 ( +loop standardization )
  349 ( +loop standardization )
  350 ( test )
  351 ( -- )
  352 : Do
  353 : ?Do
  354 ( LEAVE study )
  355 ( UNLOOP study )
  356 ( t )
  357 ( Matt Davies'  .helloworld )
  358 ( Speed Test - Benchmark - 5.12 sec. )
  360 ( F_STAT     via RST 8 hook code )
  361 ( F_FGETPOS  via RST 08 hook code )
  362 ( F_SEEK     via RST 08 hook code )
  363 ( F_WRITE    via RST 8 hook code )
  364 ( F_READ     via RST 8 hook code )
  365 ( F_CLOSE    via RST 8 hook code )
  366 ( F_OPEN     via RST 8 hook code )
  367 ( F_OPEN     via RST 8 hook code )
  368 ( F_FSTAT    via RST 8 hook code )
  369 ( F_SYNC     via RST 8 hook code )
  370 ( M_DOSVERSION via RST 8 hook code )
  371 ( F_GETFREE  via RST 08 hook code test )
  372 ( M_P3DOS )
  373 ( M_P3DOS )
  374 ( M_P3DOS )
  375 ( F_OPENDIR  via RST 8 hook code )
  376 ( F_READDIR  via RST 8 hook code )
  377 ( NextZXOS - IDE_PATH 01b1 )
  378 ( DIR TEST )
  379 ( NextZXOS - IDE_MODE 01d5 )
  380 ( NextZXOS - IDE_CAPACITY $01b4 )
  381 ( NextZXOS - DOS_FREE_SPACE $0121 )
  382 ( NextZXOS - IDE_MODE 01d5 )
  383 ( NextZXOS - IDE_MODE 01d5 )
  384 ( DOS_FLUSH $0142 )
  385 ( DOS_VERSION / IDE_VERSION )
  386 ( IDE_BASIC 1/5 )
  387 ( IDE_BASIC 2/5 )
  388 ( IDE_BASIC 3/5 )
  389 ( IDE_BASIC 4/5 )
  390 ( IDE_BASIC 5/5 )
  391 ( IDE_BASIC test )
  392 ( REMOUNT via IDE_MOUNT    $01d2 )
  393 ( IDE_TOKENISE $01d8 )
  394 ( IDE_TOKENISER )
  395 ( SPRITE structure )
  398 ( looking for AT position in LAYERs )
  399 ( Sprite definition )
  400 ( Sprite struct definition )
  401 ( Sprite struct definition )
  402 ( Sprite Lib - Derek Bolli et Al. )
  403 ( Sprite Lib )
  404 ( Sprite Lib )
  405 ( Sprite Lib )
  406 ( Sprite )
  407 ( Sprite )
  408 ( Sprite Test )
  409 ( Sprite Test )
  410 ( Sprite definition )
  411 ( TEST )
  412 ( ISR-TEST )
  413 ( SPRITE with ISR-TEST )
  414 needs .at  needs .paper  needs mouse
  415 ( .HEX and .BIN utility )
  416 ( rshift )
  417 ( rshift )
  418 ( Enhanced ULA Control Register $43 )
  419 ( Autoexec )
  420 ( TILEMAP study )
  421 ( TILEMAP study )
  422 ( TILEMAP study )
  423 ( TILEMAP study )
  424 ( TILEMAP study )
  425 ( TILEMAP study )
  426 ( TILEMAP study )
  427 ( TILEMAP study )
  428 ( TILEMAP study )
  429 ( TILEMAP study )
  430 ( TILEMAP study )
  431 ( TILEMAP study )
  433 ( tile help )
  434 ( tile help )
  435 ( tile help )
  436 ( tile help )
  438 ( afxframe tester )
  439 ( afx load to block )
  480 ( Lift Challenge )
  481 ( Lift Challenge )
  482 ( Lift Challenge )
  483 ( Lift Challenge )
  484 ( Lift Challenge )
  485 ( Lift Challenge )
  486 ( Lift Challenge )
  487 ( Lift Challenge )
  490 ( MOUSE FACE )
  491  m | " " _ _ _ _ _ _ _ _ _ _ _ _   \ 0
  492 ( MOUSE FACE )
  493 ( MOUSE FACE )
  500 ( Next Registers )
  501 ( Next Registers )
  502 ( Next Registers )
  503 ( Next Registers )
  504 ( Next Registers )
  511 ( Prepare Sine Table on Screen # DEST )
  512 ( Prepare Sine Table on Screen # DEST )
  513 ( Sine Cosine Table )
  514 ( Sine Cosine using table values )
  520 ( LAYER 2 palette picker )
  521 ( LAYER 2 palette picker )
  522 ( LAYER 2 palette picker )
  523 ( LAYER 2 palette picker )
  524 ( LAYER 2 palette picker )
  525 ( LAYER 2 palette picker )
  526 ( LAYER 2 palette picker )
  527 ( LAYER 2 palette picker )
  528 ( LAYER 2 palette picker )
  529 ( LAYER 2 palette picker )
  530 ( LAYER 2 palette picker )
  531 ( mouse test )
  532 ( LAYER 2 palette picker )
  533 ( LAYER 2 palette picker )
  534 ( LAYER 2 palette picker )
  535 ( LAYER 2 palette picker )
  537 ( VALUE TO )
  538 \ test
  540 ( LAYER2 )
  548 ( Mr Jones' keyboard test )
  549 ( Mr Jones' keyboard test )
  552 ( Pitch bend )
  553 ( KEYBOARD-TEST )
  557 ( FRAMES )
  558 ( FRAMES 2 )
  559 ( TEST )
  560 ( Convawys Game Of Life )
  561 ( Convawys Game Of Life )
  562 ( Convawys Game Of Life )
  563 ( Convawys Game Of Life )
  564 ( Convawys Game Of Life )
  565 ( Convawys Game Of Life )
  566 ( Convawys Game Of Life )
  567 ( test SOURCE )
  568 ( testing  test/source.f )
  569 ( SOURCE )
  580 ( TEST )
  581 ( DOT example  .var )
  590 ( Product routine for 12:4 fixed point )
  591 ( Product routine for 12:4 fixed point )
  592 ( Product routine for 12:4 fixed point )
  593 ( Product routine for 12:4 fixed point )
  594 ( Product routine for 12:4 fixed point )
  595 ( Product routine for 12:4 fixed point )
  598 \ kempston test
  599 \ kempston test
  600 .( Chomp.f )
  601 ( Chomp.f )
  602 ( Chomp.f )
  603 ( Chomp.f )
  604 ( Chomp.f )
  605 ( Chomp.f )
  606 ( Chomp.f )
  610 .( Chomp.f - UDG )
  611 ( Chomp.f - UDG )
  612 ( Chomp.f - UDG )
  613 ( Chomp.f - UDG )
  614 .( Chomp.f - maze )
  615 ( Chomp.f - maze )
  616 ( Chomp.f - maze )
  617 ( Chomp.f - maze )
  618 ( Chomp.f - maze )
  619 ( Chomp.f - maze )
  620 .( Chomp.f - Sprite )
  621 ( Chomp.f - Sprite )
  622 ( Chomp.f - Sprite )
  623 ( chomp.f - Sprite )
  624 ( Chomp.f - Sprite )
  625 ( Chomp.f - Sprite )
  626 ( Chomp.f - Sprite )
  627 ( Chomp.f - Sprite )
  628 ( Chomp.f - Sprite )
  629 ( Chomp.f )
  630 .( Chomp.f - trail )
  631 ( Chomp.f - trail )
  632 ( Chomp.f - trail )
  633 ( Chomp.f - trail )
  634 ( Chomp.f - trail )
  635 ( Chomp.f - trail )
  636 ( Chomp.f - trail )
  637 ( Chomp.f - trail )
  638 ( Chomp.f - trail )
  639 ( Chomp.f - trail )
  640 ( Chomp.f - ghost )
  641 ( Chomp.f - ghost )
  642 ( Chomp.f - ghost )
  643 ( Chomp.f - ghost )
  644 ( Chomp.f - ghost )
  645 ( Chomp.f - ghost )
  646 ( Chomp.f - trail )
  650 ( Chomp.f )
  651 ( Chomp.f )
  652 ( Chomp.f )
  653 ( Chomp.f - Interlude )
  654 ( Chomp.f )
  655 ( Chomp.f )
  656 ( Chomp.f )
  657 ( Chomp.f )
  658 ( Chomp.f )
  659 ( Chomp.f )
  660 ( Chomp.f )
  661 ( Chomp.f )
  662 ( Chomp.f )
  663 ( Chomp.f )
  664 ( Chomp.f )
  665 ( Chomp.f )
  666 ( Chomp.f )
  667 ( Chomp.f )
  668 ( Chomp.f )
  670 ( Create standalone executable )
  680 \ integer approximation of  1 / (2^(1/12))
  690 \ integer approximation of  1 / (2^(1/12))
  700 \ HEAP colon-definition: 128K dictionary space.
  701 \ HEAP colon-definition: 128K dictionary space.
  702 \ HEAP colon-definition: 128K dictionary space.
  703 \ HEAP colon-definition: 128K dictionary space.
  704 \ HEAP colon-definition: 128K dictionary space.
  705 \ HEAP colon-definition: 128K dictionary space.
  706 \ HEAP colon-definition: 128K dictionary space.
  707 \ HEAP colon-definition: 128K dictionary space.
  708 ( HEAP )
  709 ( HEAP )
  710 ( TERM )
  711 ( TERM0 )
  712 ( TERM0 )
  713 ( TERM0 )
  714 ( TERM0 )
  715 exit

Restarting Supervisor
c [38;5;154mi------------------
  716 ( 3CONSTANT )
  717 ( 3CONSTANT )
  718 ( Collatz conjecture )
  720 ( 256 bitmap )
  721 ( 256 bitmap )
  722 ( 256 bitmap )
  723 ( 256 bitmap )
  777 ( 0< modified )
  778 ( Bernstein - Vazirani )
  779 ( Bernstein - Vazirani )
  790 ( ZX-Next Copper )
  791 ( ZX-Next Copper )
  792 ( ZX-Next Copper )
  793 ( ZX-Next Copper - Example )
  795 ( ZX-Next Copper - Example )
  796 ( ZX-Next Copper - Example )
  798 ( test )
  799 ( test )
  800 \ Brodie - Starting FORTH - Ch. 1 - Fundamental Forth
  801 \ Brodie - Starting FORTH - Ch. 1 - Fundamental Forth
  802 \ Brodie - Starting FORTH - Ch. 1 - Fundamental Forth
  803 \ Brodie - Starting FORTH - Ch. 1 - Fundamental Forth
  804 \ Brodie - Starting FORTH - Ch. 1 - Fundamental Forth
  805 \ Brodie - Starting FORTH - Ch. 2 - How to get results
  806 \ Brodie - Starting FORTH - Ch. 2 - How to get results
  807 \ Brodie - Starting FORTH - Ch. 2 - How to get results
  808 \ Brodie - Starting FORTH - Ch. 2 - How to get results
  809 \ Brodie - Starting FORTH - Ch. 2 - How to get results
  810 \ Brodie - Starting FORTH - Ch. 2 - How to get results
  811 \ Brodie - Starting FORTH - Ch. 2 - How to get results
  812 \ Brodie - Starting FORTH - Ch. 2 - How to get results
  813 \ Brodie - Starting FORTH - Ch. 2 - How to get results
  814 \ Brodie - Starting FORTH - Ch. 2 - How to get results
  815 \ Brodie - Starting FORTH - Ch. 3 - The Editor
  816 \ Brodie - Starting FORTH - Ch. 4 - Decisions, Decisions...
  817 \ Brodie - Starting FORTH - Ch. 4 - Decisions, Decisions...
  818 \ Brodie - Starting FORTH - Ch. 4 - Decisions, Decisions...
  819 \ Brodie - Starting FORTH - Ch. 4 - Decisions, Decisions...
  820 \ Brodie - Starting FORTH - Ch. 4 - Decisions, Decisions...
  821 \ Brodie - Starting FORTH - Ch. 5 - Philosophy of Fixed Point
  822 \ Brodie - Starting FORTH - Ch. 5 - Philosophy of Fixed Point
  823 \ Brodie - Starting FORTH - Ch. 5 - Philosophy of Fixed Point
  824 \ Brodie - Starting FORTH - Ch. 5 - Philosophy of Fixed Point
  825 \ Brodie - Starting FORTH - Ch. 5 - Philosophy of Fixed Point
  826   Brodie - Starting FORTH - Ch. 6 - Throw it for a loop
  827 \ Brodie - Starting FORTH - Ch. 6 - Throw it for a loop
  828 \ Brodie - Starting FORTH - Ch. 6 - Throw it for a loop
  829 \ Brodie - Starting FORTH - Ch. 6 - Throw it for a loop
  830 \ Brodie - Starting FORTH - Ch. 6 - Throw it for a loop
  831 \ Brodie - Starting FORTH - Ch. 6 - Throw it for a loop
  832 \ Brodie - Starting FORTH - Ch. 6 - Throw it for a loop
  833 \ Brodie - Starting FORTH - Ch. 6 - Throw it for a loop
  834 \ Brodie - Starting FORTH - Ch. 6 - Throw it for a loop
  835 \ Brodie - Starting FORTH - Ch. 6 - Throw it for a loop
  836 \ Brodie - Starting FORTH - Ch. 6 - Throw it for a loop
  837 \ Brodie - Starting FORTH - Ch. 6 - Throw it for a loop
  838 \ Brodie - Starting FORTH - Ch. 7 - A Numbers of Kind of Numbers
  839 \ Brodie - Starting FORTH - Ch. 7 - A Numbers of Kind of Numbers
  840 \ Brodie - Starting FORTH - Ch. 7 - A Numbers of Kind of Numbers
  841 \ Brodie - Starting FORTH - Ch. 7 - A Numbers of Kind of Numbers
  842 \ Brodie - Starting FORTH - Ch. 7 - A Numbers of Kind of Numbers
  843 \ Brodie - Starting FORTH - Ch. 7 - A Numbers of Kind of Numbers
  844 \ Brodie - Starting FORTH - Ch. 7 - A Numbers of Kind of Numbers
  845 \ Brodie - Starting FORTH - Ch. 7 - A Numbers of Kind of Numbers
  846 \ Brodie - Starting FORTH - Ch. 7 - A Numbers of Kind of Numbers
  847 \ Brodie - Starting FORTH - Ch. 7 - A Numbers of Kind of Numbers
  848 \ Brodie - Starting FORTH - Ch. 7 - A Numbers of Kind of Numbers
  849 \ Brodie - Starting FORTH - Ch. 7 - A Numbers of Kind of Numbers
  850 \ Brodie - Starting FORTH - Ch. 8 - Variables, Constants, Arrays
  851 \ Brodie - Starting FORTH - Ch. 8 - Variables, Constants, Arrays
  852 \ Brodie - Starting FORTH - Ch. 8 - Variables, Constants, Arrays
  853 \ Brodie - Starting FORTH - Ch. 8 - Variables, Constants, Arrays
  854 \ Brodie - Starting FORTH - Ch. 8 - Variables, Constants, Arrays
  855 \ Brodie - Starting FORTH - Ch. 8 - Variables, Constants, Arrays
  856 \ Brodie - Starting FORTH - Ch. 8 - Variables, Constants, Arrays
  857 \ Brodie - Starting FORTH - Ch. 8 - Variables, Constants, Arrays
  858 \ Brodie - Starting FORTH - Ch. 8 - Variables, Constants, Arrays
  859 \ Brodie - Starting FORTH - Ch. 8 - Variables, Constants, Arrays
  860 \ Brodie - Starting FORTH - Ch. 8 - Variables, Constants, Arrays
  861 \ Brodie - Starting FORTH - Ch. 8 - Variables, Constants, Arrays
  862 \ Brodie - Starting FORTH - Ch. 8 - Variables, Constants, Arrays
  863 \ Brodie - Starting FORTH - Ch. 8 - Variables, Constants, Arrays
  864 \ Brodie - Starting FORTH - Ch. 8 - Variables, Constants, Arrays
  865 \ Brodie - Starting FORTH - Ch. 8 - Variables, Constants, Arrays
  866 \ Brodie - Starting FORTH - Ch. 8 - Variables, Constants, Arrays
  867 \ Brodie - Starting FORTH - Ch. 8 - Variables, Constants, Arrays
  868 \ Brodie - Starting FORTH - Ch. 9 - Under the Hood
  869 \ Brodie - Starting FORTH - Ch. 9 - Under the Hood
  870 \ Brodie - Starting FORTH - Ch. 9 - Under the Hood
  871 \ Brodie - Starting FORTH - Ch. 9 - Under the Hood
  872 \ Brodie - Starting FORTH - Ch. 9 - Under the Hood
  873 \ Brodie - Starting FORTH - Ch. 9 - Under the Hood
  874 \ Brodie - Starting FORTH - Ch. 9 - Under the Hood
  875 \ Brodie - Starting FORTH - Ch. 9 - Under the Hood
  876 \ Brodie - Starting FORTH - Ch. 9 - Under the Hood
  877 \ Brodie - Starting FORTH - Ch. 10 - I/O and You
  878 \ Brodie - Starting FORTH - Ch. 10 - I/O and You
  879 \ Brodie - Starting FORTH - Ch. 10 - I/O and You
  880 \ Brodie - Starting FORTH - Ch. 10 - I/O and You
  881 \ Brodie - Starting FORTH - Ch. 10 - I/O and You
  892 ( trim routine )
  893 ( trim routine )
  895 1 RPI0 wrapper )
  896 ( RPI0 wrapper )
  897 ( RPI0 wrapper )
  898 ( RPI0 wrapper )
  899 ( Example for THIS definition )
  900 ( UART Raspberry PI Zero )
  901 ( UART Raspberry PI Zero - setup )
  902 ( UART Raspberry PI Zero - setup )
  903 ( UART Raspberry PI Zero - setup )
  904 ( UART Raspberry PI Zero - setup )
  905 ( UART Raspberry PI Zero - transmit )
  906 ( UART Raspberry PI Zero - transmit )
  907 ( UART Raspberry PI Zero - receive )
  908 ( UART Raspberry PI Zero - receive )
  909 ( UART Raspberry PI Zero - receive )
  910 ( UART Raspberry PI Zero - receive a block )
  911 ( UART Raspberry PI Zero - receive a block )
  912 ( UART Raspberry PI Zero - receive a block )
  913 ( UART Raspberry PI Zero - receive a block )
  914 ( UART Raspberry PI Zero - receive a block )
  915 ( UART Raspberry PI Zero - block receive )
  916 ( UART Raspberry PI Zero - send a command )
  917 ( UART Raspberry PI Zero )
  918 ( UART Raspberry PI Zero )
  919 ( UART Raspberry PI Zero )
  920 ( UART Raspberry PI Zero - simple terminal )
  921 ( UART Raspberry PI Zero - simple terminal )
  922 ( UART Raspberry PI Zero - simple terminal )
  930 ( UART Raspberry PI Zero - testing )
  931 ( UART Raspberry PI Zero - testing )
  932 ( UART Raspberry PI Zero - testing )
  940 ( DOT-RELATIVE + FILENAME" )
  941 ( SAVE-BYTES TEST )
  942 ( UART Raspberry PI Zero )
  943 ( UART Raspberry PI Zero - setup )
  946 ( variables )
  947 ( .python )
  948 ( UART Raspberry PI Zero - setup )
  949 ( UART Raspberry PI Zero - simple terminal )
  950 ( MAP-KEYB )
  951 ( CAPS-LOCK )
  952 ( VIDEO-TIMING )
  953 ( UART-SELECT )
  954 ( UART-SELECT )
  960 ( traverse heap )
  961 ( dir sort )
  962 ( combsort gap tester )
  989 ( AY  Sound )
  990 ( AY  Sound )
  991 ( AY  Sound )
  992 ( AY  Sound )
  993 ( AY  Sound )
  994 ( AY  Sound )
  996 ( ?break )
  997 ( Sound )
  998 ( Layer2 Clip Example )
  999 ( Sinus )
 1000 ( custom KEY )
 1001 ( at. ink. paper. )
 1002 ( test )
 1003 ( plot layer2 )
 1004 ( plot layer2 )
 1005 ( draw-line )
 1006 ( draw-line )
 1007 ( draw-line )
 1008 ( draw-line example )
 1009 ( beep example )
 1010 ( D+ )
 1011 ( mouse test )
 1012 ( mouse test )
 1013 ( FLIP )
 1015 ( Bresenhams' Circle )
 1016 ( Bresenhams' Circle )
 1017 ( Bresenhams' Circle )
 1018 ( Bresenhams' Circle )
 1020 ( AY-3-8910 )
 1021 ( AY-3-8910 )
 1022 ( AY-3-8910 )
 1034 ( mod65537 )
 1035 ( RND tester )
 1036 ( RND tester )
 1037 ( RND )
 1038 ( Example: RND Test )
 1039 ( CHOOSE - Brodie )
 1040 .(            RND ) CR
 1100 ( L11-pixeladd )
 1101 ( L11-pixeladd )
 1111 ( fm/mod )
 1112 ( test )
 1113 ( test )
 1114 ( test )
 1115 ( test )
 1116 ( test )
 1118 ( RND )
 1601 ( test )
 1602 ( test )
 1615 latest -- smudge   immediate (;code)   does>    -find
 1616 ( DP and HP model )
 1617 ( h-latest )
 1618 ( heap dictionary )
 1619 ( heap dictionary )
 1620 ( heap dictionary )
 1621 ( heap dictionary )
 1998 ( SHADOW SCREEN )
 1999 ( touch.f )
 2022 ( Christmas Star )
 2200 ( tutorial afx loader )
 2201 ( tutorial/afx/zxgames/arcanoid2_1.afx
 2202 ( tutorial/afx/zxgames/arcanoid2_3.afx
 2203 ( tutorial/afx/zxgames/arcanoid2_5.afx
 2204 ( tutorial/afx/zxgames/captainfizz_2.afx
 2205 ( tutorial/afx/zxgames/captainfizz_4.afx
 2206 ( tutorial/afx/zxgames/clickmania_1.afx
 2207 ( tutorial/afx/zxgames/clickmania_3.afx
 2208 ( tutorial/afx/zxgames/clickmania_5.afx
 2209 ( tutorial/afx/zxgames/cybernoid_10.afx
 2210 ( tutorial/afx/zxgames/cybernoid_12.afx
 2211 ( tutorial/afx/zxgames/cybernoid_3.afx
 2212 ( /sfx/zxgames/cybernoid_7.afx
 2213 ( /sfx/zxgames/cybernoid_9.afx
 2214 ( /sfx/zxgames/exolon_2.afx
 2215 ( /sfx/zxgames/exolon_4.afx
 2216 ( /sfx/zxgames/exolon_6.afx
 2217 ( /sfx/zxgames/exolon_8.afx
 2218 ( /sfx/zxgames/fireandice_2.afx
 2219 ( /sfx/zxgames/fireandice_4.afx
 2220 ( /sfx/zxgames/fireandice_6.afx
 2221 ( /sfx/zxgames/licensetokill_2.afx
 2222 ( /sfx/zxgames/licensetokill_4.afx
 2223 ( /sfx/zxgames/megatetris2k_2.afx
 2224 ( /sfx/zxgames/megatetris2k_4.afx
 2225 ( /sfx/zxgames/mineman2_2.afx
 2226 ( /sfx/zxgames/mineman2_4.afx
 2227 ( /sfx/zxgames/mkdemo_1.afx
 2228 ( /sfx/zxgames/netherworld_1.afx
 2229 ( /sfx/zxgames/netherworld_3.afx
 2230 ( /sfx/zxgames/netherworld_5.afx
 2231 ( /sfx/zxgames/netherworld_7.afx
 2232 ( /sfx/zxgames/netherworld_9.afx
 2233 ( /sfx/zxgames/rainbowislands_2.afx
 2234 ( /sfx/zxgames/rainbowislands_4.afx
 2235 ( /sfx/zxgames/rodland_2.afx
 2236 ( /sfx/zxgames/rodland_4.afx
 2237 ( /sfx/zxgames/rodland_6.afx
 2238 ( /sfx/zxgames/saintdragon_2.afx
 2239 ( /sfx/zxgames/saintdragon_4.afx
 2240 ( /sfx/zxgames/silkworm_2.afx
 2241 ( /sfx/zxgames/silkworm_4.afx
 2242 ( /sfx/zxgames/silkworm_6.afx
 2243 ( /sfx/zxgames/wizball_2.afx
 2244 ( /sfx/zxgames/wizball_4.afx
 2245 ( /sfx/zxgames/wizball_6.afx
 2246 ( /sfx/zxgames/wizball_8.afx
 2250 ( /sfx/zxmsxdemo/aleste_1.afx
 2251 ( /sfx/zxmsxdemo/aleste_11.afx
 2252 ( /sfx/zxmsxdemo/aleste_13.afx
 2253 ( /sfx/zxmsxdemo/aleste_2.afx
 2254 ( /sfx/zxmsxdemo/aleste_4.afx
 2255 ( /sfx/zxmsxdemo/aleste_6.afx
 2256 ( /sfx/zxmsxdemo/aleste_8.afx
 2257 ( /sfx/zxmsxdemo/druid_1.afx
 2258 ( /sfx/zxmsxdemo/druid_3.afx
 2259 ( /sfx/zxmsxdemo/druid_5.afx
 2260 ( /sfx/zxmsxdemo/firebird_10.afx
 2261 ( /sfx/zxmsxdemo/firebird_12.afx
 2262 ( /sfx/zxmsxdemo/firebird_14.afx
 2263 ( /sfx/zxmsxdemo/firebird_16.afx
 2264 ( /sfx/zxmsxdemo/firebird_18.afx
 2265 ( /sfx/zxmsxdemo/firebird_2.afx
 2266 ( /sfx/zxmsxdemo/firebird_21.afx
 2267 ( /sfx/zxmsxdemo/firebird_23.afx
 2268 ( /sfx/zxmsxdemo/firebird_25.afx
 2269 ( /sfx/zxmsxdemo/firebird_3.afx
 2270 ( /sfx/zxmsxdemo/firebird_5.afx
 2271 ( /sfx/zxmsxdemo/firebird_7.afx
 2272 ( /sfx/zxmsxdemo/firebird_9.afx
 2273 ( /sfx/zxmsxdemo/girlyblock_10.afx
 2274 ( /sfx/zxmsxdemo/girlyblock_12.afx
 2275 ( /sfx/zxmsxdemo/girlyblock_14.afx
 2276 ( /sfx/zxmsxdemo/girlyblock_2.afx
 2277 ( /sfx/zxmsxdemo/girlyblock_4.afx
 2278 ( /sfx/zxmsxdemo/girlyblock_6.afx
 2279 ( /sfx/zxmsxdemo/girlyblock_8.afx
 2280 ( /sfx/zxmsxdemo/metalgear_1.afx
 2281 ( /sfx/zxmsxdemo/metalgear_11.afx
 2282 ( /sfx/zxmsxdemo/metalgear_13.afx
 2283 ( /sfx/zxmsxdemo/metalgear_2.afx
 2284 ( /sfx/zxmsxdemo/metalgear_4.afx
 2285 ( /sfx/zxmsxdemo/metalgear_6.afx
 2286 ( /sfx/zxmsxdemo/metalgear_8.afx
 2287 ( /sfx/zxmsxdemo/nemesis_1.afx
 2288 ( /sfx/zxmsxdemo/nemesis_11.afx
 2289 ( /sfx/zxmsxdemo/nemesis_13.afx
 2290 ( /sfx/zxmsxdemo/nemesis_15.afx
 2291 ( /sfx/zxmsxdemo/nemesis_17.afx
 2292 ( /sfx/zxmsxdemo/nemesis_19.afx
 2293 ( /sfx/zxmsxdemo/nemesis_20.afx
 2294 ( /sfx/zxmsxdemo/nemesis_4.afx
 2295 ( /sfx/zxmsxdemo/nemesis_6.afx
 2296 ( /sfx/zxmsxdemo/nemesis_8.afx
 2297 ( /sfx/zxmsxdemo/penguinadventure_1.afx
 2298 ( /sfx/zxmsxdemo/penguinadventure_11.afx
 2299 ( /sfx/zxmsxdemo/penguinadventure_2.afx
 2300 ( /sfx/zxmsxdemo/penguinadventure_4.afx
 2301 ( /sfx/zxmsxdemo/penguinadventure_6.afx
 2302 ( /sfx/zxmsxdemo/penguinadventure_8.afx
 2303 ( /sfx/zxmsxdemo/treasureofusas_1.afx
 2304 ( /sfx/zxmsxdemo/treasureofusas_3.afx
 2305 ( /sfx/zxmsxdemo/treasureofusas_5.afx
 2306 ( /sfx/zxmsxdemo/vampirekiller_10.afx
 2307 ( /sfx/zxmsxdemo/vampirekiller_12.afx
 2308 ( /sfx/zxmsxdemo/vampirekiller_14.afx
 2309 ( /sfx/zxmsxdemo/vampirekiller_16.afx
 2310 ( /sfx/zxmsxdemo/vampirekiller_18.afx
 2311 ( /sfx/zxmsxdemo/vampirekiller_2.afx
 2312 ( /sfx/zxmsxdemo/vampirekiller_3.afx
 2313 ( /sfx/zxmsxdemo/vampirekiller_5.afx
 2314 ( /sfx/zxmsxdemo/vampirekiller_7.afx
 2315 ( /sfx/zxmsxdemo/vampirekiller_9.afx
 2316 ( /sfx/zxmsxdemo/zanac_10.afx
 2318 ( /sfx/zxmsxdemo/zanac_3.afx
 2319 ( /sfx/zxmsxdemo/zanac_5.afx
 2320 ( /sfx/zxmsxdemo/zanac_7.afx
 2321 ( /sfx/zxmsxdemo/zanac_9.afx
 2323 ( /sfx/streetsofrage_2/noname003.afx
 2324 ( /sfx/streetsofrage_2/noname005.afx
 2325 ( /sfx/streetsofrage_2/noname007.afx
 2326 ( /sfx/streetsofrage_2/noname009.afx
 2327 ( /sfx/streetsofrage_2/noname011.afx
 2328 ( /sfx/streetsofrage_2/noname013.afx
 2329 ( /sfx/streetsofrage_2/noname015.afx
 2330 ( /sfx/streetsofrage_2/noname017.afx
 2331 ( /sfx/streetsofrage_2/noname019.afx
 2332 ( /sfx/streetsofrage_2/noname021.afx
 2333 ( /sfx/streetsofrage_2/noname023.afx
 2336 ( /sfx/test/test2.afx
 2337 ( /sfx/test/test4.afx
 2338 ( /sfx/test/test6.afx
 2339 ( /sfx/test/test8.afx
 2340 ( /sfx/test/test11.afx
 2341 ( /sfx/test/test13.afx
 2342 ( /sfx/test/test15.afx
 2343 ( /sfx/test/test17.afx
 2344 ( /sfx/test/test19.afx
 2350 ( AFX demo )
 2351 ( AFX demo )
 2380 filename" L2_10_1113.bin" hex 10 mmu7! print1 save-page
 2872     CR DECIMAL U. HEX U.
 2873 ( CHOOSE - Brodie )
 3333 ( disk free )              needs f_getfree
 3916 RS loading error.
 3918     CR DECIMAL U. HEX U.
 3968 x     xxx x xxx x xxx x xxx x xxx x xxx x xxx x xxx x xxx x xxx
 3969 x     x x x x xxx x x x xxx x x x x xxx x x x x x xxx x x xxx x
 3970 x
 3971     x            x            x            x            x
 3972            x
 3973 
 3974 x
 3975                            x                               x
 4000 xx  x x xxx x xxx x xxx xxxxx x xxxxx xxx x xxx xxxxx xxxxx x xx
 4001 xxxxxxx x xxxxx xxxxxxxxx x xxxxxxxxx x xxxxx xxxxxxxxxxxxxxxxx
 4002 xxxxx xxxxxxxxx xxxxx xxxxxxxxxxx x xxx x xxxxxxxxx xxxxxxxxxxx
 4003 xxxxxxx xxx xxxxx xxxxxxxxxxxxxxxxxxx xxxxxxxxx x xxxxxxxxxxxxxx
 4004 xxx xxxxxxxxxxx xxxxxxxxxxxxxxx x xxx xxxxx xxxxxxxxxxxxx xxx x
 4005 xxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxx xxxxxxxxxxxxx xxx xxxxxxx xxxx
 4006 xxxxxxx xxxxxxxxxxx xxxxxxxxx xxxxxxxxxxxxxxxxxxxxxxx x xxx xxxx
 4007 xxxxxxxxx xxxxxxxxx xxxxx xxxxxxxxxxxxx xxx x xxxxx xxxxxxxxx xx
 4008 xxxxxxxxxxxxxxxxx xxxxxxxxx x xxxxxxxxx x xxx xxxxx xxxxxxxxxxxx
 4009 xxxxx xxxxx xxxxxxxxxxx x xxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxx xx
 4010 xxx xxx xxxxx xxxxx xxxxxxx xxx x xxxxxxxxxxxxxxx xxxxxxxxxxx x
 4011 xxxxxxxxx xxxxx xxxxxxx xxxxxxxxxxx xxxxxxxxxxx xxxxx xxx xxxxxx
 4012 x xxxxxxxxxxx xxxxxxxxxxxxxxxxxxxxx xxxxx xxxxxxxxxxxxx xxx xxxx
 4013 x xxxxxxxxxxxxx xxx xxxxx x xxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxxxxx
 4014 xxxxx xxxxx xxxxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxx x xxxxxxxxxx
 4015 x xxxxxxxxxxx xxx xxxxx xxxxxxx xxxxxxxxx xxxxxxxxxxx xxxxxxxxxx
 4016 xxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxx xxx xxxxx xxxxx xxxxxxxxxxxxx
 4017 xxxxxxxxx x xxxxxxxxxxx xxxxxxxxxxx xxxxx xxxxxxxxxxxxxxxxx xxx
 4018 x xxxxx xxx xxxxxxx xxxxx xxx xxxxxxxxxxxxxxxxxxx xxxxxxxxxxx xx
 4019 x xxxxx xxxxx x xxxxx xxxxx xxxxx xxxxxxxxxxx xxxxx xxxxxxxxxxxx
 4020 xxx xxxxxxxxxxxxxxxxxxxxxxx x xxxxxxxxxxx xxxxxxxxxxx xxxxxxxxx
 4021 xxxxxxxxxxxxx xxx x xxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxx x xxx xxxx
 4022 xxx xxxxxxxxx x xxxxx xxxxxxxxxxxxxxxxx xxx x xxxxxxxxxxxxxxxxxx
 4023 xxxxx xxx x xxx xxxxxxxxxxxxx xxxxxxxxxxx xxxxx xxx xxxxx xxxxxx
 4024 xxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxx xxxxxxxxxxx xxxxxxx xxxxxxxx
 4025 x x xxxxx xxxxxxxxxxx xxxxxxxxxxx xxxxx xxx xxxxxxxxxxxxx xxxxxx
 4026 xxx xxxxx xxxxxxx xxxxx xxxxxxxxxxxxxxxxxxxxx xxxxxxxxxxx x xxx
 4027 xxxxx xxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxx x xxxxx xxx xxxxxxxxxx
 4028 xxxxxxxxxxxxxxxxxxxxxxxxx xxxxx xxxxxxx xxxxxxxxxxx xxxxx xxxxxx
 4029 xxxxxxxxxxxxxxxxxxxxx xxxxx xxxxxxxxxxxxxxxxx xxxxxxxxxxx xxxxx
 4030 xxxxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxx xxxxxxxxx xxxxxxx xx
 4031 xxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
 4646 ( reply )
 6475 ( solid circle )
 6476 : solid-circle ( x y r -- )
 6989 ( new SPLASH with string on Heap )
 8990 ( PRESENTATION )
 8991 ( PRESENTATION )
 8992 ( PRESENTATION )
 8993 ( PRESENTATION )
 8998 ( wait )
 8999 ---  D I R E C T O R Y  ---
 9000 ---  T I M E L I N E  ---
 9001 ---  D I R E C T O R Y  ---
 9002 ---  M E M O R Y   M A P  ---
 9003 ---  U T I L I T I E S  ---
 9004 ---  E X A M P L E S  ---
 9005 ---  A S S E M B L E R   1  ---
 9006 ---  A S S E M B L E R   2  ---
 9007 ---  A S S E M B L E R   3  ---
 9008 ---  A S S E M B L E R   4  ---
 9009 ---  D I R E C T   v s   I N D I R E C T ---
 9010 ---  D I R E C T   v s   I N D I R E C T ---
 9012 ---  H E A P   C O N C E P T  ---
 9013 ---  H E A P   D E F I N I T I O N S  ---
 9058    8 24 at. h-bar count type
 9990 ( splash screen )
 9991 ( splash screen )
 9992 ( splash screen )
 9993 ( splash screen )
 9994 ( splash screen )
 9999 ( MIT License )
10000 ( splash screen )
10001 ( Table of contents 1/2 ) ;S
10002 ( Table of contents 2/2 ) ;S
10003 .( Autoexec. )            CR
10004 ( Error messages    1/3 )
10005 ( Error messages    2/3 )
10006 ( Error messages    3/3 )
10007 ( Get the list of errors )
10008 ( DR0 )
10009 ." Assembler. "           CR
10010 .( Line editor. )         CR
10011 ( Line Editor          2/6 )
10012 ( Line Editor          3/6 )
10013 ( Line Editor          4/6 )
10014 ( Line Editor          5/6 )
10015 ( Line Editor          6/6 )
10016 ( Editor utility           )
10017 .( Case-of structure. )   CR
10018 ( Case-Of structure  2/2 )
10019 .( Call utility. )        CR
10020 .( Debugger. )            CR
10021 ( Debugger             2/6 )
10022 ( Debugger             3/6 )
10023 ( Debugger             4/6 )
10024 ( Debugger             5/6 )
10025 ( Debugger             6/6 )
10026 ( Stack viewer             )
10027 ( ?ESCAPE experiment       )
10028 ( Vocabulary viewer        )
10029 ( Simple Word RENAMEr )
10030 .( Floating point utility. )
10031 ( FLOATING             2/7 )
10032 ( FLOATING             3/7 )
10033 ( FLOATING             4/7 )
10034 ( FLOATING             5/7 )
10035 ( FLOATING             6/7 )
10036 ( FLOATING             7/7 )
10037 ( VALUE TO )
10038 ( BEHAVE )
10040 ( RND                      )
10041 ( COLOR                    )
10042 ( AT TAB                   )
10043 ( POINT SCREEN$ )
10044 ( PLOT )
10045 ( DRAW                     )
10046 ( PAINT )
10047 ( PAINT )
10048 ( Mr Jones' keyboard test )
10049 ( Mr Jones' keyboard test )
10050 ( BLEEP )
10051 ( BLEEP )
10052 ( Pitch bend )
10053 ( KEYBOARD-TEST )
10055 ( MS delay )
10057 ( FRAMES )
10058 ( FRAMES )
10059 ( TEST )
10060 ( Interrupt Handler )
10061 ( Interrupt Handler )
10062 ( Interrupt Handler )
10063 ( Interrupt Handler )
10064 ( Interrupt Handler )
10065 ( Interrupt Handler )
10066 ( Interrupt Handler )
10068 ( INTERRUPT - TEST )
10069 ( INTERRUPT )
10070 ." Microdrives " CR
10071 ( MICRODRIVE )
10072 ( MICRODRIVE )
10073 ( COMPARE )
10074 ( COMPARE )
10075 ( BSEARCH )
10076 ( SEARCH )
10077 ( BSEARCH SEARCH-ALL )
10078 ( LOCATE )
10079 ( LOCATE )
10080 ( MDRR2   n -- )
10081 ( UPPER )
10085 ( SET-FENCE )
10086 ( CHECK NULL               )
10087 ( USED-BY )
10088 ( DUMP WORDS )
10089 ( HIDE )
10090 ( STRING )
10091 ( Word List )
10092 ( RS to MDR mover )
10093 ( RS-LIST )
10098 ( MOVE SP & RP )
10099 ( SET-FENCE )
10100 .( Z80 Assembler. ) CR
10101 ( Z80 Utility - Sys depend )
10102 ( Z80 Utility - Sys depend )
10103 ( Z80 System independ. )
10104 ( Z80 System independ. )
10105 ( Z80 Generate errors )
10106 ( Assembler Z80 )
10107 ( Assembler Z80 )
10108 ( Assembler Z80 )
10109 ( Assembler Z80 )
10110 ( Assembler Z80 )
10111 ( Assembler Z80 )
10112 ( Assembler Z80 )
10113 ( Assembler Z80 )
10114 ( Assembler Z80 )
10115 ( Assembler Z80 )
10116 ( Assembler Z80 )
10117 ( Assembler z80 )
10120 .( Z80 definitions. ) CR
10121 ( Z80 ) HEX
10122 ( Z80 ) HEX
10123 ( Z80 ) HEX
10124 ( Z80 immediate data )
10125 ( Z80 address )
10126 ( Z80 ) HEX
10127 ( Z80 relative jump )
10128 ( ED prefix )
10129 ( ED )
10130 ( ED )
10131 ( CB )
10132 ( IX IY )
10133 ( IX IY )
10134 ( IX IY )
10135 ( IX IY )
10136 ( IX IY )
10137 ( IX IY )
10138 ( IX IY )
10140 .( Z80 near structure )   CR
10141 ( Z80 Near struct. )
10142 ( Z80 Near struct. )
10143 ( Z80 Near struct. )
10144 ." Z80 far struct "
10146 ( TESTING )
10149 ( 128K Bank )
10150 ( TEST )
10151 ( TEST1 )
10152 ( TEST2 )
10153 ( TEST3 )
10154 ( TEST IF, THEN, )
10155 \ TEST
10156 \ TEST6
10157 \ TEST7
10158 \ TEST Z80N
10159 \ TEST Z80N
10160 ( Z80N Next extension )
10161 ( Z80N Next extension )
10162 ( Z80N Next extension )
10163 ( DAA )
10164 ( 2CONSTANT )
10165 ( Fibonacci )
10166 ( White noise Egghead 3 )
10167 ( White noise Egghead 3 )
10168 ( White noise Egghead 3 )
10169 ( Checksum of a RAM chunk )
10170 \ BURP
10171 ( U* )
10172 ( U* )
10173 ( U/   dn n -- r dq )
10174 ( U/ )
10175 ( U/ )
10176 ( DSQRT )
10177 ( DSQRT )
10178 ( D2* )
10179 ( D2/ )
10180 ( LARGE LETTER-F )
10202 ( DAA )
10211 \ S" ( strings )
10220 ( MOVE SP )
10221 ( MOVE RP )
10222 ( MOVE LIMIT )
10223 ( UP AND DOWN )
10224 ( BANK! TEST )
10230 ( DOS CALL# )
10231 ( DOS CALL# )
10239 ( Rainbow effects )
10240 ( +3DOS TEST )
10251 ( block move reorder )
10252 \ Print all blocsks to #13
10254 ( MICRODRIVE CARTRIDGE )
10259 ( POSTPONE )
10270 ( PICK )
10287 ( GREY-SCREEN example )
10288 ( GREY-SCREEN example )
10292 ( GREY-SCREEN example )
10293 ( MMU7 = 40h )
10300 ( FAR-HL )
10301 ( FAR-HL )
10305 ( MMU7 banking study )
10306 ( MMU7 banking study )
10307 ( MMU7 banking study )
10308 ( MMU7 banking study )
10309 ( MMU7 banking study )
10310 ( MMU7 banking study )
10311 ( MMU7 banking study )
15360 
15361 x     x x x x x x x x x x x x x x x x x x x x x x x x x x x x x
15362 x             x          x          x          x          x
16000 ( porting page 1 to blocks )
